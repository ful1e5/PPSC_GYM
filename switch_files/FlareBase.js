(window.webpackJsonp=window.webpackJsonp||[]).push([[2],Array(168).concat([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=u(n(18)),i=n(7),a=u(n(300)),s=u(n(287)),l=u(n(329));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._RecomputeAABB=!1,n._AABB=new a.default,n._StageContext=null,n._Stage=null,n._HitDetectOnMesh=!0,n._MinPoint=i.vec2.create(),n._MaxPoint=i.vec2.create(),n._MeshPoints=null,n._MeshStride=0,n._MeshIndices=null,n._RecomputeContour=!1,n._MeshContourIndices=null,n._Contour=null,n._IsSelected=!1,n._IsVisible=!0,n._IsLocked=!1,n._IsSelectable=!0,n._IsFiltered=!1,n._Node=e||null,n._WorldPoints=[i.vec2.create(),i.vec2.create(),i.vec2.create(),i.vec2.create()],n._Highlight=!1,n._RenderTransform=i.mat2d.create(),n._InverseRenderTransform=i.mat2d.create(),n._TempOverPoint=i.vec2.create(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"updateHighlights",value:function(e){var t=this.node;if(t){var n=t.root;if(n){var r=t.constraints;if(r){var o=!0,i=!1,a=void 0;try{for(var l,u=r[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;c.stageItem&&c.stageItem.updateHighlights(e)}}catch(e){i=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw a}}}var d=n.dependencyGraph.getDependents(t);if(d){var f=!0,h=!1,p=void 0;try{for(var y,v=d[Symbol.iterator]();!(f=(y=v.next()).done);f=!0){var m=y.value.constraints;if(m){var g=!0,b=!1,k=void 0;try{for(var S,O=m[Symbol.iterator]();!(g=(S=O.next()).done);g=!0){var w=S.value;w instanceof s.default&&w.target===t&&w.stageItem&&w.stageItem.updateHighlights(e)}}catch(e){b=!0,k=e}finally{try{!g&&O.return&&O.return()}finally{if(b)throw k}}}}}catch(e){h=!0,p=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw p}}}}}}},{key:"setNode",value:function(e){this._Node=e}},{key:"computeTightAABB",value:function(e){return null}},{key:"computeRecursiveTightAABB",value:function(e){var t=e(this)&&this.computeTightAABB(!0)||null;if(this.node instanceof l.default){var n=!0,r=!1,o=void 0;try{for(var i,s=this.node.children[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value.stageItem,c=e(u)&&u.computeRecursiveTightAABB(e)||null;c&&(t?t.combine(c):t=c)}}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}}if(this._tightAABB=t,t){var d=new a.default;d.set(t.min,t.max),t=d}return t}},{key:"dispatchSelectionChanged",value:function(){var e=this._IsSelected;this.onSelectedChange&&this.onSelectedChange(e),this.dispatch("selectedChange",e)}},{key:"setSelected",value:function(e,t){return this._IsSelected!=e&&(this._IsSelected=e,t||this.dispatch("selectedChange",e),!0)}},{key:"computeAABB",value:function(){for(var e=Number.MAX_VALUE,t=Number.MAX_VALUE,n=-Number.MAX_VALUE,r=-Number.MAX_VALUE,o=[i.vec2.set(this._WorldPoints[0],this._MinPoint[0],this._MinPoint[1]),i.vec2.set(this._WorldPoints[1],this._MaxPoint[0],this._MinPoint[1]),i.vec2.set(this._WorldPoints[2],this._MaxPoint[0],this._MaxPoint[1]),i.vec2.set(this._WorldPoints[3],this._MinPoint[0],this._MaxPoint[1])],a=0;a<o.length;a++){var s=o[a],l=i.vec2.transformMat2d(s,s,this._RenderTransform);l[0]<e&&(e=l[0]),l[1]<t&&(t=l[1]),l[0]>n&&(n=l[0]),l[1]>r&&(r=l[1])}this._AABB.set([e,t],[n,r])}},{key:"setMinMax",value:function(e,t){i.vec2.copy(this._MinPoint,e),i.vec2.copy(this._MaxPoint,t),this._RecomputeAABB=!0}},{key:"getLocalPoint",value:function(e){return this._TempOverPoint[0]=e[0],this._TempOverPoint[1]=e[1],i.vec2.transformMat2d(this._TempOverPoint,this._TempOverPoint,this._InverseRenderTransform),this._TempOverPoint}},{key:"getWorldPoint",value:function(e){return this._TempOverPoint[0]=e[0],this._TempOverPoint[1]=e[1],i.vec2.transformMat2d(this._TempOverPoint,this._TempOverPoint,this._RenderTransform),this._TempOverPoint}},{key:"getViewPoint",value:function(e){return this._TempOverPoint[0]=e[0],this._TempOverPoint[1]=e[1],i.vec2.transformMat2d(this._TempOverPoint,this._TempOverPoint,this._RenderTransform),i.vec2.transformMat2d(this._TempOverPoint,this._TempOverPoint,this._Stage._ViewTransform),this._TempOverPoint}},{key:"isPointOver",value:function(e,t){if(this.customHitDetectEarly)return this.customHitDetectEarly(e,t);var n=this.node&&this.node.root;if(n&&n.clipContents&&!n.isPointInside(e,t))return!1;if(!this.aabb.isPointInside(e,t))return!1;if(this._TempOverPoint[0]=e,this._TempOverPoint[1]=t,i.vec2.transformMat2d(this._TempOverPoint,this._TempOverPoint,this._InverseRenderTransform),e=this._TempOverPoint[0],t=this._TempOverPoint[1],!(e>=this._MinPoint[0]&&e<=this._MaxPoint[0]&&t>=this._MinPoint[1]&&t<=this._MaxPoint[1]))return!1;if(!this._MeshIndices||!this._HitDetectOnMesh)return!this.customHitDetect||this.customHitDetect(e,t);for(var r=0;r<this._MeshIndices.length;r+=3){var o=this._MeshIndices[r]*this._MeshStride,a=this._MeshPoints[o],s=this._MeshPoints[o+1];o=this._MeshIndices[r+1]*this._MeshStride;var l=this._MeshPoints[o],u=this._MeshPoints[o+1];o=this._MeshIndices[r+2]*this._MeshStride;var c=this._MeshPoints[o],d=this._MeshPoints[o+1],f=s*c-a*d+(d-s)*e+(a-c)*t,h=a*u-s*l+(s-u)*e+(l-a)*t;if(!(f*h<0)){var p=-u*c+s*(c-l)+a*(u-d)+l*d;if(p<0&&(f=-f,h=-h,p=-p),f>0&&h>0&&f+h<p)return!0}}return!1}},{key:"setMesh",value:function(e,t,n,r){this._MeshPoints=e,this._MeshStride=t,this._MeshIndices=n,this._MeshContourIndices=r;for(var o=Number.MAX_VALUE,i=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=-Number.MAX_VALUE,l=0;l<e.length;l+=t){var u=e[l],c=e[l+1];u<o&&(o=u),c<i&&(i=c),u>a&&(a=u),c>s&&(s=c)}o===a&&(o-=10,a+=10),i===s&&(i-=10,s+=10),this._MinPoint[0]=o,this._MinPoint[1]=i,this._MaxPoint[0]=a,this._MaxPoint[1]=s,this._RecomputeAABB=!0,this._RecomputeContour=!0}},{key:"addToStage",value:function(e){if(null===this._Stage){if(this._Stage=e,e){var t=this.node;if(t&&!t.root)return void e.displayWarning({title:"No Artboard.",message:"Create an Artboard to add elements on the stage."});this._StageContext=e.getStageItemContext(this),e.addItem(this),this.dispatch("addedToStage",e,this),this._IsSelected=e.isItemSelected(this)}this.onAddedToStage&&this.onAddedToStage(e)}}},{key:"removeFromStage",value:function(){if(this._Stage){var e=this._Stage;this._Stage=null,e.removeItem(this),this.dispatch("removedFromStage",e,this),this.onRemovedFromStage&&this.onRemovedFromStage(e)}}},{key:"drawOBB",value:function(e,t,n){this._RecomputeAABB&&(this.computeAABB(),i.mat2d.invert(this._InverseRenderTransform,this._RenderTransform),this._RecomputeAABB=!1);for(var r=[i.vec2.set(i.vec2.create(),this._MinPoint[0],this._MinPoint[1]),i.vec2.set(i.vec2.create(),this._MaxPoint[0],this._MinPoint[1]),i.vec2.set(i.vec2.create(),this._MaxPoint[0],this._MaxPoint[1]),i.vec2.set(i.vec2.create(),this._MinPoint[0],this._MaxPoint[1])],o=0;o<r.length;o++){var a=r[o];i.vec2.transformMat2d(a,a,this._RenderTransform)}var s=[r[0][0],r[0][1],r[1][0],r[1][1],r[2][0],r[2][1],r[3][0],r[3][1],r[0][0],r[0][1]];e.drawLine(null,s,t,n)}},{key:"drawAABB",value:function(e,t,n){var r=this.aabb,o=[r.min[0],r.min[1],r.max[0],r.min[1],r.max[0],r.max[1],r.min[0],r.max[1],r.min[0],r.min[1]];e.drawLine(null,o,t,n)}},{key:"drawContour",value:function(e){if(this._RecomputeContour&&this._MeshContourIndices){this._RecomputeContour=!1;for(var t=[],n=0;n<this._MeshContourIndices.length;n++){var r=this._MeshContourIndices[n]*this._MeshStride;t.push([this._MeshPoints[r],this._MeshPoints[r+1]])}this._Contour=e.makeThickLine(t,!0)}if(this._Contour){var o=this._Stage,i=this.renderViewTransform;e.drawThickLine(i,this._Contour,o.settings.contourThickness/o.scale*o.screenScale,o.settings.contourOpacity,this._IsSelected?o.settings.selectionColor:o.settings.highlightColor)}}},{key:"rectIntersects",value:function(e){return this._RecomputeAABB&&(this.computeAABB(),i.mat2d.invert(this._InverseRenderTransform,this._RenderTransform),this._RecomputeAABB=!1),t.polygonsIntersect(this._WorldPoints,e)}},{key:"setTranslation",value:function(e){this._RenderTransform[4]=e[0],this._RenderTransform[5]=e[1],this._RecomputeAABB=!0}},{key:"draw",value:function(e,t){}},{key:"drawSelection",value:function(e,t){}},{key:"isAutomatic",get:function(){return!0}},{key:"highlight",get:function(){return this._Highlight},set:function(e){this._Highlight!==e&&(this._Highlight=e,this.stage&&this.stage.redraw())}},{key:"doesCustomSelection",get:function(){return!1}},{key:"isFiltered",set:function(e){this._IsFiltered!=e&&(this._IsFiltered=e,this.onFilteredChanged&&this.onFilteredChanged(e))},get:function(){return this._IsFiltered}},{key:"node",get:function(){return this._Node}},{key:"hitDetectOnMesh",get:function(){return this._HitDetectOnMesh},set:function(e){this._HitDetectOnMesh=e}},{key:"isVisible",get:function(){return this._IsVisible},set:function(e){this._IsVisible!=e&&(this._IsVisible=e,this.dispatch("visibilityChange"),this._Stage&&this._Stage.onItemVisibilityChanged(this),this.onVisibilityChanged&&this.onVisibilityChanged(e))}},{key:"isLocked",get:function(){return this._IsLocked},set:function(e){this._IsLocked!=e&&(this._IsLocked=e,this.dispatch("lockedChange"),!this._IsLocked&&this._Stage&&this._Stage.deSelectItem(this),this.onLockedChange&&this.onLockedChange(e))}},{key:"isSelectable",get:function(){return this._IsSelectable&&!this._IsLocked},set:function(e){this._IsSelectable=e}},{key:"renderTransform",get:function(){return this._RenderTransform},set:function(e){i.mat2d.copy(this._RenderTransform,e),this._RecomputeAABB=!0}},{key:"worldTranslation",get:function(){return i.mat2d.getTranslation(i.vec2.create(),this._RenderTransform)}},{key:"worldPoints",get:function(){return this._WorldPoints}},{key:"renderViewTransform",get:function(){return i.mat2d.mul(t._RenderViewTransform,this._Stage.viewTransform,this._RenderTransform)}},{key:"viewTranslation",get:function(){var e=this._RenderTransform,t=this._Stage,n=i.vec2.fromValues(e[4],e[5]);return i.vec2.transformMat2d(n,n,t.viewTransform)}},{key:"aabb",get:function(){return this._RecomputeAABB&&(this.computeAABB(),i.mat2d.invert(this._InverseRenderTransform,this._RenderTransform),this._RecomputeAABB=!1),this._AABB}},{key:"tightAABB",get:function(){return this._tightAABB}},{key:"stageContext",get:function(){return this._StageContext}},{key:"stage",get:function(){return this._Stage}},{key:"isSelected",get:function(){return this._IsSelected},set:function(e){if(this._IsSelected!=e){this._IsSelected=e;var t=this.node;this.onSelectedChange&&this.onSelectedChange(e),t&&t.root&&t.root.makeActive(),this.dispatch("selectedChange",e)}}},{key:"min",get:function(){return this._MinPoint}},{key:"max",get:function(){return this._MaxPoint}}],[{key:"computeRecursiveTightAABB",value:function(e,t){var n=null,r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value.computeRecursiveTightAABB(t);l&&(n?n.combine(l):n=l)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}},{key:"polygonsIntersect",value:function(e,t){var n,r,o,a,s,l,u,c,d=[e,t];for(a=0;a<d.length;a++){var f=d[a];for(s=0;s<f.length;s++){var h=(s+1)%f.length,p=f[s],y=f[h],v=i.vec2.set(i.vec2.create(),y[1]-p[1],p[0]-y[0]);for(n=r=null,l=0;l<e.length;l++)o=v[0]*e[l][0]+v[1]*e[l][1],(null===n||o<n)&&(n=o),(null===r||o>r)&&(r=o);for(u=c=null,l=0;l<t.length;l++)o=v[0]*t[l][0]+v[1]*t[l][1],(null===u||o<u)&&(u=o),(null===c||o>c)&&(c=o);if(r<u||c<n)return!1}}return!0}}]),t}();t.default=c,c._RenderViewTransform=i.mat2d.create()},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=c(n(329)),a=n(7),s=c(n(328)),l=c(n(175)),u=c(n(508));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Transform=a.mat2d.create(),n._WorldTransform=a.mat2d.create(),n._Translation=a.vec2.create(),n._Rotation=0,n._Scale=a.vec2.set(a.vec2.create(),1,1),n._Opacity=1,n._RenderOpacity=1,n._AnimationTranslation=a.vec2.create(),n._AnimationRotation=0,n._AnimationScale=a.vec2.set(a.vec2.create(),1,1),n._AnimationOpacity=1,n._UseAnimationValues=!1,n._KeyStatePosX=0,n._KeyStatePosY=0,n._KeyStateRotation=0,n._KeyStateOpacity=0,n._KeyStateScaleX=0,n._KeyStateScaleY=0,n._Clips=null,n._ClippingSourceFor=null,n._OverrideWorldTransform=!1,n._IsVisible=!0,n._IsCollapsedVisibility=!1,n._RenderCollapsed=!1,n._Constraints=null,n._PeerConstraints=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"setAsClippingSourceFor",value:function(e,t){this._ClippingSourceFor||(this._ClippingSourceFor=new Set),t?this._ClippingSourceFor.add(e):this._ClippingSourceFor.delete(e)}},{key:"setClips",value:function(e){if(this._Clips){var t=!0,n=!1,r=void 0;try{for(var o,i=this._Clips[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.setAsClippingSourceFor(this,!1)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}if(this._Clips=e,this._Clips){var a=!0,s=!1,l=void 0;try{for(var u,c=this._Clips[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.setAsClippingSourceFor(this,!0)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}},{key:"onDelete",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onDelete",this).call(this);var e=this._ClippingSourceFor;if(e){var n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){a.value.removeClip(this)}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}}}},{key:"removeClip",value:function(e){var t=this._Clips;if(!t)return!1;var n=t.indexOf(e);if(-1===n)return!1;t.splice(n,1),this.clips=t}},{key:"clearKeyStates",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearKeyStates",this).call(this),this.framePosXKS=0,this.framePosYKS=0,this.frameScaleXKS=0,this.frameScaleYKS=0,this.frameRotationKS=0,this.frameOpacityKS=0}},{key:"removePeerConstraint",value:function(e){if(this._PeerConstraints){var t=this._PeerConstraints.indexOf(e);-1!==t&&this._PeerConstraints.splice(t,1),0===this._PeerConstraints.length&&(this._PeerConstraints=null)}}},{key:"addPeerConstraint",value:function(e){this._PeerConstraints||(this._PeerConstraints=[]),this._PeerConstraints.push(e)}},{key:"updateDependencies",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDependencies",this).call(this,e);var n=this._Parent;n&&e.addDependency(this,n);var r=!0,i=!1,a=void 0;try{for(var s,l=this._Children[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){s.value.updateDependencies(e)}}catch(e){i=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw a}}}},{key:"onDirty",value:function(e){}},{key:"markTransformDirty",value:function(){var e=this.root;if(e){var t=e._DependencyGraph;t&&t.addDirt(this,1)&&t.addDirtRecursive(this,2)}}},{key:"updateWorldTransform",value:function(){var e=this.parent,t=e&&e.isNode;if(t){var n=this._IsCollapsedVisibility||e.renderCollapsed;this._RenderCollapsed!=n&&(this._RenderCollapsed=n,this.dispatch("renderCollapseChange")),this.setStageItemVisibility()}var r=this._UseAnimationValues?this._AnimationOpacity:this._Opacity;this._OverrideWorldTransform||a.mat2d.copy(this._WorldTransform,this.transform),t&&(r*=e.renderOpacity,this._OverrideWorldTransform||a.mat2d.mul(this._WorldTransform,e.rawWorldTransform,this._WorldTransform)),this.renderOpacity=r;var o=this._Constraints;if(o){var i=!0,s=!1,l=void 0;try{for(var u,c=o[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value;d.isEnabled&&d.constrain(this)}}catch(e){s=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}}return this.dispatch("worldTransform",this._WorldTransform),this.onWorldTransform(),!0}},{key:"update",value:function(e,t){1==(1&t)&&this.updateTransform(),2==(2&t)&&this.updateWorldTransform()}},{key:"onWorldTransform",value:function(){}},{key:"updateTransform",value:function(){var e=this._Rotation,t=this._Translation,n=this._Scale;this._UseAnimationValues&&(e=this._AnimationRotation,t=this._AnimationTranslation,n=this._AnimationScale);var r=this._Transform;return 0!==e?a.mat2d.fromRotation(r,e):a.mat2d.identity(r),r[4]=t[0],r[5]=t[1],a.mat2d.scale(r,r,n),this.dispatch("transform",this._Transform),this.onTransform&&this.onTransform(),!0}},{key:"calculateWorldTransform",value:function(){for(var e=this.parent,n=[this];e;)n.unshift(e),e=e.parent;var r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l instanceof t&&(l.updateTransform(),l.updateWorldTransform())}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return this._WorldTransform}},{key:"forceRedraw",value:function(){this._Actor.forceRedraw()}},{key:"onSetStageItem",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onSetStageItem",this).call(this,e),this.setStageItemVisibility()}},{key:"setStageItemVisibility",value:function(){this.stageItem&&(this.stageItem.isVisible=this.isVisible&&!this._RenderCollapsed)}},{key:"onParentChanged",value:function(){this.markTransformDirty()}},{key:"onChildrenChanged",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildrenChanged",this).call(this),this.updateConstraints()}},{key:"onChildAdded",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildAdded",this).call(this,e),this.updateChildRoot(e)}},{key:"updateChildRoot",value:function(e){var t=this.root;e?e instanceof i.default?e.all(function(e){e.root=t}):e.root=t:this.eachChildRecursive(function(e){e.root=t})}},{key:"resetSiblingIndices",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resetSiblingIndices",this).call(this),this.updateChildRoot()}},{key:"onChildRemoved",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildRemoved",this).call(this,e),e instanceof i.default?e.all(function(e){e.root=null}):e.root=null}},{key:"updateConstraints",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this.children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a instanceof s.default&&e.push(a)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}(0,l.default)(e,this._Constraints)||(this._Constraints=e)}},{key:"eachNodeRecursive",value:function(e){for(var n=this.children,r=0;r<n.length;r++){var o=n[r];o instanceof t&&!1!==e(o)&&o.eachNodeRecursive(e)}}},{key:"allNodes",value:function(e){if(!1!==e(this))for(var n=this.children,r=0;r<n.length;r++){var o=n[r];o instanceof t&&!1!==e(o)&&(o.eachNodeRecursive&&o.eachNodeRecursive(e))}}},{key:"read",value:function(e,n){var r=this;if(o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),n.clips){var i=n.clips;e.whenNodesLoaded(function(){for(var t=[],n=0;n<i.length;n++){var o=i[n],a=void 0;(a=o.constructor===Object?e.getNode(o.id):e.getNode(o))&&t.push(a)}t.length&&r.setClips(t)})}n.hidden&&(this._IsVisible=!1);var a=n.translation;a&&a.constructor===Array&&2==a.length&&(this._Translation[0]=a[0],this._Translation[1]=a[1]),(a=n.scale)&&a.constructor===Array&&2==a.length&&(this._Scale[0]=a[0],this._Scale[1]=a[1]),(a=n.rotation)&&a.constructor===Number&&(this._Rotation=a/180*Math.PI),this.markTransformDirty();var s=n.opacity;if(void 0!==s&&(this._Opacity=s),this.constructor===t){var l=n.displayType;void 0!==l&&(this._DisplayType=u.default.fromString(l))}}},{key:"compensate",value:function(e){if(this.parent&&!this._OverrideWorldTransform){e||(e=this._WorldTransform);var t=this.parent.calculateWorldTransform(),n=a.mat2d.invert(a.mat2d.create(),t),r=a.mat2d.mul(a.mat2d.create(),n,e),o=a.mat2d.getTranslation(a.vec2.create(),r),i=a.vec2.create(),s=a.mat2d.decompose(i,r);this.scale=i,this.translation=o,this.rotation=s}}},{key:"serializeTransform",value:function(e){e.translation=a.vec2.clone(this._Translation),e.rotation=this._Rotation,e.scale=a.vec2.clone(this._Scale)}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);this.stageItem&&!this.isVisible&&(n.hidden=!0),this.stageItem&&this.stageItem.isLocked&&(n.locked=!0),void 0!==n.rotation&&(n.rotation=n.rotation/Math.PI*180),0===n.rotation&&delete n.rotation,1===n.opacity&&delete n.opacity;var r=n.scale;r&&1===r[0]&&1===r[1]&&delete n.scale;var i=n.translation;return i&&0===i[0]&&0===i[1]&&delete n.translation,this.constructor===t&&(n.displayType=this.displayType.toString()),delete n.clips,this._Clips&&this._Clips.length&&(n.clips=this._Clips.map(function(e){return e.refId})),n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return this.serializeTransform(e),e.opacity=this._Opacity,this.constructor===t&&(e.displayType=this.displayType),e.clips=this._Clips&&this._Clips.slice(0)||null,e}},{key:"serialize",value:function(e){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this,e)}},{key:"nullFrame",value:function(){return{framePosX:null,framePosY:null,frameScaleX:null,frameScaleY:null,frameOpacity:null,frameRotation:null}}},{key:"clips",get:function(){return this._Clips},set:function(e){this.setClips(e),this.forceRedraw(),this.dispatch("clipsChange")}},{key:"displayType",get:function(){return this._DisplayType||u.default.Empty},set:function(e){if(this._DisplayType!==e){this._DisplayType=e,this.dispatch("displayChange"),this.forceRedraw();var t=this.stageItem;t&&t.updateDisplayType(e)}}},{key:"uiHierIconClass",get:function(){return this.parent?this.displayType===u.default.Target?"HierarchyIKTargetIcon":"HierarchyNodeIcon":"HierarchyCharIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionNodeIcon"}},{key:"isConstrained",get:function(){return!(!this._Constraints||!this._Constraints.find(function(e){return e.isEnabled}))||!(!this._PeerConstraints||!this._PeerConstraints.find(function(e){return e.isEnabled}))}},{key:"uiIcon",get:function(){return this.parent?this.displayType===u.default.Target?"icon-iktarget":"icon-node":"icon-character"}},{key:"allowDragDrop",get:function(){return!0}},{key:"typeName",get:function(){return"Node"}},{key:"dirtInfo",get:function(){var e=this._Actor._DependencyGraph;if(!e)return"no graph";var t=e.getDirt(this),n=[];return 1==(1&t)&&n.push("TransformDirty"),2==(2&t)&&n.push("WorldTransformDirty"),0===n.length?"Clean":n.join(",")}},{key:"constraints",get:function(){return this._Constraints}},{key:"allConstraints",get:function(){return new Set((this._Constraints||[]).concat(this._PeerConstraints||[]))}},{key:"isNode",get:function(){return!0}},{key:"rigTranslation",get:function(){return this._Translation}},{key:"translation",get:function(){if(this._OverrideWorldTransform&&this.parent){var e=a.mat2d.invert(a.mat2d.create(),this.parent.worldTransform),t=a.mat2d.mul(a.mat2d.create(),e,this._WorldTransform);return a.mat2d.getTranslation(a.vec2.create(),t)}return this._OverrideTransform?a.mat2d.getTranslation(a.vec2.create(),this._Transform):this._UseAnimationValues?this._AnimationTranslation:this._Translation},set:function(e){if(this._UseAnimationValues){var n=e[0];if(Math.abs(n-this._AnimationTranslation[0])>t.EPSILON){var r=this.framePosX;this.framePosX=n,this.dispatch("animatePosX",{from:r,to:n})}var o=e[1];if(Math.abs(o-this._AnimationTranslation[1])>t.EPSILON){var i=this.framePosY;this.framePosY=o,this.dispatch("animatePosY",{from:i,to:o})}}else a.vec2.isEqual(this._Translation,e)||(a.vec2.copy(this._Translation,e),this.markTransformDirty())}},{key:"overrideWorldTransform",get:function(){return this._OverrideWorldTransform},set:function(e){null===e?this._OverrideWorldTransform=!1:(this._OverrideWorldTransform=!0,a.mat2d.copy(this._WorldTransform,e)),this.markTransformDirty()}},{key:"hasTransformOverride",get:function(){return this._OverrideTransform}},{key:"hasWorldTransformOverride",get:function(){return this._OverrideWorldTransform}},{key:"worldTranslation",get:function(){var e=this.worldTransform;return a.mat2d.getTranslation(a.vec2.create(),e)}},{key:"rigRotation",get:function(){return this._Rotation}},{key:"rotation",get:function(){return this._UseAnimationValues?this._AnimationRotation:this._Rotation},set:function(e){if(this._UseAnimationValues){if(Math.abs(e-this._AnimationRotation)>t.EPSILON){var n=this.frameRotation;this.frameRotation=e,this.dispatch("animateRotation",{from:n,to:e})}}else e!=this._Rotation&&(this._Rotation=e,this.markTransformDirty())}},{key:"rigScale",get:function(){return this._Scale}},{key:"scale",get:function(){return this._UseAnimationValues?this._AnimationScale:this._Scale},set:function(e){if(this._UseAnimationValues){if(e[0]!=this._AnimationScale[0]){var t=this.frameScaleX;this.frameScaleX=e[0],this.dispatch("animateScaleX",{from:t,to:e[0]})}if(e[1]!=this._AnimationScale[1]){var n=this.frameScaleY;this.frameScaleY=e[1],this.dispatch("animateScaleY",{from:n,to:e[1]})}}else a.vec2.isEqual(this._Scale,e)||(a.vec2.copy(this._Scale,e),this.markTransformDirty())}},{key:"transform",get:function(){return this._Transform}},{key:"rawTransform",get:function(){return this._Transform}},{key:"rawWorldTransform",get:function(){return this._WorldTransform}},{key:"worldTransform",get:function(){return this._WorldTransform}},{key:"renderTransform",get:function(){return this.root?a.mat2d.mul(a.mat2d.create(),this.root.rawWorldTransform,this._WorldTransform):(console.warn("NO ROOT YET",this.name),this._WorldTransform)}},{key:"useAnimationValues",get:function(){return this._UseAnimationValues},set:function(e){e!=this._UseAnimationValues&&(this._UseAnimationValues=e,this.markTransformDirty(),this.onUseAnimationValuesChange&&this.onUseAnimationValuesChange(e))}},{key:"rigPosX",get:function(){return this._Translation[0]}},{key:"rigPosY",get:function(){return this._Translation[1]}},{key:"rigScaleX",get:function(){return this._Scale[0]}},{key:"rigScaleY",get:function(){return this._Scale[1]}},{key:"framePosX",get:function(){return this._AnimationTranslation[0]},set:function(e){this._AnimationTranslation[0]!=e&&(this._AnimationTranslation[0]=e,this.markTransformDirty())}},{key:"framePosXWorld",get:function(){return this.worldTransform[4]}},{key:"framePosYWorld",get:function(){return this.worldTransform[5]}},{key:"framePosXParent",get:function(){var e=this.worldTransform;if(this.parent&&this.parent.parent){var t=this.parent.parent.worldTransform,n=a.mat2d.invert(a.mat2d.create(),t);e=a.mat2d.mul(a.mat2d.create(),n,e)}return e[4]}},{key:"framePosYParent",get:function(){var e=this.worldTransform;if(this.parent&&this.parent.parent){var t=this.parent.parent.worldTransform,n=a.mat2d.invert(a.mat2d.create(),t);e=a.mat2d.mul(a.mat2d.create(),n,e)}return e[5]}},{key:"framePosY",get:function(){return this._AnimationTranslation[1]},set:function(e){this._AnimationTranslation[1]!=e&&(this._AnimationTranslation[1]=e,this.markTransformDirty())}},{key:"frameScaleX",get:function(){return this._AnimationScale[0]},set:function(e){this._AnimationScale[0]!=e&&(this._AnimationScale[0]=e,this.markTransformDirty())}},{key:"frameScaleY",get:function(){return this._AnimationScale[1]},set:function(e){this._AnimationScale[1]!=e&&(this._AnimationScale[1]=e,this.markTransformDirty())}},{key:"frameRotation",get:function(){return this._AnimationRotation},set:function(e){this._AnimationRotation!=e&&(this._AnimationRotation=e,this.markTransformDirty())}},{key:"renderOpacity",get:function(){return this._RenderOpacity},set:function(e){this._RenderOpacity!==e&&(this._RenderOpacity=e,this.dispatch("opacityChange",this._RenderOpacity))}},{key:"renderCollapsed",get:function(){return this._RenderCollapsed}},{key:"rigOpacity",get:function(){return this._Opacity}},{key:"opacity",get:function(){return this._UseAnimationValues?this._AnimationOpacity:this._Opacity},set:function(e){if(this._UseAnimationValues){if(this._AnimationOpacity!=e){var t=this.frameOpacity;this.frameOpacity=e,this.dispatch("animateOpacity",{from:t,to:e})}}else this._Opacity=e,this.forceRedraw(),this.markTransformDirty()}},{key:"frameOpacity",get:function(){return this._AnimationOpacity},set:function(e){this._AnimationOpacity!=e&&(this._AnimationOpacity=e,this.markTransformDirty())}},{key:"frameRotationKS",get:function(){return this._KeyStateRotation},set:function(e){this._KeyStateRotation!=e&&(this._KeyStateRotation=e,this.markKeyStateDirty())}},{key:"frameOpacityKS",get:function(){return this._KeyStateOpacity},set:function(e){this._KeyStateOpacity!=e&&(this._KeyStateOpacity=e,this.markKeyStateDirty())}},{key:"framePosXKS",get:function(){return this._KeyStatePosX},set:function(e){this._KeyStatePosX!=e&&(this._KeyStatePosX=e,this.markKeyStateDirty())}},{key:"framePosYKS",get:function(){return this._KeyStatePosY},set:function(e){this._KeyStatePosY!=e&&(this._KeyStatePosY=e,this.markKeyStateDirty())}},{key:"frameScaleXKS",get:function(){return this._KeyStateScaleX},set:function(e){this._KeyStateScaleX!=e&&(this._KeyStateScaleX=e,this.markKeyStateDirty())}},{key:"frameScaleYKS",get:function(){return this._KeyStateScaleY},set:function(e){this._KeyStateScaleY!=e&&(this._KeyStateScaleY=e,this.markKeyStateDirty())}},{key:"isVisible",get:function(){return this._IsVisible},set:function(e){this._IsVisible!==e&&(this._IsVisible=e,this.dispatch("visibilityChange"),this.setStageItemVisibility(),this._Actor.revise())}},{key:"isCollapsedVisibility",get:function(){return this._IsCollapsedVisibility},set:function(e){this._IsCollapsedVisibility!==e&&(this._IsCollapsedVisibility=e,this.forceRedraw(),this.markTransformDirty(),this.dispatch("collapseChange"),this._UseAnimationValues||this._Actor.revise())}},{key:"isLocked",get:function(){return this.stageItem&&this.stageItem.isLocked},set:function(e){this.stageItem&&(this.stageItem.isLocked=e),this._Actor.revise()}},{key:"visibilityItem",get:function(){return this.stageItem}}]),t}();t.default=d,d.EPSILON=.001},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e==t)return!0;if(!e&&t||e&&!t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=f(n(2)),a=n(7),s=f(n(168)),l=f(n(198)),u=f(n(219)),c=f(n(195)),d=f(n(266));function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var p=[255,255,255,.5],y=[255,255,255,1],v=[198,198,198,.5],m=[10,10,10,.5],g=[50,50,50,.5],b=[255,255,255,1],k=[0,139,255,.8],S=[255,255,255,1],O=[198,198,198,1],w=[255,185,0,1],_=null,P=(h((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._ActorBone=e,n._ParentJoint=null,n._Joint=null,n._UpdateRequired=!0,n._IsConnected=!1,n._OverrideTransform=null,n._OverrideLength=null,n._IsPainting=!1,n.customSelectionAction=t.RangeSelect,e.parent&&(e.parent.constructor===l.default?n._ParentJoint=e.parent.stageItem.joint:e.parent.constructor===u.default&&(n._ParentJoint=e.parent.stageItem)),n._Joint=new c.default,n._Joint.setBone(n),n._FromSize=1,n._Length=0,n._Size=0,n._EdgeLine=null,n._VertexBuffer=null,n._IndexBuffer=null,n._ParentJointSize=0,n._JointSize=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"onVisibilityChanged",value:function(e){this._ParentJoint&&this._ParentJoint.updateVisibility(),this._Joint&&this._Joint.updateVisibility()}},{key:"updateConnectionState",value:function(){var e=this.node&&this.node.skins;if(e){for(var t=0;t<e.length;t++)if(e[t].stageItem.isSelected)return void(this.isConnected=!0);this.isConnected=!1}else this.isConnected=!1}},{key:"updateJelly",value:function(e){if(this._ActorBone.isJelly){var t=e||this.stage;this._JellyIn||(this._JellyIn=new d.default(this._ActorBone,!0),t&&this._JellyIn.addToStage(t)),this._JellyOut||(this._JellyOut=new d.default(this._ActorBone,!1),t&&this._JellyOut.addToStage(t))}else this._JellyIn&&(this._JellyIn.removeFromStage(),this._JellyIn=null),this._JellyOut&&(this._JellyOut.removeFromStage(),this._JellyOut=null)}},{key:"onAddedToStage",value:function(e){this._ParentJoint&&this._ParentJoint.addChild(this),this.updateJelly(e),this._Joint.addToStage(e);var t=this._ActorBone;t.addEventListener("minAngleChange",this.updateTransform),t.addEventListener("maxAngleChange",this.updateTransform),t.addEventListener("worldTransform",this.updateTransform),t.addEventListener("lengthChanged",this.updateTransform),t.addEventListener("sizeChanged",this.updateTransform),t.addEventListener("jellyChange",this.updateJelly),this.updateConnectionState()}},{key:"onRemovedFromStage",value:function(e){this._ParentJoint&&this._ParentJoint.removeChild(this),this._JellyIn&&(this._JellyIn.removeFromStage(),this._JellyIn=null),this._JellyOut&&(this._JellyOut.removeFromStage(),this._JellyOut=null),this._Joint.removeFromStage();var t=this._ActorBone;t.removeEventListener("minAngleChange",this.updateTransform),t.removeEventListener("maxAngleChange",this.updateTransform),t.removeEventListener("worldTransform",this.updateTransform),t.removeEventListener("lengthChanged",this.updateTransform),t.removeEventListener("lengthChanged",this.updateTransform),t.removeEventListener("jellyChange",this.updateJelly)}},{key:"updateTransform",value:function(){this._UpdateRequired=!0}},{key:"update",value:function(e){var t=this._ActorBone.renderTransform,n=this._ActorBone.size,r=a.vec2.create(),o=a.vec2.set(a.vec2.create(),this._ActorBone.length,0);a.vec2.transformMat2d(r,r,t),a.vec2.transformMat2d(o,o,t);var i=a.vec2.subtract(a.vec2.create(),o,r),s=Math.max(2.22*n,a.vec2.length(i));this._OverrideLength&&(s*=this._OverrideLength/this._ActorBone.length);var l=a.mat2d.create();a.mat2d.fromRotation(l,Math.atan2(i[1],i[0])),l[4]=r[0],l[5]=r[1],this.renderTransform=this._OverrideTransform||l;var u=.9*(this._ParentJoint?this._ParentJoint.scaledSize:8),c=.9*this._Joint.scaledSize;if(Math.abs(s-this._Length)>.5||n!=this._Size||!this._Path||u!=this._ParentJointSize||c!=this._JointSize){this._JointSize=c,this._ParentJointSize=u,this._Size=n,this._Length=s;var d=.7*this._Size,f=d/3.22;this._Path||(this._Path=e.makePath());var h=this._Path;h.rewind();var p=[u,0,d+u,d,this._Length-c-f,f,this._Length-c,0,this._Length-c-f,-f,d+u,-d];h.moveTo(p[0],p[1]);for(var y=2;y<p.length;y+=2)h.lineTo(p[y],p[y+1]);h.close(),this.setMesh(p,2,[0,1,2,0,2,3,0,3,4,0,4,5])}}},{key:"drawBone",value:function(e,t,n){this._UpdateRequired&&(this.update(e),this._UpdateRequired=!1);var r=this._Path,o=this._ActorBone,i=this._FillColor,a=this._Highlight,s=this.stage,l=this.renderTransform,u=this._IsPainting,c=this.stageContext;if(r){var d=c.strokePainting,f=c.strokeHighlight,h=c.strokeContrast,p=c.strokeSelected,y=c.strokeHover,v=c.stroke,m=c.fillSelected,g=c.fillHover,b=c.fillOverride,k=c.fillContrast,S=c.fill,O=o.hasContrast,w=e.skCanvas;if(w.save(),o.root&&o.root.clip(e),!o.hideBone){w.save(),e.transform(l);var _=void 0,P=void 0;n?_=m:t?_=g:i?(_=b).setColor(i):_=O?k:S,(P=n?p:t?y:u?d:a?f:O?h:v).setStrokeWidth(u?1/s.scale:a?2/s.scale:1/s.scale),w.drawPath(r,_),w.drawPath(r,P),w.restore()}if(!this._HideHelpers){var C=o.jelly;if(C&&!C.hideJellies&&(!C._GraphicsCurve&&C._CurvePoints&&(C._GraphicsCurve=e.linePath(C._CurvePoints,!1)),C._GraphicsCurve)){w.save();var E=o.renderTransform;e.transform(E);var T=n?p:a?f:y;T.setStrokeWidth(1/s.scale),w.drawPath(C._GraphicsCurve,T),w.restore()}}w.restore()}}},{key:"draw",value:function(e,t,n){t||n||this.drawBone(e,t,n)}},{key:"drawSelection",value:function(e,t){this.drawBone(e,t,this.isSelected)}},{key:"parentJoint",get:function(){return this._ParentJoint}},{key:"joint",get:function(){return this._Joint}},{key:"actorBone",get:function(){return this._ActorBone}},{key:"isConnected",get:function(){return this._IsConnected},set:function(e){this._IsConnected!=e&&(this._IsConnected=e,this.stage&&this.stage.redraw())}},{key:"fillColor",get:function(){return this._FillColor},set:function(e){e?(this._FillColor=_.Color(e[0],e[1],e[2],1),this._CssFillColor="rgba("+e.join(",")+", 1.0)"):this._FillColor=null}},{key:"cssFillColor",get:function(){return this._CssFillColor}},{key:"isPainting",get:function(){return this._IsPainting},set:function(e){e!=this._IsPainting&&(this._IsPainting=e,this.stage&&this.stage.redraw())}},{key:"overrideTransform",get:function(){return this._OverrideTransform},set:function(e){this._OverrideTransform=e&&a.mat2d.clone(e)||null,this._UpdateRequired=!0}},{key:"overrideLength",get:function(){return this._OverrideLength},set:function(e){this._OverrideLength=e||null,this._UpdateRequired=!0}},{key:"hideHelpers",get:function(){return this._HideHelpers},set:function(e){this._HideHelpers=e;var t=this.stage;t&&this._ActorBone.isJelly&&(e?(this._JellyIn.removeFromStage(),this._JellyOut.removeFromStage()):(this._JellyIn.addToStage(t),this._JellyOut.addToStage(t)))}},{key:"isSelectable",set:function(e){!function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var s=i.set;void 0!==s&&s.call(o,r)}return r}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"isSelectable",e,this)},get:function(){return!this._ActorBone.hideBone&&function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"isSelectable",this)}}]),t}()).prototype,"updateJelly",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"updateJelly"),r.prototype),h(r.prototype,"updateTransform",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"updateTransform"),r.prototype),r);t.default=P,P.Colors=[[109,145,255],[144,90,238],[255,106,147],[255,214,106],[104,254,217],[212,222,255],[209,183,255],[255,153,182],[255,238,195],[201,255,241],[18,76,255],[255,0,255],[244,46,100],[251,188,20],[0,190,143]],P.RangeSelect=function(e,t){if(!t)return!1;var n=e.stage.selectedItems;if(n.length>0){var r=n[n.length-1],o=e,i=[],a=null;if(r.constructor===P||o.constructor===P||r.constructor===c.default||o.constructor===c.default){if(r.node.treeDepth<o.node.treeDepth){var s=r;r=o,o=s}o.constructor===c.default&&(o=o.node.stageItem),r.constructor===c.default&&(r=r.node.stageItem,i.push(r));for(var l=r;(l=l.node.parent)&&(l=l.stageItem);){if(l==o){a=i;break}l.constructor===P&&i.push(l)}}}return a&&e.stage.selectItems(a,!0,!1),!1},P.initializeStageContext=function(e,t){var n=new(_=e.canvasKit).SkPaint;n.setAntiAlias(!1),n.setStyle(_.PaintStyle.Fill),n.setBlendMode(_.BlendMode.SrcOver),n.setColor(_.Color(g[0],g[1],g[2],g[3])),t.fillContrast=n;var r=n.copy();r.setColor(_.Color(v[0],v[1],v[2],v[3])),t.fill=r;var o=n.copy();o.setColor(_.Color(O[0],O[1],O[2],O[3])),t.fillHover=o;var i=n.copy();i.setColor(_.Color(k[0],k[1],k[2],k[3])),t.fillSelected=i;var a=n.copy();t.fillOverride=a;var s=new _.SkPaint;s.setAntiAlias(!0),s.setStyle(_.PaintStyle.Stroke),s.setBlendMode(_.BlendMode.SrcOver),s.setColor(_.Color(m[0],m[1],m[2],m[3])),s.setStrokeWidth(1),t.strokeContrast=s;var l=s.copy();l.setColor(_.Color(p[0],p[1],p[2],p[3])),t.stroke=l;var u=s.copy();u.setColor(_.Color(S[0],S[1],S[2],S[3])),t.strokeHover=u;var c=s.copy();c.setColor(_.Color(b[0],b[1],b[2],b[3])),t.strokeSelected=c;var d=s.copy();d.setColor(_.Color(w[0],w[1],w[2],w[3])),t.strokeHighlight=d;var f=s.copy();f.setColor(_.Color(y[0],y[1],y[2],y[3])),t.strokePainting=f}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(2)),a=d(n(505)),s=d(n(639)),l=d(n(264)),u=(n(360),d(n(300))),c=n(7);function d(e){return e&&e.__esModule?e:{default:e}}var f,h,p,y,v,m,g=[255,255,255,1],b=[0,139,255,1],k=[0,0,0,1],S=null,O=null,w=(r=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"onAddedToStage",value:function(e){this.node.addEventListener("worldTransform",this.onTransformed),this.renderTransform=this.node.renderTransform}},{key:"onRemovedFromStage",value:function(e){this.node.removeEventListener("worldTransform",this.onTransformed)}},{key:"onTransformed",value:function(){this.renderTransform=this.node.renderTransform,this._Wireframe&&this._Wireframe.onTransformed()}},{key:"updateMesh",value:function(e,t){for(var n=e.length,r=new Float32Array(2*n),o=0,i=0;i<n;i++){var a=e[i];r[o++]=a[0],r[o++]=a[1]}this.setMesh(r,2,t)}},{key:"computeTightAABB",value:function(){var e=this.node,t=this.stage,n=new u.default;if(t&&t.graphics){var r=e.getMesh(t.graphics).clone(),o=r.bounds();r.delete();var i=e.isConnectedToBones?c.mat2d.create():e.worldTransform,a=c.vec2.transformMat2d(c.vec2.create(),c.vec2.fromValues(o.fLeft,o.fTop),i),s=c.vec2.transformMat2d(c.vec2.create(),c.vec2.fromValues(o.fRight,o.fBottom),i);n.set(a,s)}else{var l=Number.MAX_VALUE,d=Number.MAX_VALUE,f=-Number.MAX_VALUE,h=-Number.MAX_VALUE,p=this.min,y=this.max,v=[c.vec2.fromValues(p[0],p[1]),c.vec2.fromValues(y[0],p[1]),c.vec2.fromValues(y[0],y[1]),c.vec2.fromValues(p[0],y[1])],m=e.isConnectedToBones?c.mat2d.create():e.worldTransform,g=!0,b=!1,k=void 0;try{for(var S,O=v[Symbol.iterator]();!(g=(S=O.next()).done);g=!0){var w=S.value,_=c.vec2.transformMat2d(c.vec2.create(),w,m);_[0]<l&&(l=_[0]),_[1]<d&&(d=_[1]),_[0]>f&&(f=_[0]),_[1]>h&&(h=_[1])}}catch(e){b=!0,k=e}finally{try{!g&&O.return&&O.return()}finally{if(b)throw k}}n.set(c.vec2.fromValues(l,d),c.vec2.fromValues(f,h))}return n}},{key:"draw",value:function(e,t){var n=this.renderTransform,r=this.node,o=r.asset,i=r.hasContour;if(o){var a=o.getPaint(e);if(a){var s=e.skCanvas,u=r.getMesh(e);!u&&i||(s.save(),this.clip(e),e.transform(n),l.default.setPaintColor(a,[1,1,1,r._RenderOpacity]),l.default.setBlendMode(a,r.blendMode),i?s.drawVertices(u,S.BlendMode.SrcOver,a):s.drawImage(o.image,-o.width/2,-o.height/2,a),s.restore())}}}},{key:"drawSelection",value:function(e,t){var n=this.renderTransform,r=this.node,o=r.asset;if(o&&o.getPaint(e)){var i=e.skCanvas,a=r.getMesh(e);a&&(O.setColor(t?g:b),i.save(),e.transform(n),i.drawVertices(a,S.BlendMode.SrcOver,O),i.restore())}}},{key:"drawContour",value:function(e){var t=this.renderTransform,n=this.node,r=e.skCanvas,o=n.getMesh(e);o&&(r.save(),e.transform(t),O.setColor(k),r.drawVertices(o,S.BlendMode.SrcOver,O),r.restore())}},{key:"showContour",get:function(){return this._ShowContour},set:function(e){this._ShowContour!==e&&(this._ShowContour=e,e?(this._Wireframe=new s.default(this.node),this._Wireframe.addToStage(this.stage)):this._Wireframe&&(this._Wireframe.removeFromStage(),this._Wireframe=null))}}],[{key:"initializeStageContext",value:function(e,n,r){S=e.canvasKit,g=S.Color(g[0],g[1],g[2],g[3]),b=S.Color(b[0],b[1],b[2],b[3]),k=S.Color(k[0],k[1],k[2],k[3]);var o=new S.SkPaint;o.setAntiAlias(!0),o.setStyle(S.PaintStyle.Fill),o.setBlendMode(S.BlendMode.SrcOver),o.setColor(S.Color(255,255,255,1)),O=o,r.setLayerRenderExtensions(1,{mode:t.RenderModes.Regular,overrideItems:function(e,t){var n=t.appContext.actor,r=n&&n.drawOrder;if(r){for(var o=r.drawables,i=new Array(o.length),a=0,s=0;s<o.length;s++){var l=o[s].stageItem;l&&l.stage&&(i[a]=l,a++)}return i.length!=a&&(i.length=a),i}var u=e.slice(0);return u.sort(function(e,t){return e=e.node,t=t.node,e.drawOrder===t.drawOrder?e.treeIndex-t.treeIndex:e.drawOrder-t.drawOrder}),u},drawPrep:function(e,n,r){return this.mode,t.RenderModes.Dim,e},drawCleanup:function(e){}})}}]),t}(),f=r.prototype,h="onTransformed",p=[i.default],y=Object.getOwnPropertyDescriptor(r.prototype,"onTransformed"),v=r.prototype,m={},Object.keys(y).forEach(function(e){m[e]=y[e]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=p.slice().reverse().reduce(function(e,t){return t(f,h,e)||e},m),v&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(v):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(f,h,m),m=null),r);t.default=w,w.RenderModes={Regular:1,Dim:2}},,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(2)),a=n(7),s=d(n(168)),l=d(n(176)),u=d(n(219)),c=d(n(198));function d(e){return e&&e.__esModule?e:{default:e}}var f,h,p,y,v,m,g=[255,255,255,.5],b=[198,198,198,.5],k=[10,10,10,.5],S=[50,50,50,.5],O=[255,255,255,1],w=[0,139,255,.8],_=[255,255,255,1],P=[198,198,198,1],C=null,E=(r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Children=[],n._Bone=null,n._IsRoot=e&&e.constructor===u.default,n._IsRoot&&(n._Bone=e),n.addEventListener("addedToStage",n.onAddedToStage),n.customSelectionAction=l.default.RangeSelect,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"onAddedToStage",value:function(){this._IsRoot?this.setMesh(this.stageContext.rootSelectionPoints,2,this.stageContext.selectionIndices):this.setMesh(this.stageContext.selectionPoints,2,this.stageContext.selectionIndices)}},{key:"updateTransform",value:function(){var e,t=a.vec2.create();if(this._Bone.constructor===u.default){var n=a.mat2d.create(),r=this.node.renderTransform;a.mat2d.fromRotation(n,a.mat2d.getRotation(r)),n[4]=r[4],n[5]=r[5],e=n}else{a.vec2.set(t,this._Bone.length,0),a.vec2.transformMat2d(t,t,this.node.renderTransform);var o=a.mat2d.create();o[4]=t[0],o[5]=t[1],e=o}if(this._Bone){var i=c.default.getBoneSizeScale(this._Bone.size);if(1!=i){var s=a.mat2d.fromScaling(a.mat2d.create(),[i,i]);a.mat2d.mul(e,e,s)}}this.renderTransform=e}},{key:"align",value:function(){this.updateTransform()}},{key:"draw",value:function(e,t,n){if(!t&&!n){this.updateTransform();var r=e.skCanvas,o=this.stageContext,i=this._IsRoot,a=this.stage,s=this.renderTransform,l=this.node,u=o.fillContrast,c=o.fill,d=o.stroke,f=o.strokeContrast,h=o.jointPath,p=o.rootPath;r.save(),l&&l.root&&l.root.clip(e),e.transform(s);var y=l&&l.hasContrast,v=i?p:h,m=y?f:d;m.setStrokeWidth(1/a.scale),r.drawPath(v,y?u:c),r.drawPath(v,m),r.restore()}}},{key:"drawSelection",value:function(e,t){this.updateTransform();var n=e.skCanvas,r=this.stageContext,o=this._IsRoot,i=this.stage,a=this.renderTransform,s=(this.node,this.isSelected),l=r.fillSelected,u=r.fillHover,c=r.strokeHover,d=r.strokeSelected,f=r.jointPath,h=r.rootPath;n.save(),e.transform(a);var p=o?h:f,y=s?d:c;y.setStrokeWidth(1/i.scale),n.drawPath(p,s?l:u),n.drawPath(p,y),n.restore()}},{key:"addChild",value:function(e){!this._Bone&&null==this.stage&&e.stage&&this.addToStage(e.stage),this._Children.push(e)}},{key:"removeChild",value:function(e){var t=this._Children.indexOf(e);-1!=t&&this._Children.splice(t,1),!this._Bone&&0==this._Children.length&&this.stage&&this.removeFromStage()}},{key:"setBone",value:function(e){this._Bone=e.node,this.setNode(e.actorBone)}},{key:"updateVisibility",value:function(){if(!this._IsRoot){var e=!1;if(this._Bone.stageItem&&this._Bone.stageItem.isVisible)e=!0;else for(var t=0;t<this._Children.length;t++){if(this._Children[t].isVisible){e=!0;break}}this.isVisible=e}}},{key:"selectionIcon",get:function(){return this.parentJoint?"icon-joint":"icon-root"}},{key:"typeName",get:function(){return this.parentJoint?"Joint":"Root Bone"}},{key:"uiSelectionIconClass",get:function(){return"SelectionRootBoneIcon"}},{key:"parentJoint",get:function(){return this._Bone&&this._Bone.constructor===c.default&&this._Bone.stageItem.parentJoint||null}},{key:"bone",get:function(){return this._Bone}},{key:"children",get:function(){return this._Children}},{key:"scaledSize",get:function(){var e=8;this._Bone&&(e*=c.default.getBoneSizeScale(this._Bone.size));return e}},{key:"isRoot",get:function(){return this._IsRoot}}]),t}(),f=r.prototype,h="onAddedToStage",p=[i.default],y=Object.getOwnPropertyDescriptor(r.prototype,"onAddedToStage"),v=r.prototype,m={},Object.keys(y).forEach(function(e){m[e]=y[e]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=p.slice().reverse().reduce(function(e,t){return t(f,h,e)||e},m),v&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(v):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(f,h,m),m=null),r);t.default=E,E.initializeStageContext=function(e,t){C=e.canvasKit;var n=[0,16,16,0,0,-16,-16,0],r=[0,1,2,2,3,0];t.rootSelectionPoints=n,t.rootSelectionIndices=r;var o=[0,8,8,0,0,-8,-8,0];t.selectionPoints=o,t.selectionIndices=r;for(var i=e.makePath(),a=2*Math.PI/4,s=16*Math.sin(.25*Math.PI),l=0,u=0;u<4;u++){var c=Math.cos(l)*s,d=Math.sin(l)*s;0===u?i.moveTo(c,d):i.lineTo(c,d),l+=a}i.close(),t.rootPath=i;var f=8*Math.sin(.25*Math.PI),h=e.makePath();h.addArc(C.LTRBRect(-f,-f,f,f),0,360),t.jointPath=h;var p=new C.SkPaint;p.setAntiAlias(!1),p.setStyle(C.PaintStyle.Fill),p.setBlendMode(C.BlendMode.SrcOver),p.setColor(C.Color(S[0],S[1],S[2],S[3])),t.fillContrast=p;var y=p.copy();y.setColor(C.Color(b[0],b[1],b[2],b[3])),t.fill=y;var v=p.copy();v.setColor(C.Color(P[0],P[1],P[2],P[3])),t.fillHover=v;var m=p.copy();m.setColor(C.Color(w[0],w[1],w[2],w[3])),t.fillSelected=m;var E=new C.SkPaint;E.setAntiAlias(!0),E.setStyle(C.PaintStyle.Stroke),E.setBlendMode(C.BlendMode.SrcOver),E.setColor(C.Color(k[0],k[1],k[2],k[3])),E.setStrokeWidth(1),t.strokeContrast=E;var T=E.copy();T.setColor(C.Color(g[0],g[1],g[2],g[3])),t.stroke=T;var I=E.copy();I.setColor(C.Color(_[0],_[1],_[2],_[3])),t.strokeHover=I;var j=E.copy();j.setColor(C.Color(O[0],O[1],O[2],O[3])),t.strokeSelected=j},E.transformChain=function(e){e.updateTransform();for(var t=0;t<e.children.length;t++){var n=e.children[t];E.transformChain(n.joint)}},E.alignChain=function(e,t){E.align(e,t);for(var n=0;n<e.children.length;n++){var r=e.children[n];E.alignChain(r.joint,t)}},E.compensateSkinnedImages=function(e,t){if(e.skins){t||(t=a.mat2d.clone(e.rawWorldTransform));for(var n=e.skins,r=0;r<n.length;r++)for(var o=n[r],i=0;i<o.connectedBones.length;i++){var s=o.connectedBones[i];if(s.node===e){var l=e.calculateWorldTransform(),u=a.mat2d.invert(a.mat2d.create(),l),c=a.mat2d.mul(a.mat2d.create(),t,s.ibind),d=a.mat2d.mul(a.mat2d.create(),u,c),f=a.mat2d.invert(a.mat2d.create(),d);o.connectedBones[i]={node:e,bind:f,ibind:d};break}}}},E.align=function(e,t){var n=e.bone;if(n){var r=void 0;t&&(t=n.skins&&n.skins.length>0),t&&(r=a.mat2d.clone(n.rawWorldTransform));var o=n.parent.calculateWorldTransform(),i=n.root,s=n.scale,l=a.mat2d.invert(a.mat2d.create(),o),u=n.stageItem.parentJoint;if(u){for(var c=i.localTransform(u.renderTransform),d=i.localTransform(e.renderTransform),f=a.vec2.transformMat2d(a.vec2.create(),a.vec2.set(a.vec2.create(),c[4],c[5]),l),h=a.vec2.transformMat2d(a.vec2.create(),a.vec2.set(a.vec2.create(),d[4],d[5]),l),p=a.vec2.subtract(a.vec2.create(),h,f),y=a.vec2.length(p),v=Math.atan2(p[1],p[0]),m=v-n.rotation;m>Math.PI;)m=(v-=2*Math.PI)-n.rotation;for(;m<-Math.PI;)m=(v+=2*Math.PI)-n.rotation;n.length=y/s[0],n.rotation=v,n.translation=f}else{var g=i.localTransform(e.renderTransform),b=a.vec2.transformMat2d(a.vec2.create(),a.vec2.set(a.vec2.create(),g[4],g[5]),l);n.translation=b}t&&E.compensateSkinnedImages(n,r)}}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(507)),a=n(288),s=l(n(225));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Shape",n._KeyStateStrokeColor=n._KeyStateFillColor=0,n._KeyStateStrokeWidth=0,n._KeyStateFillGradient=0,n._KeyStateFillRadial=0,n._KeyStateStrokeGradient=0,n._KeyStateStrokeRadial=0,n._KeyStateStrokeOpacity=0,n._KeyStateFillOpacity=0,n._KeyStatePathVertices=0,n._KeyStateStrokeStart=0,n._KeyStateStrokeEnd=0,n._KeyStateStrokeOffset=0,n._PaintFill=t.PaintType.None,n._PaintStroke=t.PaintType.None,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"onBlendModeChanged",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onBlendModeChanged",this).call(this,e);var n=this.children,r=!0,i=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var c=l.value;c instanceof a.ActorPaint&&c.markPaintDirty()}}catch(e){i=!0,s=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw s}}}},{key:"onChildrenChanged",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildrenChanged",this).call(this),this._PaintFill=t.PaintType.None,this._PaintStroke=t.PaintType.None;var e=!0,n=!1,r=void 0;try{for(var i,s=this.children[Symbol.iterator]();!(e=(i=s.next()).done);e=!0){switch(i.value.constructor){case a.ColorFill:this._PaintFill=t.PaintType.Color;break;case a.GradientFill:this._PaintFill=t.PaintType.LinearGradient;break;case a.RadialGradientFill:this._PaintFill=t.PaintType.RadialGradient;break;case a.ColorStroke:this._PaintStroke=t.PaintType.Color;break;case a.GradientStroke:this._PaintStroke=t.PaintType.LinearGradient;break;case a.RadialGradientStroke:this._PaintStroke=t.PaintType.RadialGradient}}}catch(e){n=!0,r=e}finally{try{!e&&s.return&&s.return()}finally{if(n)throw r}}}},{key:"fillRuleChanged",value:function(){this.dispatch("fillChanged"),this.forceRedraw()}},{key:"strokeCapChanged",value:function(){this.dispatch("strokeChanged"),this.forceRedraw()}},{key:"strokeJoinChanged",value:function(){this.dispatch("strokeChanged"),this.forceRedraw()}},{key:"strokeTrimChanged",value:function(){this.markRenderPathDirty(),this.dispatch("strokeChanged"),this.forceRedraw()}},{key:"strokeStartChanged",value:function(){this.dispatch("strokeChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateStrokeStart",this)}},{key:"strokeEndChanged",value:function(){this.dispatch("strokeChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateStrokeEnd",this)}},{key:"strokeOffsetChanged",value:function(){this.dispatch("strokeChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateStrokeOffset",this)}},{key:"fillOpacityChanged",value:function(){this.dispatch("fillChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateFillOpacity",this)}},{key:"strokeOpacityChanged",value:function(){this.dispatch("strokeChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateStrokeOpacity",this)}},{key:"fillColorChanged",value:function(){this.dispatch("fillChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateFillColor",this)}},{key:"fillGradientChanged",value:function(){this.dispatch("fillChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateFillGradient",this)}},{key:"fillRadialChanged",value:function(){this.dispatch("fillChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateFillRadial",this)}},{key:"strokeColorChanged",value:function(){this.dispatch("strokeChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateStrokeColor",this)}},{key:"strokeGradientChanged",value:function(){this.dispatch("strokeChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateStrokeGradient",this)}},{key:"strokeRadialChanged",value:function(){this.dispatch("strokeChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateStrokeRadial",this)}},{key:"strokeWidthChanged",value:function(){this.dispatch("strokeChanged"),this.forceRedraw(),this.useAnimationValues&&this.dispatch("animateStrokeWidth",this)}},{key:"onPathChanged",value:function(e){this.dispatch("transformPropChange"),this.actor.forceRedraw(),this.stageItem.onPathChanged(e)}},{key:"nullFrame",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.frameFillGradient=null,e.framePathVertices=null,e.frameStrokeGradient=null,e.frameStrokeRadial=null,e.frameFillRadial=null,e.frameFillColor=null,e.frameStrokeColor=null,e.frameStrokeWidth=null,e.frameStrokeOpacity=null,e.frameFillOpacity=null,e.frameStrokeStart=null,e.frameStrokeEnd=null,e.frameStrokeOffset=null,e}},{key:"markRenderPathDirty",value:function(){var e=this.stroke;e&&e.markPathEffectsDirty()}},{key:"onWorldTransform",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onWorldTransform",this).call(this),this.markRenderPathDirty()}},{key:"typeName",get:function(){return"Shape"}},{key:"uiHierIconClass",get:function(){return"HierarchyImageIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"uiIcon",get:function(){return"icon-picture"}},{key:"paintFill",get:function(){return this._PaintFill}},{key:"paintStroke",get:function(){return this._PaintStroke}},{key:"paths",get:function(){return this.children.filter(function(e){return e.constructor===s.default})}},{key:"fill",get:function(){return this.children.find(function(e){return e.constructor===a.ColorFill||e.constructor===a.GradientFill||e.constructor===a.RadialGradientFill})}},{key:"stroke",get:function(){return this.children.find(function(e){return e.constructor===a.ColorStroke||e.constructor===a.GradientStroke||e.constructor===a.RadialGradientStroke})}},{key:"rigFillOpacity",get:function(){var e=this.fill;return e?e.rigOpacity:null}},{key:"frameFillOpacity",get:function(){var e=this.fill;return e?e.frameOpacity:null},set:function(e){var t=this.fill;if(!t)return null;t.frameOpacity=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("fillChanged"))}},{key:"rigStrokeOpacity",get:function(){var e=this.stroke;return e?e.rigOpacity:null}},{key:"frameStrokeOpacity",get:function(){var e=this.stroke;return e?e.frameOpacity:null},set:function(e){var t=this.stroke;if(!t)return null;t.frameOpacity=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("strokeChanged"))}},{key:"rigStrokeWidth",get:function(){var e=this.stroke;return e?e.rigWidth:null}},{key:"frameStrokeWidth",get:function(){var e=this.stroke;return e?e.frameWidth:null},set:function(e){var t=this.stroke;if(!t)return null;t.frameWidth=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("strokeChanged"))}},{key:"rigStrokeColor",get:function(){var e=this.children.find(function(e){return e.constructor===a.ColorStroke});return e?e.rigColor:null}},{key:"frameStrokeColor",get:function(){var e=this.children.find(function(e){return e.constructor===a.ColorStroke});return e?new Float32Array(e.frameColor):null},set:function(e){var t=this.children.find(function(e){return e.constructor===a.ColorStroke});if(!t)return null;t.frameColor=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("strokeChanged"))}},{key:"rigStrokeGradient",get:function(){var e=this.children.find(function(e){return e.constructor===a.GradientStroke});return e?e.rigGradient:null}},{key:"frameStrokeGradient",get:function(){var e=this.children.find(function(e){return e.constructor===a.GradientStroke});return e?new Float32Array(e.frameGradient):null},set:function(e){var t=this.children.find(function(e){return e.constructor===a.GradientStroke});if(!t)return null;t.frameGradient=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("strokeChanged"))}},{key:"frameStrokeGradientKS",get:function(){return this._KeyStateStrokeGradient},set:function(e){this._KeyStateStrokeGradient!=e&&(this._KeyStateStrokeGradient=e,this.markKeyStateDirty())}},{key:"rigStrokeRadial",get:function(){var e=this.children.find(function(e){return e.constructor===a.RadialGradientStroke});return e?e.rigGradient:null}},{key:"frameStrokeRadial",get:function(){var e=this.children.find(function(e){return e.constructor===a.RadialGradientStroke});return e?new Float32Array(e.frameRadial):null},set:function(e){var t=this.children.find(function(e){return e.constructor===a.RadialGradientStroke});if(!t)return null;t.frameRadial=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("strokeChanged"))}},{key:"frameStrokeRadialKS",get:function(){return this._KeyStateStrokeRadial},set:function(e){this._KeyStateStrokeRadial!=e&&(this._KeyStateStrokeRadial=e,this.markKeyStateDirty())}},{key:"rigFillGradient",get:function(){var e=this.children.find(function(e){return e.constructor===a.GradientFill});return e?e.rigGradient:null}},{key:"frameFillGradient",get:function(){var e=this.children.find(function(e){return e.constructor===a.GradientFill});return e?new Float32Array(e.frameGradient):null},set:function(e){var t=this.children.find(function(e){return e.constructor===a.GradientFill});t&&(t.frameGradient=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("fillChanged")))}},{key:"frameFillGradientKS",get:function(){return this._KeyStateFillGradient},set:function(e){this._KeyStateFillGradient!=e&&(this._KeyStateFillGradient=e,this.markKeyStateDirty())}},{key:"framePathVerticesKS",get:function(){var e=!0,t=!0,n=!1,r=void 0;try{for(var o,i=this.paths[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e=e&&a.framePathVerticesKS}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return e},set:function(e){this._KeyStatePathVertices!=e&&(this._KeyStatePathVertices=e,this.markKeyStateDirty())}},{key:"rigFillRadial",get:function(){var e=this.children.find(function(e){return e.constructor===a.RadialGradientFill});return e?e.rigRadial:null}},{key:"frameFillRadial",get:function(){var e=this.children.find(function(e){return e.constructor===a.RadialGradientFill});return e?new Float32Array(e.frameRadial):null},set:function(e){var t=this.children.find(function(e){return e.constructor===a.RadialGradientFill});t&&(t.frameRadial=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("fillChanged")))}},{key:"frameFillRadialKS",get:function(){return this._KeyStateFillRadial},set:function(e){this._KeyStateFillRadial!=e&&(this._KeyStateFillRadial=e,this.markKeyStateDirty())}},{key:"rigFillColor",get:function(){var e=this.children.find(function(e){return e instanceof a.ColorFill});return e?e.rigColor:null}},{key:"frameFillColor",get:function(){var e=this.children.find(function(e){return e instanceof a.ColorFill});return e?new Float32Array(e.frameColor):null},set:function(e){var t=this.children.find(function(e){return e instanceof a.ColorFill});t&&(t.frameColor=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("fillChanged")))}},{key:"rigStrokeStart",get:function(){var e=this.stroke;return e?e.rigTrimStart:null}},{key:"frameStrokeStart",get:function(){var e=this.stroke;return e?e.frameTrimStart:null},set:function(e){var t=this.stroke;if(!t)return null;t.frameTrimStart=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("strokeChanged"))}},{key:"rigStrokeEnd",get:function(){var e=this.stroke;return e?e.rigTrimEnd:null}},{key:"frameStrokeEnd",get:function(){var e=this.stroke;return e?e.frameTrimEnd:null},set:function(e){var t=this.stroke;if(!t)return null;t.frameTrimEnd=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("strokeChanged"))}},{key:"rigStrokeOffset",get:function(){var e=this.stroke;return e?e.rigTrimOffset:null}},{key:"frameStrokeOffset",get:function(){var e=this.stroke;return e?e.frameTrimOffset:null},set:function(e){var t=this.stroke;if(!t)return null;t.frameTrimOffset=e,this.useAnimationValues&&(this.actor.forceRedraw(),this.dispatch("strokeChanged"))}},{key:"frameFillColorKS",get:function(){return this._KeyStateFillColor},set:function(e){this._KeyStateFillColor!=e&&(this._KeyStateFillColor=e,this.markKeyStateDirty())}},{key:"frameStrokeColorKS",get:function(){return this._KeyStateStrokeColor},set:function(e){this._KeyStateStrokeColor!=e&&(this._KeyStateStrokeColor=e,this.markKeyStateDirty())}},{key:"frameStrokeWidthKS",get:function(){return this._KeyStateStrokeWidth},set:function(e){this._KeyStateStrokeWidth!=e&&(this._KeyStateStrokeWidth=e,this.markKeyStateDirty())}},{key:"frameStrokeStartKS",get:function(){return this._KeyStateStrokeStart},set:function(e){this._KeyStateStrokeStart!=e&&(this._KeyStateStrokeStart=e,this.markKeyStateDirty())}},{key:"frameStrokeEndKS",get:function(){return this._KeyStateStrokeEnd},set:function(e){this._KeyStateStrokeEnd!=e&&(this._KeyStateStrokeEnd=e,this.markKeyStateDirty())}},{key:"frameStrokeOffsetKS",get:function(){return this._KeyStateStrokeOffset},set:function(e){this._KeyStateStrokeOffset!=e&&(this._KeyStateStrokeOffset=e,this.markKeyStateDirty())}},{key:"frameStrokeOpacityKS",get:function(){return this._KeyStateStrokeOpacity},set:function(e){this._KeyStateStrokeOpacity!=e&&(this._KeyStateStrokeOpacity=e,this.markKeyStateDirty())}},{key:"frameFillOpacityKS",get:function(){return this._KeyStateFillOpacity},set:function(e){this._KeyStateFillOpacity!=e&&(this._KeyStateFillOpacity=e,this.markKeyStateDirty())}}]),t}();t.default=u,u.PaintType={None:0,Color:1,LinearGradient:2,RadialGradient:3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(374)),a=l(n(173)),s=l(n(375));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Bone",n._AnimationLength=0,n._KeyStateLength=0,n._Size=t.DefaultSize,n._HasContrast=!1,n._Targets=null,n._Jelly=null,n._KeyStateLength=0,n.treeOrderFactor=99999,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"clearKeyStates",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearKeyStates",this).call(this),this.frameLengthKS=0}},{key:"onChildrenChanged",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildrenChanged",this).call(this);var e=null,n=this.children,r=!0,i=!1,a=void 0;try{for(var l,u=n[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var c=l.value;if(c instanceof s.default){e=c;break}}}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}this._Jelly!==e&&(this._Jelly=e,this.dispatch("jellyChange"))}},{key:"recurseChangeSize",value:function(){this.dispatch("sizeChanged",this._Size);for(var e=0;e<this.children.length;e++){var n=this.children[e];n.constructor===t&&n.recurseChangeSize()}}},{key:"eachNodeRecursive",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"eachNodeRecursive",this).call(this,e);var n=this._Jelly,r=n&&n.bones;if(r){var i=!0,a=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value;!1!==e(c)&&c.eachNodeRecursive(e)}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}}},{key:"eachChildRecursive",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"eachChildRecursive",this).call(this,e);var n=this._Jelly,r=n&&n.bones;if(r){var i=!0,a=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value;!1!==e(c)&&c.eachChildRecursive(e)}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.length;r&&r.constructor===Number&&(this._Length=r);var i=n.size;i&&i.constructor===Number&&(this._Size=i);var a=n.contrast;a&&(this._HasContrast=a)}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return delete n.targets,delete n.hasContrast,this._HasContrast&&(n.contrast=this._HasContrast),n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.length=this._Length,e.size=this._Size,e.hasContrast=this._HasContrast,this._Targets&&(e.targets=this._Targets.slice(0)),e}},{key:"nullFrame",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.frameLength=null,e}},{key:"canKeyFrame",value:function(e){switch(e){case"framePosX":case"framePosY":return!1}return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"canKeyFrame",this).call(this,e)}},{key:"uiHierIconClass",get:function(){return"HierarchyBoneIcon"}},{key:"uiIcon",get:function(){return"icon-bone"}},{key:"typeName",get:function(){return"Bone"}},{key:"jelly",get:function(){return this._Jelly}},{key:"hideJellies",get:function(){var e=this._Jelly;return!e||e.hideJellies}},{key:"hideBone",get:function(){var e=this._Jelly;return!!e&&e.hideBone}},{key:"jellyBones",get:function(){var e=this._Jelly;return e?e.bones:null}},{key:"isJelly",get:function(){return null!==this._Jelly},set:function(e){if(e){var t=this.actor.addNodeType(s.default,this,null,!0);t&&t.setDefaults()}else this._Jelly&&this.remove(this._Jelly)}},{key:"hierarchyChildren",get:function(){var e=this._Jelly,t=e&&e.bones;return t?t.concat(this._Children):this._Children}},{key:"size",get:function(){return this._Size},set:function(e){e!=this._Size&&(this._Size=e,this.recurseChangeSize(),this.forceRedraw())}},{key:"length",get:function(){return this.useAnimationValues?this._AnimationLength:o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"length",this)},set:function(e){if(this.useAnimationValues){if(Math.abs(e-this._AnimationLength)>a.default.EPSILON){var n=this.frameLength;this.frameLength=e,this.dispatch("animateLength",{from:n,to:e})}}else!function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var s=i.set;void 0!==s&&s.call(o,r)}return r}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"length",e,this)}},{key:"frameLength",get:function(){return this._AnimationLength},set:function(e){this._AnimationLength!=e&&this.dispatch("lengthChanged",{from:e,to:this._AnimationLength}),this._AnimationLength!==e&&(this._AnimationLength=e,this.markTransformDirty());for(var n=0;n<this.children.length;n++){this.children[n].constructor===t&&(this.children[n].framePosX=e)}}},{key:"frameLengthKS",get:function(){return this._KeyStateLength},set:function(e){this._KeyStateLength!=e&&(this._KeyStateLength=e,this.markKeyStateDirty())}},{key:"targets",get:function(){return this._Targets||(this._Targets=[]),this._Targets},set:function(e){e&&e.constructor===Array&&(this._Targets=e)}},{key:"hasContrast",get:function(){return this._HasContrast},set:function(e){this._HasContrast!=e&&(this._HasContrast=e,this.dispatch("hasContrastChange",e),this.forceRedraw())}}]),t}();t.default=u,u.DefaultSize=10,u.MinimumSize=1,u.MaximumSize=30,u.getBoneSizeScale=function(e){return.15+.85*(e-u.MinimumSize)/(u.MaximumSize-u.MinimumSize)/((u.DefaultSize-u.MinimumSize)/(u.MaximumSize-u.MinimumSize))}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=g(n(507)),s=g(n(419)),l=g(n(517)),u=g(n(518)),c=g(n(2)),d=n(7),f=g(n(332)),h=g(n(224)),p=g(n(514)),y=g(n(643)),v=g(n(331)),m=g(n(19));function g(e){return e&&e.__esModule?e:{default:e}}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var k=d.mat2d.create(),S=(b((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Image",n._Asset=null,n._PtBuffer=[],n._UvBuffer=new Float32Array,n._IxBuffer=new Uint16Array,n._MeshPoints=[],n._DefaultVertexBuffer=[],n._InverseWorld=d.mat2d.create(),n._ShowDeformed=!0,n._HasContour=null,n._KeyStateImageVertices=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,(0,p.default)(a.default)),o(t,[{key:"onWorldTransform",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onWorldTransform",this).call(this),d.mat2d.invert(this._InverseWorld,this._WorldTransform)}},{key:"onChildrenChanged",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildrenChanged",this).call(this),this._IsComputingTopology?this.invalidateMesh():this.debounceComputeTopology();var e=this.stageItem&&this.stageItem.stage;e&&(e.appContext.isEditingPath(this.stageItem)&&(0,m.default)(this.updateStageItems))}},{key:"debounceComputeTopology",value:function(){var e=this.stageItem&&this.stageItem.stage;e&&e.appContext.debounceBeforeCapture(this.computeTopology,[],1)}},{key:"updateStageItems",value:function(){var e=this.stageItem&&this.stageItem.stage;if(e){var t=e.appContext,n=this.children,r=this.showDeformed;if(t.isEditingPath(this.stageItem)){var o=!0,i=!1,a=void 0;try{for(var u,c=n[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;r&&d.constructor===l.default?(d.stageItem.addToStage(e),d.stageItem.updateContour(),d.stageItem.updateTransform()):r||d.constructor!==s.default||(d.stageItem.addToStage(e),d.stageItem.updateContour(),d.stageItem.updateTransform())}}catch(e){i=!0,a=e}finally{try{!o&&c.return&&c.return()}finally{if(i)throw a}}}this.updateContour()}}},{key:"updateContour",value:function(){var e=this.points,t=e.length;if(t){for(var n=e[0],r=!1,o=1;o<t;o++){var i=e[o];if(!i.contour)break;i.contour===n&&(r=!0)}this._HasContour!==r&&(this._HasContour=r,r?this.computeTopology():this.applyDefaultTopology(),this.dispatch("hasContourChanged",r))}else!1!==this._HasContour&&(this._HasContour=!1,this.applyDefaultTopology(),this.dispatch("hasContourChanged",!1))}},{key:"applyDefaultTopology",value:function(){var e=this.asset;if(e)if(e.removeEventListener("available",this.applyDefaultTopology),e.bitmap){var t=this.asset,n=t.width,r=t.height,o=n/2,i=r/2,a=[-o,-i,o,-i,o,i,-o,i],s=[0,0,n,0,n,r,0,r];this._PtBuffer=a,this._UvBuffer=s;for(var l=[],u=0;u<a.length;u+=2)l.push([a[u],a[u+1]]);this._DefaultVertexBuffer=l;for(var c=[],d=0;d<s.length;d+=2)c.push([s[d],s[d+1]]);this._UvBuffer=c,this._MeshPoints.length=0,this.setIndices([0,1,3,1,2,3]),this.forceRedraw()}else e.addEventListener("available",this.applyDefaultTopology)}},{key:"computeTopology",value:function(){if(!this._HasContour)return!1;var e=this.stageItem&&this.stageItem.stage;if(e){e.appContext.cancelDebounceBeforeCapture(this.computeTopology);var t=this.points,n=this.edges,r=this.deformPoints,o=(t.reduce(function(e,t){return e+(t.contour?1:0)},0),n.length,2*t.length),i=[],a=[],s=new Float32Array(o),u=0,c=[],f=!0,h=!1,p=void 0;try{for(var m,g=t[Symbol.iterator]();!(f=(m=g.next()).done);f=!0){var b=m.value,k=b.uv;s[u++]=k[0],s[u++]=k[1],b.contour&&(c.push(t.indexOf(b)),c.push(t.indexOf(b.contour)))}}catch(e){h=!0,p=e}finally{try{!f&&g.return&&g.return()}finally{if(h)throw p}}var S=!0,O=!1,w=void 0;try{for(var _,P=n[Symbol.iterator]();!(S=(_=P.next()).done);S=!0){var C=_.value;c.push(t.indexOf(C.from)),c.push(t.indexOf(C.to))}}catch(e){O=!0,w=e}finally{try{!S&&P.return&&P.return()}finally{if(O)throw w}}var E=new Int32Array(c),T=(0,y.default)("pzenQ",s,E);if(T){this._IsComputingTopology=!0;for(var I=T.vertices,j=T.triangles,A=(I.length,this.asset),D=A.width/2,R=A.height/2,M=d.vec2.create(),x=this.children.slice(0).filter(function(e){return e.constructor!==l.default}),F=0,L=I.length;F<L;F+=2){var N=I[F],z=I[F+1];d.vec2.set(M,N,z);var V=r.find(function(e){return d.vec2.exactEquals(e.uv,M)});if(V){V.translation,k=V.uv;i.push(k),a.push(k),x.push(V);var B=r.indexOf(V);-1!==B&&r.splice(B,1)}else{var H=actor.addNodeType(l.default,this,{translation:[M[0]-D,M[1]-R],uv:Array.from(M)});i.push(H.uv),a.push(H.uv),x.push(H),H.validateWeightBuffer(!1)}}if(r.length){var W=new v.default(e,this._Actor,r.map(function(e){return e.stageItem}),[],!0);W.silent=!0,W.start(),W.end()}return this.children=x,this._MeshPoints=this.deformPoints,this._PtBuffer=i,this._UvBuffer=a,this.setIndices(j),this.forceRedraw(),this._IsComputingTopology=!1,!0}}}},{key:"invalidateMesh",value:function(){this._SkVertices&&(this._SkVertices.delete(),this._SkVertices=null),this.forceRedraw()}},{key:"setIndices",value:function(e){var t=this.asset;t&&t.removeEventListener("available",this.applyDefaultTopology),this._IxBuffer=new Uint16Array(e),this._SkVertices&&(this._SkVertices.delete(),this._SkVertices=null)}},{key:"getExportWeightBuffer",value:function(){var e=this._MeshPoints,t=this.asset,n=this.isConnectedToBones;if(!t||!n)return null;if(0===e.length)return[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0];var r=e.filter(function(e){return null!==e.weights}).map(function(e){return Array.from(e.weights)}),o=[],i=!0,a=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value;Array.prototype.push.apply(o,c)}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}return o}},{key:"getExportMeshBuffer",value:function(){var e=this._UvBuffer,t=this._MeshPoints,n=this._DefaultVertexBuffer,r=this.asset;if(!r)return null;var o=r.width,i=r.height,a=void 0;a=0===t.length?n:t.map(function(e){return e.rigTranslation});for(var s=new Float32Array(4*a.length),l=0,u=0;u<s.length;u+=4){var c=a[l],d=e[l];l++,s[u]=c[0],s[u+1]=c[1],s[u+2]=d[0]/o,s[u+3]=d[1]/i}return s}},{key:"getMesh",value:function(e){if(this._SkVertices)return this._SkVertices;var t=this._UvBuffer,n=this._IxBuffer,r=this._MeshPoints,o=this._DefaultVertexBuffer,i=this.showDeformed,a=this.isConnectedToBones,s=void 0;if(0===r.length)s=o;else if(i)if(a){var l=this.boneTransformsArray,u=this.worldTransform;s=r.map(function(e){return e.skin(u,l)})}else s=r.map(function(e){return e.translation});else s=r.map(function(e){return e.uvTranslation});this._PtBuffer=s;var c=e.canvasKit;if(0===s.length||0===n.length)return null;this.stageItem.updateMesh(s,this._IxBuffer);var d=c.MakeSkVertices(c.VertexMode.Triangles,s,t,null,null,null,n);return this._SkVertices=d,d}},{key:"read",value:function(e,n){var r=this;this._IsComputingTopology=!0,i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var o=n.asset;void 0!==o&&this.setAsset(e.getAsset(o)),e.whenNodesLoaded(function(){if(void 0!==(o=n.tris)){r._MeshPoints=r.deformPoints;var e=r._MeshPoints.map(function(e){return[e.uv[0],e.uv[1]]});r._PtBuffer=e,r._UvBuffer=e,r.setIndices(o),r._HasContour=!0}setTimeout(function(){r._IsComputingTopology=!1,r.updateContour()},10)})}},{key:"removePoints",value:function(){var e=this.stageItem&&this.stageItem.stage,t=this.children.filter(function(e){return e.constructor===s.default}).map(function(e){return e.stageItem}),n=new v.default(e,this._Actor,t,[]);n.start(),n.end()}},{key:"serializeProperties",value:function(e){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return this._Asset&&this._Asset.id?n.asset=this._Asset.id:delete n.asset,this._IxBuffer&&(n.tris=Array.from(this._IxBuffer)),n}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.asset=this._Asset,e}},{key:"filteringChanged",value:function(){this.dispatch("assetChanged",this._Asset),this.forceRedraw()}},{key:"setAsset",value:function(e){this._Asset&&this._Asset.removeEventListener("filteringChange",this.filteringChanged),this._Asset=e,this._HasFrameSequence=e instanceof f.default,this._Asset&&this._Asset.addEventListener("filteringChange",this.filteringChanged)}},{key:"getCentroidTransform",value:function(){var e,t,n=this.worldTransform;e=n[4],t=n[5];var r=d.mat2d.create();return r[4]=e,r[5]=t,r}},{key:"nullFrame",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.frameImageVertices=null,e}},{key:"triggerAutoKeyFrameVertices",value:function(){this.useAnimationValues&&this.dispatch("animateImageVertices",this)}},{key:"dispatchWeightChange",value:function(){this.forceRedraw(),this.markDeformDirty(),this.dispatch("weightChange")}},{key:"onWeightsChanged",value:function(){this.dispatchWeightChange()}},{key:"validateWeights",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.constructor===l.default&&a.validateWeightBuffer(e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"onReadComplete",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onReadComplete",this).call(this),this.validateWeights(!0)}},{key:"onConnectedBoneChange",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onConnectedBoneChange",this).call(this),this.validateWeights()}},{key:"updateDeform",value:function(){this.invalidateMesh()}},{key:"inverseWorld",get:function(){return this._InverseWorld}},{key:"uiHierIconClass",get:function(){return this.asset&&this.asset.isMissing?"HierarchyMissingImageIcon":"HierarchyImageIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"typeName",get:function(){return"Image"}},{key:"uiIcon",get:function(){return this.asset&&this.asset.isMissing?"icon-missing":"icon-picture"}},{key:"meshPoints",get:function(){return this._MeshPoints}},{key:"points",get:function(){return this.children.filter(function(e){return e.constructor===s.default})}},{key:"deformPoints",get:function(){return this.children.filter(function(e){return e.constructor===l.default})}},{key:"edges",get:function(){return this.children.filter(function(e){return e.constructor===u.default})}},{key:"lastPoint",get:function(){var e=this.points;return e.length&&e[e.length-1]||null}},{key:"vertices",get:function(){return this._PtBuffer}},{key:"uvs",get:function(){return this._UvBuffer}},{key:"triangles",get:function(){return this._IxBuffer}},{key:"showDeformed",get:function(){return this._ShowDeformed},set:function(e){if(this._ShowDeformed!==e){this._ShowDeformed=e,this._SkVertices&&(this._SkVertices.delete(),this._SkVertices=null);var t=this.points,n=this.edges,r=this.deformPoints,o=this.stageItem,i=o.stage,a=i.appContext.isEditingPath(this.stageItem),s=!0,l=!1,u=void 0;try{for(var c,d=t[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value.stageItem;f&&(!a||e?f.removeFromStage():(f.addToStage(i),f.updateContour(),f.updateTransform()))}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}var h=!0,p=!1,y=void 0;try{for(var v,m=r[Symbol.iterator]();!(h=(v=m.next()).done);h=!0){var g=v.value.stageItem;g&&(a&&e?(g.addToStage(i),g.updateContour(),g.updateTransform()):g.removeFromStage(),g.updateContour(),g.updateTransform())}}catch(e){p=!0,y=e}finally{try{!h&&m.return&&m.return()}finally{if(p)throw y}}var b=!0,k=!1,S=void 0;try{for(var O,w=n[Symbol.iterator]();!(b=(O=w.next()).done);b=!0){O.value.updateStageItem()}}catch(e){k=!0,S=e}finally{try{!b&&w.return&&w.return()}finally{if(k)throw S}}o.onTransformed(),this.forceRedraw()}}},{key:"renderTransform",get:function(){return this.showDeformed&&this.isConnectedToBones?this.root?this.root.renderTransform:k:i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"renderTransform",this)}},{key:"tris",get:function(){return this._IxBuffer}},{key:"bitmap",get:function(){return this._Asset&&this._Asset.bitmap||null}},{key:"isSequence",get:function(){return!1}},{key:"asset",get:function(){return this._Asset},set:function(e){if(!e||e.constructor!==String&&e.constructor!==Number||(e=this.actor.getAsset(e)),this._Asset!=e){var t=this._Asset,n=e;t&&t.isMissing,this.setAsset(n),this.dispatch("assetChanged",e),this.forceRedraw()}}},{key:"hasContour",get:function(){return this._HasContour}},{key:"frameImageVertices",get:function(){var e=new Map,t=!0,n=!1,r=void 0;try{for(var o,i=this.children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.constructor===l.default&&e.set(a,a.frameDeform)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return e},set:function(e){this.markDeformDirty(),e.forEach(function(e,t){t.frameDeform=e}),this.useAnimationValues&&this.invalidateMesh()}},{key:"frameImageVerticesKS",get:function(){return this._KeyStateImageVertices},set:function(e){if(this._KeyStateImageVertices!=e){this._KeyStateImageVertices=e,this.markKeyStateDirty();var t=this.parent;t&&t.markKeyStateDirty()}}},{key:"rigImageVertices",get:function(){var e=new Map,t=!0,n=!1,r=void 0;try{for(var o,i=this.children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.constructor===l.default&&e.set(a,a.rigDeform)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return e}}],[{key:"makeDefaultData",value:function(e){var t=e.width,n=e.height,r=t/2,o=n/2,i=[h.default.nextRefID,h.default.nextRefID,h.default.nextRefID,h.default.nextRefID];return{children:[{type:"meshPoint",id:i[0],translation:[-r,-o],uv:[0,0],contour:i[1]},{type:"meshPoint",id:i[1],translation:[r,-o],uv:[t,0],contour:i[2]},{type:"meshPoint",id:i[2],translation:[r,o],uv:[t,n],contour:i[3]},{type:"meshPoint",id:i[3],translation:[-r,o],uv:[0,n],contour:i[0]}]}}}]),t}()).prototype,"updateStageItems",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"updateStageItems"),r.prototype),b(r.prototype,"applyDefaultTopology",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"applyDefaultTopology"),r.prototype),b(r.prototype,"computeTopology",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"computeTopology"),r.prototype),b(r.prototype,"filteringChanged",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"filteringChanged"),r.prototype),b(r.prototype,"dispatchWeightChange",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"dispatchWeightChange"),r.prototype),r);t.default=S},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=ge(n(1)),a=ge(n(5)),s=ge(n(2)),l=ge(n(19)),u=ge(n(220)),c=ge(n(172)),d=ge(n(1181)),f=ge(n(216)),h=ge(n(538)),p=ge(n(231)),y=ge(n(3)),v=n(7),m=ge(n(1184)),g=ge(n(1187)),b=ge(n(1190)),k=ge(n(1192)),S=ge(n(1193)),O=ge(n(1194)),w=ge(n(1195)),_=ge(n(1196)),P=ge(n(1197)),C=ge(n(1198)),E=ge(n(1199)),T=ge(n(1201)),I=ge(n(1203)),j=ge(n(1204)),A=ge(n(1205)),D=ge(n(1206)),R=ge(n(1208)),M=ge(n(1209)),x=ge(n(1210)),F=ge(n(1211)),L=ge(n(1213)),N=ge(n(1214)),z=ge(n(1215)),V=ge(n(1216)),B=ge(n(1217)),H=ge(n(1219)),W=ge(n(1220)),K=(ge(n(168)),ge(n(176))),G=n(333),U=ge(n(253)),X=ge(n(195)),Y=ge(n(179)),J=ge(n(268)),q=ge(n(535)),Q=ge(n(267)),Z=ge(n(536)),$=ge(n(437)),ee=ge(n(677)),te=ge(n(543)),ne=ge(n(678)),re=ge(n(544)),oe=ge(n(545)),ie=ge(n(679)),ae=ge(n(680)),se=ge(n(230)),le=ge(n(252)),ue=ge(n(236)),ce=n(302),de=ge(n(301)),fe=ge(n(337)),he=ge(n(173)),pe=ge(n(254)),ye=ge(n(348)),ve=ge(n(304)),me=(ge(n(667)),ge(n(438)));ge(n(300));function ge(e){return e&&e.__esModule?e:{default:e}}function be(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var ke=(be((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isAnimationOpen:!1,items:null,isPickingParent:!1,isEditingWeights:!1,testColor:new Uint8Array([255,0,0])},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.bones=[],this.items=[],this.itemEditors=[],this.soloItemEditors=[],this.registerEditor(K.default,b.default),this.registerEditor(X.default,b.default),this.registerEditor(Y.default,b.default),this.registerEditor(J.default,b.default),this.registerEditor(se.default,b.default),this.registerEditor(U.default,b.default),this.registerEditor(K.default,V.default),this.registerEditor(X.default,V.default),this.registerEditor(Y.default,V.default),this.registerEditor(J.default,V.default),this.registerEditor(U.default,V.default),this.registerEditor(K.default,m.default),this.registerEditor(K.default,g.default),this.registerEditor(U.default,g.default),this.registerEditor(X.default,m.default),this.registerEditor(Q.default,k.default),this.registerEditor(K.default,S.default),this.registerEditor(U.default,S.default),this.registerEditor(X.default,S.default),this.registerEditor(Y.default,S.default),this.registerEditor(J.default,S.default),this.registerEditor(se.default,S.default),this.registerEditor(te.default,j.default),this.registerEditor(te.default,O.default),this.registerEditor(ne.default,j.default),this.registerEditor(ne.default,w.default),this.registerEditor(re.default,j.default),this.registerEditor(re.default,_.default),this.registerEditor(oe.default,j.default),this.registerEditor(oe.default,P.default),this.registerEditor(ie.default,j.default),this.registerEditor(ie.default,P.default),this.registerEditor(ae.default,j.default),this.registerEditor(ae.default,C.default),this.registerEditor(G.StageArtboard,E.default),this.registerEditor(K.default,E.default),this.registerEditor(X.default,E.default),this.registerEditor(Y.default,E.default),this.registerEditor(J.default,E.default),this.registerEditor(se.default,E.default),this.registerEditor(le.default,E.default),this.registerEditor(Y.default,T.default),this.registerEditor(ee.default,T.default),this.registerEditor(K.default,T.default),this.registerEditor(X.default,T.default),this.registerEditor(J.default,T.default),this.registerEditor(U.default,T.default),this.registerEditor(se.default,T.default),this.registerEditor(le.default,T.default),this.registerEditor(Y.default,I.default),this.registerEditor(K.default,I.default),this.registerEditor(X.default,I.default),this.registerEditor(J.default,I.default),this.registerEditor(U.default,I.default),this.registerEditor(se.default,I.default),this.registerEditor(le.default,I.default),this.registerEditor(J.default,A.default),this.registerEditor(ue.default,D.default),this.registerEditor(ce.StagePathControlIn,D.default),this.registerEditor(ce.StagePathControlOut,D.default),this.registerSoloEditor(se.default,D.default),this.registerSoloEditor(le.default,D.default),this.registerEditor(de.default,R.default),this.registerSoloEditor(Y.default,R.default),this.registerEditor(se.default,x.default),this.registerEditor(se.default,F.default),this.registerEditor(le.default,M.default),this.registerEditor(Y.default,M.default),this.registerEditor(se.default,L.default),this.registerEditor(le.default,L.default),this.registerEditor(se.default,N.default),this.registerEditor(le.default,N.default),this.registerEditor(se.default,z.default),this.registerEditor(le.default,z.default),this.registerEditor(G.StageArtboard,W.default);for(var e=0;e<this.itemEditors.length;e++){this.itemEditors[e].__editors.sort(function(e,t){return(e.panelOrder||0)-(t.panelOrder||0)})}this.context.nima&&(this.context.nima.addEventListener("pickParent",this.onPickParentChanged),this.context.nima.stage.addEventListener("toolChanged",this.toolChanged)),this._FilePanelWidth=this.props.filePanelWidth}},{key:"componentWillUnmount",value:function(){if(this.context.nima){this.context.nima.removeEventListener("pickParent",this.onPickParentChanged),this.context.nima.stage.removeEventListener("toolChanged",this.toolChanged);var e=this.context.nima.stage.findTool(ve.default);e&&e.removeEventListener("selectionChanged",this.updateWeightVertexSelection)}}},{key:"debouncedForceUpdate",value:function(){this.forceUpdate()}},{key:"updateWeightVertexSelection",value:function(){(0,l.default)(this.debouncedForceUpdate)}},{key:"toolChanged",value:function(){var e=this.context.nima.stage,t=e.findTool(ve.default);t&&(e.tool===t?t.addEventListener("selectionChanged",this.updateWeightVertexSelection):t.removeEventListener("selectionChanged",this.updateWeightVertexSelection)),this.state.isEditingWeights&&this.forceUpdate()}},{key:"onPickParentChanged",value:function(e){this.setState({isPickingParent:e})}},{key:"registerSoloEditor",value:function(e,t){-1===this.soloItemEditors.indexOf(e)&&this.soloItemEditors.push(e),e.__soloEditors||(e.__soloEditors=[]),e.__soloEditors.push(t)}},{key:"registerEditor",value:function(e,t){-1===this.itemEditors.indexOf(e)&&this.itemEditors.push(e),e.__editors||(e.__editors=[]),e.__editors.push(t)}},{key:"setAnimationMode",value:function(e){var t=!!e;this.state.isAnimationOpen!=t&&this.setState({isAnimationOpen:t})}},{key:"itemPropertiesUpdated",value:function(){this.isRendering||this.forceUpdate(),this.itemPropertiesUpdateDelay()}},{key:"itemPropertiesUpdateDelay",value:function(){var e=this;clearTimeout(this.t),this.t=setTimeout(function(){e.forceUpdate()},0)}},{key:"setItems",value:function(e){if(this.items)for(var n=0;n<this.items.length;n++){var r=this.items[n];r.node&&r.node.removeEventListener("update",this.itemPropertiesUpdated)}if(this.items=e,this.setState({items:e}),e)for(var o=0;o<e.length;o++){var i=e[o];i.node&&i.node.addEventListener("update",this.itemPropertiesUpdated)}t.validate(t.Validation,e).hasReplace?this.context.nima.setReplaceTarget(e):this.context.nima.setReplaceTarget(null)}},{key:"setSelectedKeyFrames",value:function(e){this.keyFrameOptions&&this.keyFrameOptions.setKeyFrames(e)}},{key:"addEvent",value:function(){this.items&&this.items.length&&this.context.nima.actor.addNodeType(fe.default,this.items[0].node,{})}},{key:"setSelectedItem",value:function(e,t){e?e.constructor!==Array&&(e=[e]):e=[];for(var n=!1,r=!1,o=[],i=0;i<e.length;i++){var a=e[i],s=!0;if(a)switch(a.constructor){case X.default:n=!0;break;case pe.default:s=!1;continue;default:r=!0}a.selectionPanelItem&&(a=a.selectionPanelItem),s&&-1===o.indexOf(a)&&o.push(a)}if(n&&r)for(var l=0;l<o.length;l++){var u=o[l];u&&u.constructor===X.default&&!u.isRoot&&(o.splice(l,1),l--)}var c=!this.items||this.items.length!=o.length;if(!c)for(var d=0;d<o.length;d++)if(-1===this.items.indexOf(o[d])){c=!0;break}(c||t)&&this.setItems(o)}},{key:"revalidate",value:function(){this.setItems(this.state.items)}},{key:"componentDidMount",value:function(){this.setItems(this.state.items)}},{key:"setFilePanelWidth",value:function(e){this._FilePanelWidth=e}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"translateSelectionPanelForEditor",value:function(e){this.selectionPanel.style.transform=e?"translate3D(-"+this._FilePanelWidth+"px, 0, 0)":"translate3D(0px, 0, 0)"}},{key:"translatePanelOut",value:function(e){this.selectionPanel.style.transform=e?"translate3D(-"+(this._FilePanelWidth+this.props.width)+"px, 0, 0)":"translate3D(0px, 0, 0)"}},{key:"setSelectionPanel",value:function(e){this.selectionPanel=e}},{key:"selectBoneIndex",value:function(e){if(this.weightEditor){var t=this.weightEditor.node;e=Math.max(0,Math.min(e,t.connectedBones.length-1));var n=this.context.nima.stage.findTool(ye.default);n.selectedBoneIndex=e;for(var r=t.connectedBones,o=0;o<r.length;o++){r[o].node.stageItem.isPainting=o===e}null!==t.showBoneColorIndex&&(t.showBoneColorIndex=n.selectedBoneIndex),this.forceUpdate()}}},{key:"selectNextBone",value:function(){if(this.weightEditor){var e=this.context.nima.stage.findTool(ye.default);this.selectBoneIndex(e.selectedBoneIndex+1)}}},{key:"selectPreviousBone",value:function(){if(this.weightEditor){var e=this.context.nima.stage.findTool(ye.default);this.selectBoneIndex(e.selectedBoneIndex-1)}}},{key:"incBrushSize",value:function(e){this.context.nima.stage.findTool(ye.default).brush.size+=e,this.forceUpdate()}},{key:"incBrushFeather",value:function(e){this.context.nima.stage.findTool(ye.default).brush.feather+=e,this.forceUpdate()}},{key:"incBrushStrength",value:function(e){this.context.nima.stage.findTool(ye.default).brush.strength+=e,this.forceUpdate()}},{key:"editWeightsOn",value:function(){if(1===this.state.items.length){var e=this.state.items[0].node;this.translateSelectionPanelForEditor(!0),this.preWeightTool=this.context.nima.stage.toolType,e.isEditingWeights=!0,this.weightEditor=e.weightEditor||(e.weightEditor=new H.default(this.context.nima,e,this)),e.addEventListener("weightDataChanged",this.updateWeightVertexSelection),this.context.nima.editingWeights=this.weightEditor,this.weightEditor.activate();var t=this.context.nima.stage.findTool(ye.default);t&&this.selectBoneIndex(t.selectedBoneIndex),this.setState({isEditingWeights:!0}),this.props.onWeightsMode&&this.props.onWeightsMode(!0);var n=this;setTimeout(function(){n.context.nima.stage.setSoloItems([e.stageItem],!1),n.context.nima.stage.clearSelections(),e.stageItem.isSelectable=!1},0),this.context.nima.setSelectionCallbacks(this.selectBoneIndex,this.selectNextBone,this.selectPreviousBone),this.context.nima.setBrushCallbacks(this.incBrushSize,this.incBrushFeather,this.incBrushStrength)}}},{key:"autoCalculateWeights",value:function(){this.weightEditor&&this.weightEditor.calculateAutoWeights()}},{key:"editWeightsOff",value:function(){this.translateSelectionPanelForEditor(!1);var e=this,t=null;if(this.weightEditor){t=this.weightEditor.stageItem,this.weightEditor.deactivate();var n=this.weightEditor.node;n.removeEventListener("weightDataChanged",this.updateWeightVertexSelection),n.isEditingWeights=!1;for(var r=n.connectedBones,o=0;o<r.length;o++){r[o].node.stageItem.isPainting=null}this.weightEditor=null}this.context.nima.editingWeights=null,this.setState({isEditingWeights:!1}),this.props.onWeightsMode&&this.props.onWeightsMode(!1),setTimeout(function(){var n=e.context.nima.stage;n.clearSoloItems(),t&&(t.isSelectable=!0,n.selectItem(t)),e.context.nima.stage.toolType=e.preWeightTool,e.context.nima.captureJournalEntry()},0),this.context.nima.setSelectionCallbacks(),this.context.nima.setBrushCallbacks()}},{key:"replaceImage",value:function(){var e=document.createElement("input"),t=this;e.addEventListener("change",function(e){t.context.nima.replaceAssets(t.state.items,e.target.files)}),e.setAttribute("type","file"),e.click()}},{key:"resizeWeightBrush",value:function(e,t){this.context.nima.stage.findTool(ye.default).brush.size=e,this.forceUpdate()}},{key:"changeColorMapOpacity",value:function(e){this.weightEditor&&(this.weightEditor.node.colorMapOpacity=e),this.forceUpdate()}},{key:"changePoseIndex",value:function(e){var t=this.weightEditor;t&&(t.showDeformed=1===e,this.forceUpdate())}},{key:"changePaintColorMap",value:function(e){if(this.weightEditor)if(1===e){var t=this.context.nima.stage.findTool(ye.default);this.weightEditor.node.showBoneColorIndex=t.selectedBoneIndex}else this.weightEditor.node.showBoneColorIndex=null;this.forceUpdate()}},{key:"changeBrushMode",value:function(e){this.context.nima.stage.findTool(ye.default).brush.mode=e,this.forceUpdate()}},{key:"featherBrush",value:function(e,t){this.context.nima.stage.findTool(ye.default).brush.feather=e,this.forceUpdate()}},{key:"setBrushStrength",value:function(e,t){this.context.nima.stage.findTool(ye.default).brush.strength=e,this.forceUpdate()}},{key:"selectPaintBone",value:function(e){this.selectBoneIndex(e.props.index)}},{key:"onEditBrush",value:function(e,t){var n=this.context.nima.stage.findTool(ye.default);t?(n.brush.isInEditingPosition=!0,this.editingBrushControl=e):this.editingBrushControl===e&&(n.brush.isInEditingPosition=!1,this.editingBrushControl=null)}},{key:"setLeft",value:function(e){this.selectionPanel.style.left=e+"px"}},{key:"setRight",value:function(e){this.selectionPanel.style.right=e+"px"}},{key:"setWidth",value:function(e){this.selectionPanel.style.width=e+"px"}},{key:"setBottom",value:function(e){this.selectionPanel.style.bottom=e+"px"}},{key:"changeTestColor",value:function(e){this.setState({testColor:e})}},{key:"changeVertexWeight",value:function(e,t){this.weightEditor&&(this.context.nima.stage.findTool(ve.default).setSelectedVertexWeight(e,t),this.forceUpdate())}},{key:"setKeyFrameOptions",value:function(e){this.keyFrameOptions=e}},{key:"distributeHorizontal",value:function(){this.distribute(0)}},{key:"distributeVertical",value:function(){this.distribute(1)}},{key:"distribute",value:function(e){var t=this.items.filter(function(e){return e.node instanceof he.default}).map(function(e){return{node:e.node,bb:e.computeTightAABB()}});if(!(t.length<=2)){t.sort(function(t,n){return t.bb.center[e]-n.bb.center[e]});for(var n=t.length-1,r=t[0].node.worldTranslation[e]+t[0].bb.extents[e],o=t[n].node.worldTranslation[e]-t[n].bb.extents[e]-r,i=1;i<n;i++)o-=2*t[i].bb.extents[e];for(var a=o/n,s=0,l=1;l<n;l++){var u=t[l],c=u.node,d=v.mat2d.getTranslation(v.vec2.create(),c.calculateWorldTransform()),f=c.parent.calculateWorldTransform(),h=v.mat2d.invert(v.mat2d.create(),f);if(h){var p=v.vec2.clone(d),y=u.bb,m=y.extents[e];p[e]=r+s+a*l+m,s+=2*m,d[e]=(y.min[e]+y.max[e])/2;var g=v.vec2.subtract(v.vec2.create(),c.translation,v.vec2.transformMat2d(v.vec2.create(),d,h));c.translation=v.vec2.add(v.vec2.create(),g,v.vec2.transformMat2d(v.vec2.create(),p,h))}}}}},{key:"align",value:function(e,t){var n=this.context.nima.stage,r=this.items.filter(function(e){return e.node instanceof he.default}),o=r.find(function(e){return e===n.selectionTarget}),i=this.context.nima.actor,a=void 0;if(o)a=o.computeTightAABB();else if(r.length>1){a=r[0].computeTightAABB();for(var s=1;s<r.length;s++){var l=r[s].computeTightAABB();a.combine(l)}this.items.find(function(e){return e instanceof G.StageArtboard})&&a.combine(i.artboards.active.aabb)}else a=i.artboards.active.aabb;if(a){var u=t(a);r.sort(function(e,t){return e.node.treeDepth-t.node.treeDepth});var c=!0,d=!1,f=void 0;try{for(var h,p=r[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var y=h.value,m=y.node,g=v.mat2d.getTranslation(v.vec2.create(),m.calculateWorldTransform()),b=v.vec2.clone(g);b[e]=u;var k=m.parent.calculateWorldTransform(),S=v.mat2d.invert(v.mat2d.create(),k),O=y.computeTightAABB();if(O){g[e]=t(O);var w=v.vec2.subtract(v.vec2.create(),m.translation,v.vec2.transformMat2d(v.vec2.create(),g,S));m.translation=v.vec2.add(v.vec2.create(),w,v.vec2.transformMat2d(v.vec2.create(),b,S))}}}catch(e){d=!0,f=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw f}}}}},{key:"alignCenterX",value:function(){this.align(0,function(e){return(e.min[0]+e.max[0])/2})}},{key:"alignRight",value:function(){this.align(0,function(e){return e.max[0]})}},{key:"alignLeft",value:function(){this.align(0,function(e){return e.min[0]})}},{key:"alignCenterY",value:function(){this.align(1,function(e){return(e.min[1]+e.max[1])/2})}},{key:"alignTop",value:function(){this.align(1,function(e){return e.min[1]})}},{key:"alignBottom",value:function(){this.align(1,function(e){return e.max[1]})}},{key:"render",value:function(){var e=this.context.nima.stage,n=this.state.items;this.isRendering=!0;var r=n&&n.length||e.soloItems&&e.soloItems.length,o=n&&n.length>1?"Multiple Selection":"No selection",a=n&&n.length>2,s=!r,l=t.validate(t.Validation,n&&n.length?n:e.soloItems);l.name||(l.name=o);var v=!r,m=this.state.isAnimationOpen;this.isRendering=!1;var g=e.findTool(ye.default),b=[],k=0,S=1,O=0,w=this.weightEditor;if(w){var _=e.findTool(ve.default),P=w.node;null!==P.showBoneColorIndex&&(k=1),S=P.colorMapOpacity;var C=P.connectedBones,E=g.selectedBoneIndex;O=g.brush.mode;var T=null;e.toolType===ve.default&&(T=_.selectedWeights);for(var I=0;I<C.length;I++){var j=C[I];b.push(i.default.createElement(h.default,{value:T?T.get(I):null,onSelect:this.selectPaintBone,index:I,key:I,bone:j.node,color:K.default.Colors[I%K.default.Colors.length],isSelected:E==I,onWeightChanged:this.changeVertexWeight}))}}var A=null;if(e.soloItems){var D=!0,R=!1,M=void 0;try{for(var x,F=e.soloItems[Symbol.iterator]();!(D=(x=F.next()).done);D=!0){var L=x.value,N=L.constructor.__soloEditors;if(N)if(A)for(var z=0;z<A.length;z++){var V=A[z];-1!==N.indexOf(V.type)&&V.type.canMultiEdit?V.stageItems.push(L):(A.splice(z,1),z--)}else{A=[];for(var H=0;H<N.length;H++){var W=N[H];A.push({type:W,stageItems:[L]})}}}}catch(e){R=!0,M=e}finally{try{!D&&F.return&&F.return()}finally{if(R)throw M}}}if(n&&n.length)for(var G=0;G<n.length;G++){var U=n[G],X=void 0;if(U&&(X=U.constructor.__editors))if(A)for(var Y=0;Y<A.length;Y++){var J=A[Y];-1!==X.indexOf(J.type)&&J.type.canMultiEdit?J.stageItems.push(U):(A.splice(Y,1),Y--)}else{A=[];for(var q=0;q<X.length;q++){var Q=X[q];A.push({type:Q,stageItems:[U]})}}}if(A){for(var Z=[],$=0;$<A.length;$++){var ee=A[$],te=null,ne=!0;ee.type.validate&&((te=ee.type.validate(this,ee.stageItems))||(ne=!1)),ne&&Z.push(i.default.createElement(ee.type,{stageItems:ee.stageItems,disableInput:v,validation:te,key:$,isAnimating:m,selectionPanel:this}))}A=Z}else A=[];return i.default.createElement("div",{id:"SelectionPanel",className:m?"SelectionPanelAnimating":null,ref:this.setSelectionPanel,style:{width:this.props.width+"px"}},w?i.default.createElement("div",{className:"SelectionPanelContent"},i.default.createElement("div",{className:"SelectionPanelGroup"},i.default.createElement("div",{className:"SelectionPanelTitle"},"Edit Weights"),i.default.createElement(c.default,{label:"OK",onPress:this.editWeightsOff}),i.default.createElement(c.default,{label:"AUTO CALCULATE",onPress:this.autoCalculateWeights})),i.default.createElement(p.default,{label:"Options"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Pose"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(u.default,{options:["Bind","Setup"],selectedIndex:w.showDeformed?1:0,onSelectionChanged:this.changePoseIndex}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Map"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(u.default,{options:["All","Selected"],selectedIndex:k,onSelectionChanged:this.changePaintColorMap}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Map Opacity"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(f.default,{value:S,dragScale:.01,onValueChanged:this.changeColorMapOpacity})))),e.tool===g?i.default.createElement(p.default,{label:"Brush Options"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Operation"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(u.default,{options:["Add","Subtract"],selectedIndex:O,onSelectionChanged:this.changeBrushMode}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Size"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(f.default,{onEdit:this.onEditBrush,value:g&&g.brush.size,onValueChanged:this.resizeWeightBrush}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Feather"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(f.default,{onEdit:this.onEditBrush,value:g&&g.brush.feather,onValueChanged:this.featherBrush}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Strength"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(f.default,{onEdit:this.onEditBrush,dragScale:.01,value:g&&g.brush.strength,onValueChanged:this.setBrushStrength})))):null,i.default.createElement(p.default,{label:e.toolType===ve.default?"Vertex Weights":"Paint With"},b)):null,i.default.createElement("div",{className:me.default.SelectionPanelContent,style:{display:this.state.isEditingWeights?"none":"block"}},i.default.createElement("div",{className:"SelectionPanelGroup",style:{paddingTop:"17px",paddingBottom:"16px"}},l.className&&l.icon?i.default.createElement("svg",{className:"SelectionPanelCurrentIcon "+l.className},i.default.createElement("use",{xlinkHref:l.icon||null})):null,i.default.createElement("div",{className:s?"SelectedName SelectionPanelEmptyMsg":"SelectedName"},l.name),s?i.default.createElement("div",{className:"SelectionPanelEmptyNote"},"Select something to view its properties and options."):null,i.default.createElement("div",{className:"SelectedItemType"},l.typeName),l.hasReplace?i.default.createElement(c.default,{onPress:this.replaceImage,label:"Replace"}):null),!s&&l.hasAlignment?i.default.createElement("div",{className:me.default.AlignGroup},i.default.createElement(d.default,{disabled:!a,icon:"icon-distribute-horizontal",tip:{label:"Distribute horizontal",action:null},onPress:this.distributeHorizontal}),i.default.createElement(d.default,{disabled:!a,icon:"icon-distribute-vertical",tip:{label:"Distribute vertical",action:null},onPress:this.distributeVertical}),i.default.createElement("div",{className:me.default.AlignSpacer}),i.default.createElement(d.default,{icon:"icon-align-left",tip:{label:"Align left",action:null},onPress:this.alignLeft}),i.default.createElement(d.default,{icon:"icon-align-vcenter",tip:{label:"Align center",action:null},onPress:this.alignCenterX}),i.default.createElement(d.default,{icon:"icon-align-right",tip:{label:"Align right",action:null},onPress:this.alignRight}),i.default.createElement("div",{className:me.default.AlignSpacer}),i.default.createElement(d.default,{icon:"icon-align-top",tip:{label:"Align top",action:null},onPress:this.alignTop}),i.default.createElement(d.default,{icon:"icon-align-hcenter",tip:{label:"Align middle",action:null},onPress:this.alignCenterY}),i.default.createElement(d.default,{icon:"icon-align-bottom",tip:{label:"Align bottom",action:null},onPress:this.alignBottom})):null,A,l.hasReparent&&!m?i.default.createElement("div",{className:"SelectionPanelGroup"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitleSwitch",style:{color:this.state.isPickingParent?"#fff":null}},"Pick Parent"),i.default.createElement("svg",{className:this.state.isPickingParent?"PickParentActive":"PickParent",onMouseDown:this.context.nima.pickParent},i.default.createElement("use",{xlinkHref:y.default.make("/images/symbol-defs.svg#icon-aim")})))):null,null),m?i.default.createElement(B.default,{ref:this.setKeyFrameOptions}):null)}},{key:"isAnimating",get:function(){return this.state.isAnimationOpen}}]),t}()).prototype,"debouncedForceUpdate",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"debouncedForceUpdate"),r.prototype),be(r.prototype,"updateWeightVertexSelection",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"updateWeightVertexSelection"),r.prototype),be(r.prototype,"toolChanged",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"toolChanged"),r.prototype),be(r.prototype,"onPickParentChanged",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onPickParentChanged"),r.prototype),be(r.prototype,"itemPropertiesUpdated",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"itemPropertiesUpdated"),r.prototype),be(r.prototype,"commit",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),be(r.prototype,"setSelectionPanel",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setSelectionPanel"),r.prototype),be(r.prototype,"selectBoneIndex",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"selectBoneIndex"),r.prototype),be(r.prototype,"selectNextBone",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"selectNextBone"),r.prototype),be(r.prototype,"selectPreviousBone",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"selectPreviousBone"),r.prototype),be(r.prototype,"incBrushSize",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"incBrushSize"),r.prototype),be(r.prototype,"incBrushFeather",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"incBrushFeather"),r.prototype),be(r.prototype,"incBrushStrength",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"incBrushStrength"),r.prototype),be(r.prototype,"editWeightsOn",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"editWeightsOn"),r.prototype),be(r.prototype,"autoCalculateWeights",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"autoCalculateWeights"),r.prototype),be(r.prototype,"editWeightsOff",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"editWeightsOff"),r.prototype),be(r.prototype,"replaceImage",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"replaceImage"),r.prototype),be(r.prototype,"resizeWeightBrush",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"resizeWeightBrush"),r.prototype),be(r.prototype,"changeColorMapOpacity",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"changeColorMapOpacity"),r.prototype),be(r.prototype,"changePoseIndex",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"changePoseIndex"),r.prototype),be(r.prototype,"changePaintColorMap",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"changePaintColorMap"),r.prototype),be(r.prototype,"changeBrushMode",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"changeBrushMode"),r.prototype),be(r.prototype,"featherBrush",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"featherBrush"),r.prototype),be(r.prototype,"setBrushStrength",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setBrushStrength"),r.prototype),be(r.prototype,"selectPaintBone",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"selectPaintBone"),r.prototype),be(r.prototype,"onEditBrush",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onEditBrush"),r.prototype),be(r.prototype,"changeTestColor",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"changeTestColor"),r.prototype),be(r.prototype,"changeVertexWeight",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"changeVertexWeight"),r.prototype),be(r.prototype,"setKeyFrameOptions",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setKeyFrameOptions"),r.prototype),be(r.prototype,"distributeHorizontal",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"distributeHorizontal"),r.prototype),be(r.prototype,"distributeVertical",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"distributeVertical"),r.prototype),be(r.prototype,"alignCenterX",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"alignCenterX"),r.prototype),be(r.prototype,"alignRight",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"alignRight"),r.prototype),be(r.prototype,"alignLeft",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"alignLeft"),r.prototype),be(r.prototype,"alignCenterY",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"alignCenterY"),r.prototype),be(r.prototype,"alignTop",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"alignTop"),r.prototype),be(r.prototype,"alignBottom",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"alignBottom"),r.prototype),r);t.default=ke,ke.isValue=function(e){return null!=e},ke.validate=function(e,t){var n={};for(var r in e){var o=e[r],i=null;if(t&&t.length){var a=t[0];i=o.validate(a);for(var s=1;s<t.length;s++){var l=t[s];if(o.equals?!o.equals(o.validate(l),i):o.validate(l)!==i){i=!1;break}}}n[r]=i}return n},ke.Validation={hasReplace:{validate:function(e){switch(e.constructor){case Y.default:return!e.node.asset||e.node.asset.isMissing;case $.default:case Z.default:case Q.default:return!0}return!1}},hasReparent:{validate:function(e){switch(e.constructor){case J.default:case Y.default:return!0;case X.default:return!e.parentJoint}return!1}},hasAlignment:{validate:function(e){switch(e.constructor){case Q.default:case q.default:case ue.default:return!1}return!0}},disableInput:{validate:function(e){return e.constructor!==pe.default}},name:{validate:function(e){return e.node?e.node.name:e.name}},typeName:{validate:function(e){return e.typeName||e.node&&e.node.typeName}},className:{validate:function(e){return e.uiSelectionIconClass||e.node&&e.node.uiSelectionIconClass}},icon:{validate:function(e){var t=e.selectionIcon;return!t&&e.node&&(t=e.node.uiIcon),t?y.default.make("/images/symbol-defs.svg#"+t):null}}},ke.contextTypes={nima:a.default.object}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),a=u(n(2)),s=u(n(353)),l=u(n(431));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var d=(c((r=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setKey",value:function(e){this.inputField&&this.inputField.confirmValue(),e.stopPropagation(),this.props.onSetKey&&this.props.onSetKey(this.props.value)}},{key:"colorChanged",value:function(e){this.props.onValueChanged&&this.props.onValueChanged(e)}},{key:"setInputField",value:function(e){this.inputField=e}},{key:"render",value:function(){var e=this.props,t=e.value,n=e.isAnimating,r=e.addClass,o=e.disabled,a=e.readOnly,u=e.onEdit,c=e.onValueChanged,d=e.onValueCommit,f=e.converter,h=e.isText,p=e.dragScale,y=e.decimalPlaces,v=e.unit,m=this.isColor,g=void 0;switch(this.props.keyState){default:case 0:g="SelectionPanelKey";break;case 1:g="SelectionPanelKeyChanged";break;case 2:g="SelectionPanelKeyed"}return i.default.createElement("div",{className:"SelectionPanelInputField"+(o?" SelectionPanelInputFieldDisabled":"")+(r?" "+r:""),onMouseDown:this.click},this.props.label?i.default.createElement("div",{className:"SelectionPanelInputLabel"},this.props.label):null,i.default.createElement("span",{className:"InputSpan"},i.default.createElement(l.default,{ref:this.setInputField,placeholder:this.props.placeholder,style:{paddingRight:n?"12px":"0px"},value:t,isText:h,unit:v,converter:f,disabled:o,readOnly:a,dragScale:p,decimalPlaces:y,onEdit:u,onValueCommit:d,onValueChanged:c})),m?i.default.createElement(s.default,{color:t,onColorChange:this.colorChanged}):null,i.default.createElement("div",{className:g,onMouseDown:this.setKey,style:{display:this.props.isAnimating?null:"none"}},i.default.createElement("div",null)))}},{key:"isColor",get:function(){var e=this.props.value;if(null==e)return!1;if(e.constructor===Uint8Array)return!0;switch(e.type){case s.default.Mode.Solid:case s.default.Mode.LinearGradient:case s.default.Mode.RadialGradient:return!0}return!1}}]),t}()).prototype,"setKey",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setKey"),r.prototype),c(r.prototype,"colorChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"colorChanged"),r.prototype),c(r.prototype,"setInputField",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setInputField"),r.prototype),r);t.default=d,d.InvalidValueMarker="-"},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=new Map,i=new Map,a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Label=t,this._ID=n,this._NumericID=r,o.set(t,this),i.set(n,this)}return r(e,[{key:"toString",value:function(){return this._Label}},{key:"id",get:function(){return this._ID}},{key:"numericId",get:function(){return this._NumericID}},{key:"label",get:function(){return this._Label}}],[{key:"fromName",value:function(t){return o.get(t)||e.Straight}},{key:"fromID",value:function(t){return i.get(t)||e.Straight}}]),e}();t.default=a,a.Straight=new a("straight","S",0),a.Mirror=new a("mirror","M",1),a.Disconnected=new a("disconnected","D",2),a.Asymmetric=new a("asymmetric","A",3)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=s(n(173)),a=s(n(198));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Root Bone",n._HasContrast=!1,n._Size=10,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"recurseChangeSize",value:function(){this.dispatch("sizeChanged",this._Size);for(var e=0;e<this.children.length;e++){var t=this.children[e];t.constructor===a.default&&t.recurseChangeSize()}}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.contrast;r&&(this._HasContrast=r);var i=n.size;i&&i.constructor===Number&&(this._Size=i)}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return delete n.hasContrast,this._HasContrast&&(n.contrast=this._HasContrast),n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.hasContrast=this._HasContrast,e.size=this._Size,e}},{key:"uiHierIconClass",get:function(){return"HierarchyRootIcon"}},{key:"uiIcon",get:function(){return"icon-root"}},{key:"size",get:function(){return this._Size},set:function(e){e!=this._Size&&(this._Size=e,this.recurseChangeSize(),this.forceRedraw())}},{key:"hasContrast",get:function(){return this._HasContrast},set:function(e){this._HasContrast!=e&&(this._HasContrast=e,this.dispatch("hasContrastChange",e),this.forceRedraw())}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(28)),s=c(n(5)),l=c(n(2)),u=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isOpen:!1},n._Dropdowns=[],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setDropdown",value:function(e){this.dropdown=e}},{key:"open",value:function(){if(!this.props.disabled){this.setState({isOpen:!0});for(var e=[],t=0;t<this.props.options.length;t++){var n=this.props.options[t],r=n,o=n.hoverTitle,i=n.hoverDesc,s=n.hoverIcon;n&&n.constructor!==String&&(r=n.value,n=n.label),e.push({label:n,value:r,active:t===this.props.selectedIndex,hoverTitle:o||!1,hoverDesc:i||!1,hoverIcon:s||!1})}var l=void 0;this.props.dropdownClass&&(l=this.props.dropdownClass);var u=a.default.findDOMNode(this.dropdown).getBoundingClientRect(),c=this.context.nima.showDropDownMenu({onClosed:this.closed,onSelectionChanged:this.props.onSelectionChanged,options:e,rect:u,dropdownClass:l});this._Dropdowns.push(c)}}},{key:"componentWillUnmount",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this._Dropdowns[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.context.nima.removeDropdownMenu(i)}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}},{key:"closed",value:function(){this.setState({isOpen:!1})}},{key:"setKey",value:function(e){if(e.stopPropagation(),this.props.onSetKey){var t=this.props.options[this.props.selectedIndex];this.props.onSetKey(t)}}},{key:"render",value:function(){var e,t=this.props.options[this.props.selectedIndex];t&&t.constructor!==String&&(t=t.label);var n=this.props,r=n.disabled,o=n.isAnimating;if(o)switch(this.props.keyState){case 0:e="SelectionPanelKey";break;case 1:e="SelectionPanelKeyChanged";break;case 2:e="SelectionPanelKeyed"}return i.default.createElement("div",{className:this.props.addClass?"Dropdown "+this.props.addClass:"Dropdown",ref:this.setDropdown,style:{opacity:r?.2:null}},i.default.createElement("div",{className:"DropdownCurrent",onClick:this.open},i.default.createElement("span",{style:{top:this.state.isOpen?"15px":"0px",opacity:this.state.isOpen?"0":"1"}},t),r?null:i.default.createElement("svg",{className:"DropdownArrow",style:{right:o?"20px":null}},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-arrow")})),o?i.default.createElement("div",{className:e,onMouseDown:this.setKey},i.default.createElement("div",null)):null),this.props.label?i.default.createElement("div",{className:"SelectionPanelInputLabel"},this.props.label):null)}}]),t}()).prototype,"setDropdown",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setDropdown"),r.prototype),d(r.prototype,"open",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"open"),r.prototype),d(r.prototype,"closed",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"closed"),r.prototype),d(r.prototype,"setKey",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setKey"),r.prototype),r);t.default=f,f.contextTypes={nima:s.default.object}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=u(n(179)),i=u(n(195)),a=u(n(176)),s=u(n(18)),l=n(7);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._Stage=e,n._IsDragging=!1,n._ActiveTransformers=[],n._SuppressTransformers=[],n._Snap=!1,n._AllowSnap=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),r(t,[{key:"simulateDrag",value:function(e){function t(e){return e.stopPropagation=function(){},e.preventDefault=function(){},e}e||(e=[0,0]);var n=this._Stage;n._IsMouseOverStage=!0;var r=n.selectedItems[0],o=l.vec2.clone(r.getViewPoint([0,0]));n.onMouseMove(t({clientX:o[0],clientY:o[1]}),0,0),setTimeout(function(){n.onMouseDown(t({clientX:o[0],clientY:o[1]})),setTimeout(function(){n.onMouseMove(t({clientX:o[0]+e[0],clientY:o[1]+e[1]}),0,0),setTimeout(function(){n.onMouseUp(t({}))},20)},220)},20),n._IsMouseOverStage=!1}},{key:"blockMarquee",value:function(e){return!1}},{key:"clearSelections",value:function(){}},{key:"onKeyDown",value:function(e){this._AllowSnap&&(this.snap=e.shiftKey)}},{key:"onKeyUp",value:function(e){this._AllowSnap&&(this.snap=e.shiftKey)}},{key:"enable",value:function(){}},{key:"cancel",value:function(){}},{key:"disable",value:function(){this._IsDragging&&this.endDrag()}},{key:"click",value:function(e){}},{key:"release",value:function(e){this._ActiveTransformers=[],this._Stage.appContext.captureJournalEntry()}},{key:"updateSelection",value:function(e,t){}},{key:"updateSolo",value:function(e){}},{key:"startDrag",value:function(e,t){this._SuppressTransformers.length=0,this._IsDragging=!0,this.filterDragSelection&&(t=this.filterDragSelection(t));var n=this.transformers;if(!n)return!1;for(var r=0;r<n.length;r++){var o=n[r];if(this._SuppressTransformers.length){for(var i=!1,a=0;a<this._SuppressTransformers.length;a++)if(this._SuppressTransformers[a]===o){i=!0;break}if(i)continue}var s=o.make(this,t);s&&this._ActiveTransformers.push(s)}return 0!=this._ActiveTransformers.length}},{key:"advanceDrag",value:function(e,t,n,r){for(var o=0;o<this._ActiveTransformers.length;o++)this._ActiveTransformers[o].advance(e,t,n,r)}},{key:"validate",value:function(){return!0}},{key:"suppressTransformer",value:function(e){this._SuppressTransformers.push(e);for(var t=0;t<this._ActiveTransformers.length;t++){var n=this._ActiveTransformers[t];n.constructor===e&&(n.complete(),this._ActiveTransformers.splice(t,1),t--)}}},{key:"endDrag",value:function(){this._IsDragging=!1;for(var e=0;e<this._ActiveTransformers.length;e++)this._ActiveTransformers[e].complete();this._ActiveTransformers=[]}},{key:"drawPrep",value:function(e){}},{key:"draw",value:function(e){}},{key:"addActiveTransformer",value:function(e){this._ActiveTransformers.push(e)}},{key:"snap",get:function(){return this._Snap},set:function(e){if(this._Snap!==e){this._Snap=e;var t=!0,n=!1,r=void 0;try{for(var o,i=this._ActiveTransformers[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.onSnapChange&&a.onSnapChange(e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}}},{key:"stage",get:function(){return this._Stage}}]),t}();t.default=c,c.filterChildren=function(e){for(var t=e.slice(0),n=0;n<t.length;n++){var r=t[n].node;if(r&&(r.isLocked||r.stageItem&&r.stageItem.isFake))t.splice(n,1),n--;else for(;r&&r.parent;){if(-1!=t.indexOf(r.parent.stageItem)){t.splice(n,1),n--;break}r=r.parent}}function s(e,t){if(e==t)return!0;if(e.children)for(var n=0;n<e.children.length;n++){if(s(e.children[n],t))return!0}return!1}for(var l=[],u=0;u<t.length;u++){var c=t[u];switch(c.constructor){case o.default:if(-1===l.indexOf(c)){var d=!0,f=c.node.connectedBones;if(f)for(var h=0;h<f.length;h++){for(var p=f[h],y=0;y<t.length;y++){var v=t[y],m=null;switch(v.constructor){case i.default:m=v.bone;break;case a.default:m=v.node}if(m&&s(m,p.node)){d=!1;break}}if(!d)break}d&&l.push(c)}break;default:-1===l.indexOf(c)&&l.push(c)}}return l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(18),a=(r=i)&&r.__esModule?r:{default:r};var s=new Map,l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._Actor=e,n._Root=null,n._RefID=t.ID++,n._Name="Node",n._IsKeyStateDirty=!1,n._Parent=null,n._TreeOrderFactor=1,n._StageItem=null,n.siblingIndex=0,n._Removed=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"updateGraph",value:function(){var e=this.root;return!!e&&e.updateGraph()}},{key:"isValidParent",value:function(e){for(var t=this.constructor,n=void 0;t&&!(n=s.get(t));)t=t.__proto__;return!n||n.has(e.constructor)}},{key:"clearKeyStates",value:function(){}},{key:"onRootChanged",value:function(e,t){e&&e.markDependenciesDirty(),t&&t.markDependenciesDirty()}},{key:"onRemovedFromActor",value:function(){this._Removed=!0}},{key:"onDelete",value:function(){}},{key:"onAddedToActor",value:function(){this._Removed=!1}},{key:"onRenamed",value:function(e,t){}},{key:"isChildOf",value:function(e){for(var t=this.parent;null!=t;){if(t==e)return!0;t=t.parent}return!1}},{key:"newRefId",value:function(){this._RefID=t.nextRefID}},{key:"markKeyStateDirty",value:function(){this._IsKeyStateDirty||(this._IsKeyStateDirty=!0,this._Root&&(this._Root._IsKeyStateDirty=!0))}},{key:"onSetStageItem",value:function(e){this._StageItem=e}},{key:"updateDependencies",value:function(e){}},{key:"setParent",value:function(e){var t=this._Parent;if(this._Parent=e,e!==t){var n=this.root;n&&n.markDependenciesDirty()}this.onParentChanged&&this.onParentChanged()}},{key:"read",value:function(e,n){var r=n.id;if(r){var o=e.getNode(r);o?console.warn("Node with refId",r,"already exists.",o,"Will keep new id.",o===this,this,n):this._RefID=r,this._RefID.constructor===Number&&t.ID<=this._RefID&&(t.ID=this._RefID+1)}(r=n.name)&&(this._Name=r)}},{key:"serializeProperties",value:function(e){var t={type:this.constructor.registeredActorName,id:this._RefID},n=this.serializeInteractive();for(var r in n){var o=n[r];null!=o&&(o.constructor===Float32Array?t[r]=Array.prototype.slice.call(o):t[r]=o)}return t}},{key:"serializeInteractive",value:function(){return{name:this._Name}}},{key:"serializeHistory",value:function(){return this.serializeInteractive()}},{key:"serialize",value:function(e){return this.serializeProperties(e)}},{key:"nullFrame",value:function(){return{}}},{key:"canKeyFrame",value:function(e){var t=this.nullFrame();return!!t&&null===t[e]}},{key:"root",get:function(){return this._Root},set:function(e){if(this._Root!==e){var t=this._Root;this._Root=e,this.onRootChanged(t,e)}}},{key:"isRemoved",get:function(){return this._Removed}},{key:"actor",get:function(){return this._Actor}},{key:"refId",get:function(){return this._RefID}},{key:"name",get:function(){return this._Name},set:function(e){this.onRenamed(this._Name,e),this._Name=e,this.dispatch("update")}},{key:"parent",get:function(){return this._Parent}},{key:"treeOrder",get:function(){return(this.siblingIndex+1)*this._TreeOrderFactor}},{key:"treeOrderFactor",get:function(){return this._TreeOrderFactor},set:function(e){this._TreeOrderFactor=e}},{key:"treeDepth",get:function(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e}},{key:"stageItem",get:function(){return this._StageItem},set:function(e){this.onSetStageItem(e)}}],[{key:"setValidParents",value:function(e,t){s.set(e,new Set(t))}},{key:"isRelationshipValid",value:function(e,t){if(!t)return!1;for(var n=t,r=void 0;n&&!(r=s.get(n));)n=n.__proto__;return!r||r.has(e)}},{key:"nextRefID",get:function(){return t.ID++}}]),t}();t.default=l,l.ID=982},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},s=n(7),l=g(n(275)),u=g(n(218)),c=g(n(513)),d=g(n(514)),f=g(n(173)),h=g(n(19)),p=g(n(2)),y=g(n(516)),v=g(n(638)),m=g(n(264));function g(e){return e&&e.__esModule?e:{default:e}}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var k=s.mat2d.create(),S=(b((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Path",n._IsClosed=!1,n._KeyStatePathVertices=0,n._RenderPath=null,n._RenderPathDirty=!0,n._InverseWorld=s.mat2d.create(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,(0,d.default)(f.default)),i(t,[{key:"updateStageItems",value:function(){var e=this.stageItem&&this.stageItem.stage;if(e&&e.appContext.isEditingPath(this.stageItem)){var t=this.children,n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.constructor===l.default&&s.stageItem.addToStage(e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}}},{key:"markDeformDirty",value:function(){this._Skin?this._Skin.markDeformDirty():this.markRenderPathDirty()}},{key:"markRenderPathDirty",value:function(){if(!this._RenderPathDirty){this._RenderPathDirty=!0;var e=this.parent;e&&e.markRenderPathDirty()}}},{key:"onChildrenChanged",value:function(){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildrenChanged",this).call(this),this.markDeformDirty();var e=this.stageItem&&this.stageItem.stage;e&&(e.appContext.isEditingPath(this.stageItem)&&(0,h.default)(this.updateStageItems))}},{key:"onReadComplete",value:function(){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onReadComplete",this).call(this),this.validateWeights(!0)}},{key:"onConnectedBoneChange",value:function(){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onConnectedBoneChange",this).call(this),this.validateWeights()}},{key:"dispatchWeightChange",value:function(){this.forceRedraw(),this.markDeformDirty(),this.dispatch("weightChange")}},{key:"onWeightsChanged",value:function(){this.dispatchWeightChange()}},{key:"willRemoveWeightedBoneIndex",value:function(e,t){var n=this.connectedBones,r=new Map,o=!0,i=!1,a=void 0;try{for(var s,u=this.children[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value;if(c.constructor===l.default){(k=c.stageItem).udpateControlPoints(!0);var d=k.controlIn,f=k.controlOut;k.updateTransform(),r.set(k,k.worldTranslation),d&&(d.updateTransform(),r.set(d,d.worldTranslation)),f&&(f.updateTransform(),r.set(f,f.worldTranslation))}}}catch(e){i=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw a}}var h=!0,p=!1,v=void 0;try{for(var m,g=this.children[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){var b=m.value;if(b.constructor===l.default){var k;d=(k=b.stageItem).controlIn,f=k.controlOut;y.default.setPointWeight(k.weightBuffer,k.weightBufferIndex,n,t,0),y.default.adjustIndexForRemovedBone(k.weightBuffer,k.weightBufferIndex,n,t),d&&(y.default.setPointWeight(d.weightBuffer,d.weightBufferIndex,n,t,0),y.default.adjustIndexForRemovedBone(d.weightBuffer,d.weightBufferIndex,n,t)),f&&(y.default.setPointWeight(f.weightBuffer,f.weightBufferIndex,n,t,0),y.default.adjustIndexForRemovedBone(f.weightBuffer,f.weightBufferIndex,n,t))}}}catch(e){p=!0,v=e}finally{try{!h&&g.return&&g.return()}finally{if(p)throw v}}this._OldWorldTranslation=r;var S=!0,O=!1,w=void 0;try{for(var _,P=this.children[Symbol.iterator]();!(S=(_=P.next()).done);S=!0){var C=_.value;C.constructor===l.default&&C.stageItem.udpateControlPoints()}}catch(e){O=!0,w=e}finally{try{!S&&P.return&&P.return()}finally{if(O)throw w}}}},{key:"didRemoveWeightedBoneIndex",value:function(e,t){this._Skin&&this._Skin.updateBoneArrays();var n=this._OldWorldTranslation;this._OldWorldTranslation=null;var r=!0,i=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value,c=o(u,2),d=c[0],f=c[1];d.worldTranslation=f}}catch(e){i=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw a}}this.onWeightsChanged()}},{key:"validateWeights",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.constructor===l.default&&a.validateWeightBuffer(e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"read",value:function(e,n){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),this._IsClosed=!!n.isClosed}},{key:"serializeProperties",value:function(e){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e)}},{key:"serializeInteractive",value:function(){var e=a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.isClosed=this._IsClosed,e}},{key:"onTransform",value:function(){var e=this.parent;e&&e.stageItem&&e.stageItem.onPathTransformed()}},{key:"onWorldTransform",value:function(){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onWorldTransform",this).call(this),s.mat2d.invert(this._InverseWorld,this._WorldTransform);var e=!0,n=!1,r=void 0;try{for(var o,i=this.children[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var u=o.value;u.constructor===l.default&&u.onPathWorldTransform()}}catch(e){n=!0,r=e}finally{try{!e&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"onPathChanged",value:function(){this.markDeformDirty(),this.parent.onPathChanged(this)}},{key:"nullFrame",value:function(){var e=a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.framePathVertices=null,e}},{key:"triggerAutoKeyPath",value:function(){this.useAnimationValues&&this.dispatch("animatePathVertices",this)}},{key:"getOBB",value:function(e){var n=Number.MAX_VALUE,r=Number.MAX_VALUE,o=-Number.MAX_VALUE,i=-Number.MAX_VALUE;function a(t){e&&(t=s.vec2.transformMat2d(s.vec2.create(),t,e)),t[0]<n&&(n=t[0]),t[1]<r&&(r=t[1]),t[0]>o&&(o=t[0]),t[1]>i&&(i=t[1])}var l=this.deformedPoints,d=this.isClosed,f=t.makeRenderPoints(l,d);if(f.length){var h=this.isClosed;a(f[0].translation);for(var p=0,y=h?f.length:f.length-1,v=f.length;p<y;p++){var m=f[p],g=f[(p+1)%v],b=g.pointType===u.default.Straight?null:g.in,k=m.pointType===u.default.Straight?null:m.out;if(null===b&&null===k)a(g.translation);else{null===k&&(k=m.translation),null===b&&(b=g.translation);var S=m.translation,O=g.translation,w=new c.default(S[0],S[1],k[0],k[1],b[0],b[1],O[0],O[1]).bbox();a([w.x.min,w.y.min]),a([w.x.max,w.y.max])}}}return[s.vec2.fromValues(n,r),s.vec2.fromValues(o,i)]}},{key:"updateDeform",value:function(){this.markRenderPathDirty()}},{key:"getPath",value:function(e){var n=this._RenderPathDirty,r=this._RenderPath;if(!n)return r;r?r.rewind():this._RenderPath=r=e.makePath(),this._RenderPathDirty=!1;var o=this.deformedPoints,i=this.isClosed;return m.default.pointPath(r,t.makeRenderPoints(o,i),i)}},{key:"getPathTransform",value:function(){return this.isConnectedToBones?this.root?(0,v.default)(this.root.renderTransform):(0,v.default)(k):(0,v.default)(this.renderTransform)}},{key:"getPathRenderTransform",value:function(){return this.isConnectedToBones?this.root?this.root.renderTransform:k:this.renderTransform}},{key:"typeName",get:function(){return"Path"}},{key:"uiHierIconClass",get:function(){return"HierarchyImageIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"uiIcon",get:function(){return"icon-picture"}},{key:"isClosed",get:function(){return this._IsClosed},set:function(e){this._IsClosed!==e&&(this._IsClosed=e,this.onPathChanged())}},{key:"inverseWorld",get:function(){return this._InverseWorld}},{key:"points",get:function(){return this.children.filter(function(e){return e.constructor===l.default})}},{key:"deformedPoints",get:function(){var e=null;this.isConnectedToBones&&(e=this.boneTransformsArray);var t=this.children,n=this.worldTransform,r=[],o=!0,i=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value;c.constructor===l.default&&(null!==e?r.push(c.skin(n,e)):r.push(c))}}catch(e){i=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw a}}return r}},{key:"framePathVertices",get:function(){var e=new Map,t=!0,n=!1,r=void 0;try{for(var o,i=this.children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.constructor===l.default&&e.set(a,a.frameDeform)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return e},set:function(e){this.markDeformDirty(),e.forEach(function(e,t){t.frameDeform=e}),this.useAnimationValues&&(this.forceRedraw(),this.parent.stageItem.onAnimated(),this.parent.dispatch("pathsAnimated"))}},{key:"framePathVerticesKS",get:function(){return this._KeyStatePathVertices},set:function(e){if(this._KeyStatePathVertices!=e){this._KeyStatePathVertices=e,this.markKeyStateDirty();var t=this.parent;t&&t.markKeyStateDirty()}}},{key:"rigPathVertices",get:function(){var e=new Map,t=!0,n=!1,r=void 0;try{for(var o,i=this.children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.constructor===l.default&&e.set(a,a.rigDeform)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return e}},{key:"renderPoints",get:function(){var e=this.deformedPoints,n=this.isClosed;return t.makeRenderPoints(e,n)}}],[{key:"makeRenderPoints",value:function(e,t){var n=[];if(e.length)for(var r=e.length,o=t?e[e.length-1]:null,i=0;i<e.length;i++){var a=e[i];switch(a.pointType){case u.default.Straight:var l=a.radius;if(l>0)if(t||0!==i&&i!==r-1){var c=e[(i+1)%r];o=o.pointType===u.default.Straight?o.translation:o.out,c=c.pointType===u.default.Straight?c.translation:c.in;var d=a.translation,f=s.vec2.subtract(s.vec2.create(),o,d),h=s.vec2.length(f);f[0]/=h,f[1]/=h;var p=s.vec2.subtract(s.vec2.create(),c,d),y=s.vec2.length(p);p[0]/=y,p[1]/=y;var v=Math.min(h,Math.min(y,l)),m=s.vec2.scaleAndAdd(s.vec2.create(),d,f,v),g={e:!0,o:a.o||a,n:o,pointType:u.default.Disconnected,translation:m,out:s.vec2.scaleAndAdd(s.vec2.create(),d,f,(1-.552284749831)*v),in:m};n.push(g),m=s.vec2.scaleAndAdd(s.vec2.create(),d,p,v),o={e:!0,o:a.o||a,n:c,pointType:u.default.Disconnected,translation:m,in:s.vec2.scaleAndAdd(s.vec2.create(),d,p,(1-.552284749831)*v),out:m},n.push(o)}else n.push(a),o=a;else n.push(a),o=a;break;case u.default.Mirror:case u.default.Disconnected:case u.default.Asymmetric:n.push(a),o=a}}return n}}]),t}()).prototype,"updateStageItems",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"updateStageItems"),r.prototype),b(r.prototype,"dispatchWeightChange",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"dispatchWeightChange"),r.prototype),r);t.default=S},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=f(n(173)),a=n(7),s=f(n(275)),l=f(n(225)),u=f(n(197)),c=f(n(638)),d=f(n(264));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Width=0,n._Height=0,n._AnimationWidth=0,n._AnimationHeight=0,n._KeyStateWidth=0,n._KeyStateHeight=0,n._RenderPath=null,n._RenderPathDirty=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"onUseAnimationValuesChange",value:function(e){e&&(this._AnimationWidth=this._Width,this._AnimationHeight=this._Height)}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),this._Width=Math.max(0,Number.parseFloat(n.width)||0),this._Height=Math.max(0,Number.parseFloat(n.height)||0)}},{key:"serializeProperties",value:function(e){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e)}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.width=this._Width,e.height=this._Height,e}},{key:"onTransform",value:function(){var e=this.parent;e&&e.stageItem&&e.stageItem.onPathTransformed()}},{key:"onWorldTransform",value:function(){this._InverseWorld=a.mat2d.invert(a.mat2d.create(),this._WorldTransform)}},{key:"nullFrame",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.frameWidth=null,e.frameHeight=null,e}},{key:"clearKeyStates",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearKeyStates",this).call(this),this.frameWidthKS=0,this.frameHeightKS=0}},{key:"markRenderPathDirty",value:function(){if(!this._RenderPathDirty){this._RenderPathDirty=!0;var e=this.parent;e&&e.markRenderPathDirty()}}},{key:"getPath",value:function(e){var t=this._RenderPathDirty,n=this._RenderPath;return t?(n?n.rewind():this._RenderPath=n=e.makePath(),this._RenderPathDirty=!1,d.default.pointPath(n,l.default.makeRenderPoints(this.getPathPoints(),!0),!0)):n}},{key:"getOBB",value:function(e){var t=Number.MAX_VALUE,n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=-Number.MAX_VALUE;function i(i){e&&(i=a.vec2.transformMat2d(a.vec2.create(),i,e)),i[0]<t&&(t=i[0]),i[1]<n&&(n=i[1]),i[0]>r&&(r=i[0]),i[1]>o&&(o=i[1])}var s=this.width/2,l=this.height/2;return i([-s,-l]),i([s,-l]),i([s,l]),i([-s,l]),[a.vec2.fromValues(t,n),a.vec2.fromValues(r,o)]}},{key:"getPathTransform",value:function(){return(0,c.default)(this.renderTransform)}},{key:"getPathRenderTransform",value:function(){return this.renderTransform}},{key:"getPathPoints",value:function(){return[]}},{key:"convertToPath",value:function(){var e=this.getPathPoints(),t=this.actor,n=this.stageItem.stage,r=this.parent,o=t.addNodeType(l.default,r,{name:this.name,translation:Array.prototype.slice.call(this.translation),rotation:this.rotation/Math.PI*180,scale:Array.prototype.slice.call(this.scale)});if(!o)return console.error("Wasn't able to make path."),null;o.stageItem.addToStage(n);var i=!0,a=!1,u=void 0;try{for(var c,d=e[Symbol.iterator]();!(i=(c=d.next()).done);i=!0){var f=c.value;f.pointType=f.pointType.id,t.addNodeType(s.default,o,f,!1)}}catch(e){a=!0,u=e}finally{try{!i&&d.return&&d.return()}finally{if(a)throw u}}return o.isClosed=!0,this.stageItem.removeFromStage(),r.remove(this),o}},{key:"isClosed",get:function(){return!0}},{key:"inverseWorld",get:function(){return this._InverseWorld}},{key:"points",get:function(){return this.children.filter(function(e){return e.constructor===s.default})}},{key:"frameWidthKS",get:function(){return this._KeyStateWidth},set:function(e){this._KeyStateWidth!=e&&(this._KeyStateWidth=e,this.markKeyStateDirty())}},{key:"frameHeightKS",get:function(){return this._KeyStateHeight},set:function(e){this._KeyStateHeight!=e&&(this._KeyStateHeight=e,this.markKeyStateDirty())}},{key:"rigWidth",get:function(){return this._Width}},{key:"frameWidth",get:function(){return this._AnimationWidth},set:function(e){this._AnimationWidth!=e&&(this._AnimationWidth=e,this.forceRedraw(),this.markRenderPathDirty(),this.parent.stageItem.onAnimated(),this.parent.onPathChanged(this))}},{key:"rigHeight",get:function(){return this._Height}},{key:"frameHeight",get:function(){return this._AnimationHeight},set:function(e){this._AnimationHeight!=e&&(this._AnimationHeight=e,this.forceRedraw(),this.markRenderPathDirty(),this.parent.stageItem.onAnimated(),this.parent.onPathChanged(this))}},{key:"width",get:function(){return this._UseAnimationValues?this._AnimationWidth:this._Width},set:function(e){if(this._UseAnimationValues){if(Math.abs(e-this._AnimationWidth)>i.default.EPSILON){var t=this.frameWidth;this.frameWidth=e,this.dispatch("animateWidth",{from:t,to:e}),this.dispatch("transformPropChange")}}else Math.abs(e-this._Width)>i.default.EPSILON&&(this._Width=e,this.parent.onPathChanged(this),this.dispatch("transformPropChange"),this.markRenderPathDirty())}},{key:"height",get:function(){return this._UseAnimationValues?this._AnimationHeight:this._Height},set:function(e){if(this._UseAnimationValues){if(Math.abs(e-this._AnimationHeight)>i.default.EPSILON){var t=this.frameHeight;this.frameHeight=e,this.dispatch("animateHeight",{from:t,to:e}),this.parent&&this.parent.dispatch("transformPropChange"),this.dispatch("transformPropChange")}}else Math.abs(e-this._Height)>i.default.EPSILON&&(this._Height=e,this.parent.onPathChanged(this),this.dispatch("transformPropChange"),this.markRenderPathDirty())}}],[{key:"promote",value:function(e,t,n){return e.addNodeType(u.default,t,{locked:n.locked})}},{key:"promoteType",get:function(){return u.default}}]),t}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Stage=t,this._Actor=n}return r(e,[{key:"end",value:function(){this._Stage.endOperation(this)}},{key:"start",value:function(){this._Stage.startOperation(this)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=v(n(505)),a=v(n(225)),s=v(n(228)),l=n(288),u=v(n(275)),c=v(n(2)),d=n(7),f=v(n(300)),h=v(n(19)),p=v(n(264)),y=v(n(644));function v(e){return e&&e.__esModule?e:{default:e}}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var g=null,b=[255,255,255,1],k=[0,139,255,1],S=(m((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._SelectionEnabledAnimatedPaths=[],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"onAddedToStage",value:function(e){this.node.addEventListener("worldTransform",this.onTransformed),this.renderTransform=this.node.renderTransform,this.updateBounds()}},{key:"triggerUpdate",value:function(){this.updateBounds()}},{key:"onPathChanged",value:function(e){var t=this.stage;t&&(t.isSelectionDisabled?this._PathsAnimated||(this._PathsAnimated=!0,this._SelectionEnabledAnimatedPaths.push(e),t.addEventListener("selectionEnabled",this.onSelectionReenabled)):e.stageItem&&(e.stageItem.onPathChanged(),(0,h.default)(this.triggerUpdate,null,12)))}},{key:"makeIcon",value:function(e){this.renderTransform=this.node.renderTransform,d.mat2d.invert(this._InverseRenderTransform,this._RenderTransform);var t=y.default.graphics,n=y.default.iconStroke,r=y.default.padding,o=y.default.iconWidth,i=y.default.iconHeight,a=t.skCanvas,s=this._InverseRenderTransform,l=d.mat2d.getScaling(d.vec2.create(),this.renderTransform),u=this.min,c=this.max,f=o-2*r,h=i-2*r,p=d.vec2.subtract(d.vec2.create(),c,u),v=d.vec2.divide(d.vec2.create(),[f,h],p),m=Math.min(v[0],v[1]),g=f/2-p[0]*m/2,b=h/2-p[1]*m/2;t.clear(),a.save(),a.translate(g+r,b+r),a.scale(m,m),a.translate(-u[0],-u[1]),t.transform(s);var k=this.stageContext._IconPaint,S=this.getShapePath(t);k.setStrokeWidth(1/(l[0]*m)*n),a.drawPath(S,k),a.restore(),t.flush(),t.canvas.toBlob(function(t){e(URL.createObjectURL(t))})}},{key:"onAnimated",value:function(){var e=this.stage;e&&(e.isSelectionDisabled?this._PathsAnimated||(this._PathsAnimated=!0,e.addEventListener("selectionEnabled",this.onSelectionReenabled)):this._PathsAnimated||(this._PathsAnimated=!0,(0,h.default)(this.triggerUpdate,null,12)))}},{key:"onSelectionReenabled",value:function(e){e.removeEventListener("selectionEnabled",this.onSelectionReenabled),this.updateBounds();var t=!0,n=!1,r=void 0;try{for(var o,i=this._SelectionEnabledAnimatedPaths[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.onPathChanged(a)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this._SelectionEnabledAnimatedPaths.length=0}},{key:"remakeIcon",value:function(){this._RemakeIcon=!0,this.dispatch("icon")}},{key:"updateBounds",value:function(){var e=this.stage;if(e)if(e.isSelectionDisabled)e.addEventListener("selectionEnabled",this.onSelectionReenabled);else{if(this._PathsAnimated){this._PathsAnimated=!1;var t=!0,n=!1,r=void 0;try{for(var o,i=this.node.children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var l=o.value;if(l.constructor===a.default||l instanceof s.default){l.stageItem.onPathChanged();var c=!0,d=!1,h=void 0;try{for(var p,y=l.children[Symbol.iterator]();!(c=(p=y.next()).done);c=!0){var v=p.value;if(v.constructor===u.default){var m=v.stageItem;m.stage&&(m.onTranslationChanged(),m.controlOut&&m.controlOut.onTranslationChanged(),m.controlIn&&m.controlIn.onTranslationChanged())}}}catch(e){d=!0,h=e}finally{try{!c&&y.return&&y.return()}finally{if(d)throw h}}}}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}this._Icon&&(clearTimeout(this._UpdateIconTimeout),this._UpdateIconTimeout=setTimeout(this.remakeIcon,1500));var g=this.node,b=null,k=!0,S=!1,O=void 0;try{for(var w,_=g.children[Symbol.iterator]();!(k=(w=_.next()).done);k=!0){var P=w.value;if(P.constructor===a.default||P instanceof s.default){var C=P.stageItem.getPathAABB();b?b.combine(C):(b=new f.default).set(C.min,C.max),P.isConnectedToBones}}}catch(e){S=!0,O=e}finally{try{!k&&_.return&&_.return()}finally{if(S)throw O}}b&&(b.boxHeight<10&&b.expandHeight(10),b.boxWidth<10&&b.expandWidth(10),this.setMinMax(b.min,b.max))}}},{key:"onRemovedFromStage",value:function(e){this.node.removeEventListener("worldTransform",this.onTransformed),e.removeEventListener("selectionEnabled",this.onSelectionReenabled),h.default.cancel(this.updateBounds)}},{key:"onPathTransformed",value:function(){(0,h.default)(this.updateBounds,null,200)}},{key:"computeTightAABB",value:function(e){if(e)return null;var t=null,n=this.node,r=!0,o=!1,i=void 0;try{for(var l,u=n.children[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var c=l.value;if(c.constructor===a.default||c instanceof s.default){c.updateWorldTransform();var d=c.stageItem.computeTightAABB();d&&(t?t.combine(d):t=d)}}}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return t}},{key:"onTransformed",value:function(){this.renderTransform=this.node.renderTransform}},{key:"isPointOver",value:function(e,t){var n=this.node,r=n.root;if(r&&r.clipContents&&!r.isPointInside(e,t))return!1;if(!this.aabb.isPointInside(e,t))return!1;this._TempOverPoint[0]=e,this._TempOverPoint[1]=t,d.vec2.transformMat2d(this._TempOverPoint,this._TempOverPoint,this._InverseRenderTransform);var o=this._TempOverPoint[0],i=this._TempOverPoint[1];if(!(o>=this._MinPoint[0]&&o<=this._MaxPoint[0]&&i>=this._MinPoint[1]&&i<=this._MaxPoint[1]))return!1;var u=this.stage;if(!u)return!1;var c=u.graphics,f=this.getShapePath(c,!0),h=n.children.find(function(e){switch(e.constructor){case l.GradientFill:case l.RadialGradientFill:case l.ColorFill:return!0;default:return!1}});if(p.default.setPathFillType(f,h&&h.fillRule),f.contains(e,t))return!0;var y=!0,v=!1,m=void 0;try{for(var g,b=n.children[Symbol.iterator]();!(y=(g=b.next()).done);y=!0){var k=g.value;if((k.constructor===a.default||k instanceof s.default)&&k.isVisible&&!k.isClosed)if(k.stageItem.getDistanceFrom([e,t])<10/u.scale*u.screenScale)return!0}}catch(e){v=!0,m=e}finally{try{!y&&b.return&&b.return()}finally{if(v)throw m}}return!1}},{key:"draw",value:function(e){var t=e.skCanvas;e.save(),this.clip(e);var n=this.getShapePath(e),r=[],o=[],i=!0,a=!1,s=void 0;try{for(var u,c=this.node.children[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value;switch(d.constructor){case l.RadialGradientFill:case l.GradientFill:case l.ColorFill:r.push(d);break;case l.ColorStroke:case l.GradientStroke:case l.RadialGradientStroke:o.push(d)}}}catch(e){a=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw s}}this.node.renderTransform;var f=!0,h=!1,p=void 0;try{for(var y,v=r[Symbol.iterator]();!(f=(y=v.next()).done);f=!0){y.value.fill(e,n)}}catch(e){h=!0,p=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw p}}var m=!0,g=!1,b=void 0;try{for(var k,S=o[Symbol.iterator]();!(m=(k=S.next()).done);m=!0){var O=k.value;O.width>0&&O.stroke(e,n)}}catch(e){g=!0,b=e}finally{try{!m&&S.return&&S.return()}finally{if(g)throw b}}if(e.restore(),this.showContour){var w=this.stageContext._StrokeContour;w.setStrokeWidth(1/this.stage.scale),t.drawPath(n,w)}}},{key:"drawSelection",value:function(e){var t=e.skCanvas,n=this.stage,r=this.isSelected;if(n){var o=this.getShapePath(e,!0),i=this.getShapePath(e),a=this.stageContext,s=a._SelectionStroke,u=a._SelectionFill;if(s.setColor(r?k:b),s.setStrokeWidth((n.selectionTarget==this?3:1.5)/n.scale),t.drawPath(i,s),!o.isEmpty()){var c=g.multiplyByAlpha(r?k:b,.2);u.setColor(c);var d=this.node.children.find(function(e){switch(e.constructor){case l.GradientFill:case l.RadialGradientFill:case l.ColorFill:return!0;default:return!1}});p.default.setPathFillType(o,d&&d.fillRule),t.drawPath(o,u)}}}},{key:"getShapePath",value:function(e,t){var n=this.node,r=e.makePath(!0),o=!0,i=!1,l=void 0;try{for(var u,c=n.children[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;(d.constructor===a.default||d instanceof s.default)&&d.isVisible&&(t&&!d.isClosed||r.addPath(d.getPath(e),d.getPathTransform()))}}catch(e){i=!0,l=e}finally{try{!o&&c.return&&c.return()}finally{if(i)throw l}}return r}},{key:"imgIconSrc",get:function(){if(!this._Icon||this._RemakeIcon){delete this._RemakeIcon;var e=this;this.makeIcon(function(t){var n=e._Icon;e._Icon=t,e.dispatch("icon"),n&&URL.revokeObjectURL(n)})}return this._Icon}},{key:"paths",get:function(){return this.node.children.filter(function(e){return e.constructor===a.default||e instanceof s.default})}}]),t}()).prototype,"triggerUpdate",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"triggerUpdate"),r.prototype),m(r.prototype,"onSelectionReenabled",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"onSelectionReenabled"),r.prototype),m(r.prototype,"remakeIcon",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"remakeIcon"),r.prototype),m(r.prototype,"updateBounds",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"updateBounds"),r.prototype),m(r.prototype,"onTransformed",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"onTransformed"),r.prototype),r);t.default=S,S.initializeStageContext=function(e,t){g=e.canvasKit,b=g.Color(b[0],b[1],b[2],b[3]),k=g.Color(k[0],k[1],k[2],k[3]);var n=new g.SkPaint;n.setAntiAlias(!0),n.setStyle(g.PaintStyle.Stroke),n.setStrokeWidth(1),n.setBlendMode(g.BlendMode.SrcOver),n.setColor(g.Color(0,0,0,1)),t._StrokeContour=n;var r=new g.SkPaint;r.setAntiAlias(!0),r.setStyle(g.PaintStyle.Stroke),r.setStrokeWidth(1),r.setBlendMode(g.BlendMode.SrcOver),r.setColor(g.Color(0,0,0,1)),t._SelectionStroke=n;var o=new g.SkPaint;o.setAntiAlias(!0),o.setStyle(g.PaintStyle.Fill),o.setBlendMode(g.BlendMode.SrcOver),o.setColor(g.Color(0,0,0,1)),t._SelectionFill=o;var i=new g.SkPaint;i.setAntiAlias(!0),i.setStyle(g.PaintStyle.Stroke),i.setStrokeWidth(1),i.setBlendMode(g.BlendMode.SrcOver),i.setColor(g.Color(255,255,255,1)),t._IconPaint=i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),a=u(n(2)),s=u(n(5)),l=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var d=(c((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={expanded:!0},n._Preferences=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setPanelGroupContent",value:function(e){this.panelGroupContent=e}},{key:"setPanelGroup",value:function(e){this.panelGroup=e}},{key:"collapseToggle",value:function(){this.h=this.panelGroupContent.getBoundingClientRect().height;var e=!this.state.expanded;if(this.panelGroup.style.height)clearTimeout(this.collapseTimeout),this.setState({expanded:e});else{this.panelGroup.style.height=this.h+"px";var t=this;clearTimeout(this.collapseTimeout),this.collapseTimeout=setTimeout(function(){t.setState({expanded:e})},1)}if(this.props._key){var n=this._Preferences;n[this.props._key]=e,this.context.nima.setCharacterPreference("selection_panel_groups",n)}}},{key:"updateHeight",value:function(){this.h=this.panelGroupContent.getBoundingClientRect().height,this.panelGroup.style.height=this.h+"px"}},{key:"componentDidUpdate",value:function(e,t){e!=this.props&&t.expanded&&this.updateHeight()}},{key:"componentWillMount",value:function(){this._Preferences=this.context.nima.getPreference("selection_panel_groups")||{};var e=this.props._key;if(e&&this._Preferences.hasOwnProperty(e)){var t=Boolean(this._Preferences[e]);this.setState({expanded:t})}}},{key:"componentDidMount",value:function(){this.state.expanded&&this.updateHeight()}},{key:"render",value:function(){return i.default.createElement("div",{className:"SelectionPanelGroup",ref:this.setPanelGroup,style:{height:this.state.expanded?this.h:11}},i.default.createElement("div",{ref:this.setPanelGroupContent,className:this.props.className},i.default.createElement("div",{className:"SelectionPanelGroupHeader"},i.default.createElement("div",{onMouseDown:this.collapseToggle,className:"HierarchyExpandBtn"},i.default.createElement("svg",{className:"ExpandArrow",style:{transform:this.state.expanded?null:"rotate(-90deg)",marginTop:this.state.expanded?"5px":null}},i.default.createElement("use",{xlinkHref:l.default.make("/images/symbol-defs.svg#icon-arrow")}))),i.default.createElement("div",{className:"GroupHeaderTxt"},this.props.label),this.props.action?this.props.action:null),this.props.children))}}]),t}()).prototype,"setPanelGroupContent",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setPanelGroupContent"),r.prototype),c(r.prototype,"setPanelGroup",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setPanelGroup"),r.prototype),c(r.prototype,"collapseToggle",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"collapseToggle"),r.prototype),r);t.default=d,d.contextTypes={nima:s.default.object}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(168)),a=d(n(2)),s=n(7),l=n(302),u=d(n(218)),c=d(n(19));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var h=null,p=[0,139,255,1],y=[255,0,0,1],v=null,m=(f((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isSelectable=!0,n.drawAfterSelections=!0,n._RadiusScale=1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"onWeightChanged",value:function(){(0,c.default)(this.updateTransform)}},{key:"onAddedToStage",value:function(e){this.path;this.setMinMax([-3,-3],[3,3]),this.udpateControlPoints(),this.updateTransform()}},{key:"onTranslationChanged",value:function(){this.stage&&this.updateTransform()}},{key:"onTypeChanged",value:function(){this.stage&&(this.udpateControlPoints(),this.updateTransform())}},{key:"updateTransform",value:function(){var e=this.path,t=this.getWorldTranslation(this.node.translation);this.renderTransform=s.mat2d.fromTranslation(s.mat2d.create(),e.root.renderTranslation(t)),this.stage&&this.stage.redraw()}},{key:"getWorldTranslation",value:function(e){var t=this.path;return t.isConnectedToBones?this.node.skinTranslation(t.worldTransform,t.boneTransformsArray,e,0):s.vec2.transformMat2d(s.vec2.create(),e,t.worldTransform)}},{key:"udpateControlPoints",value:function(e){var t=this.stage;!e&&!t||this.node.pointType===u.default.Straight?(this._ControlIn&&(this._ControlIn.removeFromStage(),this._ControlIn=null),this._ControlOut&&(this._ControlOut.removeFromStage(),this._ControlOut=null)):(this._ControlIn||(this._ControlIn=new l.StagePathControlIn(this.node),t&&this._ControlIn.addToStage(t)),this._ControlOut||(this._ControlOut=new l.StagePathControlOut(this.node),t&&this._ControlOut.addToStage(t)),this._ControlOut.sibling=this._ControlIn,this._ControlIn.sibling=this._ControlOut)}},{key:"onRemovedFromStage",value:function(e){this.udpateControlPoints()}},{key:"customHitDetectEarly",value:function(e,t){var n=this.renderTransform,r=e-n[4],o=t-n[5],i=this.stage.scale*this.stage.screenScale;return(r*r+o*o)*i*i<=100}},{key:"rectIntersects",value:function(e){var t=this.renderTransform;return t[4]>=e[0][0]&&t[4]<=e[2][0]&&t[5]>=e[0][1]&&t[5]<=e[2][1]}},{key:"onTransformed",value:function(){this._Stage&&(this.updateTransform(),this._ControlIn&&this._ControlIn.updateTransform(),this._ControlOut&&this._ControlOut.updateTransform())}},{key:"draw",value:function(e,n){t.drawVertex(e,this.stage,this._RadiusScale,n,this.isSelected,this.renderTransform)}},{key:"isAutomatic",get:function(){return!1}},{key:"radiusScale",get:function(){return this._RadiusScale},set:function(e){this._RadiusScale=e}},{key:"path",get:function(){return this.node.parent}},{key:"weightBuffer",get:function(){return this.node.weights}},{key:"weightBufferIndex",get:function(){return 0}},{key:"pointTranslation",get:function(){return this.node.translation},set:function(e){var t=this.path,n=this.node;if(t.isConnectedToBones){var r=this.node.getSkinTransform(t.boneTransformsArray),o=s.mat2d.invert(s.mat2d.create(),r);if(!o)return void console.warn("Unable to get inverse of skin transform");var i=s.vec2.transformMat2d(s.vec2.create(),e,o);if(!s.mat2d.invert(s.mat2d.create(),n.worldTransform))return void console.warn("Unable to get inverse of override world transform");n.translation=s.vec2.transformMat2d(i,i,o)}else this.node.translation=e}},{key:"controlIn",get:function(){return this._ControlIn}},{key:"controlOut",get:function(){return this._ControlOut}},{key:"worldTranslation",get:function(){return this.getWorldTranslation(this.node.translation)},set:function(e){var t=this.path,n=this.node;if(t.isConnectedToBones){var r=n.getSkinTransform(t.boneTransformsArray,0),o=s.mat2d.invert(s.mat2d.create(),r);if(!o)return void console.warn("Unable to get inverse of skin transform");var i=s.vec2.transformMat2d(s.vec2.create(),e,o);n.translation=s.vec2.transformMat2d(i,i,t.inverseWorld)}else n.translation=s.vec2.transformMat2d(s.vec2.create(),e,t.inverseWorld)}},{key:"renderTranslation",get:function(){var e=this.renderTransform;return s.vec2.fromValues(e[4],e[5])}}],[{key:"drawVertex",value:function(e,t,n,r,o,i){var a=e.skCanvas,l=v,u=l.whiteFill,c=l.hoverStroke,d=l.stroke,f=l.selectedStroke,h=l.selectedFill,p=l.path,y=l.emphasizedPath,m=l.shadeFill,g=l.shadePath,b=l.shadeEmphasizedPath;a.save();var k=1/t.scale*n;e.transform(i),e.transform(s.mat2d.fromScaling(s.mat2d.create(),[k,k]));var S=o||r;a.drawPath(S?b:g,m);var O=S?y:p;a.drawPath(O,u),o?(a.drawPath(O,h),a.drawPath(O,f)):a.drawPath(O,r?c:d),a.restore()}},{key:"StageContext",get:function(){return v}}]),t}()).prototype,"updateTransform",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateTransform"),r.prototype),f(r.prototype,"udpateControlPoints",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"udpateControlPoints"),r.prototype),f(r.prototype,"onTransformed",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onTransformed"),r.prototype),r);t.default=m,m.initializeStageContext=function(e,t,n){if(!h){v=t;var r=new(h=e.canvasKit).SkPaint;r.setAntiAlias(!0),r.setStyle(h.PaintStyle.Fill),r.setBlendMode(h.BlendMode.SrcOver),r.setColor(h.Color(255,255,255,1)),t.whiteFill=r;var o=new h.SkPaint;o.setAntiAlias(!0),o.setStyle(h.PaintStyle.Stroke),o.setStrokeWidth(1),o.setBlendMode(h.BlendMode.SrcOver),o.setColor(h.Color(0,0,0,1)),t.hoverStroke=o;var i=o.copy();i.setColor(h.Color(p[0],p[1],p[2],p[3])),t.selectedStroke=i;var a=o.copy();a.setColor(h.Color(y[0],y[1],y[2],y[3])),t.deleteStroke=a;var s=r.copy();s.setColor(h.Color(p[0],p[1],p[2],.3*p[3])),t.selectedFill=s;var l=o.copy();l.setColor(h.Color(70,70,70,1)),t.stroke=l;var u=o.copy();u.setColor(h.Color(200,200,200,1)),t.edgeStroke=u;var c=e.makePath();c.addArc(h.LTRBRect(-3,-3,3,3),0,360),c.close(),t.path=c;var d=e.makePath();d.addArc(h.LTRBRect(-4,-4,4,4),0,360),d.close(),t.emphasizedPath=d;var f=r.copy();f.setColor(h.Color(20,20,20,.3)),t.shadeFill=f;var m=e.makePath();m.addArc(h.LTRBRect(-2,-2,4,4),0,360),m.close(),t.shadePath=m;var g=e.makePath();g.addArc(h.LTRBRect(-3,-3,5,5),0,360),g.close(),t.shadeEmphasizedPath=g,n.setLayerRenderExtensions(6,{context:t,drawPrep:function(e,t,n){return u.setStrokeWidth(1/n.scale),e}})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(173),s=(r=a)&&r.__esModule?r:{default:r};var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Solo",n._ActiveChild=void 0,n._AnimationActiveChild=void 0,n._KeyStateActiveChild=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"onUseAnimationValuesChange",value:function(){this.updateActiveChild()}},{key:"updateActiveChild",value:function(){var e=this.activeChild,t=this.children,n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.isCollapsedVisibility=s!==e}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}},{key:"onChildrenChanged",value:function(){var e=this.activeChild,n=this.children;n.find(function(t){return t===e})||(this.activeChild=n.length?n[0]:null),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildrenChanged",this).call(this),this.updateActiveChild()}},{key:"onChildRemoved",value:function(e){e.isCollapsedVisibility=!1,i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildRemoved",this).call(this,e),this.children.length||(this.activeChild=null)}},{key:"read",value:function(e,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.activeChildIndex;if(void 0!==r){var o=parseInt(r)||0,a=this;e.whenNodesLoaded(function(){a.updateActiveChild(),a.activeChild=o>=0?a.children[o]:null})}}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.activeChild=this._ActiveChild,e}},{key:"serializeProperties",value:function(e){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);delete n.activeChild;var r=this.children.indexOf(this._ActiveChild);return-1!==r&&(n.activeChildIndex=r),n}},{key:"isSolo",value:function(){return!0}},{key:"nullFrame",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.frameActiveChild=null,e}},{key:"uiHierIconClass",get:function(){return"HierarchySoloIcon"}},{key:"uiIcon",get:function(){return"icon-solo"}},{key:"rigActiveChildIndex",get:function(){return this.children.indexOf(this._ActiveChild)+1}},{key:"frameActiveChildIndex",get:function(){return this.children.indexOf(this._AnimationActiveChild)+1},set:function(e){var t=this.children[e];this._AnimationActiveChild!==t&&(this._AnimationActiveChild=t,this.dispatch("activeChildChanged"),this.updateActiveChild())}},{key:"frameActiveChild",get:function(){return this._AnimationActiveChild},set:function(e){this._AnimationActiveChild!==e&&(this._AnimationActiveChild=e,this.dispatch("activeChildChanged"),this.updateActiveChild())}},{key:"rigActiveChild",get:function(){return this._ActiveChild}},{key:"frameActiveChildKS",get:function(){return this._KeyStateActiveChild},set:function(e){this._KeyStateActiveChild!=e&&(this._KeyStateActiveChild=e,this.markKeyStateDirty())}},{key:"activeChild",get:function(){return this._UseAnimationValues?this._AnimationActiveChild:this._ActiveChild},set:function(e){if(e&&e.parent!==this)console.log("SOLO ERROR: NOT A CHILD",this,e);else if(this._UseAnimationValues){var t=this._AnimationActiveChild;this._AnimationActiveChild=e,this.updateActiveChild(),this.dispatch("animateActiveChild",{from:t,to:this._AnimationActiveChild})}else this._ActiveChild=e,this.updateActiveChild(),this.dispatch("activeChildChanged")}},{key:"activeChildIndex",get:function(){return this._UseAnimationValues?this.children.indexOf(this._AnimationActiveChild):this.children.indexOf(this._ActiveChild)},set:function(e){if(e>this.children.length)console.log("ERROR: CHILD INDEX OUT OF BOUNDS",this,e);else{var t=this.children[e];this.activeChild=t}}},{key:"isNode",get:function(){return!0}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(1)),a=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var u=(l((r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"click",value:function(){this.props.disabled||this.props.onToggle&&this.props.onToggle(!this.props.isOn)}},{key:"setKey",value:function(e){e.stopPropagation(),this.props.onSetKey&&this.props.onSetKey(this.props.isOn)}},{key:"render",value:function(){var e,t=this.props,n=t.disabled,r=t.isAnimating;if(r)switch(this.props.keyState){case 0:e="SelectionPanelKey";break;case 1:e="SelectionPanelKeyChanged";break;case 2:e="SelectionPanelKeyed"}return i.default.createElement("div",{className:this.props.addClass?"SelectionPanelToggleField "+this.props.addClass:"SelectionPanelToggleField",onMouseDown:this.click,style:{opacity:n?.5:null}},i.default.createElement("div",{className:"SelectionPanelToggle",style:{right:r?"15px":null}},i.default.createElement("div",{className:"SelectionPanelToggleHandle"+(this.props.isOn?" SelectionPanelToggleHandleSelected":"")})),r?i.default.createElement("div",{className:e,onMouseDown:this.setKey},i.default.createElement("div",null)):null)}}]),t}()).prototype,"click",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"click"),r.prototype),l(r.prototype,"setKey",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setKey"),r.prototype),r);t.default=u},,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=v(n(168)),a=n(7),s=v(n(300)),l=v(n(264)),u=v(n(19)),c=v(n(2)),d=v(n(644)),f=v(n(17)),h=v(n(218)),p=v(n(265)),y=v(n(513));function v(e){return e&&e.__esModule?e:{default:e}}function m(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var g=null,b=void 0,k=void 0,S=void 0,O=void 0,w=void 0,_=void 0,P=(a.mat2d.create(),m((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isSelectable=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"updateHighlights",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateHighlights",this).call(this,e);var n=this.node.connectedBones;if(n){var r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value.node.stageItem;l&&e.highlight(l)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}}}},{key:"onAddedToStage",value:function(e){this.node.addEventListener("worldTransform",this.onTransformed),this.renderTransform=this.node.renderTransform}},{key:"onRemovedFromStage",value:function(e){u.default.cancel(this.triggerIconRebuild),this.node.removeEventListener("worldTransform",this.onTransformed)}},{key:"onSelectionReenabled",value:function(e){e.removeEventListener("selectionEnabled",this.onSelectionReenabled),(0,u.default)(this.triggerIconRebuild,null,500)}},{key:"onPathChanged",value:function(){clearTimeout(this._UpdateIconTimeout),this._UpdateIconTimeout=setTimeout(this.triggerIconRebuild,1500)}},{key:"onTransformed",value:function(){this.renderTransform=this.node.renderTransform}},{key:"triggerIconRebuild",value:function(){this.stage&&(this.stage.isSelectionDisabled?this.stage.addEventListener("selectionEnabled",this.onSelectionReenabled):this._Icon&&(this._RemakeIcon=!0,this.dispatch("icon")))}},{key:"computeTightAABB",value:function(){var e=this.node,t=this.stage;if(t&&t.graphics){var n=e.getPath(t.graphics).copy();e.isConnectedToBones||n.transform(l.default.getTransform(e.worldTransform));var r=n.computeTightBounds();return n.delete(),(new s.default).set(a.vec2.fromValues(r.fLeft,r.fTop),a.vec2.fromValues(r.fRight,r.fBottom))}for(var o=Number.MAX_VALUE,i=Number.MAX_VALUE,u=-Number.MAX_VALUE,c=-Number.MAX_VALUE,d=this.getPathOBB(),f=d[0],h=d[1],p=[a.vec2.fromValues(f[0],f[1]),a.vec2.fromValues(h[0],f[1]),a.vec2.fromValues(h[0],h[1]),a.vec2.fromValues(f[0],h[1])],y=e.isConnectedToBones?null:e.worldTransform,v=0;v<p.length;v++){var m=p[v],g=void 0;(g=y?a.vec2.transformMat2d(a.vec2.create(),m,y):m)[0]<o&&(o=g[0]),g[1]<i&&(i=g[1]),g[0]>u&&(u=g[0]),g[1]>c&&(c=g[1])}return(new s.default).set(a.vec2.fromValues(o,i),a.vec2.fromValues(u,c))}},{key:"makeIcon",value:function(e){var t=d.default.graphics,n=d.default.iconStroke,r=d.default.padding,o=d.default.iconWidth,i=d.default.iconHeight,s=t.skCanvas,l=this.node.getPathRenderTransform(),u=a.mat2d.invert(a.mat2d.create(),l);if(u){var c=a.mat2d.getScaling(a.vec2.create(),l),f=this.min,h=this.max;a.vec2.equals(f,h)&&this.getPathOBB();var p=o-2*r,y=i-2*r,v=a.vec2.subtract(a.vec2.create(),h,f),m=a.vec2.divide(a.vec2.create(),[p,y],v),g=Math.min(m[0],m[1]),b=p/2-v[0]*g/2,k=y/2-v[1]*g/2;t.clear(),t.save(),s.translate(b+r,k+r),s.scale(g,g),s.translate(-f[0],-f[1]),t.transform(u);var S=this.getPath(t),w=this.node.getPathTransform();w&&s.concat(w.concat([0,0,1])),O.setStrokeWidth(1/(c[0]*g)*n),s.drawPath(S,O),s.restore(),t.flush(),t.canvas.toBlob(function(t){e(URL.createObjectURL(t))})}}},{key:"getDistanceFrom",value:function(e){var t=this.node,n=Number.MAX_VALUE,r=this.makeRenderPoints();if(r.length)for(var o=t.isConnectedToBones,i=t.isClosed,s=t.root.localTranslation(e),l=o?s:a.vec2.transformMat2d(a.vec2.create(),s,t.inverseWorld),u=0,c=i?r.length:r.length-1,d=r.length;u<c;u++){var f=r[u],v=r[(u+1)%d],m=v.pointType===h.default.Straight?null:v.in,g=f.pointType===h.default.Straight?null:f.out;if(null===m&&null===g){var b=p.default.pointOnSegment(f.translation,v.translation,l[0],l[1]).point,k=a.vec2.distance(b,l);k<n&&(n=k)}else{null===g&&(g=f.translation),null===m&&(m=v.translation);var S=new y.default(f.translation[0],f.translation[1],g[0],g[1],m[0],m[1],v.translation[0],v.translation[1]).project({x:l[0],y:l[1]});S.d<n&&(n=S.d)}}return n}},{key:"makeRenderPoints",value:function(){return this.node.renderPoints}},{key:"getPath",value:function(e){return this.node.getPath(e)}},{key:"getPathOBB",value:function(e){var t=this.node.getOBB(e);return this.setMinMax(t[0],t[1]),t}},{key:"getPathAABB",value:function(){var e=this.node;if(this.stage&&this.stage.graphics){var t=e.getPath(this.stage.graphics),n=void 0;if(e.isConnectedToBones){var r=a.mat2d.invert(a.mat2d.create(),e.parent.worldTransform);if(r){var o=t.copy();o.transform(l.default.getTransform(r)),n=o.computeTightBounds(),o.delete()}}else n=t.computeTightBounds();var i=new s.default;return n&&i.set(a.vec2.fromValues(n.fLeft,n.fTop),a.vec2.fromValues(n.fRight,n.fBottom)),i}var u=Number.MAX_VALUE,c=Number.MAX_VALUE,d=-Number.MAX_VALUE,f=-Number.MAX_VALUE,h=this.getPathOBB(),p=h[0],y=h[1],v=[a.vec2.fromValues(p[0],p[1]),a.vec2.fromValues(y[0],p[1]),a.vec2.fromValues(y[0],y[1]),a.vec2.fromValues(p[0],y[1])],m=null;e.isConnectedToBones&&(m=a.mat2d.invert(a.mat2d.create(),e.parent.worldTransform));for(var g=e.transform,b=0;b<v.length;b++){var k=v[b],S=void 0;(S=m?a.vec2.transformMat2d(a.vec2.create(),k,m):a.vec2.transformMat2d(a.vec2.create(),k,g))[0]<u&&(u=S[0]),S[1]<c&&(c=S[1]),S[0]>d&&(d=S[0]),S[1]>f&&(f=S[1])}return(new s.default).set(a.vec2.fromValues(u,c),a.vec2.fromValues(d,f))}},{key:"render",value:function(e,t,n){var r=this.node,o=this.stage;if(o){var i=e.skCanvas,a=r.getPath(e);if(i.save(),e.transform(r.getPathRenderTransform()),n||t){var s=n?w:_;i.drawPath(a,s)}var l=n?S:t?b:k;l.setStrokeWidth((o.selectionTarget==this?3:1.5)/o.scale),i.drawPath(a,l),i.restore()}else f.default.warn("No stage in StagePath.render?")}},{key:"draw",value:function(e,t){t||this.isSelected||!this.showContour||this.render(e,!1,!1)}},{key:"drawSelection",value:function(e,t){this.render(e,t,this.isSelected)}},{key:"isSelectable",get:function(){return!1},set:function(e){}},{key:"imgIconSrc",get:function(){if(!this._Icon||this._RemakeIcon){delete this._RemakeIcon;var e=this;this.makeIcon(function(t){var n=e._Icon;e._Icon=t,e.dispatch("icon"),n&&URL.revokeObjectURL(n)})}return this._Icon}}]),t}()).prototype,"onSelectionReenabled",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"onSelectionReenabled"),r.prototype),m(r.prototype,"onTransformed",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"onTransformed"),r.prototype),m(r.prototype,"triggerIconRebuild",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"triggerIconRebuild"),r.prototype),r);t.default=P,P.initializeStageContext=function(e,t){g=e.canvasKit,(O=new g.SkPaint).setAntiAlias(!0),O.setStyle(g.PaintStyle.Stroke),O.setStrokeWidth(1),O.setBlendMode(g.BlendMode.SrcOver),O.setColor(g.Color(255,255,255,1)),(b=O.copy()).setColor(g.Color(255,255,255,1)),(S=O.copy()).setColor(g.Color(0,139,255,1)),(k=O.copy()).setColor(g.Color(0,0,0,1)),(_=new g.SkPaint).setAntiAlias(!1),_.setStyle(g.PaintStyle.Fill),_.setBlendMode(g.BlendMode.SrcOver),_.setColor(g.Color(255,255,255,.2)),(w=_.copy()).setColor(g.Color(0,139,255,.2))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(7),a=n(168),s=(r=a)&&r.__esModule?r:{default:r};var l=[198,198,198,.5],u=[0,139,255,.8],c=[198,198,198,1],d=[255,185,0,1],f=null,h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._VertexBuffer=null,n._IndexBuffer=null,n._IsConnected=!1,n._HasCustomFillColor=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"onAddedToStage",value:function(){this.setMesh(this.stageContext.points,2,this.stageContext.indices)}},{key:"render",value:function(e,t,n,r){var o=i.mat2d.create();o[0]=(this.node.length-10)/p,o[4]=5,this.renderTransform=i.mat2d.multiply(o,this.node.renderTransform,o);var a=this.stageContext,s=this.renderTransform,l=this._IsConnected,u=this.node,c=l?a.fillConnected:a.fill;n?c=a.fillSelected:t?c=a.fillHover:this._FillColor&&(c=a.fillOverride).setColor(this._FillColor);var d=e.skCanvas;d.save(),r&&u.root&&u.root.clip(e),e.transform(s),d.drawPath(a.path,c),d.restore()}},{key:"draw",value:function(e,t,n){n||t||this.render(e,t,n,!0)}},{key:"drawSelection",value:function(e,t){this.render(e,t,this.isSelected,!1)}},{key:"updateConnectionState",value:function(){var e=this.node&&this.node.skins;if(e){for(var t=0;t<e.length;t++)if(e[t].stageItem.isSelected)return void(this.isConnected=!0);this.isConnected=!1}else this.isConnected=!1}},{key:"isConnected",get:function(){return this._IsConnected},set:function(e){this._IsConnected!=e&&(this._IsConnected=e,this.stage&&this.stage.redraw())}},{key:"fillColor",get:function(){return this._FillColor},set:function(e){e?(this._FillColor=f.Color(e[0],e[1],e[2],1),this._CssFillColor="rgba("+e.join(",")+", 1.0)"):this._FillColor=null}},{key:"cssFillColor",get:function(){return this._CssFillColor}}]),t}();t.default=h;var p=5;h.initializeStageContext=function(e,t){f=e.canvasKit;var n=[0,-p/2,p,-p/2,p,p/2,0,p/2];t.points=n,t.indices=[0,1,2,2,3,0],t.path=e.linePath(n,!0,!1);var r=new f.SkPaint;r.setAntiAlias(!0),r.setStyle(f.PaintStyle.Fill),r.setBlendMode(f.BlendMode.SrcOver),r.setColor(f.Color(d[0],d[1],d[2],d[3])),t.fillConnected=r;var o=r.copy();o.setColor(f.Color(l[0],l[1],l[2],l[3])),t.fill=o;var i=r.copy();i.setColor(f.Color(c[0],c[1],c[2],c[3])),t.fillHover=i;var a=r.copy();a.setColor(f.Color(u[0],u[1],u[2],u[3])),t.fillSelected=a;var s=r.copy();t.fillOverride=s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=T(n(652)),s=T(n(641)),l=T(n(2)),u=T(n(289)),c=T(n(375)),d=T(n(337)),f=T(n(197)),h=T(n(225)),p=T(n(275)),y=T(n(173)),v=T(n(198)),m=T(n(237)),g=T(n(303)),b=T(n(203)),k=T(n(662)),S=T(n(663)),O=T(n(332)),w=T(n(328)),_=T(n(19)),P=T(n(228)),C=T(n(335)),E=T(n(336));function T(e){return e&&e.__esModule?e:{default:e}}function I(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var j=(I((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n._Root=e,n._Order=0,n._ListeningActor=null,n._Editor=null,n._AutoKey=!1,n._IsUndoOrRedo=!1,n._IsPlaying=!1,n._Position=0,n._Duration=10,n._OldDuration=10,n._DisplayStart=0,n._DisplayEnd=10,n._WorkAreaStart=0,n._WorkAreaEnd=10,n._IsWorkAreaActive=!1,n._Loop=!1,n._FPS=60,n._OldFPS=60,n._PositionDirty=!1,n._Items=[],n._ItemToKeyFrames={},n._ID=t.ID++,n._IsEditingCurves=!1,n._ShowSelectionOnly=!1,n._Journal=[],n._JournalIndex=-1,n._LastFullState=null,n._Changes=new Map,n._KeyFramePropertyChanges=new Map,n._KeyFrameSortPropertyChanges=new Map,n._AddedKeyframes=[],n._RemovedKeyframes=[],n._KeyedNodes=[],n._ActualKeyedNodes=[],n._EditableKeyedNodes=[],n._KeyedNodeLookup=new Map,n._HiddenKeyedNodeLookup=new Map,n._OrderKeyState=0,n._UpdateNodesTimeout,n._SelectedItems=[],n._IsStable=!1,n._UIMasterKeyFrameGroups=new Map,n._IsVisible=!1;var r=n;return n.onAnimatePosX=function(e){r.change(this,"framePosX",e.to)},n.onAnimatePosY=function(e){r.change(this,"framePosY",e.to)},n.onAnimateScaleX=function(e){r.change(this,"frameScaleX",e.to)},n.onAnimateScaleY=function(e){r.change(this,"frameScaleY",e.to)},n.onAnimateRotation=function(e){r.change(this,"frameRotation",e.to)},n.onAnimateOpacity=function(e){r.change(this,"frameOpacity",e.to)},n.onAnimateSequence=function(e){r.change(this,"frameSequence",e.to)},n.onAnimateDrawOrder=function(e){r.change(this,"frameDrawOrder",e.to)},n.onAnimatePathVertices=function(e){r.change(this,"framePathVertices",e.framePathVertices)},n.onAnimateImageVertices=function(e){r.change(this,"frameImageVertices",e.frameImageVertices)},n.onAnimateFillColor=function(e){r.change(this,"frameFillColor",e.frameFillColor)},n.onAnimateFillGradient=function(e){r.change(this,"frameFillGradient",e.frameFillGradient)},n.onAnimateFillRadial=function(e){r.change(this,"frameFillRadial",e.frameFillRadial)},n.onAnimateStrokeColor=function(e){r.change(this,"frameStrokeColor",e.frameStrokeColor)},n.onAnimateStrokeGradient=function(e){r.change(this,"frameStrokeGradient",e.frameStrokeGradient)},n.onAnimateStrokeRadial=function(e){r.change(this,"frameStrokeRadial",e.frameStrokeRadial)},n.onAnimateStrokeWidth=function(e){r.change(this,"frameStrokeWidth",e.frameStrokeWidth)},n.onAnimateStrokeStart=function(e){r.change(this,"frameStrokeStart",e.frameStrokeStart)},n.onAnimateStrokeEnd=function(e){r.change(this,"frameStrokeEnd",e.frameStrokeEnd)},n.onAnimateStrokeOffset=function(e){r.change(this,"frameStrokeOffset",e.frameStrokeOffset)},n.onAnimateStrokeOpacity=function(e){r.change(this,"frameStrokeOpacity",e.frameStrokeOpacity)},n.onAnimateFillOpacity=function(e){r.change(this,"frameFillOpacity",e.frameFillOpacity)},n.onAnimateCornerRadius=function(e){r.change(this,"frameCornerRadius",e.to)},n.onAnimateInnerRadius=function(e){r.change(this,"frameInnerRadius",e.to)},n.onAnimateWidth=function(e){r.change(this,"frameWidth",e.to)},n.onAnimateHeight=function(e){r.change(this,"frameHeight",e.to)},n.onAnimateLength=function(e){r.change(this,"frameLength",e.to)},n.onAnimateStrength=function(e){r.change(this,"frameStrength",e.to)},n.onAnimateIntValue=function(e){r.change(this,"frameIntValue",e.to)},n.onAnimateFloatValue=function(e){r.change(this,"frameFloatValue",e.to)},n.onAnimateStringValue=function(e){r.change(this,"frameStringValue",e.to)},n.onAnimateBooleanValue=function(e){r.change(this,"frameBooleanValue",e.to)},n.onAnimateIsCollisionEnabled=function(e){r.change(this,"frameIsCollisionEnabled",e.to)},n.onAnimateActiveChild=function(e){r.change(this,"frameActiveChild",e.to)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),i(t,[{key:"uiHierIconClass",get:function(){return this.isPlaying?"HierarchyPauseIcon":"HierarchyPlayIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionAnimationIcon"}},{key:"uiIcon",get:function(){return"icon-"+(this.isPlaying?"pause":"play")+"-small"}},{key:"selectionIcon",get:function(){return"icon-animations"}},{key:"typeName",get:function(){return"Animation"}}]),i(t,[{key:"assignID",value:function(){this._ID=t.ID++}},{key:"clearSelection",value:function(e){this.selectItem(null,!1,e)}},{key:"selectItem",value:function(e,t,n){var r=!1;if(!t){for(var o=0;o<this._SelectedItems.length;o++)this._SelectedItems[o].isSelected=!1;this._SelectedItems.length=0,r=!0}if(e)if(e.constructor===Array)for(var i=0;i<e.length;i++){var a=e[i];a.isSelected||(a.isSelected=!0,this._SelectedItems.push(a),r=!0)}else e.isSelected||(e.isSelected=!0,this._SelectedItems.push(e),r=!0);r&&!n&&this.dispatch("itemSelected")}},{key:"doUpdateNodes",value:function(e){this._ActualKeyedNodes.length=0;for(var t=0;t<this._KeyedNodes.length;t++){var n=this._KeyedNodes[t];(e||!n.node.stageItem||n.node.stageItem.stage)&&this._ActualKeyedNodes.push(n)}this._ActualKeyedNodes.sort(function(e,t){return e.node.treeIndex-t.node.treeIndex}),this.updateEditableKeyedNodes(),this.dispatch("nodesUpdate",this._ActualKeyedNodes),this.dispatch("update"),this._IsStable=!0,this._PositionDirty=!0}},{key:"updateEditableKeyedNodes",value:function(){var e=!0,n=!1,r=void 0;try{for(var i,s=this._UIMasterKeyFrameGroups[Symbol.iterator]();!(e=(i=s.next()).done);e=!0){var l=i.value,c=o(l,2);c[0];c[1].clear()}}catch(e){n=!0,r=e}finally{try{!e&&s.return&&s.return()}finally{if(n)throw r}}this._EditableKeyedNodes.length=0;for(var d=0;d<this._ActualKeyedNodes.length;d++){var f=this._ActualKeyedNodes[d],h=f.node,p=!this._ShowSelectionOnly;if(this._ShowSelectionOnly&&(h.stageItem?p=h.stageItem.isSelected:h===t.OrderObject&&(p=!0)),!h.stageItem||h.isVisible||h.stageItem.isFake||(p=!1),p)if(h.constructor===u.default){var y=this._UIMasterKeyFrameGroups.get(h.parent);y||(y=new a.default(h.parent,this),this._UIMasterKeyFrameGroups.set(h.parent,y)),y.addGroup(f),-1===this._EditableKeyedNodes.indexOf(y)&&this._EditableKeyedNodes.push(y)}else{var v=this._UIMasterKeyFrameGroups.get(h);v||(v=new a.default(h,this),this._UIMasterKeyFrameGroups.set(h,v)),v.addGroup(f),-1===this._EditableKeyedNodes.indexOf(v)&&this._EditableKeyedNodes.push(v)}}this.dispatchUpdateEditableRows()}},{key:"doDispatchUpdateEditableRows",value:function(){this.dispatch("updateEditableRows")}},{key:"dispatchUpdateEditableRows",value:function(){(0,_.default)(this.doDispatchUpdateEditableRows)}},{key:"updateNodes",value:function(){this._IsStable=!1,clearTimeout(this._UpdateNodesTimeout),this._UpdateNodesTimeout=setTimeout(this.doUpdateNodes,1)}},{key:"deleteSelection",value:function(){this.dispatch("delete"),this._Editor.captureJournalEntry(),this.updateFrameValues()}},{key:"onKeyFrameDeleted",value:function(e){this._RemovedKeyframes.push(e)}},{key:"onKeyFrameAdded",value:function(e){this._AddedKeyframes.push(e)}},{key:"onKeyFramePropChanged",value:function(e,t,n,r,o){if(!this._IsUndoOrRedo){var i=o?this._KeyFrameSortPropertyChanges:this._KeyFramePropertyChanges,a=i.get(e);a||(a={},i.set(e,a)),(i=a[t])||(a[t]=i={from:n}),i.to=r,this._PositionDirty=!0}}},{key:"showKeyedNode",value:function(e){this._HiddenKeyedNodeLookup.get(e.node)&&(this._HiddenKeyedNodeLookup.delete(e.node),this._KeyedNodeLookup.set(e.node,e),this._KeyedNodes.push(e),this.updateNodes())}},{key:"hideKeyedNode",value:function(e){this._HiddenKeyedNodeLookup.set(e.node,e);var t=this._KeyedNodes.indexOf(e);-1!=t&&(this._KeyedNodes.splice(t,1),this._KeyedNodeLookup.delete(e.node),this.doUpdateNodes())}},{key:"getKeyedNode",value:function(e){return this._KeyedNodeLookup.get(e)}},{key:"triggerEvents",value:function(e,t){for(var n=0;n<this._ActualKeyedNodes.length;n++){var r=this._ActualKeyedNodes[n];r.node.constructor===d.default&&r.triggerEvents(e,t)}}},{key:"interpolate",value:function(e){for(var t=0;t<this._ActualKeyedNodes.length;t++){this._ActualKeyedNodes[t].interpolate(e)}}},{key:"getOrMakeKeyedNode",value:function(e){var t=this._KeyedNodeLookup.get(e);return t||(t=this._HiddenKeyedNodeLookup.get(e))&&(this._HiddenKeyedNodeLookup.delete(e),this._KeyedNodeLookup.set(e,t),this._KeyedNodes.push(t),this.updateNodes()),t||(t=new k.default(e,this),this._KeyedNodeLookup.set(e,t),this._KeyedNodes.push(t),this.updateNodes()),t}},{key:"toggleKey",value:function(e,t){var n=this.getKeyedNode(e);if(n&&n.getKeyFrames(t).removeKey())return this.updateFrameValues(),!1;this.setKey(e,t)}},{key:"setKey",value:function(e,t){this.getOrMakeKeyedNode(e).getKeyFrames(t).setKey(),this._Changes.delete(e)}},{key:"setOrderKey",value:function(){var e=this._Root.drawOrder,n=this.getOrMakeKeyedNode(t.OrderObject).getKeyFrames("frameDrawOrder"),r=n.getValue(this._Position);r||(r={});var o=!0,i=!1,a=void 0;try{for(var s,l=e.drawables[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value;r[u.refId]={obj:u,v:u.frameDrawOrder}}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}n.updateValue(this._Position,r),this.orderKeyState=2}},{key:"change",value:function(e,t,n,r){var o=this._AutoKey,i=this._Position;if(void 0!==r&&(i=r,o=!0),null!==n){if(!o||this._IsUndoOrRedo){var a=this._Changes.get(e);a||(a={obj:e,delta:{}},this._Changes.set(e,a)),a.delta[t]=n,e[t+"KS"]=1,"frameDrawOrder"==t&&(this.orderKeyState=1)}var s=null;if(!this._IsUndoOrRedo&&o){if("frameDrawOrder"==t)(0,_.default)(this.setOrderKey);else s=this.getOrMakeKeyedNode(e).getKeyFrames(t).updateValue(i,n);e[t+"KS"]=2}return this.dispatch("keyedPropertyChange"),s}}},{key:"captureJournalEntry",value:function(e){var t=new Map,n=this;this.root.eachChildRecursive(function(e){switch(e.constructor){case p.default:return}var r=e.nullFrame(),o=n._Changes.get(e);if(o&&o.delta)for(var i in o=o.delta,r)o&&void 0!==o[i]&&(r[i]=o[i]);t.set(e,r)});var r=!1;if(this._LastFullState){var i=!0,a=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value,d=o(c,2),f=d[0],h=d[1],y=this._LastFullState.get(f);if(y){for(var v in h){if(h[v]!==y[v]){r=!0;break}}if(r)break}}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}if((r||this._AddedKeyframes.length>0||this._RemovedKeyframes.length>0||this._KeyFramePropertyChanges.size>0||this._KeyFrameSortPropertyChanges.size>0||this._OldFPS!=this._FPS||this._OldDuration!=this._Duration)&&this._LastFullState&&!e){var m={time:this._Position,lastState:this._LastFullState,currentState:t,keyFrameSortPropertyChanges:this._KeyFrameSortPropertyChanges,keyFramePropertyChanges:this._KeyFramePropertyChanges,addedKeyframes:this._AddedKeyframes.slice(0),removedKeyframes:this._RemovedKeyframes.slice(0),fps:{from:this._OldFPS,to:this._FPS},duration:{from:this._OldDuration,to:this._Duration}};return this._KeyFramePropertyChanges=new Map,this._KeyFrameSortPropertyChanges=new Map,this._AddedKeyframes.length=0,this._RemovedKeyframes.length=0,this._OldFPS=this._FPS,this._OldDuration=this._Duration,m}return this._LastFullState=t,null}},{key:"updateOrderKeyState",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this._Changes[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value,s=o(a,2);s[0];if(void 0!==s[1].delta.frameDrawOrder)return void(this.orderKeyState=1)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}2!=this.orderKeyState&&(this.orderKeyState=0)}},{key:"applyEntry",value:function(e,t){this._IsUndoOrRedo=!0;var n=[];if(e.keyFrameSortPropertyChanges){var r=!0,i=!1,a=void 0;try{for(var s,l=e.keyFrameSortPropertyChanges[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value,c=o(u,2),d=c[0],f=c[1];for(var h in f){var p=f[h];d["_"+h]=t?p.from:p.to}-1===n.indexOf(d.row)&&n.push(d.row),d.dispatch("propChange"),d.prv&&(d.prv._Dirty=!0),d.nxt&&(d.nxt._Dirty=!0),d._Dirty=!0}}catch(e){i=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw a}}}for(var y=t?e.removedKeyframes:e.addedKeyframes,v=t?e.addedKeyframes:e.removedKeyframes,m=0;m<v.length;m++){var g=v[m];g.row.remove(g)}for(var b=0;b<y.length;b++){var k=y[b];k.row.add(k),-1===n.indexOf(k.row)&&n.push(k.row)}for(var S=0;S<n.length;S++)n[S].reSort();if(e.keyFramePropertyChanges){var O=!0,w=!1,_=void 0;try{for(var P,C=e.keyFramePropertyChanges[Symbol.iterator]();!(O=(P=C.next()).done);O=!0){var E=P.value,T=o(E,2),I=T[0],j=T[1];for(var A in j){var D=j[A];I["_"+A]=t?D.from:D.to}I.dispatch("propChange"),I.prv&&(I.prv._Dirty=!0),I.nxt&&(I.nxt._Dirty=!0),I._Dirty=!0}}catch(e){w=!0,_=e}finally{try{!O&&C.return&&C.return()}finally{if(w)throw _}}}this._Position=e.time,this._PositionDirty=!0;var R=t?e.fps.from:e.fps.to;R!=this._FPS&&(this._FPS=R,this.dispatch("fpsChange"));var M=t?e.duration.from:e.duration.to;if(M!=this._OldDuration&&(this._Duration=M,this.dispatch("durationChange")),this.updateFrameValues(),e.currentState){this._Changes=new Map;var x=!0,F=!1,L=void 0;try{for(var N,z=e.currentState[Symbol.iterator]();!(x=(N=z.next()).done);x=!0){var V=N.value,B=o(V,2),H=B[0],W=B[1];for(var K in W){if(null!==W[K]){var G=W[K];H[K]=G,this.change(H,K,G)}else this.change(H,K,null)}}}catch(e){F=!0,L=e}finally{try{!x&&z.return&&z.return()}finally{if(F)throw L}}}this._IsUndoOrRedo=!1,this.dispatch("position",this._Position),this.dispatch("update"),this.updateOrderKeyState()}},{key:"activateListeners",value:function(e,t){var n=this;this._Root.eachChildRecursive(function(e){e.clearKeyStates();var r=t?e.addEventListener:e.removeEventListener,o=e instanceof y.default,i=o,a=!1,s=!1,l=!1,p=!1,k=o,S=o,_=o,T=!1,I=!1,j=!1,A=!1,D=!1,R=e instanceof P.default;switch(e instanceof w.default&&(k=!1,i=!1,_=!1,p=!0),e.constructor){case h.default:j=!0;break;case f.default:s=!0,A=!0;break;case m.default:D=!0;break;case c.default:k=!1,i=!1,_=!1;break;case u.default:k=!1,i=!1,T=!0,_=!1;break;case d.default:k=!1,i=!1,_=!1;break;case g.default:k=!0,S=!1,i=!1;break;case v.default:a=!0,e.parent.constructor===v.default&&(i=!1);break;case b.default:s=!0,l=!0,I=e.asset instanceof O.default}k&&(i&&(r.call(e,"animatePosX",n.onAnimatePosX),r.call(e,"animatePosY",n.onAnimatePosY)),S&&(r.call(e,"animateScaleX",n.onAnimateScaleX),r.call(e,"animateScaleY",n.onAnimateScaleY),r.call(e,"animateRotation",n.onAnimateRotation)),t&&(e.framePosX=e.translation[0],e.framePosY=e.translation[1],e.frameScaleX=e.scale[0],e.frameScaleY=e.scale[1],e.frameRotation=e.rotation)),_&&r.call(e,"animateOpacity",n.onAnimateOpacity),D&&r.call(e,"animateActiveChild",n.onAnimateActiveChild),I&&r.call(e,"animateSequence",n.onAnimateSequence),t&&_&&(e.frameOpacity=e.opacity),t&&I&&(e.frameSequence=e.sequence),s&&(r.call(e,"animateDrawOrder",n.onAnimateDrawOrder),t&&(e.frameDrawOrder=e.drawOrder)),l&&r.call(e,"animateImageVertices",n.onAnimateImageVertices),j&&r.call(e,"animatePathVertices",n.onAnimatePathVertices),A&&(r.call(e,"animateFillColor",n.onAnimateFillColor),r.call(e,"animateFillGradient",n.onAnimateFillGradient),r.call(e,"animateFillRadial",n.onAnimateFillRadial),r.call(e,"animateStrokeColor",n.onAnimateStrokeColor),r.call(e,"animateStrokeGradient",n.onAnimateStrokeGradient),r.call(e,"animateStrokeRadial",n.onAnimateStrokeRadial),r.call(e,"animateStrokeWidth",n.onAnimateStrokeWidth),r.call(e,"animateStrokeOpacity",n.onAnimateStrokeOpacity),r.call(e,"animateFillOpacity",n.onAnimateFillOpacity),r.call(e,"animateStrokeStart",n.onAnimateStrokeStart),r.call(e,"animateStrokeEnd",n.onAnimateStrokeEnd),r.call(e,"animateStrokeOffset",n.onAnimateStrokeOffset)),e instanceof C.default&&r.call(e,"animateCornerRadius",n.onAnimateCornerRadius),e instanceof E.default&&r.call(e,"animateInnerRadius",n.onAnimateInnerRadius),R&&(r.call(e,"animateWidth",n.onAnimateWidth),r.call(e,"animateHeight",n.onAnimateHeight)),a&&(r.call(e,"animateLength",n.onAnimateLength),t&&(e.frameLength=e.length)),p&&(r.call(e,"animateStrength",n.onAnimateStrength),t&&(e.frameStrength=e.strength)),T&&(r.call(e,"animateIntValue",n.onAnimateIntValue),r.call(e,"animateFloatValue",n.onAnimateFloatValue),r.call(e,"animateStringValue",n.onAnimateStringValue),r.call(e,"animateBooleanValue",n.onAnimateBooleanValue),t&&(e.frameIntValue=e.intValue,e.frameFloatValue=e.floatValue,e.frameStringValue=e.stringValue,e.frameBooleanValue=e.booleanValue))})}},{key:"updateFrameValues",value:function(){this._Root&&(this._Root.stopAnimations(),this._Root.updateAnimations([{animation:this,mix:1,position:this._Position}]))}},{key:"advance",value:function(e,t){var n=!1;if(this._IsPlaying){var r=this._Position;this._Position+=e;var o=this._Duration;if(this._IsWorkAreaActive&&(o=this._WorkAreaEnd),this._Position>=o)if(this._Loop||t){var i=this._Position-o;this._Position=i+(this._IsWorkAreaActive?this._WorkAreaStart:0),this.triggerEvents(r,o),this.triggerEvents((this._IsWorkAreaActive?this._WorkAreaStart:0)-.001,this._Position)}else this._Position=o,this.isPlaying=!1,this._PositionDirty=!1,n=!0,this.triggerEvents(r,this._Position);else this.triggerEvents(r,this._Position)}var a=this._IsPlaying||this._PositionDirty;return(this._IsPlaying||this._PositionDirty)&&(this._PositionDirty=!1,n=!0),n&&this.dispatch("position",this._Position),a}},{key:"showPlayhead",value:function(){if(this._Position<this._DisplayStart){var e=this._Position-this._DisplayStart;this._DisplayStart+=e,this._DisplayEnd+=e,this.dispatch("update"),this.dispatch("scrollChange")}else if(this._Position>this._DisplayEnd){var t=this._Position-this._DisplayEnd;this._DisplayStart+=t,this._DisplayEnd+=t,this.dispatch("update"),this.dispatch("scrollChange")}}},{key:"moveSelectedFrames",value:function(e){var t=this,n=this.fps,r=this.duration,o=e/n,i=this._SelectedKeyFrames;if(i){var a=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;d.time=Math.max(0,Math.min(r,Math.round((d.time+o)*n)/n))}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}clearTimeout(this.moveFramesTimeout),this.moveFramesTimeout=setTimeout(function(){t._Editor.captureJournalEntry()},350),this.dispatch("moveSelectedKeyFrames")}},{key:"moveFrames",value:function(e){var t=this._FPS,n=this._Position+e/t;this.position=Math.round(n*t)/t,this.showPlayhead()}},{key:"moveKeyFrames",value:function(e){for(var t=this.position,n=null,r=999999999,o=this._ShowSelectionOnly,i=0;i<this._ActualKeyedNodes.length;i++){var a=this._ActualKeyedNodes[i],s=a.node;if(!o||s.stageItem.isSelected)for(var l=a.propsList,u=0;u<l.length;u++)for(var c=l[u].keyFrames,d=0;d<c.length;d++){var f=c[d];if(e&&f.time>t){var h=f.time-t;h<r&&(r=h,n=f)}else if(!e&&f.time<t){var p=t-f.time;p<r&&(r=p,n=f)}}}n&&(this.position=n.time)}},{key:"setActor",value:function(e,t){if(e||(this.isVisible=!1),t&&(this._Editor=t),this.updateNodes(),this._ListeningActor!=e){if(this._ListeningActor&&this.activateListeners(this._ListeningActor,!1),this._ListeningActor=e,e&&this.activateListeners(e,!0),this._LastFullState||this._Editor.captureJournalEntry(),null!=this._ListeningActor){var n=!0,r=!1,i=void 0;try{for(var a,s=this._Changes[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value,u=o(l,2),c=u[0],d=u[1];if(d&&d.delta)for(var f in d.delta)c[f]=d.delta[f]}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}}this.dispatch("activeChange")}}},{key:"read",value:function(e,n){var r=this,o=n.name;if(void 0!==o&&this.setName(o),void 0!==(o=n.order)?this._Order=o:e.actor.whenNodesLoaded(function(){r._Order=r.root.animations.indexOf(r)}),void 0!==(o=n.id)&&(this._ID=o,this._ID>=t.ID&&(t.ID=this._ID+1)),void 0!==(o=n.fps)&&(this._OldFPS=this._FPS=o),void 0!==(o=n.duration)&&(this._OldDuration=this._Duration=o),void 0!==(o=n.displayStart)&&(this._DisplayStart=o),void 0!==(o=n.displayEnd)&&(this._DisplayEnd=o),void 0!==(o=n.position)&&(this._Position=o),void 0!==(o=n.workAreaStart)&&(this._WorkAreaStart=o),void 0!==(o=n.workAreaEnd)&&(this._WorkAreaEnd=o),void 0!==(o=n.isWorkAreaActive)&&(this._IsWorkAreaActive=o),void 0!==(o=n.loop)&&(this._Loop=o),o=n.nodes){for(var i in o){var a=i==t.OrderObject.refId?t.OrderObject:e.actor.getNode(i);if(a){var s=new k.default(a,this);this._KeyedNodeLookup.set(a,s),this._KeyedNodes.push(s),s.deserialize(e.actor,o[i])}}this._ActualKeyedNodes.length=0;for(var l=0;l<this._KeyedNodes.length;l++){var u=this._KeyedNodes[l];this._ActualKeyedNodes.push(u)}this._ActualKeyedNodes.sort(function(e,t){return e.node.treeIndex-t.node.treeIndex}),this.updateNodes()}this.clampWorkArea()}},{key:"clampWorkArea",value:function(){this._WorkAreaStart=Math.min(this._Duration,Math.max(0,this._WorkAreaStart)),this._WorkAreaEnd=Math.min(this._Duration,Math.max(1/this._FPS,this._WorkAreaEnd)),this._WorkAreaStart>this._WorkAreaEnd&&(this._WorkAreaStart=this._WorkAreaEnd-1/this._FPS)}},{key:"clampDisplayArea",value:function(){var e=this._DisplayStart,t=this._DisplayEnd;return this._DisplayStart=Math.min(this._Duration,Math.max(0,this._DisplayStart)),this._DisplayEnd=Math.min(this._Duration,Math.max(1/this._FPS,this._DisplayEnd)),this._DisplayStart>this._DisplayEnd&&(this._DisplayStart=this._DisplayEnd-1/this._FPS),e!=this._DisplayStart||t!=this._DisplayEnd}},{key:"serialize",value:function(){for(var e={displayEnd:this._DisplayEnd,displayStart:this._DisplayStart,duration:this._Duration,fps:this._FPS,id:this._ID,isWorkAreaActive:this._IsWorkAreaActive,loop:this._Loop,name:this.name,order:this._Order,nodes:{},position:this._Position,workAreaEnd:this._WorkAreaEnd,workAreaStart:this._WorkAreaStart},t=0;t<this._ActualKeyedNodes.length;t++){var n=this._ActualKeyedNodes[t];e.nodes[n.node.refId]=n.serialize()}return e}},{key:"serializeInteractive",value:function(){return{name:this.name,order:this.order}}},{key:"copy",value:function(){var e={};return this.dispatch("copy",e),{keyframes:e}}},{key:"pasteToNode",value:function(e,t,n){var r=this._Root.actor,o=this.getOrMakeKeyedNode(e);for(var i in n){var a=o.getKeyFrames(i);if(a){var s=n[i],l=!0,u=!1,c=void 0;try{for(var d,f=s[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var h=d.value,p=S.default.deserializeFrameValue(r,i,h);a.updateValue(this._Position+(h.t-t.keyframes.minTime),p).interpolator=S.default.deserializeInterpolator(h)}}catch(e){u=!0,c=e}finally{try{!l&&f.return&&f.return()}finally{if(u)throw c}}}}o.updateVisibility()}},{key:"pasteToSingle",value:function(e,n,r){var o=Object.keys(n);if(1===o.length&&o[0]!==t.OrderObject.refId){var i=n[o[0]],a=new Set(r.selectedItems.map(function(e){return e.node}).filter(function(e){return null!==e}));if(a.size>0){var s=!0,l=!1,u=void 0;try{for(var c,d=a[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;this.pasteToNode(f,e,i)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}return!0}}return!1}},{key:"paste",value:function(e,n){var r=this;if(e.keyframes&&n.selectedItems.length>0){var o=this._Root.actor,i=e.keyframes.nodes;if(!this.pasteToSingle(e,i,n)){var a=function(n){var a=void 0;if(n===t.OrderObject.refId?a=t.OrderObject:o.activeArtboard.eachChildRecursive(function(e){if(e.refId==n)return a=e,!1}),a){var s=i[n];r.pasteToNode(a,e,s)}};for(var s in i)a(s)}this.doUpdateNodes(),this.updateFrameValues(),this._Editor.captureJournalEntry()}}},{key:"setPosition",value:function(e,t){if((e=Math.min(Math.max(0,e),this._Duration))!=this._Position){if(!t){var n=!0,r=!1,i=void 0;try{for(var a,s=this._Changes[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value,u=o(l,2),c=u[0],d=u[1];if(d&&d.delta)for(var f in d.delta)c[f+"KS"]=0}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}this.orderKeyState=0,this._Changes=new Map,this._Editor.captureJournalEntry()}this._Position=e,this._PositionDirty=!0}}},{key:"setRange",value:function(e,t,n){this._DisplayStart=e,this._DisplayEnd=t,n&&this.clampDisplayArea(),this.dispatch("update"),this.dispatch("scrollChange")}},{key:"getFpsWithDivisor",value:function(e){return e/Math.round(1/this._FPS*e)}},{key:"order",get:function(){return this._Order},set:function(e){e!==this._Order&&(this._Order=e,this.dispatch("orderChange"))}},{key:"editor",get:function(){return this._Editor}},{key:"isStable",get:function(){return this._IsStable}},{key:"isVisible",get:function(){return this._IsVisible},set:function(e){this._IsVisible!=e&&(this._IsVisible=e,this.dispatch("visibilityChange"))}},{key:"disableVisibilityToggle",get:function(){return!0}},{key:"visibilityItem",get:function(){return this}},{key:"isEditingCurves",get:function(){return this._IsEditingCurves},set:function(e){if(this._IsEditingCurves!=e){if(e)for(var t=0;t<this._SelectedItems.length;t++){var n=this._SelectedItems[t];n.group&&(n.group.isExpanded=!0)}this._IsEditingCurves=e,this.dispatch("update"),this.dispatch("isEditingCurvesChange",e)}}},{key:"isPlaying",get:function(){return this._IsPlaying},set:function(e){if(this._IsPlaying!=e){var t=this._Root;this._IsPlaying=e,this._IsPlaying?t.addPlayingAnimation(this):t.removePlayingAnimation(this),e&&(this._IsWorkAreaActive&&(this._Position<this._WorkAreaStart||this._Position>=this._WorkAreaEnd)?this._Position=this._WorkAreaStart:this._Position>=this._Duration&&(this._Position=0)),this.dispatch("play",this._IsPlaying),this.dispatch("update")}}},{key:"showSelectionOnly",get:function(){return this._ShowSelectionOnly},set:function(e){this._ShowSelectionOnly!=e&&(this._ShowSelectionOnly=e,this.updateEditableKeyedNodes(),this.dispatch("update"),this.dispatch("showSelectionOnlyChange",e))}},{key:"isActive",get:function(){return null!==this._ListeningActor}},{key:"loop",get:function(){return this._Loop},set:function(e){this._Loop!=e&&(this._Loop=e,this.dispatch("update"),this.dispatch("loopChange",e))}},{key:"actor",get:function(){return this._Root.actor}},{key:"root",get:function(){return this._Root}},{key:"autoKey",get:function(){return this._AutoKey},set:function(e){this._AutoKey=e}},{key:"duration",get:function(){return this._Duration},set:function(e){this._Duration!=e&&(this._OldDuration=this._Duration,this._Duration=e,this.clampWorkArea(),this.clampDisplayArea(),this._Editor.captureJournalEntry(),this.dispatch("update"),this.dispatch("scrollChange"))}},{key:"displayStart",get:function(){return this._DisplayStart},set:function(e){this._DisplayStart!=e&&(this._DisplayStart=e,this.dispatch("update"),this.dispatch("scrollChange"))}},{key:"displayEnd",get:function(){return this._DisplayEnd},set:function(e){this._DisplayEnd!=e&&(this._DisplayEnd=e,this.dispatch("update"),this.dispatch("scrollChange"))}},{key:"workAreaStart",get:function(){return this._WorkAreaStart},set:function(e){e=Math.round(e*this._FPS)/this._FPS,e=Math.min(this._WorkAreaEnd-1/this._FPS,Math.max(0,e)),this._WorkAreaStart!=e&&(this._WorkAreaStart=e,this.dispatch("update"),this.dispatch("scrollChange"))}},{key:"workAreaEnd",get:function(){return this._WorkAreaEnd},set:function(e){e=Math.round(e*this._FPS)/this._FPS,e=Math.min(this._Duration,Math.max(this._WorkAreaStart+1/this._FPS,e)),this._WorkAreaEnd!=e&&(this._WorkAreaEnd=e,this.dispatch("update"),this.dispatch("scrollChange"))}},{key:"isWorkAreaActive",get:function(){return this._IsWorkAreaActive},set:function(e){this._IsWorkAreaActive!=e&&(this._IsWorkAreaActive=e,e&&this.clampWorkArea(),this.dispatch("update"),this.dispatch("isWorkAreaActiveChange",e))}},{key:"fps",get:function(){return this._FPS},set:function(e){this._FPS!=e&&(this._OldFPS=this._FPS,this._FPS=e,this._Editor.captureJournalEntry(),this.dispatch("update"),this.dispatch("scrollChange"),this.dispatch("fpsChange"))}},{key:"refId",get:function(){return this._ID}},{key:"position",get:function(){return this._Position},set:function(e){this.setPosition(e,!1)}},{key:"orderKeyState",get:function(){return this._OrderKeyState},set:function(e){this._OrderKeyState!=e&&(this._OrderKeyState=e,this.dispatch("keyState"))}},{key:"editableKeyedNodes",get:function(){return this._EditableKeyedNodes}},{key:"keyedNodes",get:function(){return this._ActualKeyedNodes}},{key:"selectedItems",get:function(){return this._SelectedItems}},{key:"selectedKeyFrames",get:function(){return this._SelectedKeyFrames&&this._SelectedKeyFrames.slice(0)||[]}}]),t}()).prototype,"doUpdateNodes",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"doUpdateNodes"),r.prototype),I(r.prototype,"doDispatchUpdateEditableRows",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"doDispatchUpdateEditableRows"),r.prototype),I(r.prototype,"setOrderKey",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setOrderKey"),r.prototype),r);t.default=j,j.KeyFrameLocation=function(e,t,n,r){for(var o,i;n<=r;)if((i=t[o=n+r>>1].time)<e)n=o+1;else{if(!(i>e))return o;r=o-1}return n},j.InterpolateFloat32Array=function(e,t,n){for(var r=new Float32Array(t.length),o=1-n,i=0,a=t.length;i<a;i++)r[i]=e[i]*o+t[i]*n;return r},j.OrderObject={refId:"ORDER",canKeyFrame:function(e){return!0},treeIndex:Number.MAX_VALUE,name:"Draw Order",blockExpand:!0},j.ID=9e3},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=f(n(510)),a=f(n(511)),s=f(n(509)),l=f(n(512)),u=f(n(218)),c=f(n(2)),d=f(n(17));function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var p=null,y=0,v=new Map,m=null,g=void 0,b=(h((r=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._ClearPaint=null,t&&(this.makeCanvas=t),this.initCanvas(),this._Cleanup=[],null===p?CanvasKitInit({locateFile:function(e){return n+"/lib/"+e}}).then(function(e){m=(p=e).SkFontMgr.RefDefault(),g=new p.SkFont(null,10),r.init()}):this.init()}return o(e,[{key:"initCanvas",value:function(){this._Canvas&&(this._Canvas.removeEventListener("webglcontextlost",this.handleContextLost,!1),this._Canvas.removeEventListener("webglcontextrestored",this.contextRestored,!1));var e=this.makeCanvas();this._Canvas=e,e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.contextRestored,!1)}},{key:"makeCanvas",value:function(){var e=document.createElement("canvas");return e.setAttribute("id","canvas"+(y++).toString()),e.style.top="-99999px",e.style.position="absolute",document.body.appendChild(e),this._Remove=!0,e}},{key:"contextRestored",value:function(){d.default.warn("Got WebGL context."),this._ContextLost=!1}},{key:"handleContextLost",value:function(e){e.preventDefault(),d.default.warn("Lost WebGL context (preventing default)."),this.initCanvas(),this.updateSurface()}},{key:"loseContext",value:function(){var e=this._Canvas.getContext("webgl");e&&(this._GLContext=e,e.getExtension("WEBGL_lose_context").loseContext())}},{key:"init",value:function(){this.updateSurface();var e=new p.SkPaint;e.setStyle(p.PaintStyle.Fill),e.setBlendMode(p.BlendMode.Clear),this._ClearPaint=e,this.onLoaded&&this.onLoaded(),s.default.setCanvasKit(p)}},{key:"dispose",value:function(){this._Canvas.removeEventListener("webglcontextlost",this.handleContextLost,!1),this._Canvas.removeEventListener("webglcontextrestored",this.contextRestored,!1),this._CanvasSurface&&(this._CanvasSurface.delete(),this._CanvasSurface=null),this._Remove&&(document.body.removeChild(this._Canvas),this._Remove=!1)}},{key:"updateSurface",value:function(){p&&(this._CanvasSurface&&this._CanvasSurface.delete(),this._CanvasSurface=p.MakeCanvasSurface(this._Canvas.id),this._SkCanvas=this._CanvasSurface.getCanvas(),this._Context=p.currentContext())}},{key:"save",value:function(){this._SkCanvas.save()}},{key:"makeLinearGradient",value:function(e,t,n,r){return n=n.map(function(e){return p.Color(Math.round(255*e[0]),Math.round(255*e[1]),Math.round(255*e[2]),e[3])}),p.MakeLinearGradientShader(e,t,n,r,p.TileMode.Clamp,null,0)}},{key:"makeRadialGradient",value:function(e,t,n,r){return n=n.map(function(e){return p.Color(Math.round(255*e[0]),Math.round(255*e[1]),Math.round(255*e[2]),e[3])}),p.MakeRadialGradientShader(e,t,n,r,p.TileMode.Clamp,null,0)}},{key:"makePaint",value:function(e){var t=new p.SkPaint;return t.setAntiAlias(!0),t.setBlendMode(p.BlendMode.SrcOver),e&&this._Cleanup.push(t),t}},{key:"transform",value:function(e){this._SkCanvas.concat([e[0],e[2],e[4],e[1],e[3],e[5],0,0,1])}},{key:"restore",value:function(){this._SkCanvas.restore()}},{key:"clear",value:function(){var e=this._Context,t=this._ClearPaint,n=this._SkCanvas,r=this.width,o=this.height;p.setCurrentContext(e);try{n.drawRect(p.LTRBRect(0,0,r,o),t)}catch(e){console.log("Error when clearing",n,t,r,o),console.error(e)}return n.save(),!0}},{key:"flush",value:function(){this._SkCanvas.restore(),this._CanvasSurface.flush();var e=!0,t=!1,n=void 0;try{for(var r,o=this._Cleanup[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.delete()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this._Cleanup.length=0}},{key:"setSize",value:function(e,t){return(this.width!==e||this.height!==t)&&(this._Canvas.width=e,this._Canvas.height=t,this.updateSurface(),!0)}},{key:"read",value:function(){return[]}},{key:"makePath",value:function(e){var t=new p.SkPath;return e&&this._Cleanup.push(t),t}},{key:"copyPath",value:function(e,t){var n=e.copy();return t&&this._Cleanup.push(n),n}},{key:"linePath",value:function(e,t,n){if(!e.length)return null;if(e[0].constructor===Number){var r=this.makePath(n);r.moveTo(e[0],e[1]);for(var o=2;o<e.length;o+=2)r.lineTo(e[o],e[o+1]);return t&&r.close(),r}var i=this.makePath(n),a=e[0];i.moveTo(a[0],a[1]);for(var s=1;s<e.length;s++){var l=e[s];i.lineTo(l[0],l[1])}return t&&i.close(),i}},{key:"drawLine",value:function(e,t,n,r,o,i){if(t.length){var a=this._Context;a.save(),a.globalAlpha=n,e&&a.transform(e[0],e[1],e[2],e[3],e[4],e[5]),a.beginPath();var s=t.length/2;a.moveTo(t[0],t[1]);for(var l=2,u=1;u<s;u++)a.lineTo(t[l++],t[l++]);o&&a.closePath(),a.strokeStyle=r,a.lineWidth=i||1.1,a.stroke(),a.restore()}}},{key:"drawVecLine",value:function(e,t,n,r,o,i){if(t.length){var a=this._Context;a.save(),a.globalAlpha=n,e&&a.transform(e[0],e[1],e[2],e[3],e[4],e[5]),a.beginPath();var s=t.length;a.moveTo(t[0][0],t[0][1]);for(var l=1;l<s;l++){var u=t[l];a.lineTo(u[0],u[1])}o&&a.closePath(),a.strokeStyle=r,a.lineWidth=i||1.1,a.stroke(),a.restore()}}},{key:"registerTypeface",value:function(e,t,n){var r=v.get(e);if(!r){r={name:e,source:t,cb:[]},v.set(e,r);var o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="blob",o.onload=function(){var e=new FileReader;e.onload=function(){r.typeface=m.MakeTypefaceFromData(this.result);var e=!0,t=!1,n=void 0;try{for(var o,i=r.cb[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){(0,o.value)(r.typeface)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}delete r.cb},e.readAsArrayBuffer(this.response)},o.send()}r.typeface?n(r.typeface):r.cb&&r.cb.push(n)}},{key:"isLoading",get:function(){return null===this._ClearPaint}},{key:"canvasKit",get:function(){return p}},{key:"canvas",get:function(){return this._Canvas}},{key:"skCanvas",get:function(){return this._SkCanvas}},{key:"ctx",get:function(){return this._Context}},{key:"width",get:function(){return this._Canvas.width}},{key:"height",get:function(){return this._Canvas.height}}],[{key:"setPaintColor",value:function(e,t){e.setColor(p.Color(Math.round(255*t[0]),Math.round(255*t[1]),Math.round(255*t[2]),t[3]))}},{key:"getTransform",value:function(e){return[e[0],e[2],e[4],e[1],e[3],e[5],0,0,1]}},{key:"setPathFillType",value:function(e,t){var n=void 0;switch(t){case i.default.EvenOdd:n=p.FillType.EvenOdd;break;case i.default.NonZero:n=p.FillType.Winding;break;default:n=p.FillType.EvenOdd}e.setFillType(n)}},{key:"setPaintStrokeCap",value:function(e,t){var n=void 0;switch(t){case a.default.Butt:n=p.StrokeCap.Butt;break;case a.default.Round:n=p.StrokeCap.Round;break;case a.default.Square:n=p.StrokeCap.Square;break;default:n=p.StrokeCap.Butt}e.setStrokeCap(n)}},{key:"setPaintStrokeJoin",value:function(e,t){var n=void 0;switch(t){case l.default.Miter:n=p.StrokeJoin.Miter;break;case l.default.Round:n=p.StrokeJoin.Round;break;case l.default.Bevel:n=p.StrokeJoin.Bevel;break;default:n=p.StrokeJoin.Miter}e.setStrokeJoin(n)}},{key:"pointPath",value:function(e,t,n){if(t.length){var r=t[0];e.moveTo(r.translation[0],r.translation[1]);for(var o=0,i=n?t.length:t.length-1,a=t.length;o<i;o++){var s=t[o],l=t[(o+1)%a],c=l.pointType===u.default.Straight?null:l.in,d=s.pointType===u.default.Straight?null:s.out;null===c&&null===d?e.lineTo(l.translation[0],l.translation[1]):(null===d&&(d=s.translation),null===c&&(c=l.translation),e.cubicTo(d[0],d[1],c[0],c[1],l.translation[0],l.translation[1]))}n&&e.close()}return e}},{key:"makeFont",value:function(e,t){return new p.SkFont(e,t)}},{key:"makeTextBlob",value:function(e,t){return new p.SkTextBlob.MakeFromText(e,t)}},{key:"setBlendMode",value:function(e,t){e.setBlendMode(t.sk)}},{key:"trimPath",value:function(e,t,n,r){var o=new p.SkPath,i=0,a=new p.SkPathMeasure(e,!1,1);do{i+=a.getLength()}while(a.nextContour());a.delete();var s=new p.SkPathMeasure(e,!1,1),l=i*t,u=i*n,c=0;return r?(l>0&&(c=S(s,o,c,0,l)),u<i&&(c=S(s,o,c,u,i))):l<u&&(c=S(s,o,c,l,u)),s.delete(),o}},{key:"trimPathSync",value:function(e,t,n,r){var o=new p.SkPath,i=new p.SkPathMeasure(e,!1,1);do{var a=i.getLength(),s=a*t,l=a*n;r?(s>0&&O(i,o,0,0,s),l<a&&O(i,o,0,l,a)):s<l&&O(i,o,0,s,l)}while(i.nextContour());return i.delete(),o}},{key:"canvasKit",get:function(){return p}},{key:"defaultFont",get:function(){return g}}]),e}()).prototype,"contextRestored",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"contextRestored"),r.prototype),h(r.prototype,"handleContextLost",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"handleContextLost"),r.prototype),r);t.default=b;var k=[1,0,0,0,1,0];function S(e,t,n,r,o){var i=n;do{if(r<(i=n+e.getLength())){var a=new p.SkPath;if(e.getSegment(r-n,o-n,a,!0)&&(t.addPath(a,k),a.delete()),o<i)break}n=i}while(e.nextContour());return n}function O(e,t,n,r,o){if(r<n+e.getLength()){var i=new p.SkPath;e.getSegment(r-n,o-n,i,!0)&&(t.addPath(i,k),i.delete())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(168)),a=u(n(236)),s=u(n(2)),l=n(7);function u(e){return e&&e.__esModule?e:{default:e}}var c,d,f,h,p,y,v=(r=function(e){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,null));return o._VtxA=e,o._VtxB=n,o._IsDeformer=r,o._CollisionEdge=null,o._Highlight=!1,r&&o.addEventListener("selectedChange",o.onSelectedChange),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"setB",value:function(e){return e!==this._VtxB&&(this._VtxB=e),this}},{key:"cleanup",value:function(){this.removeEventListener("selectedChange",this.onSelectedChange),this.collisionEdge=null}},{key:"onSelectedChange",value:function(e){e&&this.stage.selectItem(this.parent,!0)}},{key:"customHitDetectEarly",value:function(e,n){var r=this._VtxA,o=this._VtxB,i=8/this.stage.scale,a=i*i;return t.squaredDistanceToSegment(r.stageItem.worldTranslation,o.stageItem.worldTranslation,e,n)<a}},{key:"draw",value:function(e,t){if(!t&&!this.isSelected)if(this._Highlight)this.drawSelection(e,t);else{var n=e.skCanvas,r=this._VtxA,o=this._VtxB,i=(this.node,r.stageItem.worldTranslation),s=o.stageItem.worldTranslation,l=(this.willDelete,a.default.StageContext.edgeStroke);n.drawLine(i[0],i[1],s[0],s[1],l)}}},{key:"drawSelection",value:function(e,t){}},{key:"vtxA",get:function(){return this._VtxA},set:function(e){this._VtxA=e}},{key:"vtxB",get:function(){return this._VtxB},set:function(e){this._VtxB=e}},{key:"collisionEdge",get:function(){return this._CollisionEdge},set:function(e){this._CollisionEdge!=e&&(this._CollisionEdge&&(this._CollisionEdge.highlight=!1),this._CollisionEdge=e,this._CollisionEdge&&(this._CollisionEdge.highlight=!0))}},{key:"highlight",get:function(){return this._Highlight},set:function(e){this._Highlight!=e&&(this._Highlight=e)}},{key:"isDeformer",get:function(){return this._IsDeformer}}]),t}(),c=r.prototype,d="onSelectedChange",f=[s.default],h=Object.getOwnPropertyDescriptor(r.prototype,"onSelectedChange"),p=r.prototype,y={},Object.keys(h).forEach(function(e){y[e]=h[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=f.slice().reverse().reduce(function(e,t){return t(c,d,e)||e},y),p&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(p):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(c,d,y),y=null),r);t.default=v,v.initializeStageContext=function(e,t,n){n.setLayerRenderExtensions(5,{context:t,drawPrep:function(e,t,n){return n.willSelectionsDraw?e:[]}})},v.TempV1=l.vec2.create(),v.TempV2=l.vec2.create(),v.squaredDistanceToSegment=function(e,t,n,r){var o=v.TempV2,i=l.vec2.set(v.TempV1,n,r),a=l.vec2.squaredLength(l.vec2.subtract(o,e,t));if(0==a)return l.vec2.squaredLength(l.vec2.subtract(o,i,e));var s=((n-e[0])*(t[0]-e[0])+(r-e[1])*(t[1]-e[1]))/a;return s<0?l.vec2.squaredLength(l.vec2.subtract(o,i,e)):s>1?l.vec2.squaredLength(l.vec2.subtract(o,i,t)):(o[0]=e[0]+s*(t[0]-e[0]),o[1]=e[1]+s*(t[1]-e[1]),l.vec2.squaredLength(l.vec2.subtract(o,i,o)))},v.pointOnSegment=function(e,t,n,r){var o=v.TempV2,i=l.vec2.squaredLength(l.vec2.subtract(o,e,t));if(0==i)return{point:e,t:0};var a=((n-e[0])*(t[0]-e[0])+(r-e[1])*(t[1]-e[1]))/i;return a<0?{point:e,t:0}:a>1?{point:t,t:1}:(o[0]=e[0]+a*(t[0]-e[0]),o[1]=e[1]+a*(t[1]-e[1]),{point:o,t:a})},v.intersection=function(e,t){if(e.vtxA===t.vtxA||e.vtxA===t.vtxB||e.vtxB===t.vtxA||e.vtxB===t.vtxB)return!1;var n=e.vtxA.position,r=e.vtxB.position,o=t.vtxA.position,i=t.vtxB.position,a=r[0]-n[0],s=r[1]-n[1],l=i[0]-o[0],u=i[1]-o[1],c=(-s*(n[0]-o[0])+a*(n[1]-o[1]))/(-l*s+a*u),d=(l*(n[1]-o[1])-u*(n[0]-o[0]))/(-l*s+a*u);return c>=1e-4&&c<=1.0001&&d>=1e-4&&d<=1.0001?[n[0]+d*a,n[1]+d*s]:null},v.intersects=function(e,t){if(e.vtxA===t.vtxA||e.vtxA===t.vtxB||e.vtxB===t.vtxA||e.vtxB===t.vtxB)return!1;var n=e.vtxA.position,r=e.vtxB.position,o=t.vtxA.position,i=t.vtxB.position,a=r[0]-n[0],s=r[1]-n[1],l=i[0]-o[0],u=i[1]-o[1],c=(-s*(n[0]-o[0])+a*(n[1]-o[1]))/(-l*s+a*u),d=(l*(n[1]-o[1])-u*(n[0]-o[0]))/(-l*s+a*u);return c>=1e-4&&c<=1.0001&&d>=1e-4&&d<=1.0001}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(2)),a=n(7),s=l(n(168));function l(e){return e&&e.__esModule?e:{default:e}}var u,c,d,f,h,p,y=[255,255,255,.8],v=[198,198,198,.5],m=[255,255,255,1],g=[0,139,255,.8],b=[255,255,255,1],k=[198,198,198,1],S=null,O=(r=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._WorldPosition=a.vec2.create(),r._IsIn=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"onAddedToStage",value:function(){this.node.addEventListener("transform",this.updatePosition),this.node.addEventListener("updateInOut",this.updatePosition),this.setMesh(this.stageContext.selectionPoints,2,this.stageContext.selectionIndices),this.updatePosition()}},{key:"onRemovedFromStage",value:function(){this.node.removeEventListener("transform",this.updatePosition),this.node.removeEventListener("updateInOut",this.updatePosition)}},{key:"updatePosition",value:function(){var e=this.node,t=e&&e.jelly;if(t){var n=this._IsIn?t.inPoint:t.outPoint;if(n){a.vec2.transformMat2d(this._WorldPosition,n,e.renderTransform),this.setTranslation(this._WorldPosition);var r=a.mat2d.create();r[4]=this._WorldPosition[0],r[5]=this._WorldPosition[1],this.renderTransform=r,this.stage&&this.stage.redraw()}}}},{key:"customHitDetectEarly",value:function(e,t){var n=this.node,r=this.stage,o=this._WorldPosition;if(n&&n.root&&n.root.clipContents&&!n.root.isPointInside(e,t))return!1;var i=e-o[0],a=t-o[1],s=r.scale*r.screenScale;return(i*i+a*a)*s*s<=100}},{key:"rectIntersects",value:function(e){return this._WorldPosition[0]>=e[0][0]&&this._WorldPosition[0]<=e[2][0]&&this._WorldPosition[1]>=e[0][1]&&this._WorldPosition[1]<=e[2][1]}},{key:"render",value:function(e,t,n,r){var o=e.skCanvas,i=this.stageContext,a=this.stage,s=this.renderTransform,l=this.node,u=this._WorldPosition,c=i.strokeLine,d=i.path,f=i.fill,h=i.fillSelected,p=i.fillHover,y=i.stroke,v=i.strokeSelected,m=i.strokeHover,g=l.root,b=this._IsIn?l.worldTranslation:l.tipWorldTranslation;g&&(b=g.renderTranslation(b));var k=f,S=y;n?(k=h,S=v):t&&(k=p,S=m),o.save(),r&&g&&g.clip(e),c.setStrokeWidth(2/a.scale),o.drawLine(u[0],u[1],b[0],b[1],c),e.transform(s),e.transform(i.scaleTransform),o.drawPath(d,k),o.drawPath(d,S),o.restore()}},{key:"draw",value:function(e,t){t||this.isSelected||this.render(e,!1,!1,!0)}},{key:"drawSelection",value:function(e,t){this.render(e,t,this.isSelected,!1)}},{key:"selectionPanelItem",get:function(){return this.node.stageItem}},{key:"worldPosition",get:function(){return this._WorldPosition}},{key:"isIn",get:function(){return this._IsIn}},{key:"worldRotationTransform",get:function(){var e=this.node,t=e&&e.jelly;if(t){var n=this._IsIn?t.inDirection:t.outDirection;return a.vec2.transformMat2(a.vec2.create(),n,e.renderTransform)}}}]),t}(),u=r.prototype,c="updatePosition",d=[i.default],f=Object.getOwnPropertyDescriptor(r.prototype,"updatePosition"),h=r.prototype,p={},Object.keys(f).forEach(function(e){p[e]=f[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=d.slice().reverse().reduce(function(e,t){return t(u,c,e)||e},p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(u,c,p),p=null),r);t.default=O,O.initializeStageContext=function(e,t,n){S=e.canvasKit;var r=[0,7,7,0,0,-7,-7,0];t.selectionPoints=r,t.selectionIndices=[0,1,2,2,3,0];var o=e.makePath(),i=7*Math.sin(.25*Math.PI);o.addArc(S.LTRBRect(-i,-i,i,i),0,360),o.close(),t.path=o;var s=new S.SkPaint;s.setAntiAlias(!1),s.setStyle(S.PaintStyle.Fill),s.setBlendMode(S.BlendMode.SrcOver),s.setColor(S.Color(v[0],v[1],v[2],v[3])),t.fill=s;var l=s.copy();l.setColor(S.Color(k[0],k[1],k[2],k[3])),t.fillHover=l;var u=s.copy();u.setColor(S.Color(g[0],g[1],g[2],g[3])),t.fillSelected=u;var c=new S.SkPaint;c.setAntiAlias(!0),c.setStyle(S.PaintStyle.Stroke),c.setBlendMode(S.BlendMode.SrcOver),c.setColor(S.Color(y[0],y[1],y[2],y[3])),c.setStrokeWidth(1),t.stroke=c;var d=c.copy();d.setColor(S.Color(b[0],b[1],b[2],b[3])),t.strokeHover=d;var f=c.copy();f.setColor(S.Color(m[0],m[1],m[2],m[3])),t.strokeSelected=f;var h=c.copy();h.setColor(S.Color(v[0],v[1],v[2],v[3])),t.strokeLine=h,n.setLayerRenderExtensions(9,{context:t,scaleTransform:a.mat2d.create(),drawPrep:function(e,t,n){if(!n.willSelectionsDraw||!e.length)return[];var r=1/n.scale*n.screenScale;return this.context.renderScale=r,a.mat2d.fromScaling(this.scaleTransform,[r,r]),this.context.scaleTransform=this.scaleTransform,e}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=u(n(347)),a=u(n(271)),s=u(n(642)),l=u(n(17));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Bitmap=null,n._Texture=null,n._IsFilteringEnabled=!0,n._ShowBorder=!0,n._ImgSrc=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"read",value:function(e,n,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n,r);var i=n.isFilteringEnabled;void 0!==i&&(this._IsFilteringEnabled=i);var a=n.showBorder;void 0!==a&&(this._ShowBorder=a)}},{key:"serialize",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this);return e.isFilteringEnabled=this._IsFilteringEnabled,e.showBorder=this._ShowBorder,e}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.isFilteringEnabled=this._IsFilteringEnabled,e.showBorder=this._ShowBorder,e}},{key:"readRaw",value:function(e,t,n){if(t.bytes&&t.width&&t.height&&t.channels){var r=t.width,o=t.height,i=t.channels,a=t.bytes;this._Bitmap={width:r,height:o,channels:i,bytes:a},this.isMissing=!1,this.markAvailable();var s=document.createElement("canvas");s.width=r,s.height=o;for(var l=s.getContext("2d"),u=l.createImageData(r,o),c=0;c<r;c++)for(var d=0;d<o;d++)for(var f=d*r+c,h=4*f,p=f*i,y=0;y<i;y++)u.data[h+y]=a[p+y];l.putImageData(u,0,0);var v=this;s.toBlob(function(e){v.imgSrc=URL.createObjectURL(e);var t=new FileReader;t.onload=function(){v.file=this.result,n(!0)},t.readAsArrayBuffer(e)},"image/png")}else n(!1)}},{key:"fromBase64",value:function(e){var t=this;a.default.fromUrl("data:"+this.type+";base64,"+e,function(e,n){t._Bitmap=e,t.isMissing=!1,t.imgSrc=n,t.markAvailable()})}},{key:"fromFile",value:function(e,t){var n=this;a.default.fromFile(e,function(e,r){e?(n._Bitmap=e,n.imgSrc=r,n.isMissing=!1,n.markAvailable()):n.isMissing=!0,t&&t()})}},{key:"getDistanceFieldTexture",value:function(e){if(!this._ShowBorder)return null;if(this._DistanceFieldTexture)return this._DistanceFieldTexture;if(this._Bitmap){var t=this;a.default.createSignedDistanceField(this._Bitmap,function(n){n?t._DistanceFieldTexture=e.loadBitmapTexture(n,s.default.LinearFilter|s.default.MipMapped|s.default.ClampToEdge):l.default.debug("Failed to create distance field for bitmap. "+t._Bitmap.width+"x"+t._Bitmap.height)})}return null}},{key:"getPaint",value:function(e){if(this._Paint)return this._Paint;var t=this._Bitmap;if(!t)return null;var n=e.canvasKit,r=t.bytes,o=t.width,i=t.height,a=void 0;switch(t.channels){case 1:a=n.ColorType.Alpha_8;break;case 4:a=n.ColorType.RGBA_8888;break;case 3:a=n.ColorType.RGB_888x}var s=n.MakeImage(r,o,i,n.AlphaType.Unpremul,a);this._Image=s;var l=n.MakeImageShader(s,n.TileMode.Clamp,n.TileMode.Clamp);this._ImageShader=l;var u=new n.SkPaint;return u.setAntiAlias(!0),u.setStyle(n.PaintStyle.Fill),u.setBlendMode(n.BlendMode.SrcOver),u.setColor(n.Color(255,255,255,1)),u.setShader(l),u.setFilterQuality(n.FilterQuality.Low),this._Paint=u,u}},{key:"imgSrc",get:function(){return this._ImgSrc},set:function(e){this._ImgSrc!=e&&(this._ImgSrc=e,this.dispatch("update"))}},{key:"uiHierIconClass",get:function(){return this.isMissing?"HierarchyMissingImageIcon":null}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"selectionIcon",get:function(){return"icon-picture"}},{key:"typeName",get:function(){return"Image Asset"}},{key:"uiIcon",get:function(){return this.isMissing?"icon-missing-large":"icon-picture"}},{key:"uiHierThumbClass",get:function(){return this.isMissing?null:"imageThumb"}},{key:"width",get:function(){return this._Bitmap&&this._Bitmap.width||0}},{key:"height",get:function(){return this._Bitmap&&this._Bitmap.height||0}},{key:"bitmap",get:function(){return this._Bitmap}},{key:"isFilteringEnabled",get:function(){return this._IsFilteringEnabled},set:function(e){this._IsFilteringEnabled=e,this.dispatch("filteringChange",e)}},{key:"showBorder",get:function(){return this._ShowBorder},set:function(e){this._ShowBorder=e,this.dispatch("showBorderChange",e)}},{key:"image",get:function(){return this._Image}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(168)),a=u(n(508)),s=u(n(2)),l=u(n(300));function u(e){return e&&e.__esModule?e:{default:e}}var c,d,f,h,p,y,v=.8,m=[255,255,255,.5],g=[255,255,255,1],b=null,k=(r=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"onAddedToStage",value:function(e){this.node.addEventListener("worldTransform",this.onTransformed);var t=this.node.displayType===a.default.Target?15:O;this.setMinMax([-t,-t],[t,t]),this.renderTransform=this.node.renderTransform}},{key:"onRemovedFromStage",value:function(e){this.node.removeEventListener("worldTransform",this.onTransformed)}},{key:"onTransformed",value:function(){this.renderTransform=this.node.renderTransform}},{key:"doCustomHitDetect",value:function(e,t){var n=Math.sqrt(e*e+t*t);return Math.abs(15-n)<=5}},{key:"computeTightAABB",value:function(){var e=new l.default,t=this.node.worldTranslation;return e.set(t,t),e}},{key:"updateDisplayType",value:function(e){e===a.default.Target?(this.hitDetectOnMesh=!1,this.customHitDetect=this.doCustomHitDetect,this.setMinMax([-15,-15],[15,15])):(this.setMinMax([-O,-O],[O,O]),this.hitDetectOnMesh=!0,this.customHitDetect=null)}},{key:"draw",value:function(e,t){var n=this.node,r=this.renderTransform,o=e.skCanvas;switch(o.save(),n.root&&n.root.clip(e),n.displayType){case a.default.Empty:_(e,this.stageContext,r,t?g:m,this.stage.selectionTarget==this);break;case a.default.Target:P(e,this.stageContext,r,t?g:m,this.stage.selectionTarget==this)}o.restore()}},{key:"drawSelection",value:function(e,t){var n=this.node,r=this.renderTransform;switch(e.save(),n.displayType){case a.default.Empty:_(e,this.stageContext,r,t?g:m,this.stage.selectionTarget==this);break;case a.default.Target:P(e,this.stageContext,r,t?g:m,this.stage.selectionTarget==this)}e.restore()}}]),t}(),c=r.prototype,d="onTransformed",f=[s.default],h=Object.getOwnPropertyDescriptor(r.prototype,"onTransformed"),p=r.prototype,y={},Object.keys(h).forEach(function(e){y[e]=h[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=f.slice().reverse().reduce(function(e,t){return t(c,d,e)||e},y),p&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(p):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(c,d,y),y=null),r);t.default=k;var S=1.5,O=9,w=S/2;function _(e,t,n,r,o){var i=e.skCanvas,a=t._NodeStroke,s=t._NodeFill,l=t.nodeEdgePath,u=t.nodeInside;e.transform(n),a.setColor(b.Color(r[0],r[1],r[2],r[3]*v)),s.setColor(b.Color(r[0],r[1],r[2],r[3]*v)),a.setStrokeWidth(o?2*S:S),i.drawPath(l,a),i.drawPath(u,s)}function P(e,t,n,r,o){var i=e.skCanvas,a=t._NodeStroke,s=t._NodeFill,l=t._TargetTicks,u=t._TargetPath;e.transform(n),a.setColor(b.Color(r[0],r[1],r[2],r[3]*v)),s.setColor(b.Color(r[0],r[1],r[2],r[3]*v)),a.setStrokeWidth(o?2*S:S),i.drawPath(l,s),i.drawPath(u,a)}k.initializeStageContext=function(e,t){b=e.canvasKit;var n=e.makePath();n.moveTo(-9+w,-3-w),n.lineTo(-9+w,-9+w),n.lineTo(-3-w,-9+w),n.moveTo(3+w,-9+w),n.lineTo(9-w,-9+w),n.lineTo(9-w,-3-w),n.moveTo(9-w,3+w),n.lineTo(9-w,9-w),n.lineTo(3+w,9-w),n.moveTo(-3-w,9-w),n.lineTo(-9+w,9-w),n.lineTo(-9+w,3+w),t.nodeEdgePath=n;var r=e.makePath();r.moveTo(-1.5,-1.5),r.lineTo(1.5,-1.5),r.lineTo(1.5,1.5),r.lineTo(-1.5,1.5),r.close(),t.nodeInside=r;var o=e.makePath();o.addArc(b.XYWHRect(-15,-15,30,30),0,360),t._TargetPath=o;var i=e.makePath();i.moveTo(-1,18.75),i.lineTo(1,18.75),i.lineTo(1,15),i.lineTo(-1,15),i.close(),i.moveTo(-1,-18.75),i.lineTo(1,-18.75),i.lineTo(1,-15),i.lineTo(-1,-15),i.close(),i.moveTo(-18.75,-1),i.lineTo(-18.75,1),i.lineTo(-15,1),i.lineTo(-15,-1),i.close(),i.moveTo(18.75,-1),i.lineTo(18.75,1),i.lineTo(15,1),i.lineTo(15,-1),i.close(),t._TargetTicks=i;var a=new b.SkPaint;a.setAntiAlias(!0),a.setStyle(b.PaintStyle.Stroke),a.setStrokeWidth(1),a.setBlendMode(b.BlendMode.SrcOver),a.setColor(b.Color(255,86,120,1)),t._NodeStroke=a;var s=new b.SkPaint;s.setAntiAlias(!0),s.setStyle(b.PaintStyle.Fill),s.setBlendMode(b.BlendMode.SrcOver),s.setColor(b.Color(0,0,0,1)),t._NodeFill=s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=new Map,i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Label=t,this._ID=n,o.set(t,this)}return r(e,[{key:"toString",value:function(){return this._Label}},{key:"id",get:function(){return this._ID}}],[{key:"fromString",value:function(t){return o.get(t)||e.World}}]),e}();t.default=i,i.Local=new i("local",0),i.World=new i("world",1)},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(224)),a=n(7),s=l(n(218));function l(e){return e&&e.__esModule?e:{default:e}}var u=new Float32Array(6),c=new Float32Array([1,0,0,0,1,0,0,0]),d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Path Point",n._Translation=a.vec2.create(),n._AnimationTranslation=a.vec2.create(),n._AnimationIn=a.vec2.create(),n._AnimationOut=a.vec2.create(),n._In=a.vec2.create(),n._Out=a.vec2.create(),n._PointType=s.default.Straight,n._UseAnimationValues=!1,n._Radius=0,n._AnimationRadius=0,n._Weights=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"onPathWorldTransform",value:function(){this.stageItem&&this.stageItem.onTransformed()}},{key:"getSkinTransform",value:function(e,n){return t.computeSkinTransform(e,this._Weights,n)}},{key:"skinTranslation",value:function(e,t,n,r){var o=this._Weights,i=e[0]*n[0]+e[2]*n[1]+e[4],a=e[1]*n[0]+e[3]*n[1]+e[5],s=u;s.fill(0);for(var l=r,c=r+4;l<c;l++){var d=o[l],f=o[l+4];if(f>0)for(var h=6*d,p=0;p<6;p++)s[p]+=t[h+p]*f}return new Float32Array([s[0]*i+s[2]*a+s[4],s[1]*i+s[3]*a+s[5]])}},{key:"skin",value:function(e,t){var n=this._Weights,r=this.translation,o=this.pointType,i=this.out,a=this.in,l=this.radius,c=e[0]*r[0]+e[2]*r[1]+e[4],d=e[1]*r[0]+e[3]*r[1]+e[5],f={pointType:o,o:this},h=u;h.fill(0);for(var p=0;p<4;p++){var y=n[p],v=n[p+4];if(v>0)for(var m=6*y,g=0;g<6;g++)h[g]+=t[m+g]*v}if(f.translation=new Float32Array([h[0]*c+h[2]*d+h[4],h[1]*c+h[3]*d+h[5]]),o!==s.default.Straight){c=e[0]*a[0]+e[2]*a[1]+e[4],d=e[1]*a[0]+e[3]*a[1]+e[5],h.fill(0);for(var b=8;b<12;b++){var k=n[b],S=n[b+4];if(S>0)for(var O=6*k,w=0;w<6;w++)h[w]+=t[O+w]*S}f.in=new Float32Array([h[0]*c+h[2]*d+h[4],h[1]*c+h[3]*d+h[5]]),c=e[0]*i[0]+e[2]*i[1]+e[4],d=e[1]*i[0]+e[3]*i[1]+e[5],h.fill(0);for(var _=16;_<20;_++){var P=n[_],C=n[_+4];if(C>0)for(var E=6*P,T=0;T<6;T++)h[T]+=t[E+T]*C}f.out=new Float32Array([h[0]*c+h[2]*d+h[4],h[1]*c+h[3]*d+h[5]])}else f.radius=l;return f}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),this._PointType=s.default.fromID(n.pointType);var r=n.translation;r&&r.constructor===Array&&2==r.length&&(this._Translation[0]=r[0],this._Translation[1]=r[1]),(r=n.in)&&r.constructor===Array&&2==r.length&&(this._In[0]=r[0],this._In[1]=r[1]),(r=n.out)&&r.constructor===Array&&2==r.length&&(this._Out[0]=r[0],this._Out[1]=r[1]),(r=n.radius)&&(this._Radius=r),(r=n.weights)&&r.constructor===Array&&(this._Weights=new Float32Array(r))}},{key:"validateWeightBuffer",value:function(e){var t=this._Weights,n=this._PointType,r=0;if(this.isConnectedToBones)switch(n){case s.default.Straight:r=8;break;default:r=24}if(0===r&&null!==t)e&&console.warn("Expected weights to be null for a point in",this.parent.name),this._Weights=null;else if(null==t||t.length!==r){e&&console.warn("Expected weights to be",r," instead of ",t&&t.length||null," for a point in",this.parent.name);var o=new Float32Array(r);if(null!==t)for(var i=0,a=Math.min(o.length,t.length);i<a;i++)o[i]=t[i];this._Weights=o}}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.pointType=this._PointType.id,n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.translation=a.vec2.clone(this._Translation),e.in=a.vec2.clone(this._In),e.out=a.vec2.clone(this._Out),e.pointType=this._PointType,e.radius=this._Radius,e.weights=null===this._Weights?null:new Float32Array(this._Weights),e}},{key:"typeName",get:function(){return"Path Point"}},{key:"hideInHierarchy",get:function(){return!0}},{key:"uiHierIconClass",get:function(){return"HierarchyVertexIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionVertexIcon"}},{key:"uiIcon",get:function(){return"icon-vertex"}},{key:"weights",get:function(){return this._Weights},set:function(e){this._Weights=e,this.parent.onWeightsChanged(),this.stageItem.onWeightChanged()}},{key:"translation",get:function(){return this._UseAnimationValues?this._AnimationTranslation:this._Translation},set:function(e){var t=this._UseAnimationValues?this._AnimationTranslation:this._Translation;a.vec2.isEqual(t,e)||(a.vec2.copy(t,e),this.stageItem&&this.stageItem.onTranslationChanged(),this.parent.onPathChanged(),this.dispatch("posChange"))}},{key:"frameTranslation",get:function(){return this._AnimationTranslation},set:function(e){a.vec2.copy(this._AnimationTranslation,e)}},{key:"rigTranslation",get:function(){return this._Translation}},{key:"rigIn",get:function(){return this._In}},{key:"rigOut",get:function(){return this._Out}},{key:"useAnimationValues",get:function(){return this._UseAnimationValues},set:function(e){this._UseAnimationValues!==e&&(this._UseAnimationValues=e,e&&(a.vec2.copy(this._AnimationTranslation,this._Translation),a.vec2.copy(this._AnimationIn,this._In),a.vec2.copy(this._AnimationOut,this._Out),this._AnimationRadius=this._Radius),this.parent.onPathChanged())}},{key:"isConnectedToBones",get:function(){return this.parent.isConnectedToBones}},{key:"rigDeform",get:function(){var e={pos:a.vec2.clone(this._Translation)};return this._PointType!==s.default.Straight?(e.in=a.vec2.clone(this._In),e.out=a.vec2.clone(this._Out)):e.radius=this._Radius,e}},{key:"frameDeform",get:function(){var e={pos:a.vec2.clone(this._AnimationTranslation)};return this._PointType!==s.default.Straight?(e.in=a.vec2.clone(this._AnimationIn),e.out=a.vec2.clone(this._AnimationOut)):e.radius=this._AnimationRadius,e},set:function(e){a.vec2.copy(this._AnimationTranslation,e.pos),e.in&&(a.vec2.copy(this._AnimationIn,e.in),this.stageItem&&this.stageItem.controlOut&&this.stageItem.controlOut.onTranslationChanged()),e.out&&(a.vec2.copy(this._AnimationOut,e.out),this.stageItem&&this.stageItem.controlOut&&this.stageItem.controlOut.onTranslationChanged()),void 0!==e.radius&&(this._AnimationRadius=e.radius),this.stageItem&&this.stageItem.onTranslationChanged()}},{key:"rigRadius",get:function(){return this._Radius}},{key:"radius",get:function(){return this._UseAnimationValues?this._AnimationRadius:this._Radius},set:function(e){this._UseAnimationValues?this._AnimationRadius!==e&&(this._AnimationRadius=e,this.parent.onPathChanged(),this.dispatch("radiusChange")):this._Radius!==e&&(this._Radius=e,this.parent.onPathChanged(),this.dispatch("radiusChange"))}},{key:"in",get:function(){return this._UseAnimationValues?this._AnimationIn:this._In},set:function(e){var t=this._UseAnimationValues?this._AnimationIn:this._In;a.vec2.isEqual(t,e)||(a.vec2.copy(t,e),this.stageItem&&this.stageItem.controlIn&&this.stageItem.controlIn.onTranslationChanged(),this.parent&&this.parent.onPathChanged(),this.dispatch("inChange"))}},{key:"out",get:function(){return this._UseAnimationValues?this._AnimationOut:this._Out},set:function(e){var t=this._UseAnimationValues?this._AnimationOut:this._Out;a.vec2.isEqual(t,e)||(a.vec2.copy(t,e),this.stageItem&&this.stageItem.controlOut&&this.stageItem.controlOut.onTranslationChanged(),this.parent&&this.parent.onPathChanged(),this.dispatch("outChange"))}},{key:"pointType",get:function(){return this._PointType},set:function(e){if(this._PointType!==e){this._PointType=e;var t=this.isConnectedToBones?e===s.default.Straight?8:24:null;if(a.vec2.equals(this.in,[0,0])&&(this.in=a.vec2.add(a.vec2.create(),this.translation,[20,0])),(this._Weights&&this._Weights.length)!==t)if(t){for(var n=new Float32Array(t),r=this._Weights,o=0;o<t;o++)n[o]=r?r[o%8]:c[o%8];this._Weights=n}else this._Weights=null;switch(e){case s.default.Mirror:a.vec2.squaredDistance(this.translation,this.in)<a.vec2.squaredDistance(this.translation,this.out)?this.in=a.vec2.add(a.vec2.create(),this.translation,a.vec2.subtract(a.vec2.create(),this.translation,this.out)):this.out=a.vec2.add(a.vec2.create(),this.translation,a.vec2.subtract(a.vec2.create(),this.translation,this.in));break;case s.default.Asymmetric:var i=a.vec2.subtract(a.vec2.create(),this.in,this.translation),l=a.vec2.subtract(a.vec2.create(),this.translation,this.out),u=Math.atan2(i[1],i[0])/Math.PI*180,d=Math.atan2(l[1],l[0])/Math.PI*180;if(Math.abs(u-d)>.1){var f=a.vec2.distance(this.translation,this.in),h=a.vec2.distance(this.translation,this.out);f<h?(l=a.vec2.normalize(l,l),this.in=a.vec2.scaleAndAdd(a.vec2.create(),this.translation,l,f)):(i=a.vec2.normalize(i,i),this.out=a.vec2.scaleAndAdd(a.vec2.create(),this.translation,i,-h))}}this.stageItem&&this.stageItem.onTypeChanged(),this.validateWeightBuffer(),this.dispatch("typeChange")}}}],[{key:"computeSkinTransform",value:function(e,t,n){var r=u;r.fill(0);for(var o=n,i=n+4;o<i;o++){var a=t[o],s=t[o+4];if(s>0)for(var l=6*a,c=0;c<6;c++)r[c]+=e[l+c]*s}return r}}]),t}();t.default=d},,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=u(n(328)),s=u(n(506)),l=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}var c,d,f,h,p,y,v=(r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Targeted Constraint",n._Target=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"updateDependencies",value:function(e){this._Target&&e.addDependency(this.parent,this._Target)}},{key:"onTargetRemovedFromStage",value:function(e,t){this.target&&this.target.stageItem===t&&(this.target=null)}},{key:"onTargetOptionChanged",value:function(){}},{key:"read",value:function(e,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.target;if(r){var o=this;e.whenNodesLoaded(function(){o.target=e.getNode(r)})}}},{key:"serializeProperties",value:function(e){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return this._Target?n.target=this._Target.refId:delete n.target,n}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.target=this._Target,e}},{key:"target",get:function(){return this._Target},set:function(e){if(this._Target!==e){if(e){var t=this._Actor.dependencyGraph;if(t&&(t.addDependency(this.parent,e),!t.sort()))throw t.removeDependency(this.parent,e),new s.default(e)}this.root&&this.root.markDependenciesDirty(),this._Target&&this._Target.stageItem.removeEventListener("removedFromStage",this.onTargetRemovedFromStage),this._Target=e,this._Target&&this._Target.stageItem.addEventListener("removedFromStage",this.onTargetRemovedFromStage),this.dispatch("targetChange")}}}],[{key:"constraintName",get:function(){return"Targeted Constraint"}},{key:"targetName",get:function(){return"IK Target"}}]),t}(),c=r.prototype,d="onTargetRemovedFromStage",f=[l.default],h=Object.getOwnPropertyDescriptor(r.prototype,"onTargetRemovedFromStage"),p=r.prototype,y={},Object.keys(h).forEach(function(e){y[e]=h[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=f.slice().reverse().reduce(function(e,t){return t(c,d,e)||e},y),p&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(p):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(c,d,y),y=null),r);t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadialGradientStroke=t.RadialGradientFill=t.GradientStroke=t.GradientFill=t.RadialGradientColor=t.GradientColor=t.ColorStroke=t.ColorFill=t.ActorColor=t.ActorPaint=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=h(n(224)),a=n(7),s=h(n(510)),l=h(n(511)),u=h(n(512)),c=h(n(175)),d=h(n(264)),f=h(n(635));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var m=d.default.trimPath,g=d.default.trimPathSync,b=f.default.Off,k=f.default.Sequential,S=(f.default.Synced,t.ActorPaint=function(e){function t(e){p(this,t);var n=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Opacity=1,n._AnimationOpacity=1,n._RenderOpacity=1,n._UseAnimationValues=!1,n}return v(t,i.default),r(t,[{key:"markPaintDirty",value:function(){var e=this.root;if(e){var t=e._DependencyGraph;t&&t.addDirt(this,8)}}},{key:"onAddedToActor",value:function(){var e=this;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onAddedToActor",this).call(this),this._Paint||this._Actor.getContext(function(t){e.initGraphics(t.graphics)})}},{key:"initGraphics",value:function(e){this._Paint=e.makePaint(),this._Parent&&d.default.setBlendMode(this._Paint,this._Parent.blendMode)}},{key:"onRemovedFromActor",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onRemovedFromActor",this).call(this),this._Paint&&(this._Paint.delete(),this._Paint=null)}},{key:"onUseAnimationValues",value:function(){this._AnimationOpacity=this._Opacity}},{key:"onOpacityChanged",value:function(){}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.opacity;this._Opacity=Number.parseFloat(r)||1}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.opacity=this._Opacity,e}},{key:"onDirty",value:function(e){}},{key:"update",value:function(e,t){this._Parent&&(this._RenderOpacity=this.opacity*this._Parent._RenderOpacity,this._Paint&&d.default.setBlendMode(this._Paint,this._Parent.blendMode))}},{key:"updateDependencies",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDependencies",this).call(this,e);var n=this._Parent;n&&e.addDependency(this,n)}},{key:"hideInHierarchy",get:function(){return!0}},{key:"uiHierIconClass",get:function(){return"HierarchyRootIcon"}},{key:"uiIcon",get:function(){return"icon-root"}},{key:"useAnimationValues",get:function(){return this._UseAnimationValues},set:function(e){this._UseAnimationValues!==e&&(this._UseAnimationValues=e,e&&this.onUseAnimationValues(),this.markPaintDirty())}},{key:"rigOpacity",get:function(){return this._Opacity}},{key:"frameOpacity",get:function(){return this._AnimationOpacity},set:function(e){this._AnimationOpacity=e,this.markPaintDirty()}},{key:"opacity",get:function(){return this._UseAnimationValues?this._AnimationOpacity:this._Opacity},set:function(e){if(this._UseAnimationValues){if(this._AnimationOpacity===e)return;this._AnimationOpacity=e}else{if(this._Opacity===e)return;this._Opacity=e}this.onOpacityChanged(),this.markPaintDirty()}},{key:"renderOpacity",get:function(){return this._RenderOpacity}}]),t}()),O=t.ActorColor=function(e){function t(e){p(this,t);var n=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Color",n._Color=new Float32Array(4),n._AnimationColor=new Float32Array(4),n}return v(t,S),r(t,[{key:"onUseAnimationValues",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUseAnimationValues",this).call(this),a.vec4.copy(this._AnimationColor,this._Color)}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.color;r&&r.constructor===Array&&4==r.length&&(this._Color[0]=r[0],this._Color[1]=r[1],this._Color[2]=r[2],this._Color[3]=r[3])}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.color=new Float32Array(this._Color),e}},{key:"rigColor",get:function(){return this._Color}},{key:"frameColor",get:function(){return this._AnimationColor},set:function(e){var t=this._AnimationColor;a.vec4.exactEquals(t,e)||(a.vec4.copy(t,e),this.markPaintDirty())}},{key:"color",get:function(){return this._UseAnimationValues?this._AnimationColor:this._Color},set:function(e){var t=this._UseAnimationValues?this._AnimationColor:this._Color;a.vec4.exactEquals(t,e)||(a.vec4.copy(t,e),this.onColorChanged())}},{key:"runtimeColor",get:function(){var e=this.color;return[e[0],e[1],e[2],e[3]*this._RenderOpacity]}},{key:"cssColor",get:function(){var e=this.color;return"rgba("+Math.round(255*e[0])+", "+Math.round(255*e[1])+", "+Math.round(255*e[2])+", "+e[3]*this.opacity+")"}}]),t}(),w=(t.ColorFill=function(e){function t(e){p(this,t);var n=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._FillRule=s.default.EvenOdd,n}return v(t,O),r(t,[{key:"initGraphics",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initGraphics",this).call(this,e),this._Paint.setStyle(e.canvasKit.PaintStyle.Fill)}},{key:"onOpacityChanged",value:function(){this.parent&&this.parent.fillOpacityChanged()}},{key:"fill",value:function(e,t){var n=this._Paint,r=this.runtimeColor;d.default.setPaintColor(n,r),d.default.setPathFillType(t,this._FillRule),e.skCanvas.drawPath(t,n)}},{key:"onColorChanged",value:function(){this.parent&&this.parent.fillColorChanged()}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),this._FillRule=s.default.fromID(n.fillRule)}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.fillRule=this._FillRule.id,n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.fillRule=this._FillRule,e}},{key:"fillRule",get:function(){return this._FillRule},set:function(e){this._FillRule!==e&&(this._FillRule=e,this.parent&&this.parent.fillRuleChanged()),this.markPaintDirty()}}]),t}(),function(e){return function(t){function n(e){p(this,n);var t=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t._Width=1,t._AnimationWidth=1,t._Cap=l.default.Butt,t._Join=u.default.Miter,t._Trim=b,t._TrimStart=0,t._TrimEnd=1,t._TrimOffset=0,t._AnimationTrimStart=0,t._AnimationTrimEnd=1,t._AnimationTrimOffset=0,t}return v(n,e),r(n,[{key:"initGraphics",value:function(e){o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"initGraphics",this).call(this,e);var t=this._Paint;t.setStyle(e.canvasKit.PaintStyle.Stroke),d.default.setPaintStrokeCap(t,this._Cap),d.default.setPaintStrokeJoin(t,this._Join)}},{key:"onOpacityChanged",value:function(){this.parent&&this.parent.strokeOpacityChanged()}},{key:"markPathEffectsDirty",value:function(){var e=this._EffectPath;e&&e.delete(),this._EffectPath=null}},{key:"read",value:function(e,t){o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"read",this).call(this,e,t);var r=t.width;void 0!==r&&(this._Width=r),this._Cap=l.default.fromID(t.cap)||l.default.Butt,this._Join=u.default.fromID(t.join)||u.default.Miter,this._Trim=!0===t.isTrimmed?k:b;var i=t.trim;void 0!==i&&(this._Trim=f.default.fromID(i)||b),void 0!==(r=t.trimStart)&&(this._TrimStart=Number.parseFloat(r)),void 0!==(r=t.trimEnd)&&(this._TrimEnd=Number.parseFloat(r)),void 0!==(r=t.trimOffset)&&(this._TrimOffset=Number.parseFloat(r))}},{key:"serializeProperties",value:function(e){var t=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"serializeProperties",this).call(this,e);return t.cap=this._Cap.id,t.join=this._Join.id,t.trim=this._Trim.id,t}},{key:"serializeInteractive",value:function(){var e=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"serializeInteractive",this).call(this);return e.width=this._Width,e.cap=this._Cap,e.join=this._Join,e.trim=this._Trim,e.trimStart=this._TrimStart,e.trimEnd=this._TrimEnd,e.trimOffset=this._TrimOffset,e}},{key:"prepStroke",value:function(e,t){var n=this._Paint,r=this._Trim,o=this.width;if(n.setStrokeWidth(o),r!==b){var i=r===k?m:g,a=this.trimStart,s=this.trimEnd,l=this.trimOffset,u=this._EffectPath;if(u)return u;var c=null;if(1!==Math.abs(a-s)){var d=(a+l)%1,f=(s+l)%1;if(d<0&&(d+=1),f<0&&(f+=1),a>s){var h=f;f=d,d=h}c=f>=d?i(t,d,f,!1):i(t,f,d,!0)}return c||(c=t.copy()),this._EffectPath=c,c}return t}},{key:"useAnimationValues",get:function(){return o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"useAnimationValues",this)},set:function(e){!function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var s=i.set;void 0!==s&&s.call(o,r)}return r}(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"useAnimationValues",e,this),e&&(this._AnimationWidth=this._Width,this._AnimationTrimStart=this._TrimStart,this._AnimationTrimEnd=this._TrimEnd,this._AnimationTrimOffset=this._TrimOffset),this.markPaintDirty()}},{key:"isTrimmed",get:function(){return this._Trim!==b}},{key:"trim",get:function(){return this._Trim},set:function(e){this._Trim!==e&&(this._Trim=e,this.parent&&this.parent.strokeTrimChanged())}},{key:"trimStart",get:function(){return this.useAnimationValues?this._AnimationTrimStart:this._TrimStart},set:function(e){if(this.useAnimationValues){if(this._AnimationTrimStart===e)return;this._AnimationTrimStart=e}else{if(this._TrimStart===e)return;this._TrimStart=e}this.parent&&this.parent.strokeStartChanged(),this.markPathEffectsDirty()}},{key:"rigTrimStart",get:function(){return this._TrimStart}},{key:"frameTrimStart",get:function(){return this._AnimationTrimStart},set:function(e){this._AnimationTrimStart!==e&&(this._AnimationTrimStart=e,this.markPathEffectsDirty())}},{key:"trimEnd",get:function(){return this.useAnimationValues?this._AnimationTrimEnd:this._TrimEnd},set:function(e){if(this.useAnimationValues){if(this._AnimationTrimEnd===e)return;this._AnimationTrimEnd=e}else{if(this._TrimEnd===e)return;this._TrimEnd=e}this.parent&&this.parent.strokeEndChanged(),this.markPathEffectsDirty()}},{key:"rigTrimEnd",get:function(){return this._TrimEnd}},{key:"frameTrimEnd",get:function(){return this._AnimationTrimEnd},set:function(e){this._AnimationTrimEnd!==e&&(this._AnimationTrimEnd=e,this.markPathEffectsDirty())}},{key:"trimOffset",get:function(){return this.useAnimationValues?this._AnimationTrimOffset:this._TrimOffset},set:function(e){if(this.useAnimationValues){if(this._AnimationTrimOffset===e)return;this._AnimationTrimOffset=e}else{if(this._TrimOffset===e)return;this._TrimOffset=e}this.parent&&this.parent.strokeOffsetChanged(),this.markPathEffectsDirty()}},{key:"rigTrimOffset",get:function(){return this._TrimOffset}},{key:"frameTrimOffset",get:function(){return this._AnimationTrimOffset},set:function(e){this._AnimationTrimOffset!==e&&(this._AnimationTrimOffset=e,this.markPathEffectsDirty())}},{key:"cap",get:function(){return this._Cap},set:function(e){this._Cap!==e&&(this._Cap=e,d.default.setPaintStrokeCap(this._Paint,e),this.parent&&this.parent.strokeCapChanged())}},{key:"join",get:function(){return this._Join},set:function(e){this._Join!==e&&(this._Join=e,d.default.setPaintStrokeJoin(this._Paint,e),this.parent&&this.parent.strokeJoinChanged())}},{key:"width",get:function(){return this.useAnimationValues?this._AnimationWidth:this._Width},set:function(e){if(this.useAnimationValues){if(this._AnimationWidth===e)return;this._AnimationWidth=e}else{if(this._Width===e)return;this._Width=e}this.parent&&this.parent.strokeWidthChanged(),this.markPaintDirty()}},{key:"rigWidth",get:function(){return this._Width}},{key:"frameWidth",get:function(){return this._AnimationWidth},set:function(e){this._AnimationWidth=e,this.markPaintDirty()}}]),n}()}),_=(t.ColorStroke=function(e){function t(e){return p(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return v(t,w(O)),r(t,[{key:"onColorChanged",value:function(){this.parent&&this.parent.strokeColorChanged()}},{key:"stroke",value:function(e,t){var n=this._Paint,r=this.runtimeColor;t=this.prepStroke(e,t),d.default.setPaintColor(n,r),e.skCanvas.drawPath(t,n)}}]),t}(),t.GradientColor=function(e){function t(e){p(this,t);var n=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Gradient Color",n._ColorStops=new Float32Array(10),n._AnimationColorStops=new Float32Array(10),n._Start=a.vec2.create(),n._AnimationStart=a.vec2.create(),n._End=a.vec2.create(),n._AnimationEnd=a.vec2.create(),n._RenderStart=a.vec2.create(),n._RenderEnd=a.vec2.create(),n._GradientDirty=!0,n._Gradient=null,n}return v(t,S),r(t,[{key:"onRemovedFromActor",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onRemovedFromActor",this).call(this),this._Gradient&&(this._Gradient.delete(),this._Gradient=null,this._GradientDirty=!0)}},{key:"onUseAnimationValues",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUseAnimationValues",this).call(this),this._AnimationColorStops=new Float32Array(this._ColorStops),a.vec2.copy(this._AnimationStart,this._Start),a.vec2.copy(this._AnimationEnd,this._End)}},{key:"updateColorStops",value:function(e,t){var n=this._UseAnimationValues?this._AnimationColorStops:this._ColorStops;!t&&(0,c.default)(n,e)||(this._UseAnimationValues?this._AnimationColorStops=new Float32Array(e):this._ColorStops=new Float32Array(e),this.onColorChanged(),this.stageItem&&this.stageItem.onGradientChanged())}},{key:"update",value:function(e,n){var r=this.start,i=this.end,s=this._RenderStart,l=this._RenderEnd,u=this._Parent;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e,n);var c=u.renderTransform;a.vec2.transformMat2d(s,r,c),a.vec2.transformMat2d(l,i,c),this._GradientDirty=!0}},{key:"read",value:function(e,n){var r=this;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var i=n.colorStops;i&&i.constructor===Array&&i.length%5==0&&(this._ColorStops=new Float32Array(i)),void 0!==(i=n.start)&&(this._Start=i),void 0!==(i=n.end)&&(this._End=i),(i=n.isInUserSpace)&&e.whenNodesLoaded(function(){r.parent.updateTransform();var e=r.parent.transform,t=a.mat2d.create();a.mat2d.invert(t,e)&&(a.vec2.transformMat2d(r._Start,r._Start,t),a.vec2.transformMat2d(r._End,r._End,t))})}},{key:"serializeProperties",value:function(e){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e)}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.colorStops=new Float32Array(this._ColorStops),e.start=this._Start,e.end=this._End,e}},{key:"setToBounds",value:function(){var e=this.parent;if(e){var t=e.stageItem.min,n=e.stageItem.max,r=a.vec2.add(a.vec2.create(),t,n);a.vec2.scale(r,r,.5),this.start=[r[0],t[1]],this.end=[r[0],n[1]]}}},{key:"hideInHierarchy",get:function(){return!0}},{key:"uiHierIconClass",get:function(){return"HierarchyRootIcon"}},{key:"uiIcon",get:function(){return"icon-root"}},{key:"numColorStops",get:function(){return this._ColorStops.length/5}},{key:"rigColorStops",get:function(){return this._ColorStops}},{key:"frameColorStops",get:function(){return this._AnimationColorStops},set:function(e){this.markPaintDirty(),this._AnimationColorStops=new Float32Array(e)}},{key:"colorStops",get:function(){return this._UseAnimationValues?this._AnimationColorStops:this._ColorStops},set:function(e){this.updateColorStops(e,!1)}},{key:"rigGradient",get:function(){var e=new Float32Array(this._ColorStops.length+4);return e.set(this._Start,0),e.set(this._End,2),e.set(this._ColorStops,4),e}},{key:"frameGradient",get:function(){var e=new Float32Array(this._AnimationColorStops.length+4);return e.set(this._AnimationStart,0),e.set(this._AnimationEnd,2),e.set(this._AnimationColorStops,4),e},set:function(e){var t=e.buffer;this._AnimationStart=new Float32Array(t,0,2),this._AnimationEnd=new Float32Array(t,8,2),e.length>4&&(this._AnimationColorStops=new Float32Array(t,16)),this.markPaintDirty()}},{key:"start",get:function(){return this.useAnimationValues?this._AnimationStart:this._Start},set:function(e){if(this.useAnimationValues){if(this._AnimationStart===e)return;this._AnimationStart=e}else{if(this._Start===e)return;this._Start=e}this.onColorChanged(),this.stageItem&&this.stageItem.onGradientChanged()}},{key:"rigStart",get:function(){return this._Start}},{key:"frameStart",get:function(){return this._AnimationStart},set:function(e){this._AnimationStart=e,this.markPaintDirty()}},{key:"end",get:function(){return this.useAnimationValues?this._AnimationEnd:this._End},set:function(e){if(this.useAnimationValues){if(this._AnimationEnd===e)return;this._AnimationEnd=e}else{if(this._End===e)return;this._End=e}this.onColorChanged(),this.stageItem&&this.stageItem.onGradientChanged()}},{key:"rigEnd",get:function(){return this._End}},{key:"frameEnd",get:function(){return this._AnimationEnd},set:function(e){this._AnimationEnd=e}}]),t}()),P=t.RadialGradientColor=function(e){function t(e){p(this,t);var n=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Radial Gradient Color",n._SecondaryRadiusScale=1,n._AnimationSecondaryRadiusScale=1,n}return v(t,_),r(t,[{key:"onUseAnimationValues",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUseAnimationValues",this).call(this),this._AnimationSecondaryRadiusScale=this._SecondaryRadiusScale}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),this._SecondaryRadiusScale=Number.parseFloat(n.secondaryRadiusScale)||1}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.secondaryRadiusScale=this._SecondaryRadiusScale,e}},{key:"rigRadial",get:function(){var e=new Float32Array(this._ColorStops.length+5);return e[0]=this._SecondaryRadiusScale,e.set(this._Start,1),e.set(this._End,3),e.set(this._ColorStops,5),e}},{key:"frameRadial",get:function(){var e=new Float32Array(this._AnimationColorStops.length+5);return e[0]=this._AnimationSecondaryRadiusScale,e.set(this._AnimationStart,1),e.set(this._AnimationEnd,3),e.set(this._AnimationColorStops,5),e},set:function(e){var t=e.buffer;this._AnimationSecondaryRadiusScale=e[0],this._AnimationStart=new Float32Array(t,4,2),this._AnimationEnd=new Float32Array(t,12,2),e.length>5&&(this._AnimationColorStops=new Float32Array(t,20)),this.markPaintDirty()}},{key:"secondaryRadiusScale",get:function(){return this.useAnimationValues?this._AnimationSecondaryRadiusScale:this._SecondaryRadiusScale},set:function(e){if(this.useAnimationValues){if(this._AnimationSecondaryRadiusScale===e)return;this._AnimationSecondaryRadiusScale=e}else{if(this._SecondaryRadiusScale===e)return;this._SecondaryRadiusScale=e}this.onColorChanged(),this.stageItem&&this.stageItem.onGradientChanged()}},{key:"rigSecondaryRadiusScale",get:function(){return this._SecondaryRadiusScale}},{key:"frameSecondaryRadiusScale",get:function(){return this._AnimationSecondaryRadiusScale},set:function(e){this._AnimationSecondaryRadiusScale=e}}]),t}();t.GradientFill=function(e){function t(e){p(this,t);var n=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._FillRule=s.default.EvenOdd,n}return v(t,_),r(t,[{key:"initGraphics",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initGraphics",this).call(this,e),this._Paint.setStyle(e.canvasKit.PaintStyle.Fill)}},{key:"onOpacityChanged",value:function(){this.parent&&this.parent.fillOpacityChanged()}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),this._FillRule=s.default.fromID(n.fillRule)}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.fillRule=this._FillRule.id,n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.fillRule=this._FillRule,e}},{key:"onColorChanged",value:function(){this.markPaintDirty(),this.parent&&this.parent.fillGradientChanged()}},{key:"fill",value:function(e,t){var n=this._RenderStart,r=this._RenderEnd,o=this.colorStops,i=this._Paint;if(this._GradientDirty){this._Gradient&&this._Gradient.delete(),this._GradientDirty=!1;for(var a=this._RenderOpacity,s=o.length/5,l=0,u=[],c=[],f=0;f<s;f++)u.push([o[l++],o[l++],o[l++],o[l++]*a]),c.push(o[l++]);var h=e.makeLinearGradient(n,r,u,c);i.setShader(h),this._Gradient=h}d.default.setPathFillType(t,this._FillRule),e.skCanvas.drawPath(t,i)}},{key:"fillRule",get:function(){return this._FillRule},set:function(e){this._FillRule!==e&&(this._FillRule=e,this.parent&&this.parent.fillRuleChanged())}}]),t}(),t.GradientStroke=function(e){function t(e){return p(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return v(t,w(_)),r(t,[{key:"stroke",value:function(e,n){n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepStroke",this).call(this,e,n);var r=this._RenderStart,i=this._RenderEnd,a=this.colorStops,s=this._Paint;if(this._GradientDirty){this._Gradient&&this._Gradient.delete(),this._GradientDirty=!1;for(var l=this._RenderOpacity,u=a.length/5,c=0,d=[],f=[],h=0;h<u;h++)d.push([a[c++],a[c++],a[c++],a[c++]*l]),f.push(a[c++]);var p=e.makeLinearGradient(r,i,d,f);s.setShader(p),this._Gradient=p}e.skCanvas.drawPath(n,s)}},{key:"onColorChanged",value:function(){this.markPaintDirty(),this.parent&&this.parent.strokeGradientChanged(),this.stageItem&&this.stageItem.onGradientChanged()}}]),t}(),t.RadialGradientFill=function(e){function t(e){p(this,t);var n=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._FillRule=s.default.EvenOdd,n}return v(t,P),r(t,[{key:"initGraphics",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initGraphics",this).call(this,e),this._Paint.setStyle(e.canvasKit.PaintStyle.Fill)}},{key:"onOpacityChanged",value:function(){this.parent&&this.parent.fillOpacityChanged()}},{key:"onColorChanged",value:function(){this.markPaintDirty(),this.parent&&this.parent.fillRadialChanged()}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),this._FillRule=s.default.fromID(n.fillRule)}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.fillRule=this._FillRule.id,n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.fillRule=this._FillRule,e}},{key:"fill",value:function(e,t){var n=this._Paint,r=this._RenderStart,o=this._RenderEnd,i=this.colorStops;this.secondaryRadiusScale;if(this._GradientDirty){this._Gradient&&this._Gradient.delete(),this._GradientDirty=!1;for(var s=this._RenderOpacity,l=i.length/5,u=0,c=[],f=[],h=0;h<l;h++)c.push([i[u++],i[u++],i[u++],i[u++]*s]),f.push(i[u++]);var p=e.makeRadialGradient(r,a.vec2.distance(r,o),c,f);n.setShader(p),this._Gradient=p}d.default.setPathFillType(t,this._FillRule),e.skCanvas.drawPath(t,n)}},{key:"fillRule",get:function(){return this._FillRule},set:function(e){this._FillRule!==e&&(this._FillRule=e,this.parent&&this.parent.fillRuleChanged()),this.markPaintDirty()}}]),t}(),t.RadialGradientStroke=function(e){function t(e){return p(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return v(t,w(P)),r(t,[{key:"stroke",value:function(e,n){n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepStroke",this).call(this,e,n);var r=this._Paint,i=this._RenderStart,s=this._RenderEnd,l=this.colorStops;this.secondaryRadiusScale;if(this._GradientDirty){this._Gradient&&this._Gradient.delete(),this._GradientDirty=!1;for(var u=this._RenderOpacity,c=l.length/5,d=0,f=[],h=[],p=0;p<c;p++)f.push([l[d++],l[d++],l[d++],l[d++]*u]),h.push(l[d++]);var y=e.makeRadialGradient(i,a.vec2.distance(i,s),f,h);r.setShader(y),this._Gradient=y}e.skCanvas.drawPath(n,r)}},{key:"onColorChanged",value:function(){this.markPaintDirty(),this.parent&&this.parent.strokeRadialChanged(),this.stageItem&&this.stageItem.onGradientChanged()}}]),t}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(224),s=(r=a)&&r.__esModule?r:{default:r};var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Custom Property",n._Type=t.Type.Integer,n._IntValue=0,n._FloatValue=0,n._StringValue="",n._BooleanValue=!1,n._AnimationIntValue=0,n._AnimationFloatValue=0,n._AnimationStringValue="",n._AnimationBooleanValue=!1,n._KeyStateIntValue=0,n._KeyStateFloatValue=0,n._KeyStateStringValue=0,n._KeyStateBooleanValue=0,n._UseAnimationValues=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"clearKeyStates",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearKeyStates",this).call(this),this.frameBooleanValueKS=0,this.frameStringValueKS=0,this.frameIntValueKS=0,this.frameFloatValueKS=0}},{key:"read",value:function(e,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.propertyType;switch(r){case t.Type.Integer:case t.Type.Float:case t.Type.String:case t.Type.Boolean:this._Type=r;break;default:this._Type=t.Type.Integer}this._IntValue=n.intValue||0,this._FloatValue=n.floatValue||0,this._StringValue=n.stringValue||"",this._BooleanValue=!0===n.booleanValue||!1}},{key:"serializeProperties",value:function(e){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e)}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.propertyType=this._Type,e.intValue=this._IntValue,e.floatValue=this._FloatValue,e.stringValue=this._StringValue,e.booleanValue=this._BooleanValue,e}},{key:"nullFrame",value:function(){return{frameIntValue:null,frameFloatValue:null,frameStringValue:null,frameBooleanValue:null}}},{key:"hideInHierarchy",get:function(){return!0}},{key:"propertyType",get:function(){return this._Type},set:function(e){e!=this._Type&&(this._Type=e,this.dispatch("typeChanged",e))}},{key:"useAnimationValues",get:function(){return this._UseAnimationValues},set:function(e){e!=this._UseAnimationValues&&(this._UseAnimationValues=e)}},{key:"rigIntValue",get:function(){return this._IntValue}},{key:"intValue",get:function(){return this._UseAnimationValues?this._AnimationIntValue:this._IntValue},set:function(e){if(this._UseAnimationValues){if(e!=this._AnimationIntValue){var t=this.frameIntValue;this.frameIntValue=e,this.dispatch("animateIntValue",{from:t,to:e})}}else e!=this._IntValue&&(this._IntValue=e,this.dispatch("valueChanged",e))}},{key:"floatValue",get:function(){return this._UseAnimationValues?this._AnimationFloatValue:this._FloatValue},set:function(e){if(this._UseAnimationValues){if(e!=this._AnimationFloatValue){var t=this.frameFloatValue;this.frameFloatValue=e,this.dispatch("animateFloatValue",{from:t,to:e})}}else e!=this._FloatValue&&(this._FloatValue=e,this.dispatch("valueChanged",e))}},{key:"frameIntValue",get:function(){return this._AnimationIntValue},set:function(e){this._AnimationIntValue!=e&&(this._AnimationIntValue=e,this.dispatch("valueChanged",e))}},{key:"frameIntValueKS",get:function(){return this._KeyStateIntValue},set:function(e){this._KeyStateIntValue!=e&&(this._KeyStateIntValue=e,this.markKeyStateDirty())}},{key:"rigFloatValue",get:function(){return this._FloatValue},set:function(e){if(this._UseAnimationValues){if(e!=this._AnimationFloatValue){var t=this.frameFloatValue;this.frameFloatValue=e,this.dispatch("animateFloatValue",{from:t,to:e})}}else e!=this._FloatValue&&(this._FloatValue=e,this.dispatch("valueChanged",e))}},{key:"frameFloatValue",get:function(){return this._AnimationFloatValue},set:function(e){this._AnimationFloatValue!=e&&(this._AnimationFloatValue=e,this.dispatch("valueChanged",e))}},{key:"frameFloatValueKS",get:function(){return this._KeyStateFloatValue},set:function(e){this._KeyStateFloatValue!=e&&(this._KeyStateFloatValue=e,this.markKeyStateDirty())}},{key:"rigStringValue",get:function(){return this._StringValue}},{key:"stringValue",get:function(){return this._UseAnimationValues?this._AnimationStringValue:this._StringValue},set:function(e){if(this._UseAnimationValues){if(e!=this._AnimationStringValue){var t=this.frameStringValue;this.frameStringValue=e,this.dispatch("animateStringValue",{from:t,to:e})}}else e!=this._StringValue&&(this._StringValue=e,this.dispatch("valueChanged",e))}},{key:"frameStringValue",get:function(){return this._AnimationStringValue},set:function(e){this._AnimationStringValue!=e&&(this._AnimationStringValue=e,this.dispatch("valueChanged",e))}},{key:"frameStringValueKS",get:function(){return this._KeyStateStringValue},set:function(e){this._KeyStateStringValue!=e&&(this._KeyStateStringValue=e,this.markKeyStateDirty())}},{key:"rigBooleanValue",get:function(){return this._BooleanValue}},{key:"booleanValue",get:function(){return this._UseAnimationValues?this._AnimationBooleanValue:this._BooleanValue},set:function(e){if(this._UseAnimationValues){if(e!=this._AnimationBooleanValue){var t=this.frameBooleanValue;this.frameBooleanValue=e,this.dispatch("animateBooleanValue",{from:t,to:e})}}else e!=this._BooleanValue&&(this._BooleanValue=e,this.dispatch("valueChanged",e))}},{key:"frameBooleanValue",get:function(){return this._AnimationBooleanValue},set:function(e){this._AnimationBooleanValue!=e&&(this._AnimationBooleanValue=e,this.dispatch("valueChanged",e))}},{key:"frameBooleanValueKS",get:function(){return this._KeyStateBooleanValue},set:function(e){this._KeyStateBooleanValue!=e&&(this._KeyStateBooleanValue=e,this.markKeyStateDirty())}}]),t}();t.default=l,l.Type={Integer:0,Float:1,String:2,Boolean:3},l.TypeNames=["Integer","Float","String","Boolean"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(5)),s=c(n(203)),l=c(n(2)),u=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1,filterDisplay:!1,includeBones:!0,includeImages:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.visible=!1,this.includeBones=!0,this.includeImages=!0,this.focusNext=!1}},{key:"componentDidUpdate",value:function(){this.focusNext&&(this.focusNext=!1,this.input.focus(),this.input.setSelectionRange(0,this.input.value.length))}},{key:"show",value:function(){if(this.visible)this.input.focus();else{this.visible=!0,this.setState({visible:!0});var e=this;this.context.nima.setCancelCallback(function(){e.hide()}),this.focusNext=!0,this.updateFilter(),clearTimeout(this.myTimeout),this.setState({filterDisplay:!0})}}},{key:"hide",value:function(){if(this.visible){this.setState({visible:!1}),this.visible=!1,this.updateFilter();var e=this;this.myTimeout=setTimeout(function(){e.setState({filterDisplay:!1})},400)}}},{key:"updateFilter",value:function(){var e=this.input.value,n=this.context.nima.actor;if(n){if(!this.visible)return n.artboards.eachChildRecursive(function(e){e.filterState=t.Show}),n.activeArtboard&&f(n.activeArtboard.drawOrder.hierarchyChildren,function(e){e.filterState=t.Show}),f(n.assetFolder.hierarchyChildren,function(e){e.filterState=t.Show}),f(n.animationFolder.hierarchyChildren,function(e){e.filterState=t.Show}),void(this.props.onFilter&&this.props.onFilter(!1));var r=[];f(n.assetFolder.hierarchyChildren,function(n){-1!==n.name.search(new RegExp(e,"i"))?(n.filterState=t.Show,r.push(n)):n.filterState=t.Hidden});for(var o=0;o<r.length;o++)for(var i=r[o].parent;i&&i!==n.artboards;)i.filterState===t.Hidden&&(i.filterState=t.SemiHidden),i=i.parent;n.activeArtboard&&f(n.activeArtboard.drawOrder.hierarchyChildren,function(n){-1!==n.name.search(new RegExp(e,"i"))?n.filterState=t.Show:n.filterState=t.Hidden}),n.animationFolder&&f(n.animationFolder.hierarchyChildren,function(n){-1!==n.name.search(new RegExp(e,"i"))?n.filterState=t.Show:n.filterState=t.Hidden});var a=[],l=this.includeImages,u=this.includeBones;f(n.artboards.hierarchyChildren,function(n){switch(n.constructor){case s.default:if(!l)return void(n.filterState=t.Hidden);break;default:if(!u)return void(n.filterState=t.Hidden)}-1!==n.name.search(new RegExp(e,"i"))?(n.filterState=t.Show,a.push(n)):n.filterState=t.Hidden});for(var c=0;c<a.length;c++)for(var d=a[c].parent;d&&d!==n.artboards;)d.filterState===t.Hidden&&(d.filterState=t.SemiHidden),d.filterState|=t.Expanded,d=d.parent;this.props.onFilter&&this.props.onFilter(!0)}function f(e,t){var n;if(n=e.constructor===Array?e:e.hierarchyChildren)for(var r=0;r<n.length;r++){var o=n[r];t(o),f(o,t)}}}},{key:"keyDown",value:function(e){switch(e.keyCode){case 27:this.hide()}}},{key:"toggleIncludeImages",value:function(){this.includeImages=!this.state.includeImages,this.setState({includeImages:!this.state.includeImages}),this.updateFilter()}},{key:"toggleIncludeBones",value:function(){this.includeBones=!this.state.includeBones,this.setState({includeBones:!this.state.includeBones}),this.updateFilter()}},{key:"setInput",value:function(e){this.input=e}},{key:"render",value:function(){return i.default.createElement("div",{style:{display:this.state.filterDisplay?null:"none",animation:this.state.visible?null:"bounceFilterOut .1s cubic-bezier(0.000, 0.010, 1.000, 0.000) 0s both"},className:"HierarchyFilter"},i.default.createElement("div",{className:"HierarchyFilterMain"},i.default.createElement("input",{ref:this.setInput,type:"text",onChange:this.updateFilter,onKeyDown:this.keyDown,placeholder:"Type to find..."}),i.default.createElement("svg",{className:"CloseButton",onClick:this.hide},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-close3")}))),i.default.createElement("div",{className:"HierarchyFilterOptions"},i.default.createElement("svg",{onMouseDown:this.toggleIncludeImages,className:"HierarchyIcon HierarchyImageIcon "+(this.state.includeImages?"HierarchyFilterGroupIconActive":"HierarchyFilterGroupIcon")},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-picture")})),i.default.createElement("svg",{onMouseDown:this.toggleIncludeBones,className:"HierarchyIcon HierarchyBoneIcon "+(this.state.includeBones?"HierarchyFilterGroupIconActive":"HierarchyFilterGroupIcon")},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-bone")}))))}}]),t}()).prototype,"hide",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"hide"),r.prototype),d(r.prototype,"updateFilter",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"updateFilter"),r.prototype),d(r.prototype,"keyDown",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"keyDown"),r.prototype),d(r.prototype,"toggleIncludeImages",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleIncludeImages"),r.prototype),d(r.prototype,"toggleIncludeBones",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleIncludeBones"),r.prototype),d(r.prototype,"setInput",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setInput"),r.prototype),r);t.default=f,f.Show=1,f.Hidden=2,f.SemiHidden=4,f.Collapsed=8,f.Expanded=16,f.contextTypes={nima:a.default.object}},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7);var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Min=o.vec2.create(),this._Max=o.vec2.create(),this._Area=0,this._Width=0,this._Height=0}return r(e,[{key:"set",value:function(e,t){return o.vec2.copy(this._Min,e),o.vec2.copy(this._Max,t),this._Area=(this._Width=this._Max[0]-this._Min[0])*(this._Height=this._Max[1]-this._Min[1]),this}},{key:"contains",value:function(e){return this._Min[0]<=e.min[0]&&this._Min[1]<=e.min[1]&&this._Max[0]>=e.max[0]&&this._Max[1]>=e.max[1]}},{key:"combineFrom",value:function(e,t){return this._Min[0]=Math.min(e.min[0],t.min[0]),this._Min[1]=Math.min(e.min[1],t.min[1]),this._Max[0]=Math.max(e.max[0],t.max[0]),this._Max[1]=Math.max(e.max[1],t.max[1]),this._Area=(this._Width=this._Max[0]-this._Min[0])*(this._Height=this._Max[1]-this._Min[1]),this}},{key:"combine",value:function(e){return this._Min[0]=Math.min(this._Min[0],e.min[0]),this._Min[1]=Math.min(this._Min[1],e.min[1]),this._Max[0]=Math.max(this._Max[0],e.max[0]),this._Max[1]=Math.max(this._Max[1],e.max[1]),this._Area=(this._Width=this._Max[0]-this._Min[0])*(this._Height=this._Max[1]-this._Min[1]),this}},{key:"isPointInside",value:function(e,t){return e>=this._Min[0]&&e<=this._Max[0]&&t>=this._Min[1]&&t<=this._Max[1]}},{key:"overlaps",value:function(e){var t=o.vec2.subtract(o.vec2.create(),e.min,this._Max),n=o.vec2.subtract(o.vec2.create(),this._Min,e.max);return!(t[0]>0||t[1]>0)&&!(n[0]>0||n[1]>0)}},{key:"expandHeight",value:function(e){this._Min[1]-=e,this._Max[1]+=e}},{key:"expandWidth",value:function(e){this._Min[0]-=e,this._Max[0]+=e}},{key:"min",get:function(){return this._Min}},{key:"max",get:function(){return this._Max}},{key:"area",get:function(){return this._Area}},{key:"boxWidth",get:function(){return this._Width}},{key:"boxHeight",get:function(){return this._Height}},{key:"center",get:function(){return o.vec2.scale(o.vec2.create(),o.vec2.add(o.vec2.create(),this._Min,this._Max),.5)}},{key:"extents",get:function(){return o.vec2.scale(o.vec2.create(),o.vec2.subtract(o.vec2.create(),this._Max,this._Min),.5)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(168)),a=d(n(265)),s=d(n(236)),l=d(n(2)),u=n(7),c=(n(302),d(n(218)),d(n(19)));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var h=(f((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isSelectable=!0,n.drawAfterSelections=!0,n._RadiusScale=1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"onWeightChanged",value:function(){(0,c.default)(this.updateTransform)}},{key:"onAddedToStage",value:function(e){this.setMinMax([-3,-3],[3,3]),this.updateTransform(),this.updateContour()}},{key:"updateContour",value:function(){var e=this.node,t=this.stage,n=e.parent&&!e.parent.showDeformed&&e.contour;if(n){var r=this._Contour&&this._Contour.setB(n)||new a.default(e,n);this._Contour=r,t?r.addToStage(t):r.removeFromStage()}else this._Contour&&this._Contour.removeFromStage()}},{key:"onRemovedFromStage",value:function(e){this.updateContour()}},{key:"onTranslationChanged",value:function(){this.stage&&this.updateTransform()}},{key:"updateTransform",value:function(){var e=this.image;if(e){if(e.isConnectedToBones&&this.node.skin){var t=this.node.skin(e.worldTransform,e.boneTransformsArray);this.renderTransform=u.mat2d.fromTranslation(u.mat2d.create(),e.root.renderTranslation(t))}else{var n=u.vec2.transformMat2d(u.vec2.create(),this.node.translation,e.renderTransform);this.renderTransform=u.mat2d.fromTranslation(u.mat2d.create(),n)}this.stage&&this.stage.redraw()}}},{key:"customHitDetectEarly",value:function(e,t){var n=this.renderTransform,r=e-n[4],o=t-n[5],i=this.stage.scale*this.stage.screenScale;return(r*r+o*o)*i*i<=100}},{key:"rectIntersects",value:function(e){var t=this.renderTransform;return t[4]>=e[0][0]&&t[4]<=e[2][0]&&t[5]>=e[0][1]&&t[5]<=e[2][1]}},{key:"onTransformed",value:function(){this._Stage&&(this.updateTransform(),this._ControlIn&&this._ControlIn.updateTransform(),this._ControlOut&&this._ControlOut.updateTransform())}},{key:"draw",value:function(e,t){s.default.drawVertex(e,this.stage,this._RadiusScale,t,this.isSelected,this.renderTransform)}},{key:"isAutomatic",get:function(){return!1}},{key:"radiusScale",get:function(){return this._RadiusScale},set:function(e){this._RadiusScale=e}},{key:"image",get:function(){return this.node.parent}},{key:"weightBuffer",get:function(){return this.node.weights}},{key:"weightBufferIndex",get:function(){return 0}},{key:"pointTranslation",get:function(){return this.node.translation},set:function(e){var t=this.image,n=this.node;if(t.isConnectedToBones){var r=this.node.getSkinTransform(t.boneTransformsArray),o=u.mat2d.invert(u.mat2d.create(),r);if(!o)return void console.warn("Unable to get inverse of skin transform");var i=u.vec2.transformMat2d(u.vec2.create(),e,o);if(!u.mat2d.invert(u.mat2d.create(),n.worldTransform))return void console.warn("Unable to get inverse of override world transform");n.translation=u.vec2.transformMat2d(i,i,o)}else this.node.translation=e}},{key:"worldTranslation",get:function(){var e=this.renderTransform;return u.vec2.fromValues(e[4],e[5])},set:function(e){var t=this.image,n=this.node;if(e=n.root.localTranslation(e),t.isConnectedToBones&&n.getSkinTransform){var r=n.getSkinTransform(t.boneTransformsArray,0),o=u.mat2d.invert(u.mat2d.create(),r);if(!o)return void console.warn("Unable to get inverse of skin transform");var i=u.vec2.transformMat2d(u.vec2.create(),e,o);n.translation=u.vec2.transformMat2d(i,i,t.inverseWorld)}else n.translation=u.vec2.transformMat2d(u.vec2.create(),e,t.inverseWorld)}}],[{key:"StageContext",get:function(){return null}}]),t}()).prototype,"updateTransform",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"updateTransform"),r.prototype),f(r.prototype,"onTransformed",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"onTransformed"),r.prototype),r);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StagePathControlLine=t.StagePathControlOut=t.StagePathControlIn=t.StagePathControlPoint=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(168)),a=c(n(236)),s=n(7),l=c(n(19)),u=c(n(2));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p,y,v,m,g,b,k=null,S=null,O=t.StagePathControlPoint=(r=function(e){function t(e){d(this,t);var n=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isSelectable=!0,n.drawAfterSelections=!0,n.line=new w(e),n.line.control=n,n}return h(t,i.default),o(t,[{key:"onWeightChanged",value:function(){(0,l.default)(this.updateTransform)}},{key:"onAddedToStage",value:function(e){this.setMinMax([-2,-2],[2,2]),this.updateTransform(),this.line.addToStage(e)}},{key:"onTranslationChanged",value:function(){this.stage&&(this.updateTransform(),this.stage.redraw())}},{key:"updateTransform",value:function(){var e=this.path,t=this.getWorldTranslation(this.pointTranslation);this.renderTransform=s.mat2d.fromTranslation(s.mat2d.create(),e.root.renderTranslation(t))}},{key:"getWorldTranslation",value:function(e){var t=this.path;return t.isConnectedToBones?this.node.skinTranslation(t.worldTransform,t.boneTransformsArray,e,this.weightBufferIndex):s.vec2.transformMat2d(s.vec2.create(),e,t.worldTransform)}},{key:"onRemovedFromStage",value:function(e){this.line.removeFromStage()}},{key:"customHitDetectEarly",value:function(e,t){var n=this.renderTransform,r=e-n[4],o=t-n[5],i=this.stage.scale*this.stage.screenScale;return(r*r+o*o)*i*i<=100}},{key:"rectIntersects",value:function(e){var t=this.renderTransform;return t[4]>=e[0][0]&&t[4]<=e[2][0]&&t[5]>=e[0][1]&&t[5]<=e[2][1]}},{key:"draw",value:function(e,t){var n=e.skCanvas,r=this.isSelected,o=this.renderTransform,i=this.stage,l=S,u=l.shadeSelectedPath,c=l.shadePath,d=l.selectedPath,f=l.path,h=a.default.StageContext,p=h.whiteFill,y=h.hoverStroke,v=h.stroke,m=(h.selectedStroke,h.selectedFill),g=h.shadeFill,b=r||t?d:f,k=1/i.scale;n.save(),e.transform(o),e.transform(s.mat2d.fromScaling(s.mat2d.create(),[k,k])),n.drawPath(r||t?u:c,g),n.drawPath(b,p),r&&n.drawPath(b,m),n.drawPath(b,t?y:v),n.restore()}},{key:"weightBuffer",get:function(){return this.node.weights}},{key:"isAutomatic",get:function(){}},{key:"path",get:function(){return this.node.parent}},{key:"parent",get:function(){return this.node.stageItem.parent}},{key:"worldTranslation",get:function(){return this.getWorldTranslation(this.pointTranslation)},set:function(e){var t=this.path,n=this.node;if(t.isConnectedToBones){var r=n.getSkinTransform(t.boneTransformsArray,this.weightBufferIndex),o=s.mat2d.invert(s.mat2d.create(),r);if(!o)return void console.warn("Unable to get inverse of skin transform");var i=s.vec2.transformMat2d(s.vec2.create(),e,o);this.pointTranslation=s.vec2.transformMat2d(s.vec2.create(),i,t.inverseWorld)}else this.pointTranslation=s.vec2.transformMat2d(s.vec2.create(),e,t.inverseWorld);this.updateTransform()}},{key:"renderTranslation",get:function(){var e=this.renderTransform;return s.vec2.fromValues(e[4],e[5])}}],[{key:"initializeStageContext",value:function(e,t){if(!k){S=t,k=e.canvasKit;var n=e.makePath();n.addRect(-2,-2,4,4),t.shadeSelectedPath=n;var r=e.makePath();r.addRect(-1,-1,3,3),t.shadePath=r;var o=e.makePath();o.addRect(-3,-3,3,3),t.selectedPath=o;var i=e.makePath();i.addRect(-2,-2,2,2),t.path=i;var a=new k.SkPaint;a.setAntiAlias(!0),a.setStyle(k.PaintStyle.Stroke),a.setStrokeWidth(1),a.setBlendMode(k.BlendMode.SrcOver),a.setColor(k.Color(0,0,0,1)),t.lineStroke=a}}}]),t}(),p=r.prototype,y="updateTransform",v=[u.default],m=Object.getOwnPropertyDescriptor(r.prototype,"updateTransform"),g=r.prototype,b={},Object.keys(m).forEach(function(e){b[e]=m[e]}),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=v.slice().reverse().reduce(function(e,t){return t(p,y,e)||e},b),g&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(g):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(p,y,b),b=null),r),w=(t.StagePathControlIn=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,O),o(t,[{key:"getPointTranslation",value:function(e){return e.in}},{key:"pointTranslation",set:function(e){this.node.in=e},get:function(){return this.node.in}},{key:"weightBufferIndex",get:function(){return 8}}]),t}(),t.StagePathControlOut=function(e){function t(){return d(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,O),o(t,[{key:"getPointTranslation",value:function(e){return e.out}},{key:"pointTranslation",get:function(){return this.node.out},set:function(e){this.node.out=e}},{key:"weightBufferIndex",get:function(){return 16}}]),t}(),t.StagePathControlLine=function(e){function t(e){d(this,t);var n=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isSelectable=!1,n.drawAfterSelections=!1,n}return h(t,i.default),o(t,[{key:"draw",value:function(e,t){var n=e.skCanvas,r=S.lineStroke,o=this.node,i=this.control,a=this.stage,s=o.stageItem.renderTranslation,l=i.renderTranslation;r.setStrokeWidth(1/a.scale),n.drawLine(s[0],s[1],l[0],l[1],r)}},{key:"isAutomatic",get:function(){}}]),t}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=i(n(374));n(7),i(n(17));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Jelly Bone",n.treeOrderFactor=-9999999,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"serializeTransform",value:function(e){}},{key:"setStageItemVisibility",value:function(){(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setStageItemVisibility",this).call(this);var e=this.stageItem;e.isVisible&&this.parent&&(e.isVisible=!this.parent.hideJellies)}},{key:"uiHierIconClass",get:function(){return"HierarchyBoneIcon"}},{key:"uiIcon",get:function(){return"icon-jelly-bone"}},{key:"typeName",get:function(){return"Jelly Bone"}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(223)),a=l(n(516)),s=l(n(16));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Brush=new a.default(e),n._SuppressDragOperation=!1,n._WasBoneSelectionDisabled=!1,n._SelectedBone=null,n._Deform=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"blockMarquee",value:function(e){return!s.default.isMultiSelect(e)&&!e.shiftKey&&this._Brush.hasSelection}},{key:"selectBone",value:function(e){this._SelectedBone=e}},{key:"setWeight",value:function(e,t){this._Brush.setWeight(e,t)}},{key:"normalizePath",value:function(e){this._Brush.normalizePath(e)}},{key:"setSelectedVertexWeight",value:function(e,t){var n=this.stage.appContext.isEditingShape;n&&n.setWeight(t,e,this._Brush.selectedVertices)}},{key:"cancel",value:function(){}},{key:"validate",value:function(){return this.stage.appContext.isEditingShape}},{key:"enable",value:function(){this._Brush.addToStage(this.stage),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this)}},{key:"disable",value:function(){this._Brush.removeFromStage(this.stage),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this),this.cancel()}},{key:"updateSelection",value:function(e,t){this._Brush.updateSelection(e)}},{key:"clearSelections",value:function(){this._Brush.updateSelection(null),this.stage.redraw(),this.dispatch("selectionChanged")}},{key:"startDrag",value:function(e,n){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startDrag",this).call(this,e,n),!0}},{key:"advanceDrag",value:function(e,n,r,i){!this.stage.isDraggingMarquee&&this._SelectedBone&&(this._Brush.incWeight(this._Deform,this._SelectedBone,-n[1]/200),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"advanceDrag",this).call(this,e,n,r,i))}},{key:"mouseMove",value:function(e,t,n){if(!this.stage.isDraggingMarquee)return this._Brush.position=n,!0}},{key:"release",value:function(e,n,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"release",this).call(this,e,n),n||this.dispatch("selectionChanged")}},{key:"click",value:function(e,t,n){this._Deform=!n.altKey}},{key:"doesCustomSelection",get:function(){return!0}},{key:"selectedWeights",get:function(){return this._Brush.selectedWeights}},{key:"weightableBones",get:function(){return this._Brush.weightableBones}},{key:"brush",get:function(){return this._Brush}}]),t}();t.default=u},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(224),s=(r=a)&&r.__esModule?r:{default:r};var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Constraint",n._IsEnabled=!0,n._Strength=1,n._AnimationStrength=1,n._KeyStateStrength=0,n.treeOrderFactor=1e-9,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"nullFrame",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.frameStrength=null,e}},{key:"onAdded",value:function(){}},{key:"markDirty",value:function(){this.parent.markTransformDirty()}},{key:"clearKeyStates",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearKeyStates",this).call(this),this.frameStrengthKS=0}},{key:"setParent",value:function(e){var n=this._Parent;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setParent",this).call(this,e),e!==n&&this.root&&this.root.markDependenciesDirty()}},{key:"onRootChanged",value:function(e,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onRootChanged",this).call(this,e,n),e&&e.markDependenciesDirty(),n&&n.markDependenciesDirty()}},{key:"read",value:function(e,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.strength;void 0!==r&&(this._Strength=Math.min(1,Math.max(0,r)));var o=n.isEnabled;void 0!==o&&(this._IsEnabled=!!o)}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.strength=this._Strength,e.isEnabled=this._IsEnabled,e}},{key:"typeName",get:function(){return"Constraint"}},{key:"uiHierIconClass",get:function(){return"HierarchyEventIcon"}},{key:"uiSelectionIconClass",get:function(){return"HierarchyEventIcon"}},{key:"uiIcon",get:function(){return"icon-constraint"}},{key:"allowDragDrop",get:function(){return!1}},{key:"frameStrengthKS",get:function(){return this._KeyStateStrength},set:function(e){this._KeyStateStrength!=e&&(this._KeyStateStrength=e,this.markKeyStateDirty())}},{key:"rigStrength",get:function(){return this._Strength}},{key:"strength",get:function(){return this.useAnimationValues?this._AnimationStrength:this._Strength},set:function(e){if(e=Math.min(1,Math.max(0,e)),this.useAnimationValues){if(this._AnimationStrength!=e){var t=this.frameStrength;this.frameStrength=e,this.markDirty(),this.dispatch("animateStrength",{from:t,to:e})}}else this._Strength!=e&&(this._Strength=e,this.dispatch("strengthChange"),this.markDirty())}},{key:"frameStrength",get:function(){return this._AnimationStrength},set:function(e){e=Math.min(1,Math.max(0,e)),this._AnimationStrength!=e&&(this._AnimationStrength=e,this.markDirty(),this.dispatch("strengthChange"))}},{key:"isEnabled",get:function(){return this._IsEnabled},set:function(e){this._IsEnabled!==e&&(this._IsEnabled=e,this.dispatch("enabledChange"),this.markDirty())}}],[{key:"constraintName",get:function(){return"Constraint"}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(224),s=(r=a)&&r.__esModule?r:{default:r};var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Children=[],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"resetSiblingIndices",value:function(){for(var e=0;e<this._Children.length;e++)this._Children[e].siblingIndex=e}},{key:"silentlySetChildren",value:function(e){this._Children=e,this.resetSiblingIndices()}},{key:"notifyChildrenChanged",value:function(e){e||(this.dispatch("childrenChanged",this),this._Actor&&this._Actor.notifyChildrenChanged()),this.onChildrenChanged()}},{key:"onChildrenChanged",value:function(){}},{key:"onChildAdded",value:function(e){}},{key:"onChildRemoved",value:function(e){}},{key:"add",value:function(e,t,n){if(!e.isValidParent(this))return!1;var r=this._Children,o=r.indexOf(e);if(e.parent==this||-1!=o)throw new Error(e+" is already a child of "+this);return e.parent&&e.parent.remove(e),e.setParent(this),void 0===n?(e.siblingIndex=r.length&&r[r.length-1].siblingIndex+1||0,r.push(e)):(r.splice(n,0,e),this.resetSiblingIndices()),this.notifyChildrenChanged(t),this.onChildAdded(e),!0}},{key:"remove",value:function(e,t){var n=this._Children.indexOf(e);-1!=n&&(e.setParent(null),this._Children.splice(n,1)),this.onChildRemoved(e),this.notifyChildrenChanged(t)}},{key:"eachChild",value:function(e){for(var t=0;t<this._Children.length;t++)e(this._Children[t])}},{key:"eachChildRecursive",value:function(e){for(var t=0;t<this._Children.length;t++){var n=this._Children[t];!1!==e(n)&&(n.eachChildRecursive&&n.eachChildRecursive(e))}}},{key:"all",value:function(e){if(!1===e(this))return!1;for(var t=0;t<this._Children.length;t++){var n=this._Children[t];!1!==e(n)&&(n.eachChildRecursive&&n.eachChildRecursive(e))}return!0}},{key:"childrenOfType",value:function(e){return this._Children.filter(function(t){return t instanceof e})}},{key:"serializeProperties",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this);return delete e.children,e}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.children=this._Children.slice(0),e}},{key:"serialize",value:function(e){for(var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this,e),r=0;r<this._Children.length;r++){var o=this._Children[r].serialize(e);o&&(n.children||(n.children=[]),n.children.push(o))}return n}},{key:"children",get:function(){return this._Children},set:function(e){this._Children=e,this.resetSiblingIndices(),this.notifyChildrenChanged()}},{key:"hierarchyChildren",get:function(){return this._Children}},{key:"firstChild",get:function(){var e=this._Children;return e.length&&e[0]||null}},{key:"lastChild",get:function(){var e=this._Children;return e.length&&e[e.length-1]||null}},{key:"hasChildren",get:function(){return!0}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(a(n(2)),n(7)),i=a(n(168));function a(e){return e&&e.__esModule?e:{default:e}}var s=[1,1,1,.8],l=[198/255,198/255,198/255,.5],u=[1,1,1,1],c=[0,139/255,1,1],d=[1,1,1,1],f=[198/255,198/255,198/255,1],h=[198/255,0,0,1],p=[1,0,0,1],y=function(e){function t(e,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,null));return a._WorldTransform=e,a._InverseWorldTransform=n,a._DeformIdx=i,a._DeformData=r,a._WorldPosition=o.vec2.create(),a._Position=o.vec2.create(),a._IsDeformer=!!r,a._InverseBoneTransform=null,a.drawAfterSelections=!0,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"onSelectedChange",value:function(e){e&&this._IsDeformer&&this.stage.selectItem(this.parent,!0)}},{key:"cleanup",value:function(){}},{key:"customHitDetectEarly",value:function(e,t){var n=e-this._WorldPosition[0],r=t-this._WorldPosition[1],o=this.stage.scale*this.stage.screenScale;return(n*n+r*r)*o*o<=100}},{key:"rectIntersects",value:function(e){return this._WorldPosition[0]>=e[0][0]&&this._WorldPosition[0]<=e[2][0]&&this._WorldPosition[1]>=e[0][1]&&this._WorldPosition[1]<=e[2][1]}},{key:"draw",value:function(e,t){if(!t&&!this.isSelected){var n=this.renderViewTransform,r=this.stageContext;o.mat2d.mul(n,n,r.scaleTransform);var i=this.willDelete;e.drawColor(n,r.vertexBuffer,r.indexBuffer,1,i?h:l),e.drawThickLine(n,r.edgeLine,.5,1/this.stage.scale,i?p:s)}}},{key:"drawSelection",value:function(e,t){var n=this.renderViewTransform,r=this.stageContext;o.mat2d.mul(n,n,r.scaleTransform);var i=this.willDelete;e.drawColor(n,r.vertexBuffer,r.indexBuffer,1,i?h:this.isSelected?c:f),e.drawThickLine(n,r.edgeLine,.5/this.stage.scale,1,i?p:this.isSelected?u:d)}},{key:"setDeformBuffer",value:function(e){this._DeformData=e}},{key:"setBoneTransform",value:function(e){this._InverseBoneTransform=e?o.mat2d.invert(o.mat2d.create(),e):null}},{key:"position",get:function(){return this._Position},set:function(e){o.vec2.copy(this._Position,e),o.vec2.transformMat2d(this._WorldPosition,this._Position,this._WorldTransform),this.setTranslation(this._WorldPosition)}},{key:"worldPosition",get:function(){return this._WorldPosition},set:function(e){o.vec2.copy(this._WorldPosition,e),o.vec2.transformMat2d(this._Position,this._WorldPosition,this._InverseWorldTransform),this.setTranslation(this._WorldPosition)}},{key:"isDeformer",get:function(){return this._IsDeformer}},{key:"deformWorld",set:function(e){if(o.vec2.copy(this._WorldPosition,e),o.vec2.transformMat2d(this._Position,this._WorldPosition,this._InverseWorldTransform),this.setTranslation(this._WorldPosition),this._IsDeformer){var t=this._Position;this._InverseBoneTransform&&(t=o.vec2.transformMat2d(o.vec2.create(),this._WorldPosition,this._InverseBoneTransform),o.vec2.transformMat2d(t,t,this._InverseWorldTransform)),this._DeformData[this._DeformIdx]=t[0],this._DeformData[this._DeformIdx+1]=t[1],this.parent.node.markVertexDeformMeshDirty()}}}]),t}();t.default=y,y.initializeStageContext=function(e,t,n){n.setLayerRenderExtensions(6,{context:t,scaleTransform:o.mat2d.create(),drawPrep:function(e,t,n){return n.willSelectionsDraw?e:[]}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(229)),o=u(n(203)),i=u(n(198)),a=u(n(303)),s=u(n(420)),l=u(n(347));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n,r,u,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var d=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));c||e.endDragTool(!0);var f=r.indexOf(n.artboards.stageItem);-1!=f&&r.splice(f,1);for(var h=[],p=0;p<u.length;p++){var y=u[p];y instanceof s.default?y.all(function(e){h.push(e)}):y instanceof l.default&&h.push(y)}n.removeAssets(u),e.appContext.deselectItems(u);for(var v=[],m=[],g=new Set,b=0;b<r.length;b++){var k=r[b],S=k.node;S&&(S.all?S.all(function(e){g.add(e)}):g.add(S));var O=!0;if(S){switch(S.constructor){case a.default:continue}for(var w=0;w<r.length;w++)if(w!=b){var _=r[w];if(k.node.isChildOf(_.node)){O=!1;break}}if(O&&k.node.parent){switch(k.node.parent.remove(k.node),k.node.stageItem.removeFromStage(),k.node.constructor){case i.default:v.push(k.node);break;case o.default:m.push(k.node)}k.node.hasChildren&&k.node.eachChildRecursive(function(e){e.constructor===i.default&&v.push(e),e.stageItem&&e.stageItem.removeFromStage()})}}else k.removeFromStage()}if(m.length){var P=!0,C=!1,E=void 0;try{for(var T,I=m[Symbol.iterator]();!(P=(T=I.next()).done);P=!0){var j=T.value;if(j.connectedBones&&j.connectedBones.length){var A=j.connectedBones.slice(0),D=!0,R=!1,M=void 0;try{for(var x,F=A[Symbol.iterator]();!(D=(x=F.next()).done);D=!0){var L=x.value;j.disconnectBone(L.node)}}catch(e){R=!0,M=e}finally{try{!D&&F.return&&F.return()}finally{if(R)throw M}}}}}catch(e){C=!0,E=e}finally{try{!P&&I.return&&I.return()}finally{if(C)throw E}}}if(v.length){var N=[];n.artboards.eachChildRecursive(function(e){e.constructor===o.default&&e.connectedBones.length&&N.push(e)});for(var z=0;z<v.length;z++)for(var V=v[z],B=0;B<N.length;B++){N[B].disconnectBone(V)}}var H=!0,W=!1,K=void 0;try{for(var G,U=g[Symbol.iterator]();!(H=(G=U.next()).done);H=!0){G.value.onDelete()}}catch(e){W=!0,K=e}finally{try{!H&&U.return&&U.return()}finally{if(W)throw K}}return d}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(420)),i=a(n(267));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Type="image/sequence",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"resolveChildType",value:function(e,t){return-1!==e.constructor.getImageMimeTypes().indexOf(t)?i.default:null}},{key:"getDistanceFieldTexture",value:function(e,t){var n=this._Children;if(0===n.length)return null;var r=t%n.length;return r<0&&(r+=n.length),n[Math.floor(r)].getDistanceFieldTexture(e)}},{key:"getPaint",value:function(e){var t=this._Children;return 0===t.length?new e.canvasKit.SkPaint:(this._Paint||(this._Paint=t[0].getPaint(e)),this._Paint)}},{key:"getTexture",value:function(e,t){var n=this._Children;if(0===n.length)return null;var r=t%n.length;return r<0&&(r+=n.length),n[Math.floor(r)].getTexture(e)}},{key:"uiHierThumbClass",get:function(){return"seqThumb"}},{key:"uiIcon",get:function(){return"icon-seq-asset"}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"typeName",get:function(){return"Image Asset"}},{key:"width",get:function(){var e=this.bitmap;return e&&e.width||0}},{key:"height",get:function(){var e=this.bitmap;return e&&e.height||0}},{key:"bitmap",get:function(){return this._Children&&this._Children.length>0&&this._Children[0].bitmap||null}},{key:"imgSrc",get:function(){return this._Children&&this._Children.length>0&&this._Children[0].imgSrc||null}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StageArtboardName=t.StageArtboard=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(168)),a=n(7),s=u(n(2)),l=u(n(264));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h,p,y,v,m,g,b=null,k=t.StageArtboard=(r=function(e){function t(e){c(this,t);var n=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._NameItem=new S(e,n),n}return f(t,i.default),o(t,[{key:"onAddedToStage",value:function(e){this._NameItem.addToStage(e),this.node.addEventListener("worldTransform",this.onTransformed),this.onTransformed()}},{key:"onRemovedFromStage",value:function(e){this._NameItem.removeFromStage(),this.node.removeEventListener("worldTransform",this.onTransformed)}},{key:"onTransformed",value:function(){this.setMinMax(this.node.translation,a.vec2.add(a.vec2.create(),this.node.translation,[this.node.width,this.node.height]))}},{key:"onSelectedChange",value:function(e){e&&this.node.makeActive()}},{key:"customHitDetectEarly",value:function(e,t){var n=this.node,r=n.translation,o=n.width,i=n.height;if(!n.isActive)return e>=r[0]&&t>=r[1]&&e<=r[0]+o&&t<=r[1]+i}},{key:"rectIntersects",value:function(e){var t=this.node,n=t.translation,r=t.width,o=t.height;return n[0]>=e[0][0]&&n[0]+r<=e[2][0]&&n[1]>=e[0][1]&&n[1]+o<=e[2][1]}},{key:"draw",value:function(e,t){var n=e.skCanvas,r=this.node,o=this.stage,i=this.stageContext,a=r.translation,s=r.width,u=r.height,c=r.color,d=i._Fill,f=i._ActiveStroke,h=i._Shadow;if(n.drawRect(b.XYWHRect(a[0],a[1]+10,s,u),h),l.default.setPaintColor(d,c),n.drawRect(b.XYWHRect(a[0],a[1],s,u),d),r.isActive){var p=2/(o.scale*o.screenScale),y=p/2;f.setStrokeWidth(p),n.drawRect(b.XYWHRect(a[0]-y,a[1]-y,s+p,u+p),f)}}},{key:"drawSelection",value:function(e,t){var n=e.skCanvas,r=this.node,o=this.stage,i=r.translation,a=r.width,s=r.height,l=this.stageContext,u=l._SelectedStroke,c=l._HoverStroke,d=2/(o.scale*o.screenScale),f=d/2;n.drawRect(b.XYWHRect(i[0]-f,i[1]-f,a+d,s+d),t?c:u)}}]),t}(),h=r.prototype,p="onTransformed",y=[s.default],v=Object.getOwnPropertyDescriptor(r.prototype,"onTransformed"),m=r.prototype,g={},Object.keys(v).forEach(function(e){g[e]=v[e]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=y.slice().reverse().reduce(function(e,t){return t(h,p,e)||e},g),m&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(m):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(h,p,g),g=null),r),S=t.StageArtboardName=function(e){function t(e,n){c(this,t);var r=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._ArtboardStageItem=n,r}return f(t,i.default),o(t,[{key:"onSelectedChange",value:function(e){e&&this.stage.selectItem(this._ArtboardStageItem,!0)}},{key:"customHitDetectEarly",value:function(e,t){var n=this.node.translation;if(!this._Measurement)return!1;var r=this.stage.scale*this.stage.screenScale,o=20/r,i=this._Measurement/r;return e>=n[0]&&t>=n[1]-o&&e<=n[0]+i&&t<=n[1]}},{key:"rectIntersects",value:function(e){return!1}},{key:"draw",value:function(e,t){var n=e.skCanvas,r=this.node,o=this.stage,i=r.translation,s=(r.width,r.height,this.stageContext),u=s._FillTextHover,c=s._FillText,d=s._Font;if(d){n.restore();var f=o.viewTransform,h=a.vec2.transformMat2d(a.vec2.create(),i,f);this._Measurement=d.measureText(r.name);var p=l.default.makeTextBlob(r.name,d);n.drawTextBlob(p,Math.round(h[0]),Math.round(h[1]-10),t?u:c),n.save(),e.transform(f)}}},{key:"drawSelection",value:function(e,t){}}]),t}();S.initializeStageContext=function(e,t,n){var r=new b.SkPaint;r.setAntiAlias(!0),r.setStyle(b.PaintStyle.Fill),r.setStrokeWidth(1),r.setBlendMode(b.BlendMode.SrcOver),r.setColor(b.Color(255,255,255,1)),t._FillTextHover=r;var o=new b.SkPaint;o.setAntiAlias(!0),o.setStyle(b.PaintStyle.Fill),o.setStrokeWidth(1),o.setBlendMode(b.BlendMode.SrcOver),o.setColor(b.Color(255,255,255,.4)),t._FillText=o,e.registerTypeface("Roboto","https://cdn.2dimensions.com/roboto/Roboto-Regular.woff",function(e){t._Font=l.default.makeFont(e,12.5),n.redraw()})},k.initializeStageContext=function(e,t){var n=new(b=e.canvasKit).SkPaint;n.setAntiAlias(!0),n.setStyle(b.PaintStyle.Stroke),n.setStrokeWidth(1),n.setBlendMode(b.BlendMode.SrcOver),n.setColor(b.Color(255,86,120,1)),t._ActiveStroke=n;var r=new b.SkPaint;r.setAntiAlias(!0),r.setStyle(b.PaintStyle.Fill),r.setBlendMode(b.BlendMode.SrcOver),r.setColor(b.Color(0,0,0,1)),t._Fill=r;var o=new b.SkPaint;o.setAntiAlias(!0),o.setStyle(b.PaintStyle.Fill),o.setBlendMode(b.BlendMode.SrcOver),o.setColor(b.Color(0,0,0,.12)),t._Shadow=o;var i=b.MakeBlurMaskFilter(b.BlurStyle.Normal,5,!1);o.setMaskFilter(i);var a=new b.SkPaint;a.setAntiAlias(!0),a.setStyle(b.PaintStyle.Stroke),a.setStrokeWidth(1),a.setBlendMode(b.BlendMode.SrcOver),a.setColor(b.Color(0,139,255,1)),t._SelectedStroke=a;var s=new b.SkPaint;s.setAntiAlias(!0),s.setStyle(b.PaintStyle.Stroke),s.setStrokeWidth(1),s.setBlendMode(b.BlendMode.SrcOver),s.setColor(b.Color(255,255,255,1)),t._HoverStroke=s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StageRadialGradientLine=t.StageRadialGradient=t.StageGradientLine=t.StageLinearGradientEnd=t.StageLinearGradientMid=t.StageLinearGradient=t.StageGradientPoint=t.StageColorStroke=t.StageColorFill=void 0;var r,o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=d(n(168)),s=d(n(19)),l=d(n(2)),u=n(7),c=d(n(265));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=null,m=(t.StageColorFill=function(e){function t(e){h(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return y(t,a.default),i(t,[{key:"isAutomatic",get:function(){}}]),t}(),t.StageColorStroke=function(e){function t(e){h(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return y(t,a.default),i(t,[{key:"isAutomatic",get:function(){}}]),t}(),null),g=null,b=null,k=null,S=null,O=null,w=t.StageGradientPoint=(f((r=function(e){function t(e){h(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!0,n.drawAfterSelections=!0,n}return y(t,a.default),i(t,[{key:"customHitDetectEarly",value:function(e,t){var n=this.renderTransform,r=e-n[4],o=t-n[5],i=this.stage.scale*this.stage.screenScale;return(r*r+o*o)*i*i<=100}},{key:"onAddedToStage",value:function(e){this.shape.addEventListener("worldTransform",this.onGradientChanged),this.setMinMax([-6,-6],[6,6]),this.update()}},{key:"onRemovedFromStage",value:function(e){this.shape&&this.shape.removeEventListener("worldTransform",this.onGradientChanged)}},{key:"update",value:function(){if(this.stage){var e=this.node,t=u.mat2d.fromTranslation(u.mat2d.create(),this.translation);u.mat2d.multiply(t,e.parent.renderTransform,t),this.renderTransform=t,this.onUpdated()}}},{key:"onUpdated",value:function(){this.stage&&this.stage.redraw()}},{key:"onGradientChanged",value:function(){(0,s.default)(this.update)}},{key:"draw",value:function(e,t){var n=e.skCanvas,r=this.stage,o=this.isSelected,i=this.renderTransform,a=this.node,s=this.colorIndex,l=r.scale,c=(o||t?8:6)/l,d=u.mat2d.getTranslation(u.vec2.create(),i),f=1/l;n.drawOval(v.LTRBRect(d[0]+f-c,d[1]+f-c,d[0]+f+c,d[1]+f+c),k);var h=a.colorStops,p=5*s;S.setColor(v.Color(Math.round(255*h[p]),Math.round(255*h[p+1]),Math.round(255*h[p+2]),h[p+3]));var y=v.LTRBRect(d[0]-c,d[1]-c,d[0]+c,d[1]+c);n.drawOval(y,S),n.drawOval(y,o?b:t?g:m)}},{key:"shape",get:function(){return this.node.parent}},{key:"isAutomatic",get:function(){return!1}},{key:"worldTranslation",get:function(){var e=this.renderTransform;return u.vec2.fromValues(e[4],e[5])},set:function(e){var t=u.mat2d.invert(u.mat2d.create(),this.shape.renderTransform);this.translation=u.vec2.transformMat2d(u.vec2.create(),e,t),this.update()}},{key:"colorIndex",get:function(){return 0}}],[{key:"initializeStageContext",value:function(e,t){v=e.canvasKit,(m=new v.SkPaint).setAntiAlias(!0),m.setStyle(v.PaintStyle.Stroke),m.setBlendMode(v.BlendMode.SrcOver),m.setColor(v.Color(255,255,255,1)),(k=m.copy()).setColor(v.Color(20,20,20,.3)),(g=m.copy()).setColor(v.Color(255,255,255,1)),(b=m.copy()).setColor(v.Color(0,139,255,1)),(S=new v.SkPaint).setAntiAlias(!1),S.setStyle(v.PaintStyle.Fill),S.setBlendMode(v.BlendMode.SrcOver),(O=m.copy()).setColor(v.Color(198,198,198,.5))}}]),t}()).prototype,"update",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"update"),r.prototype),f(r.prototype,"onGradientChanged",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"onGradientChanged"),r.prototype),r),_=t.StageLinearGradient=function(e){function t(e){h(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._MidPoints=[],n}return y(t,w),i(t,[{key:"onAddedToStage",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onAddedToStage",this).call(this,e),this._End=new C(this.node),this._End.addToStage(e);var n=this.lineType;this._Line=new n(this.node),this._Line.addToStage(e)}},{key:"onUpdated",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUpdated",this).call(this),this._End&&this._End.update();for(var e=this.node.colorStops,n=Math.max(0,e.length/5-2),r=this._MidPoints.length;r<n;r++){var i=new P(this.node);i.colorIndex=r+1,i.addToStage(this.stage),this._MidPoints.push(i)}for(;this._MidPoints.length>n;){this._MidPoints.splice(this._MidPoints.length-1,1)[0].removeFromStage()}var a=1,s=!0,l=!1,u=void 0;try{for(var c,d=this._MidPoints[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;f.colorIndex=a++,f.update()}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}},{key:"onRemovedFromStage",value:function(e){this._End&&(this._End.removeFromStage(),this._End=null),this._Line&&(this._Line.removeFromStage(),this._Line=null);var t=!0,n=!1,r=void 0;try{for(var o,i=this._MidPoints[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.removeFromStage()}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this._MidPoints.length=0}},{key:"end",get:function(){return this._End}},{key:"isAutomatic",get:function(){}},{key:"lineType",get:function(){return E}},{key:"translation",get:function(){return this.node.start},set:function(e){this.node.start=e}}]),t}(),P=t.StageLinearGradientMid=function(e){function t(e){return h(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return y(t,w),i(t,[{key:"onAddedToStage",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onAddedToStage",this).call(this,e)}},{key:"translation",get:function(){var e=this.node.colorStops[5*this._Idx+4],t=this.node.end,n=this.node.start,r=u.vec2.distance(n,t),o=u.vec2.subtract(u.vec2.create(),t,n);return u.vec2.scale(o,o,1/r*r*e),u.vec2.add(u.vec2.create(),n,o)},set:function(e){var t=this.node.end,n=this.node.start,r=c.default.pointOnSegment(n,t,e[0],e[1]).t,o=this.node.colorStops;o[5*this._Idx+4]=r,this.node.updateColorStops(o,!0),this.update()}},{key:"colorIndex",get:function(){return this._Idx},set:function(e){this._Idx=e}}]),t}(),C=t.StageLinearGradientEnd=function(e){function t(e){return h(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return y(t,w),i(t,[{key:"onAddedToStage",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onAddedToStage",this).call(this,e)}},{key:"translation",get:function(){return this.node.end},set:function(e){this.node.end=e}},{key:"colorIndex",get:function(){return this.node.colorStops.length/5-1}}]),t}(),E=t.StageGradientLine=function(e){function t(e){h(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isSelectable=!1,n.drawAfterSelections=!1,n}return y(t,a.default),i(t,[{key:"draw",value:function(e,t){var n=this.node,r=this.stage,o=n.parent,i=n.start,a=n.end,s=u.mat2d.fromTranslation(u.mat2d.create(),i);u.mat2d.multiply(s,o.renderTransform,s),i=[s[4],s[5]],s=u.mat2d.fromTranslation(u.mat2d.create(),a),u.mat2d.multiply(s,o.renderTransform,s),a=[s[4],s[5]];var l=e.skCanvas;O.setStrokeWidth(1/r.scale),l.drawLine(i[0],i[1],a[0],a[1],O)}},{key:"isAutomatic",get:function(){}}]),t}(),T=(t.StageRadialGradient=function(e){function t(){return h(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,_),i(t,[{key:"onAddedToStage",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onAddedToStage",this).call(this,e)}},{key:"onRemovedFromStage",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onRemovedFromStage",this).call(this,e),this._RadiusControl&&(this._RadiusControl.stage&&this._RadiusControl.removeFromStage(),this._RadiusControl=null)}},{key:"onUpdated",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUpdated",this).call(this),this._RadiusControl&&this._RadiusControl.update()}},{key:"isAutomatic",get:function(){}},{key:"lineType",get:function(){return T}}]),t}(),t.StageRadialGradientLine=function(e){function t(e){h(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isSelectable=!1,n.drawAfterSelections=!1,n}return y(t,a.default),i(t,[{key:"draw",value:function(e,t){var n=this.node,r=this.stage,o=n.parent,i=n.start,a=n.end,s=e.skCanvas,l=r.scale;s.save();var c=o.renderTransform,d=u.vec2.create(),f=u.vec2.create();i=u.vec2.transformMat2d(d,i,c),a=u.vec2.transformMat2d(f,a,c),m.setStrokeWidth(1/l),s.drawLine(i[0],i[1],a[0],a[1],m);var h=u.vec2.getAngle(u.vec2.subtract(u.vec2.create(),a,i));e.transform(u.mat2d.fromTranslation(u.mat2d.create(),i)),e.transform(u.mat2d.fromRotation(u.mat2d.create(),h));var p=u.vec2.distance(i,a),y=v.LTRBRect(-p,-p,p,p);O.setStrokeWidth(1/l),s.drawOval(y,O),s.restore()}},{key:"isAutomatic",get:function(){}}]),t}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=s(n(228)),a=(n(7),s(n(218)));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Rectangle",n._CornerRadius=0,n._AnimationCornerRadius=0,n._KeyStateCornerRadius=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),this._CornerRadius=Number.parseFloat(n.cornerRadius)||0}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.cornerRadius=this._CornerRadius,e}},{key:"nullFrame",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.frameCornerRadius=null,e}},{key:"clearKeyStates",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearKeyStates",this).call(this),this.frameCornerRadiusKS=0}},{key:"onUseAnimationValuesChange",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUseAnimationValuesChange",this).call(this,e),e&&(this._AnimationCornerRadius=this._CornerRadius)}},{key:"getPathPoints",value:function(){var e=this.width,t=this.height,n=e/2,r=t/2,o=this.cornerRadius||0;return e<2*o&&(o=e/2),t<2*o&&(o=t/2),[{pointType:a.default.Straight,translation:[-n,-r],radius:o},{pointType:a.default.Straight,translation:[n,-r],radius:o},{pointType:a.default.Straight,translation:[n,r],radius:o},{pointType:a.default.Straight,translation:[-n,r],radius:o}]}},{key:"typeName",get:function(){return"Rectangle"}},{key:"uiHierIconClass",get:function(){return"HierarchyImageIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"uiIcon",get:function(){return"icon-picture"}},{key:"rigCornerRadius",get:function(){return this._CornerRadius}},{key:"cornerRadius",get:function(){return this._UseAnimationValues?this._AnimationCornerRadius:this._CornerRadius},set:function(e){if(this._UseAnimationValues){if(this._AnimationCornerRadius!=e){var t=this.frameCornerRadius;this.frameCornerRadius=e,this.dispatch("animateCornerRadius",{from:t,to:e})}}else this._CornerRadius=e,this.parent&&this.parent.onPathChanged(this),this.dispatch("shapePropChange"),this.markRenderPathDirty()}},{key:"frameCornerRadius",get:function(){return this._AnimationCornerRadius},set:function(e){this._AnimationCornerRadius!=e&&(this._AnimationCornerRadius=e,this.forceRedraw(),this.markRenderPathDirty(),this.parent&&this.parent.stageItem.onAnimated(),this.dispatch("shapePropChange"))}},{key:"frameCornerRadiusKS",get:function(){return this._KeyStateCornerRadius},set:function(e){this._KeyStateCornerRadius!=e&&(this._KeyStateCornerRadius=e,this.markKeyStateDirty())}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(228)),a=n(7),s=l(n(218));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Star",n._Points=5,n._InnerRadius=0,n._AnimationInnerRadius=0,n._KeyStateInnerRadius=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),this._InnerRadius=Number.parseFloat(n.innerRadius)||.5,this._Points=Math.max(3,Number.parseFloat(n.points)||5)}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.innerRadius=this._InnerRadius,e.points=this._Points,e}},{key:"nullFrame",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.frameInnerRadius=null,e}},{key:"clearKeyStates",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearKeyStates",this).call(this),this.frameInnerRadiusKS=0}},{key:"onUseAnimationValuesChange",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUseAnimationValuesChange",this).call(this,e),e&&(this._AnimationInnerRadius=this._InnerRadius)}},{key:"getOBB",value:function(e){var t=Number.MAX_VALUE,n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=-Number.MAX_VALUE;function i(i){e&&(i=a.vec2.transformMat2d(a.vec2.create(),i,e)),i[0]<t&&(t=i[0]),i[1]<n&&(n=i[1]),i[0]>r&&(r=i[0]),i[1]>o&&(o=i[1])}var s=2*this.points,l=this.innerRadius,u=this.width/2,c=this.height/2,d=-Math.PI/2,f=2*Math.PI/s,h=[u,u*l],p=[c,c*l];i([0,-c]);for(var y=0;y<s;y++)i([Math.cos(d)*h[y%2],Math.sin(d)*p[y%2]]),d+=f;return[a.vec2.fromValues(t,n),a.vec2.fromValues(r,o)]}},{key:"getPathPoints",value:function(){for(var e=2*this.points,t=this.innerRadius,n=[],r=Math.max(0,this.width/2),o=Math.max(0,this.height/2),i=-Math.PI/2,a=2*Math.PI/e,l=[r,r*t],u=[o,o*t],c=0;c<e;c++)n.push({pointType:s.default.Straight,translation:[Math.cos(i)*l[c%2],Math.sin(i)*u[c%2]]}),i+=a;return n}},{key:"typeName",get:function(){return"Star"}},{key:"uiHierIconClass",get:function(){return"HierarchyImageIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"uiIcon",get:function(){return"icon-picture"}},{key:"points",get:function(){return this._Points},set:function(e){e!==this._Points&&(this._Points=Math.max(3,e),this.parent.onPathChanged(this),this.dispatch("shapePropChange"),this.markRenderPathDirty())}},{key:"rigInnerRadius",get:function(){return this._InnerRadius}},{key:"innerRadius",get:function(){return this._UseAnimationValues?this._AnimationInnerRadius:this._InnerRadius},set:function(e){if(this._UseAnimationValues){if(this._AnimationInnerRadius!=e){var t=this.frameInnerRadius;this.frameInnerRadius=e,this.dispatch("animateInnerRadius",{from:t,to:e})}}else this._InnerRadius=e,this.parent.onPathChanged(this),this.dispatch("shapePropChange"),this.markRenderPathDirty()}},{key:"frameInnerRadius",get:function(){return this._AnimationInnerRadius},set:function(e){this._AnimationInnerRadius!=e&&(this._AnimationInnerRadius=e,this.forceRedraw(),this.parent.stageItem.onAnimated(),this.dispatch("shapePropChange"),this.markRenderPathDirty())}},{key:"frameInnerRadiusKS",get:function(){return this._KeyStateInnerRadius},set:function(e){this._KeyStateInnerRadius!=e&&(this._KeyStateInnerRadius=e,this.markKeyStateDirty())}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(329),s=(r=a)&&r.__esModule?r:{default:r};var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Event",n._KeyStateTrigger=0,n.treeOrderFactor=1e-9,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"clearKeyStates",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clearKeyStates",this).call(this),this.frameTriggerKS=0}},{key:"nullFrame",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.frameTrigger=null,e}},{key:"uiHierIconClass",get:function(){return"HierarchyEventIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionEventIcon"}},{key:"typeName",get:function(){return"Event"}},{key:"uiIcon",get:function(){return"icon-event"}},{key:"frameTrigger",get:function(){return null},set:function(e){}},{key:"frameTriggerKS",get:function(){return this._KeyStateTrigger},set:function(e){this._KeyStateTrigger!=e&&(this._KeyStateTrigger=e,this.markKeyStateDirty())}},{key:"keyFrameHandler",get:function(){return this.kfh||(this.kfh=new u(this)),this.kfh}}]),t}();t.default=l;var u=function(){function e(e){this.dispatcher=e}return e.prototype.setKey=function(e){e.editingAnimation.setKey(this.dispatcher,"frameTrigger"),e.captureJournalEntry()},Object.defineProperties(e.prototype,{state:{get:function(){return this.dispatcher.frameTriggerKS}},event:{get:function(){return"keyState"}}}),e}()},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(641)),i=a(n(224));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._Actor=e,n._Id=null,n._RefID="A"+i.default.ID++,n._Type=null,n._IsMissing=!1,n._Parent=null,n.file=null,n._Removed=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"onRemovedFromActor",value:function(){this._Removed=!0}},{key:"onAddedToActor",value:function(){this._Removed=!1}},{key:"setParent",value:function(e){this._Parent=e,this.onParentChanged&&this.onParentChanged()}},{key:"fromFile",value:function(e,t){t&&t()}},{key:"read",value:function(e,t,n){this.setName(t.name),this._Id=t.id,t.generateNewId&&(e.addTempAssetLookup(this._Id,this),this._Id=null),this._Type=t.type,this._IsMissing=!1;var r=this,o=t.data,i=t.blob,a=!1;o?this.fromBase64(o):i?(a=!0,this.file=i,this.fromFile(i,n)):t.getAsync?(a=!0,t.getAsync(this,function(e){e?r.fromFile(e,n):(r._IsMissing=!0,r.dispatch("update",r),n&&n())})):this.readRaw?(a=!0,this.readRaw(e,t,function(e){e||(r._IsMissing=!0,r.dispatch("update",r)),n&&n()})):this._IsMissing=!0,!a&&n&&n()}},{key:"serialize",value:function(){return{name:this.name,id:this._Id,type:this._Type}}},{key:"serializeInteractive",value:function(){return{name:this.name}}},{key:"serializeHistory",value:function(){return this.serializeInteractive()}},{key:"markAvailable",value:function(){this.dispatch("available",this)}},{key:"canBeReplacedBy",value:function(e){return this.constructor===e.constructor}},{key:"replaceWith",value:function(e,t){var n=this;t.artboards.eachChildRecursive(function(t){t.asset===n&&(t.asset=e)}),t.removeAsset(this)}},{key:"all",value:function(e){return e(this)}},{key:"parent",get:function(){return this._Parent}},{key:"refId",get:function(){return this._RefID}},{key:"id",get:function(){return this._Id},set:function(e){this._Id!=e&&(this._Id=e,this.dispatch("update",this))}},{key:"type",get:function(){return this._Type}},{key:"isMissing",get:function(){return this._IsMissing},set:function(e){this._IsMissing=e,this.dispatch("update",this)}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(223)),a=l(n(176)),s=l(n(1145));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Brush=new s.default,n._SuppressDragOperation=!1,n._WasBoneSelectionDisabled=!1,n._SelectedBoneIndex=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"blockMarquee",value:function(){return!0}},{key:"cancel",value:function(){}},{key:"validate",value:function(){return!!this.stage.appContext.editingWeights}},{key:"enable",value:function(){this._Brush.addToStage(this.stage),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this);var e=this.stage.getLayerOptions(a.default);this._WasBoneSelectionDisabled=e.disableSelection,e.disableSelection=!0,this.stage.setLayerOptions(a.default,e);var n=this.stage.appContext.editingWeights;n&&(this._SelectedBoneIndex%=n.node.connectedBones.length)}},{key:"disable",value:function(){this._Brush.removeFromStage(this.stage),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this),this.cancel();var e=this.stage.getLayerOptions(a.default);e.disableSelection=this._WasBoneSelectionDisabled,this.stage.setLayerOptions(a.default,e)}},{key:"updateSelection",value:function(e){}},{key:"advanceDrag",value:function(e,n,r,i){this._Brush.position=r,this.paint(),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"advanceDrag",this).call(this,e,n,r,i)}},{key:"mouseMove",value:function(e,t,n){return this._Brush.position=n,!0}},{key:"release",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"release",this).call(this,e,n);var r=this.stage.appContext.editingWeights;r&&r.weightsUpdated()}},{key:"click",value:function(e){this.paint()}},{key:"paint",value:function(){var e=this.stage.appContext.editingWeights;if(e){var t=this._Brush.influence;this._Brush.mode===s.default.Mode.Add?e.paintInfluence(this._Brush.strength,t.index,t.weights,this._SelectedBoneIndex):e.subtractInfluence(this._Brush.strength,t.index,t.weights,this._SelectedBoneIndex)}}},{key:"brush",get:function(){return this._Brush}},{key:"selectedBoneIndex",get:function(){return this._SelectedBoneIndex},set:function(e){e!=this._SelectedBoneIndex&&(this._SelectedBoneIndex=e)}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=n(7),a=x(n(223)),s=x(n(179)),l=x(n(230)),u=x(n(252)),c=n(333),d=x(n(236)),f=x(n(301)),h=n(334),p=n(302),y=x(n(268)),v=x(n(176)),m=x(n(253)),g=x(n(195)),b=x(n(265)),k=x(n(330)),S=x(n(266)),O=x(n(377)),w=x(n(648)),_=x(n(519)),P=x(n(520)),C=x(n(378)),E=x(n(376)),T=x(n(1146)),I=x(n(640)),j=x(n(350)),A=x(n(649)),D=x(n(1147)),R=x(n(521)),M=x(n(650));function x(e){return e&&e.__esModule?e:{default:e}}var F=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._LockToAxis=!1,n._TransformSpace=i.mat2d.create(),n._XHandle=new w.default,n._XHandle.color=[236/255,62/255,74/255,1],n._XHandle.hoverColor=[1,1,1,1],n._XHandle.rotationTransform=i.mat2d.fromRotation(i.mat2d.create(),Math.PI/2),n._YHandle=new w.default,n._YHandle.color=[104/255,254/255,217/255,1],n._YHandle.hoverColor=[1,1,1,1],n._RotationHandle=new _.default(!0),n._RotationHandle.customSelectionAction=function(){return!0},n._TranslateItem=null,n._XHandle.customSelectionAction=function(){return!0},n._YHandle.customSelectionAction=function(){return!0},n._ScaleXHandle=new P.default,n._ScaleXHandle.color=[236/255,62/255,74/255,1],n._ScaleXHandle.hoverColor=[1,1,1,1],n._ScaleXHandle.rotationTransform=i.mat2d.fromRotation(i.mat2d.create(),Math.PI/2),n._ScaleYHandle=new P.default,n._ScaleYHandle.color=[104/255,254/255,217/255,1],n._ScaleYHandle.hoverColor=[1,1,1,1],n._ScaleModulation=i.vec2.set(i.vec2.create(),1,1),n._ScaleXHandle.customSelectionAction=function(){return!0},n._ScaleYHandle.customSelectionAction=function(){return!0},n.filterDragSelection=a.default.filterChildren,n._IsRotating=n._IsScaling=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"validate",value:function(){var e=this.stage.soloItem;return!e||!e.meshEditor}},{key:"findValidItem",value:function(e){for(var t=null,n=e.length-1;n>=0;n--)if(e[n].constructor===k.default){t=[k.default];break}for(var r=e.length-1;r>=0;r--){var o=e[r];if(!t||-1!==t.indexOf(o.constructor)){switch(o.constructor){case m.default:continue;case s.default:if(o.node&&o.node.isConnectedToBones&&this.stage.appContext.editingAnimation)continue}return o}}return null}},{key:"updateSelection",value:function(e){if(e=a.default.filterChildren(e),this._TranslateItem=this.findValidItem(e),this._TranslateItem){var t=!0;switch(this._TranslateItem.constructor){case h.StageLinearGradient:case h.StageLinearGradientEnd:case h.StageLinearGradientMid:case h.StageRadialGradient:case h.StageRadialGradientRadius:case d.default:case f.default:case p.StagePathControlIn:case p.StagePathControlOut:case k.default:case S.default:case c.StageArtboard:t=!1}this._XHandle.stage||(this._XHandle.addToStage(this.stage),this._YHandle.addToStage(this.stage)),t?this._RotationHandle.addToStage(this.stage):this._RotationHandle.removeFromStage(),t?(this._ScaleXHandle.addToStage(this.stage),this._ScaleYHandle.addToStage(this.stage)):(this._ScaleXHandle.removeFromStage(),this._ScaleYHandle.removeFromStage())}else this._XHandle.stage&&(this._XHandle.removeFromStage(),this._YHandle.removeFromStage(),this._ScaleXHandle.removeFromStage(),this._ScaleYHandle.removeFromStage(),this._RotationHandle.removeFromStage())}},{key:"drawPrep",value:function(e){var t=i.mat2d.create(),n=t,r=this.stage.transformSpace,o=null,a=this._TranslateItem;if(a)switch(a.constructor){case b.default:if(a.vtxA&&a.vtxB){var m=i.vec2.add(i.vec2.create(),a.vtxA.worldPosition,a.vtxB.worldPosition);i.vec2.scale(m,m,.5);var w=i.mat2d.fromRotation(i.mat2d.create(),i.mat2d.getRotation(a.parent.node.renderTransform));t=n=i.mat2d.mul(w,i.mat2d.fromTranslation(i.mat2d.create(),m),w)}break;case k.default:var _=i.mat2d.fromRotation(i.mat2d.create(),i.mat2d.getRotation(a.parent.node.renderTransform));t=n=i.mat2d.mul(_,a.renderTransform,_);break;case S.default:t=a.renderTransform,n=a.worldRotationTransform;break;case y.default:case v.default:case s.default:case l.default:case u.default:(o=a.node).isConnectedToBones?(t=o.getCentroidTransform(),n=o.renderTransform):t=n=o.renderTransform;break;case h.StageLinearGradient:case h.StageLinearGradientEnd:case h.StageLinearGradientMid:case h.StageRadialGradient:case h.StageRadialGradientRadius:t=a.renderTransform,n=a.shape.renderTransform;break;case p.StagePathControlIn:case p.StagePathControlOut:case d.default:t=a.renderTransform,n=a.path.renderTransform;break;case f.default:t=a.renderTransform,n=a.image.renderTransform;break;case g.default:o=a.node,t=a.renderTransform,n=o.renderTransform;break;case c.StageArtboard:n=t=(o=a.node).renderTransform}r==O.default.Parent?n=o&&o.parent?o.parent.renderTransform:i.mat2d.create():r==O.default.World&&(n=i.mat2d.create()),this._XHandle.alignToTransform(t,n),this._YHandle.alignToTransform(t,n),this._ScaleXHandle.stage&&(this._ScaleXHandle.alignToTransform(t,n),this._ScaleYHandle.alignToTransform(t,n)),this._RotationHandle.stage&&this._RotationHandle.alignToTransform(t,n),this._TransformSpace[0]=n[0],this._TransformSpace[1]=n[1],this._TransformSpace[2]=n[2],this._TransformSpace[3]=n[3],this._TransformSpace[4]=t[4],this._TransformSpace[5]=t[5]}},{key:"startDrag",value:function(e,n){return(this._IsScaling=e===this._ScaleYHandle||e===this._ScaleXHandle)?e==this._ScaleXHandle?(this._ScaleModulation[0]=1,this._ScaleModulation[1]=0):e==this._ScaleYHandle&&(this._ScaleModulation[0]=0,this._ScaleModulation[1]=1):(this._IsRotating=e===this._RotationHandle)?this._RotationHandle.lockAngle():e!=this._XHandle&&e!=this._YHandle||(this._LockToAxis=e),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startDrag",this).call(this,e,n)}},{key:"endDrag",value:function(){this._IsRotating&&(this._RotationHandle.unlockAngle(),this._RotationHandle.sliceAngle=0),this._LockToAxis=!1,o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"endDrag",this).call(this)}},{key:"advanceDrag",value:function(e,n,r,a){if(this._LockToAxis){var s=this._LockToAxis.renderTransform,l=i.mat2d.invert(i.mat2d.create(),s);(n=i.vec2.transformMat2(i.vec2.create(),n,l))[0]=0,i.vec2.transformMat2(n,n,s)}o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"advanceDrag",this).call(this,e,n,r,a)}},{key:"onKeyDown",value:function(e){this.snap=e.shiftKey}},{key:"onKeyUp",value:function(e){this.snap=e.shiftKey}},{key:"disable",value:function(){this._XHandle.stage&&(this._XHandle.removeFromStage(),this._YHandle.removeFromStage(),this._ScaleXHandle.removeFromStage(),this._ScaleYHandle.removeFromStage(),this._RotationHandle.removeFromStage()),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}},{key:"transformers",get:function(){return this._IsScaling?[M.default]:this._IsRotating?[R.default]:[C.default,E.default,I.default,T.default,j.default,A.default,D.default]}},{key:"handle",get:function(){return this._IsRotating?this._RotationHandle:this._LockToAxis||this._XHandle}},{key:"modulation",get:function(){return this._ScaleModulation}},{key:"transformSpace",get:function(){return this._TransformSpace}}]),t}();t.default=F},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=l(n(236)),i=n(302),a=l(n(218)),s=n(7);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Stage=t;for(var r=this._Paths=new Set,o=[],s=0;s<n.length;s++){var l=n[s];switch(l.constructor){case i.StagePathControlIn:case i.StagePathControlOut:if(-1!==n.indexOf(l.node.stageItem))continue;if((l.node.pointType===a.default.Mirror||l.node.pointType===a.default.Asymmetric)&&-1!==n.indexOf(l.sibling))continue}o.push(l),r.add(l.node.parent)}this._Vertices=o}return r(e,[{key:"advance",value:function(t,n,r,o){e.translate(this._Vertices,n);var i=!0,a=!1,s=void 0;try{for(var l,u=this._Paths[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){l.value.triggerAutoKeyPath()}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}},{key:"complete",value:function(){}}],[{key:"translate",value:function(e,t){var n=s.vec2.create(),r=!0,l=!1,u=void 0;try{for(var c,d=e[Symbol.iterator]();!(r=(c=d.next()).done);r=!0){var f=c.value;switch(f.worldTranslation=s.vec2.add(n,f.worldTranslation,t),f.constructor){case o.default:f.node.pointType!==a.default.Straight&&(f.controlIn.worldTranslation=s.vec2.add(n,f.controlIn.worldTranslation,t),f.controlOut.worldTranslation=s.vec2.add(n,f.controlOut.worldTranslation,t));break;case i.StagePathControlIn:case i.StagePathControlOut:switch(f.node.pointType){case a.default.Mirror:var h=s.vec2.subtract(s.vec2.create(),f.node.translation,f.pointTranslation);f.sibling.pointTranslation=s.vec2.add(h,h,f.node.translation);break;case a.default.Asymmetric:var p=s.vec2.subtract(s.vec2.create(),f.node.translation,f.pointTranslation),y=s.vec2.subtract(s.vec2.create(),f.node.translation,f.sibling.pointTranslation),v=s.vec2.length(y);s.vec2.normalize(p,p),f.sibling.pointTranslation=s.vec2.add(p,s.vec2.scale(p,p,v),f.node.translation)}}}}catch(e){l=!0,u=e}finally{try{!r&&d.return&&d.return()}finally{if(l)throw u}}}}]),e}();t.default=u,u.make=function(e,t){for(var n=[],r=0;r<t.length;r++){var a=t[r];switch(a.constructor){case i.StagePathControlIn:case i.StagePathControlOut:case o.default:n.push(a)}}if(0!=n.length)return new u(e.stage,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=I(n(329)),s=n(7),l=I(n(1148)),u=I(n(171)),c=I(n(1149)),d=I(n(2)),f=I(n(173)),h=I(n(237)),p=I(n(228)),y=I(n(328)),v=I(n(375)),m=I(n(225)),g=I(n(335)),b=I(n(336)),k=I(n(198)),S=I(n(303)),O=I(n(332)),w=I(n(289)),_=I(n(337)),P=I(n(203)),C=I(n(197)),E=I(n(254)),T=I(n(300));function I(e){return e&&e.__esModule?e:{default:e}}function j(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var A=(j((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Translation=s.vec2.create(),n._Origin=s.vec2.create(),n._Width=1024,n._Height=768,n._DependencyGraph=null,n._AreDependenciesDirty=!0,n._DrawOrder=new c.default,n._ClipContents=!0,n._RenderPathDirty=!0,n._RenderPath=null,n._Animations=[],n._PlayingAnimations=[],n._Color=new Float32Array([93/255,93/255,93/255,1]),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"isStable",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this._Animations[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){if(!r.value.isStable)return!1}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}return!0}},{key:"addPlayingAnimation",value:function(e){-1===this._PlayingAnimations.indexOf(e)&&(this._PlayingAnimations.push(e),this.dispatch("play"))}},{key:"removePlayingAnimation",value:function(e){var t=this._PlayingAnimations.indexOf(e);-1!==t&&(this._PlayingAnimations.splice(t,1),this.dispatch("play"))}},{key:"stopAnimations",value:function(){for(var e=this._PlayingAnimations.length-1;e>=0;e--)this._PlayingAnimations[e].isPlaying=!1;this._PlayingAnimations.length=0}},{key:"createAnimation",value:function(){var e=new E.default(this);return e.read(this,{name:"Untitled"}),this.addAnimation(e,!1,0)}},{key:"onAnimationRenamed",value:function(){this.dispatch("animationRenamed")}},{key:"onAnimationOrderChanged",value:function(){this.dispatch("animationListChanged")}},{key:"addAnimation",value:function(e,t,n){return e.addEventListener("nameChanged",this.onAnimationRenamed),e.addEventListener("orderChange",this.onAnimationOrderChanged),void 0===n?this._Animations.push(e):this._Animations.splice(n,0,e),t||(this.actor.revise(),this.dispatch("animationListChanged")),e}},{key:"importAnimations",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=new E.default(this);s.read(this,a),this.addAnimation(s,!0)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.dispatch("animationListChanged")}},{key:"removeAnimations",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.removeAnimation(a)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"removeAnimation",value:function(e){var t=this._Animations.indexOf(e);-1!=t&&this._Animations.splice(t,1),e.setActor(null),e.removeEventListener("nameChanged",this.onAnimationRenamed),e.removeEventListener("orderChange",this.onAnimationOrderChanged),this.dispatch("animationListChanged"),this.actor.revise()}},{key:"duplicateAnimations",value:function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;t.push(this.duplicateAnimation(s))}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return t}},{key:"duplicateAnimation",value:function(e){var t=new E.default(this);this.actor.registerNodeLookup();var n=e.serialize();return delete n.id,n.name=e.name+" Duplicate",t.read(this,n),this.actor.clearNodeLookup(),this.addAnimation(t,!1,0)}},{key:"removeAnimatedProperty",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this._Animations[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.getKeyedNode(e);s&&s.removeProperty(t)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}},{key:"makeMain",value:function(){this._Parent&&(this._Parent.main=this)}},{key:"makeActive",value:function(){this._Parent&&(this._Parent.active=this)}},{key:"isPointInside",value:function(e,t){var n=this.translation,r=this.width,o=this.height;return e>=n[0]&&t>=n[1]&&e<=n[0]+r&&t<=n[1]+o}},{key:"onChildAdded",value:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildAdded",this).call(this,e);var n=this.root;e instanceof a.default?e.all(function(e){e.root=n}):e.root=n}},{key:"onChildRemoved",value:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildRemoved",this).call(this,e),e instanceof a.default?e.all(function(e){e.root=null}):e.root=null}},{key:"updateDrawOrder",value:function(){this._DrawOrder.updateDrawOrder()}},{key:"onDirty",value:function(e){this._RenderPathDirty=!0}},{key:"onRenamed",value:function(e,t){this._Actor.forceRedraw()}},{key:"markTransformDirty",value:function(){var e=this.root;if(e){var t=e._DependencyGraph;t&&t.addDirt(this,1)&&t.addDirtRecursive(this,2)}}},{key:"localTransform",value:function(e){var t=this.originWorld,n=s.mat2d.clone(e);return n[4]-=t[0],n[5]-=t[1],n}},{key:"localTranslation",value:function(e){var t=this.originWorld;return s.vec2.subtract(s.vec2.create(),e,t)}},{key:"renderTranslation",value:function(e){var t=this.originWorld;return s.vec2.add(s.vec2.create(),e,t)}},{key:"calculateWorldTransform",value:function(){return s.mat2d.create()}},{key:"read",value:function(e,n){var r=this;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var o=n.translation;o&&o.constructor===Array&&2==o.length&&(this._Translation[0]=o[0],this._Translation[1]=o[1]),(o=n.origin)&&o.constructor===Array&&2==o.length&&(this._Origin[0]=o[0],this._Origin[1]=o[1]),(o=n.width)&&(this._Width=Math.max(0,Number.parseFloat(o)||0)),(o=n.height)&&(this._Height=Math.max(0,Number.parseFloat(o)||0)),void 0!==(o=n.clipContents)&&(this._ClipContents=!!o),(o=n.color)&&o.constructor===Array&&4==o.length&&(this._Color[0]=o[0],this._Color[1]=o[1],this._Color[2]=o[2],this._Color[3]=o[3]),e.whenNodesLoaded(function(){var e=n.animations;e&&r.importAnimations(e)})}},{key:"serializeProperties",value:function(e){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.animations=this._Animations.map(function(e){return e.serialize()}),n}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.translation=s.vec2.clone(this._Translation),e.origin=s.vec2.clone(this._Origin),e.width=this._Width,e.height=this._Height,e.color=new Float32Array(this._Color),e.clipContents=this._ClipContents,e}},{key:"update",value:function(e,t){this.dispatch("worldTransform")}},{key:"updateDependencies",value:function(){var e=new l.default(this);this._DependencyGraph=e,this._AreDependenciesDirty=!1;var t=this.children,n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.updateDependencies(e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return this.dispatch("dependenciesUpdate"),e.sort()}},{key:"markDependenciesDirty",value:function(){this._AreDependenciesDirty=!0}},{key:"updateGraph",value:function(){var e=this._DependencyGraph;return!(!e||!e.update())}},{key:"advance",value:function(e,t,n,r){var o=this,i=!1;if(this._AreDependenciesDirty){i=!0;var a=function(e){if(!o.updateDependencies()&&r.undo())return r.removeRestOfJournal(),r.alert({title:"Cyclic Dependency.",message:"The last operation caused a cyclic dependency and has been reverted.",type:u.default.Types.Default,buttons:[]}),"continue";var t=0;return o.eachChildRecursive(function(e){e.treeIndex=t,t++}),"break"};e:for(var s=0;s<10;s++){switch(a()){case"continue":continue;case"break":break e}}}var l=this._DependencyGraph;if(t){for(var c=!1,d=this._PlayingAnimations.slice(0),f=[],h=0;h<d.length;h++){var p=d[h];p===t&&(c=!0),p.advance(e,n&&p===t)&&f.push({animation:p,mix:1,position:p.position})}c||t.advance(e,n)&&f.push({animation:t,mix:1,position:t.position}),f.length&&this.updateAnimations(f),0===this._PlayingAnimations.length&&this._IsKeyStateDirty&&(this._IsKeyStateDirty=!1,this.eachChildRecursive(function(e){e._IsKeyStateDirty&&(e._IsKeyStateDirty=!1,e.dispatch("keyState"))}))}return l&&l.update()&&(i=!0),this._DrawOrder.advance()&&(i=!0),this._ChildrenChanged&&(this._ChildrenChanged=!1,this.dispatch("childrenChanged",this)),i}},{key:"clip",value:function(e){this.clipContents&&e.skCanvas.clipPath(this.getPath(e),e.canvasKit.ClipOp.Intersect,!0)}},{key:"getPath",value:function(e){var t=this._RenderPathDirty,n=this._RenderPath;if(!t)return n;n?n.rewind():this._RenderPath=n=e.makePath(),this._RenderPathDirty=!1;var r=this.translation,o=this.width,i=this.height;return n.addRect(r[0],r[1],r[0]+o,r[1]+i),n}},{key:"updateAnimations",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.animation.interpolate(a.position)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.eachChildRecursive(function(t){var n=t instanceof f.default,r=n,o=n,i=!1,a=!1,s=!1,l=!1,u=!1,c=!1,d=!1,T=!1,I=t instanceof h.default,j=t instanceof p.default;switch(t instanceof y.default&&(o=!1,r=!1,c=!0),t.constructor){case v.default:o=!1,r=!1;break;case w.default:d=!0,r=!1,o=!1;break;case _.default:case S.default:r=!1,o=!1;break;case k.default:i=!0,t.parent.constructor===k.default&&(r=!1);break;case m.default:l=!0;break;case C.default:u=!0,a=!0;break;case P.default:a=!0,s=!0,T=t.asset instanceof O.default}I&&(t.frameActiveChild=t.rigActiveChild),r&&(t.framePosX=t.rigTranslation[0],t.framePosY=t.rigTranslation[1]),o&&(t.frameScaleX=t.rigScale[0],t.frameScaleY=t.rigScale[1],t.frameRotation=t.rigRotation,t.frameOpacity=t.rigOpacity),T&&(t.frameSequence=t.rigSequence);var A=null,D=null;a&&(t.frameDrawOrder=t.rigDrawOrder),i&&(t.frameLength=t.rigLength),c&&(t.frameStrength=t.rigStrength);for(var R=0;R<e.length;R++){var M=e[R],x=M.animation.getKeyedNode(t),F=M.mix;if(0!=F&&x){var L=x.props,N=void 0;if(d)switch(t.propertyType){case w.default.Type.Integer:if(N=L.frameIntValue){var z=F;t.frameIntValue=1==z?N.frameValue:t.frameIntValue*(1-z)+N.frameValue*z}break;case w.default.Type.Float:if(N=L.frameFloatValue){var V=F;t.frameFloatValue=1==V?N.frameValue:t.frameFloatValue*(1-V)+N.frameValue*V}break;case w.default.Type.String:(N=L.frameStringValue)&&(t.frameStringValue=N.frameValue);break;case w.default.Type.Boolean:(N=L.frameBooleanValue)&&(t.frameBooleanValue=N.frameValue)}if(I&&(N=L.frameActiveChild)&&(t.frameActiveChild=N.frameValue),r){if(N=L.framePosX){var B=F;t.framePosX=1==B?N.frameValue:t.framePosX*(1-B)+N.frameValue*B}if(N=L.framePosY){var H=F;t.framePosY=1==H?N.frameValue:t.framePosY*(1-H)+N.frameValue*H}}if(T&&(N=L.frameSequence)){var W=F;t.frameSequence=1==W?N.frameValue:t.frameSequence*(1-W)+N.frameValue*W}if(N=L.frameScaleX){var K=F;t.frameScaleX=1==K?N.frameValue:t.frameScaleX*(1-K)+N.frameValue*K}if(N=L.frameScaleY){var G=F;t.frameScaleY=1==G?N.frameValue:t.frameScaleY*(1-G)+N.frameValue*G}if(N=L.frameRotation){var U=F;t.frameRotation=1==U?N.frameValue:t.frameRotation*(1-U)+N.frameValue*U}if(N=L.frameOpacity){var X=F;t.frameOpacity=1==X?N.frameValue:t.frameOpacity*(1-X)+N.frameValue*X}if(c&&(N=L.frameStrength)){var Y=F;t.frameStrength=1==Y?N.frameValue:t.frameStrength*(1-Y)+N.frameValue*Y}if(i&&(N=L.frameLength)){var J=F;t.frameLength=1==J?N.frameValue:t.frameLength*(1-J)+N.frameValue*J}if(l)if(N=L.framePathVertices)1==F&&(A=N.frameValue);if(s)if(N=L.frameImageVertices)1==F&&(D=N.frameValue);if(u){if(N=L.frameFillColor){var q=F;t.frameFillColor=1==q?N.frameValue:E.default.InterpolateFloat32Array(t.frameFillColor,N.frameValue,q)}if(N=L.frameFillGradient){var Q=F;t.frameFillGradient=1==Q?N.frameValue:E.default.InterpolateFloat32Array(t.frameFillGradient,N.frameValue,Q)}if(N=L.frameFillRadial){var Z=F;t.frameFillRadial=1==Z?N.frameValue:E.default.InterpolateFloat32Array(t.frameFillRadial,N.frameValue,Z)}if(N=L.frameStrokeColor){var $=F;t.frameStrokeColor=1==$?N.frameValue:E.default.InterpolateFloat32Array(t.frameStrokeColor,N.frameValue,$)}if(N=L.frameStrokeGradient){var ee=F;t.frameStrokeGradient=1==ee?N.frameValue:E.default.InterpolateFloat32Array(t.frameStrokeGradient,N.frameValue,ee)}if(N=L.frameStrokeRadial){var te=F;t.frameStrokeRadial=1==te?N.frameValue:E.default.InterpolateFloat32Array(t.frameStrokeRadial,N.frameValue,te)}if(N=L.frameStrokeWidth){var ne=F;t.frameStrokeWidth=1==ne?N.frameValue:t.frameStrokeWidth*(1-ne)+N.frameValue*ne}if(N=L.frameStrokeStart){var re=F;t.frameStrokeStart=1==re?N.frameValue:t.frameStrokeStart*(1-re)+N.frameValue*re}if(N=L.frameStrokeEnd){var oe=F;t.frameStrokeEnd=1==oe?N.frameValue:t.frameStrokeEnd*(1-oe)+N.frameValue*oe}if(N=L.frameStrokeOffset){var ie=F;t.frameStrokeOffset=1==ie?N.frameValue:t.frameStrokeOffset*(1-ie)+N.frameValue*ie}if(N=L.frameStrokeOpacity){var ae=F;t.frameStrokeOpacity=1==ae?N.frameValue:t.frameStrokeOpacity*(1-ae)+N.frameValue*ae}if(N=L.frameFillOpacity){var se=F;t.frameFillOpacity=1==se?N.frameValue:t.frameFillOpacity*(1-se)+N.frameValue*se}}if(j){if(N=L.frameWidth){var le=F;t.frameWidth=1==le?N.frameValue:t.frameWidth*(1-le)+N.frameValue*le}if(N=L.frameHeight){var ue=F;t.frameHeight=1==ue?N.frameValue:t.frameHeight*(1-ue)+N.frameValue*ue}}if(t.constructor===g.default&&(N=L.frameCornerRadius)){var ce=F;t.frameCornerRadius=1==ce?N.frameValue:t.frameCornerRadius*(1-ce)+N.frameValue*ce}if(t.constructor===b.default&&(N=L.frameInnerRadius)){var de=F;t.frameInnerRadius=1==de?N.frameValue:t.frameInnerRadius*(1-de)+N.frameValue*de}}}D&&(t.frameImageVertices=D),A&&(t.framePathVertices=A)});for(var s=0;s<e.length;s++){var l=e[s],u=l.animation.getKeyedNode(E.default.OrderObject);if(u){var c=l.mix;u.props.frameDrawOrder;if(0!=c){var d=u.props.frameDrawOrder.frameValue;for(var T in d){var I=d[T];I.obj.frameDrawOrder=I.v}}}}this.dispatch("frameUpdated")}},{key:"fitToContent",value:function(){this.markDependenciesDirty(),this.advance(0);var e=void 0;this.eachChildRecursive(function(t){var n=t.stageItem;if(n.isVisible&&n.updateBounds){n.onTransformed&&n.onTransformed(),n.updateBounds();var r=n.aabb;r.boxHeight>0&&(e?e.combine(r):(e=new T.default).set(r.min,r.max))}}),e&&(e.min[0]-=this._Translation[0]+this._Origin[0]*this._Width,e.min[1]-=this._Translation[1]+this._Origin[1]*this._Height,e.max[0]-=this._Translation[0]+this._Origin[0]*this._Width,e.max[1]-=this._Translation[1]+this._Origin[1]*this._Height,this.origin=[-e.min[0]/e.boxWidth,-e.min[1]/e.boxHeight],this.height=e.boxHeight,this.width=e.boxWidth)}},{key:"animations",get:function(){return this._Animations},set:function(e){this._Animations=e,this.dispatch("animationListChanged")}},{key:"orderedAnimations",get:function(){return this._Animations.slice(0).sort(function(e,t){return e.order-t.order})}},{key:"hasPlayingAnimations",get:function(){return this._PlayingAnimations.length>0}},{key:"drawOrder",get:function(){return this._DrawOrder}},{key:"isMain",get:function(){return this._Parent&&this._Parent._Main===this}},{key:"isActive",get:function(){return this._Parent&&this._Parent._Active===this}},{key:"root",get:function(){return this}},{key:"isRoot",get:function(){return!0}},{key:"dependencyGraph",get:function(){return this._DependencyGraph}},{key:"uiHierIconClass",get:function(){return"HierarchyCharIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionNodeIcon"}},{key:"uiIcon",get:function(){return"icon-artboard"}},{key:"typeName",get:function(){return"Artboard"}},{key:"translation",get:function(){return this._Translation},set:function(e){s.vec2.isEqual(this._Translation,e)||(s.vec2.copy(this._Translation,e),this.markTransformDirty(),this.dispatch("transformPropChange"))}},{key:"origin",get:function(){return this._Origin},set:function(e){s.vec2.isEqual(this._Origin,e)||(s.vec2.copy(this._Origin,e),this.markTransformDirty(),this.dispatch("transformPropChange"))}},{key:"graph",get:function(){return this._Graph}},{key:"width",get:function(){return this._Width},set:function(e){this._Width=e,this.dispatch("transformPropChange"),this.markTransformDirty(),this._Actor.forceRedraw()}},{key:"height",get:function(){return this._Height},set:function(e){this._Height=e,this.dispatch("transformPropChange"),this.markTransformDirty(),this._Actor.forceRedraw()}},{key:"clipContents",get:function(){return this._ClipContents},set:function(e){this._ClipContents=e,this._Actor.forceRedraw(),this.dispatch("clipContentsChanged")}},{key:"color",get:function(){return this._Color},set:function(e){var t=this._Color;s.vec4.exactEquals(t,e)||(s.vec4.copy(t,e),this._Actor.forceRedraw(),this.dispatch("colorChanged"))}},{key:"cssColor",get:function(){var e=this._Color;return"rgba("+Math.round(255*e[0])+", "+Math.round(255*e[1])+", "+Math.round(255*e[2])+", "+e[3]+")"}},{key:"renderOpacity",get:function(){return 1}},{key:"renderCollapsed",get:function(){return!1}},{key:"rawWorldTransform",get:function(){return s.mat2d.fromValues(1,0,0,1,this._Translation[0]+this._Width*this._Origin[0],this._Translation[1]+this._Height*this._Origin[1])}},{key:"originWorld",get:function(){return s.vec2.fromValues(this._Translation[0]+this._Width*this._Origin[0],this._Translation[1]+this._Height*this._Origin[1])}},{key:"worldTransform",get:function(){return s.mat2d.create()}},{key:"renderTransform",get:function(){return this.rawWorldTransform}},{key:"aabb",get:function(){var e=this.width,t=this.height,n=this._Origin,r=-e*n[0],o=-t*n[1],i=new T.default;return i.set([r,o],[r+e,o+t]),i}}]),t}()).prototype,"onAnimationRenamed",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onAnimationRenamed"),r.prototype),j(r.prototype,"onAnimationOrderChanged",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onAnimationOrderChanged"),r.prototype),r);t.default=A},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(221),a=(r=i)&&r.__esModule?r:{default:r};var s=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._X1=void 0===t?.42:t,this._Y1=void 0===t?0:n,this._X2=void 0===t?.58:r,this._Y2=void 0===t?1:o,this._Bezier=(0,a.default)(this._X1,this._Y1,this._X2,this._Y2)}return o(e,[{key:"setIn",value:function(e,t){this._X1=e,this._Y1=t,this._Bezier=(0,a.default)(this._X1,this._Y1,this._X2,this._Y2)}},{key:"setOut",value:function(e,t){this._X2=e,this._Y2=t,this._Bezier=(0,a.default)(this._X1,this._Y1,this._X2,this._Y2)}},{key:"getEasedMix",value:function(e){return this._Bezier(e)}},{key:"serialize",value:function(e){e.curve=[this._X1,this._Y1,this._X2,this._Y2]}},{key:"deserialize",value:function(e){var t=e.curve;t&&4===t.length&&(this._X1=t[0],this._Y1=t[1],this._X2=t[2],this._Y2=t[3],this._Bezier=(0,a.default)(this._X1,this._Y1,this._X2,this._Y2))}},{key:"x1",get:function(){return this._X1}},{key:"x2",get:function(){return this._X2}},{key:"y1",get:function(){return this._Y1}},{key:"y2",get:function(){return this._Y2}}],[{key:"makeEasyEase",value:function(){return new e(.25,.1,.25,1)}},{key:"makeEaseIn",value:function(){return new e(.42,0,1,1)}},{key:"makeEaseOut",value:function(){return new e(0,0,.58,1)}},{key:"ID",get:function(){return 2}},{key:"label",get:function(){return"Cubic"}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=m(n(1)),l=m(n(2)),u=m(n(28)),c=m(n(667)),d=m(n(1155)),f=m(n(1156)),h=m(n(1157)),p=n(7),y=m(n(19)),v=m(n(431));function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function S(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var O=[1,1,1,1],w=[1,0,0,1],_=(S((r=function(e){function t(e){g(this,t);var n=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={open:!1,hsv:p.vec3.create(),left:0,top:0,stops:[p.vec4.create()],mode:t.Mode.Solid,stopIndex:0},n.lastRGBA=null,n}return k(t,s.default.Component),a(t,[{key:"componentWillUnmount",value:function(){window.removeEventListener("mouseup",this.close,!0),window.removeEventListener("mousemove",this.dragGrabber,!0),window.removeEventListener("mouseup",this.releaseGrabber,!0),window.removeEventListener("mousemove",this.dragHueGrabber,!0)}},{key:"receiveColor",value:function(e){var n=this.state.mode;switch(e.constructor===Object&&(e.type!==this.state.mode&&this.setState({mode:e.type}),n=e.type,e=e.value),n){case t.Mode.Solid:break;case t.Mode.LinearGradient:case t.Mode.RadialGradient:var r=5*this.state.stopIndex;e=[e[r++],e[r++],e[r++],e[r++]]}this.lastRGBA&&p.vec4.exactEquals(e,this.lastRGBA)||this.setToRGBA(e)}},{key:"componentWillMount",value:function(){var e=this.props.color;e.value?this.receiveColor(e):this.receiveColor(w)}},{key:"componentWillReceiveProps",value:function(e){var t=e.color;t.value?this.receiveColor(t):this.receiveColor(w)}},{key:"notifyChange",value:function(e){this.wasNotifySilent=e;var n=this.lastRGBA,r=this.state,o=r.mode,i=r.stopIndex,a={type:o};switch(o){case t.Mode.Solid:a.value=this.lastRGBA;break;default:for(var s=new Float32Array(this.props.color.value),l=5*i,u=0;u<n.length;u++)s[l++]=n[u];a.value=s}this.props.onColorChange&&this.props.onColorChange(a,e)}},{key:"setToRGBA",value:function(e,t){if(this.lastRGBA||(this.lastRGBA=new Float32Array([-1,-1,-1,-1])),3===e.length){if(void 0===t&&p.vec3.exactEquals(this.lastRGBA,e))return;p.vec3.copy(this.lastRGBA,e)}else{if(void 0===t&&p.vec4.exactEquals(this.lastRGBA,e))return;p.vec4.copy(this.lastRGBA,e)}var n={hsv:function(e,t,n){var r,o,i=Math.max(e,t,n),a=Math.min(e,t,n),s=i,l=i-a;if(o=0==i?0:l/i,i==a)r=0;else{switch(i){case e:r=(t-n)/l+(t<n?6:0);break;case t:r=(n-e)/l+2;break;case n:r=(e-t)/l+4}r/=6}return[r,o,s]}(e[0],e[1],e[2])};void 0!==t&&(n.stopIndex=t),this.setState(n)}},{key:"setToHSV",value:function(e){var t=E(e[0],e[1],e[2]);this.lastRGBA||(this.lastRGBA=new Float32Array(O)),p.vec3.copy(this.lastRGBA,t),this.setState({hsv:e})}},{key:"removeStop",value:function(e){var t=this.props.color,n=t.value,r=[],o=0,i=n.length/5;if(!(i<=2)){for(var a=0;a<i;a++){var s={r:n[o++],g:n[o++],b:n[o++],a:n[o++],p:n[o++]};a!==e&&r.push(s.r,s.g,s.b,s.a,s.p)}var l={type:t.type,value:new Float32Array(r)};this.setState({stopIndex:Math.max(0,Math.min(r.length/5-1,e))}),this.props.onColorChange&&this.props.onColorChange(l)}}},{key:"onKeyDown",value:function(e){if((!e.target||e.target.constructor!==HTMLInputElement)&&this.props.allowDelete)switch(e.keyCode){case 8:case 46:e.preventDefault(),e.stopPropagation(),this.removeStop(this.state.stopIndex)}}},{key:"open",value:function(e){e.preventDefault(),e.stopPropagation(),window.addEventListener("mouseup",this.close,!0),window.addEventListener("keydown",this.onKeyDown,!0);var t=u.default.findDOMNode(this.preview).getBoundingClientRect(),n={left:t.left,right:t.right,top:t.top,bottom:t.bottom},r=this.props.placementMarker;if(r){var o=u.default.findDOMNode(r).getBoundingClientRect();n.top=o.top,n.bottom=o.bottom,n.left=o.left,n.right=o.right}var i=void 0,a=void 0;i=window.innerHeight-n.bottom-0<371?n.top-0-371:n.bottom+0,a=window.innerWidth-n.left<200?n.right-200:n.left,this.setState({open:!0,left:a,top:i}),this.props.onOpened&&this.props.onOpened(this)}},{key:"selectGradientStop",value:function(e){this.setState({stopIndex:e})}},{key:"checkClose",value:function(){return!(this.props.checkClose&&!this.props.checkClose(this))&&(this.doClose(),!0)}},{key:"doClose",value:function(){window.removeEventListener("mouseup",this.close,!0),window.removeEventListener("keydown",this.onKeyDown,!0),this.setState({open:!1}),this.props.onClosed&&this.props.onClosed(this)}},{key:"close",value:function(e){if(!this.wasNotifySilent){for(var t=e.target;null!==t;t=t.parentNode)if(t===this.root)return;(0,y.default)(this.checkClose)}}},{key:"pressGrabber",value:function(e){e.preventDefault(),e.stopPropagation(),this.placeGrabber(e),window.addEventListener("mousemove",this.dragGrabber,!0),window.addEventListener("mouseup",this.releaseGrabber,!0),window.removeEventListener("mouseup",this.close,!0)}},{key:"dragGrabber",value:function(e){e.preventDefault(),e.stopPropagation(),this.placeGrabber(e)}},{key:"releaseGrabber",value:function(e){this.notifyChange(),e.preventDefault(),e.stopPropagation(),window.removeEventListener("mousemove",this.dragGrabber,!0),window.removeEventListener("mouseup",this.releaseGrabber,!0),window.removeEventListener("mousemove",this.dragHueGrabber,!0),window.addEventListener("mouseup",this.close,!0)}},{key:"placeGrabber",value:function(e){var t=u.default.findDOMNode(this.graph).getBoundingClientRect(),n=Math.min(1,Math.max(0,(e.clientX-t.left)/t.width)),r=Math.min(1,Math.max(0,1-(e.clientY-t.top)/t.height)),o=p.vec3.clone(this.state.hsv);o[1]=n,o[2]=r,this.setToHSV(o),this.notifyChange(!0)}},{key:"pressHueGrabber",value:function(e){e.preventDefault(),e.stopPropagation(),this.placeHueGrabber(e),window.addEventListener("mousemove",this.dragHueGrabber,!0),window.addEventListener("mouseup",this.releaseGrabber,!0)}},{key:"dragHueGrabber",value:function(e){e.preventDefault(),e.stopPropagation(),this.placeHueGrabber(e)}},{key:"placeHueGrabber",value:function(e){var t=u.default.findDOMNode(this.hueGraph).getBoundingClientRect(),n=Math.min(1,Math.max(0,(e.clientX-t.left)/t.width)),r=p.vec3.clone(this.state.hsv);r[0]=n,this.setToHSV(r),this.notifyChange(!0)}},{key:"setRoot",value:function(e){this.root=e}},{key:"setGraph",value:function(e){this.graph=e}},{key:"setStopsContainer",value:function(e){this.stopsContainer=e}},{key:"setHueGraph",value:function(e){this.hueGraph=e}},{key:"mouseDown",value:function(e){e.stopPropagation()}},{key:"setH",value:function(e,t){var n=p.vec3.clone(this.state.hsv);n[0]=e,this.setToHSV(n),this.notifyChange(t)}},{key:"setS",value:function(e,t){var n=p.vec3.clone(this.state.hsv);n[1]=e,this.setToHSV(n),this.notifyChange(t)}},{key:"setV",value:function(e,t){var n=p.vec3.clone(this.state.hsv);n[2]=e,this.setToHSV(n),this.notifyChange(t)}},{key:"setR",value:function(e,t){this.lastRGBA||(this.lastRGBA=new Float32Array(O));var n=new Float32Array(this.lastRGBA),r=parseInt(e);n[0]=Math.min(255,Math.max(0,Number.isNaN(r)?n[0]:r/255)),this.setToRGBA(n),this.notifyChange(t)}},{key:"setG",value:function(e,t){this.lastRGBA||(this.lastRGBA=new Float32Array(O));var n=new Float32Array(this.lastRGBA),r=parseInt(e);n[1]=Math.min(255,Math.max(0,Number.isNaN(r)?n[1]:r/255)),this.setToRGBA(n),this.notifyChange(t)}},{key:"setB",value:function(e,t){this.lastRGBA||(this.lastRGBA=new Float32Array(O));var n=new Float32Array(this.lastRGBA),r=parseInt(e);n[2]=Math.min(255,Math.max(0,Number.isNaN(r)?n[2]:r/255)),this.setToRGBA(n),this.notifyChange(t)}},{key:"setA",value:function(e,t){this.lastRGBA||(this.lastRGBA=new Float32Array(O));var n=new Float32Array(this.lastRGBA);n[3]=e,this.setToRGBA(n),this.notifyChange(t)}},{key:"setHex",value:function(e){try{var t=c.default.fromInputValue(e)||this.props.color;this.setToRGBA(t),this.notifyChange()}catch(e){}}},{key:"setPreview",value:function(e){this.preview=e}},{key:"setSolid",value:function(){this.changeMode(t.Mode.Solid)}},{key:"setLinear",value:function(){this.changeMode(t.Mode.LinearGradient)}},{key:"setRadial",value:function(){this.changeMode(t.Mode.RadialGradient)}},{key:"changeMode",value:function(e){var n={type:e};switch(e){case t.Mode.Solid:n.value=O;break;default:n.value=new Float32Array([1,1,1,1,0,0,0,0,1,1])}this.props.onColorChange&&this.props.onColorChange(n)}},{key:"pressStop",value:function(e){var t=this.props.color.value,n=5*e.props.index;this.setToRGBA([t[n++],t[n++],t[n++],t[n++]],e.props.index),window.addEventListener("mousemove",this.dragStop,!0),window.addEventListener("mouseup",this.releaseStop,!0)}},{key:"addStop",value:function(e){if(this.props.allowDelete){e.preventDefault(),e.stopPropagation();for(var t=u.default.findDOMNode(this.stopsContainer).getBoundingClientRect(),n=Math.min(1,Math.max(0,(e.clientX-t.left)/t.width)),r=this.props.color,o=r.value,i=this.state.stopIndex,a=[],s=0,l=o.length/5,c=null,d=null,f=0;f<l;f++){var h={r:o[s++],g:o[s++],b:o[s++],a:o[s++],p:o[s++]};if(null===c&&h.p>n){if(!d)return;var p=(n-d.p)/(h.p-d.p),y=1-p;c={r:d.r*y+h.r*p,g:d.g*y+h.g*p,b:d.b*y+h.b*p,a:d.a*y+h.a*p,p:n},i=a.length/5,a.push(c.r,c.g,c.b,c.a,c.p)}a.push(h.r,h.g,h.b,h.a,h.p),d=h}var v={type:r.type,value:new Float32Array(a)};this.setState({stopIndex:i}),this.props.onColorChange&&this.props.onColorChange(v),window.addEventListener("mousemove",this.dragStop,!0),window.addEventListener("mouseup",this.releaseStop,!0)}}},{key:"dragStop",value:function(e){for(var t=u.default.findDOMNode(this.stopsContainer).getBoundingClientRect(),n=Math.min(1,Math.max(0,(e.clientX-t.left)/t.width)),r=this.props.color,o=r.value,i=this.state.stopIndex,a=[],s=0,l=o.length/5,c=null,d=0;d<l;d++){var f={r:o[s++],g:o[s++],b:o[s++],a:o[s++],p:o[s++]};a.push(f),d===i&&(f.p=n,c=f)}a.sort(function(e,t){return e.p-t.p});for(var h=[],p=i,y=0;y<l;y++){var v=a[y];v.r===c.r&&v.g===c.g&&v.b===c.b&&v.a===c.a&&v.p===c.p&&(p=y),h.push(v.r,v.g,v.b,v.a,v.p)}var m={type:r.type,value:new Float32Array(h)};p!==i&&this.setState({stopIndex:p}),this.props.onColorChange&&this.props.onColorChange(m)}},{key:"releaseStop",value:function(e){window.removeEventListener("mousemove",this.dragStop,!0),window.removeEventListener("mouseup",this.releaseStop,!0)}},{key:"setHexInput",value:function(e){this.hexInput=e,this.hexInput&&this.hexInput.focus()}},{key:"render",value:function(){var e=this.state.hsv,n=E(e[0],e[1],e[2]).map(function(e){return Math.round(255*e)}),r=E(e[0],1,1).map(function(e){return Math.round(255*e)}),o="rgb("+n.join(",")+")",i="rgb("+r.join(",")+")",a=o,l=c.default.toDisplayValue(n),u=this.state,p=u.left,y=u.top,m=u.mode,g=null,b=null;if(m!==t.Mode.Solid){var k=this.props.color.value,S=k.length/5,O=[];b=[];for(var w=0,_=0;_<S;_++){var T=Math.round(255*k[w++]),I=Math.round(255*k[w++]),j=Math.round(255*k[w++]),A=k[w++],D=k[w++];O.push("rgba("+T+","+I+","+j+","+A+") "+100*D+"%"),b.push(s.default.createElement(P,{index:_,isActive:_===this.state.stopIndex,key:_,r:T,g:I,b:j,a:A,p:D,pressStop:this.pressStop}))}g="linear-gradient(to right, "+O.join(",")+")",a="linear-gradient(to bottom, "+O.join(",")+")"}var R=!1===this.props.color.value;return(this.props.isEmpty||R)&&(a="rgba(0,0,0,0)"),s.default.createElement("div",{ref:this.setRoot,className:"ClrPck",onMouseDown:this.mouseDown},s.default.createElement("div",{ref:this.setPreview,className:"ClrPckPrv",style:{background:a},onMouseDown:this.props.disabled?null:this.open}),s.default.createElement("div",{className:"ClrPckMenu",style:{display:this.state.open?null:"none",left:p+"px",top:y+"px"}},this.props.allowChangeType?s.default.createElement("div",{className:"ClrPckOp"},s.default.createElement("div",{className:"ClrPckOpSolid"+(m===t.Mode.Solid?" ClrPckOpSelected":""),onClick:this.setSolid}),s.default.createElement("div",{className:"ClrPckOpLinear"+(m===t.Mode.LinearGradient?" ClrPckOpSelected":""),onClick:this.setLinear}),s.default.createElement("div",{className:"ClrPckOpRadial"+(m===t.Mode.RadialGradient?" ClrPckOpSelected":""),onClick:this.setRadial})):null,m===t.Mode.Solid?null:s.default.createElement("div",{className:"ClrPckGradientOp"},s.default.createElement("div",{className:"ClrPckGradientBG"}),s.default.createElement("div",{className:"ClrPckGradient",style:{background:g}},s.default.createElement("div",{ref:this.setStopsContainer,className:"ClrPckGradientStops",onMouseDown:this.addStop},b))),s.default.createElement("div",{ref:this.setGraph,className:"ClrPckSVGraph",style:{background:i},onMouseDown:this.pressGrabber},s.default.createElement("div",{className:"ClrPckSVLighten"}),s.default.createElement("div",{className:"ClrPckSVDarken"}),s.default.createElement("div",{className:"ClrPckSVGrabber",style:{left:100*e[1]+"%",top:100*(1-e[2])+"%"}},s.default.createElement("div",{style:{background:o}},s.default.createElement("div",null)))),s.default.createElement("div",{ref:this.setHueGraph,className:"ClrPckHGraph",onMouseDown:this.pressHueGrabber},s.default.createElement("div",{className:"ClrPckHGrabber",style:{left:100*e[0]+"%",background:i}})),s.default.createElement("div",{className:"ClrPckInput"},s.default.createElement("div",null,s.default.createElement("div",null,"H"),s.default.createElement(v.default,{converter:h.default,value:!R&&e[0],onValueChanged:this.setH,onValueCommit:this.notifyChange}),s.default.createElement("div",null,"S"),s.default.createElement(v.default,{converter:d.default,value:!R&&e[1],onValueChanged:this.setS,onValueCommit:this.notifyChange}),s.default.createElement("div",null,"B"),s.default.createElement(v.default,{converter:d.default,value:!R&&e[2],onValueChanged:this.setV,onValueCommit:this.notifyChange})),s.default.createElement("div",null,s.default.createElement("div",null,"R"),s.default.createElement(v.default,{converter:f.default,value:!R&&n[0],onValueChanged:this.setR,onValueCommit:this.notifyChange}),s.default.createElement("div",null,"G"),s.default.createElement(v.default,{converter:f.default,value:!R&&n[1],onValueChanged:this.setG,onValueCommit:this.notifyChange}),s.default.createElement("div",null,"B"),s.default.createElement(v.default,{converter:f.default,value:!R&&n[2],onValueChanged:this.setB,onValueCommit:this.notifyChange})),s.default.createElement("div",null,s.default.createElement("div",null,"Hex"),s.default.createElement(C,{ref:this.setHexInput,className:"ClrPckInputLong",value:R?"":l||"",onChange:this.setHex}),s.default.createElement("div",null,"A"),s.default.createElement(v.default,{converter:d.default,value:!R&&this.lastRGBA[3],onValueChanged:this.setA,onValueCommit:this.notifyChange})))))}}]),t}()).prototype,"notifyChange",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"notifyChange"),r.prototype),S(r.prototype,"onKeyDown",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyDown"),r.prototype),S(r.prototype,"open",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"open"),r.prototype),S(r.prototype,"checkClose",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"checkClose"),r.prototype),S(r.prototype,"close",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"close"),r.prototype),S(r.prototype,"pressGrabber",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"pressGrabber"),r.prototype),S(r.prototype,"dragGrabber",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"dragGrabber"),r.prototype),S(r.prototype,"releaseGrabber",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"releaseGrabber"),r.prototype),S(r.prototype,"pressHueGrabber",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"pressHueGrabber"),r.prototype),S(r.prototype,"dragHueGrabber",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"dragHueGrabber"),r.prototype),S(r.prototype,"setRoot",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setRoot"),r.prototype),S(r.prototype,"setGraph",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setGraph"),r.prototype),S(r.prototype,"setStopsContainer",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setStopsContainer"),r.prototype),S(r.prototype,"setHueGraph",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setHueGraph"),r.prototype),S(r.prototype,"mouseDown",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),S(r.prototype,"setH",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setH"),r.prototype),S(r.prototype,"setS",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setS"),r.prototype),S(r.prototype,"setV",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setV"),r.prototype),S(r.prototype,"setR",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setR"),r.prototype),S(r.prototype,"setG",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setG"),r.prototype),S(r.prototype,"setB",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setB"),r.prototype),S(r.prototype,"setA",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setA"),r.prototype),S(r.prototype,"setHex",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setHex"),r.prototype),S(r.prototype,"setPreview",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setPreview"),r.prototype),S(r.prototype,"setSolid",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setSolid"),r.prototype),S(r.prototype,"setLinear",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setLinear"),r.prototype),S(r.prototype,"setRadial",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setRadial"),r.prototype),S(r.prototype,"pressStop",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"pressStop"),r.prototype),S(r.prototype,"addStop",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"addStop"),r.prototype),S(r.prototype,"dragStop",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"dragStop"),r.prototype),S(r.prototype,"releaseStop",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"releaseStop"),r.prototype),S(r.prototype,"setHexInput",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setHexInput"),r.prototype),r);t.default=_;var P=(S((o=function(e){function t(){return g(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return k(t,s.default.Component),a(t,[{key:"mouseDown",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.pressStop(this)}},{key:"render",value:function(){var e=this.props,t=e.isActive,n=e.r,r=e.g,o=e.b,i=e.a,a=e.p;return s.default.createElement("div",{className:t?"ClrPckHGrabber":"ClrPckStopGrabber",style:{left:100*a+"%",background:t?"rgba("+n+","+r+","+o+","+i+")":null},onMouseDown:this.mouseDown})}}]),t}()).prototype,"mouseDown",[l.default],Object.getOwnPropertyDescriptor(o.prototype,"mouseDown"),o.prototype),o),C=(S((i=function(e){function t(e){g(this,t);var n=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={focused:!1,input:""},n}return k(t,s.default.Component),a(t,[{key:"componentWillUnmount",value:function(){window.removeEventListener("mousedown",this.losefocus,!0)}},{key:"losefocus",value:function(e){this.state.input=null,this.input.blur(),window.removeEventListener("mousedown",this.losefocus,!0)}},{key:"componentDidUpdate",value:function(){this.input&&this.state.focused&&document.activeElement!==this.input&&this.input.focus()}},{key:"focus",value:function(e){e&&(e.preventDefault(),e.stopPropagation());var t=e&&e.target;this.setState({focused:!0,input:this.props.value},function(){t?t.select():this.input&&this.input.focus()}),window.addEventListener("mousedown",this.losefocus,!0)}},{key:"blur",value:function(e){null!==this.state.input&&this.props.onChange&&this.props.onChange(this.state.input),this.setState({focused:!1})}},{key:"keyDown",value:function(e){switch(e.keyCode){case 9:case 13:this.input.blur();break;case 27:this.state.input=null,this.input.blur()}}},{key:"change",value:function(e){this.setState({input:e.target.value})}},{key:"setInput",value:function(e){this.input=e}},{key:"render",value:function(){var e=(this.state.focused?this.state.input:(Number.isFinite(this.props.value)?Math.round(this.props.value):this.props.value)+(this.props.unit||""))||"";return s.default.createElement("input",{className:this.props.className,ref:this.setInput,type:"text",value:e,onFocus:this.focus,onBlur:this.blur,onChange:this.change,onKeyDown:this.keyDown})}}]),t}()).prototype,"losefocus",[l.default],Object.getOwnPropertyDescriptor(i.prototype,"losefocus"),i.prototype),S(i.prototype,"focus",[l.default],Object.getOwnPropertyDescriptor(i.prototype,"focus"),i.prototype),S(i.prototype,"blur",[l.default],Object.getOwnPropertyDescriptor(i.prototype,"blur"),i.prototype),S(i.prototype,"keyDown",[l.default],Object.getOwnPropertyDescriptor(i.prototype,"keyDown"),i.prototype),S(i.prototype,"change",[l.default],Object.getOwnPropertyDescriptor(i.prototype,"change"),i.prototype),S(i.prototype,"setInput",[l.default],Object.getOwnPropertyDescriptor(i.prototype,"setInput"),i.prototype),i);function E(e,t,n){var r,o,i,a=Math.floor(6*e),s=6*e-a,l=n*(1-t),u=n*(1-s*t),c=n*(1-(1-s)*t);switch(a%6){case 0:r=n,o=c,i=l;break;case 1:r=u,o=n,i=l;break;case 2:r=l,o=n,i=c;break;case 3:r=l,o=u,i=n;break;case 4:r=c,o=l,i=n;break;case 5:r=n,o=l,i=u}return[r,o,i]}_.Mode={Solid:1,LinearGradient:2,RadialGradient:3}},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(173),s=(r=a)&&r.__esModule?r:{default:r},l=n(7);var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Length=0,n._Skins=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"markSkinDeformDirty",value:function(){if(this._Skins)for(var e=0;e<this._Skins.length;e++){this._Skins[e].markDeformDirty()}}},{key:"onTransform",value:function(){this.markSkinDeformDirty()}},{key:"onWorldTransform",value:function(){this.markSkinDeformDirty()}},{key:"serializeProperties",value:function(e){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return delete n.skins,n}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return this._Skins&&(e.skins=this._Skins.slice(0)),e}},{key:"uiSelectionIconClass",get:function(){return"SelectionBoneIcon"}},{key:"allowDragDrop",get:function(){return!1}},{key:"length",get:function(){return this._Length},set:function(e){this._Length!=e&&this.dispatch("lengthChanged",{from:e,to:this._Length}),this._Length!==e&&(this._Length=e,this.markTransformDirty())}},{key:"firstBone",get:function(){var e=this.children,n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(s instanceof t)return s}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return null}},{key:"tipWorldTranslation",get:function(){var e=l.mat2d.create();return e[4]=this.length,l.mat2d.mul(e,this.worldTransform,e),l.mat2d.getTranslation(l.vec2.create(),e)}},{key:"rigLength",get:function(){return this._Length}},{key:"skins",get:function(){return this._Skins||(this._Skins=[]),this._Skins},set:function(e){e&&e.constructor===Array&&(this._Skins=e)}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=p(n(374)),s=p(n(224)),l=p(n(303)),u=n(7),c=p(n(17)),d=p(n(2)),f=p(n(506)),h=p(n(168));function p(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=4*(Math.sqrt(2)-1)/3*Math.sqrt(2)*.5;function b(e,t,n,r,o,i,a){var s=i,l=3*(t-e)/s,u=3*(e-2*t+n)/(s*=i),c=(r-e+3*(t-n))/(s*=i);e=e,t=l+u+c,n=2*u+6*c,r=6*c;for(var d=0;d<=i;d++)o[d][a]=e,e+=t,t+=n,n+=r}var k=.001;function S(e,t){var n=e[0],r=e[1],o=t[0],i=t[1];return Math.abs(n-o)<=k*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-i)<=k*Math.max(1,Math.abs(r),Math.abs(i))}var O,w,_,P,C,E,T=(r=function(e){function t(e){y(this,t);var n=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Jelly",n.hideInHierarchy=!0,n._Bones=[],n._Pool=[],n._Cache=null,n._HideJellies=!1,n._HideBone=!1,n._EaseIn=.5,n._EaseOut=.5,n._ScaleIn=1,n._ScaleOut=1,n._InTarget=null,n._OutTarget=null,n._InPoint=u.vec2.create(),n._InDirection=u.vec2.create(),n._OutPoint=u.vec2.create(),n._OutDirection=u.vec2.create(),n}return m(t,s.default),o(t,[{key:"updateDependencies",value:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDependencies",this).call(this,e);var n=this._Parent,r=[];if(n){e.addDependency(this,n),r=r.concat(Array.from(n.allConstraints));var o=n.firstBone;o&&(e.addDependency(this,o),r=r.concat(Array.from(o.allConstraints)),!this.outTarget&&o.jelly&&o.jelly.inTarget&&(e.addDependency(this,o.jelly.inTarget),r=r.concat(Array.from(o.jelly.inTarget.allConstraints))));var s=n.parent instanceof a.default&&n.parent,l=s&&s.jelly;l&&l.outTarget&&(e.addDependency(this,l.outTarget),r=r.concat(Array.from(l.outTarget.allConstraints)))}this._InTarget&&(e.addDependency(this,this._InTarget),r=r.concat(Array.from(this._InTarget.allConstraints))),this._OutTarget&&(e.addDependency(this,this._OutTarget),r=r.concat(Array.from(this._OutTarget.allConstraints))),r=new Set(r);var u=!0,c=!1,d=void 0;try{for(var f,h=r[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value;e.addDependency(this,p)}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}var y=this._Bones;if(y){var v=!0,m=!1,g=void 0;try{for(var b,k=y[Symbol.iterator]();!(v=(b=k.next()).done);v=!0){var S=b.value;e.addDependency(S,this),S.updateDependencies(e)}}catch(e){m=!0,g=e}finally{try{!v&&k.return&&k.return()}finally{if(m)throw g}}}}},{key:"setDefaults",value:function(){this.segments=2}},{key:"updateJellies",value:function(){var e=this.parent,t=u.vec2.set(u.vec2.create(),e._Length,0),n=this._Cache;e.dispatch("updateInOut");var r=this._Bones;if(r&&!(n&&n.count===r.length&&S(n.tip,t)&&S(n.out,this._OutPoint)&&S(n.in,this._InPoint)&&n.sin===this._ScaleIn&&n.sout===this._ScaleOut)){this._Cache={count:r.length,tip:t,out:u.vec2.clone(this._OutPoint),in:u.vec2.clone(this._InPoint),sin:this._ScaleIn,sout:this._ScaleOut};for(var o=u.vec2.create(),i=this._InPoint,a=this._OutPoint,s=t,l=[],c=0;c<=16;c++)l.push(new Float32Array(2));b(o[0],i[0],a[0],s[0],l,16,0),b(o[1],i[1],a[1],s[1],l,16,1),this._CurvePoints=l,this._GraphicsCurve&&(this._GraphicsCurve.delete(),this._GraphicsCurve=null);for(var d=function(e,t){var n=[],r=e.length,o=new Float32Array(r);o[0]=0;for(var i=0;i<r-1;i++){var a=e[i],s=e[i+1];o[i+1]=o[i]+u.vec2.distance(a,s)}for(var l=o[r-1]/t,c=1,d=1;d<=t;d++){for(var f=l*d;c<r-1&&o[c]<f;)c++;var h=o[c],p=(h-f)/(h-o[c-1]),y=1-p,v=e[c-1],m=e[c];try{n.push([v[0]*p+m[0]*y,v[1]*p+m[1]*y])}catch(t){console.log("P1",v,m,c,e)}}return n}(l,r.length),f=l[0],h=this._ScaleIn,p=(this._ScaleOut-this._ScaleIn)/(r.length-1),y=0;y<d.length;y++){var v=r[y],m=d[y];v.translation=f,v.length=u.vec2.distance(m,f),v.scale=u.vec2.set(u.vec2.create(),1,h),h+=p;var g=u.vec2.subtract(u.vec2.create(),m,f);v.rotation=Math.atan2(g[1],g[0]),f=m}}}},{key:"setOutDirection",value:function(e){var t=this.parent,n=this._EaseOut*t._Length*g,r=u.vec2.normalize(this._OutDirection,e);r=u.vec2.scale(u.vec2.create(),r,n);var o=this.tipPosition;u.vec2.add(this._OutPoint,o,r),this.updateJellies()}},{key:"onParentChanged",value:function(){var e=this.parent;if(e instanceof a.default){var t=!0,n=!1,r=void 0;try{for(var o,i=this._Bones[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value;s.setParent(e),e&&e.onChildAdded(s)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}}},{key:"markJellyDirty",value:function(){var e=this.parent;e&&(e.markTransformDirty(),e.dispatch("jellyChange"))}},{key:"onTargetRemovedFromStage",value:function(e,t){this._InTarget&&this._InTarget.stageItem===t&&(this.inTarget=null),this._OutTarget&&this._OutTarget.stageItem===t&&(this.outTarget=null)}},{key:"onDirty",value:function(){}},{key:"update",value:function(e,t){var n=this.parent,r=n.parent instanceof a.default&&n.parent,o=r&&r.jelly,i=u.mat2d.invert(u.mat2d.create(),n.worldTransform);if(i){if(this._InTarget){var s=this._InTarget.worldTranslation;u.vec2.transformMat2d(this._InPoint,s,i),u.vec2.normalize(this._InDirection,this._InPoint)}else if(r){if(r.firstBone===n&&o&&o.outTarget){var l=o.outTarget.worldTranslation,d=u.vec2.transformMat2d(u.vec2.create(),l,i);u.vec2.normalize(d,d),u.vec2.negate(this._InDirection,d)}else{var f=u.vec2.set(u.vec2.create(),1,0),h=u.vec2.set(u.vec2.create(),1,0);u.vec2.transformMat2(f,f,r.worldTransform),u.vec2.transformMat2(h,h,n.worldTransform);var p=u.vec2.add(u.vec2.create(),f,h),y=u.vec2.transformMat2(this._InDirection,p,i);u.vec2.normalize(y,y)}u.vec2.scale(this._InPoint,this._InDirection,this._EaseIn*n._Length*g)}else u.vec2.set(this._InDirection,1,0),u.vec2.set(this._InPoint,this._EaseIn*n._Length*g,0);if(this._OutTarget){var v=this._OutTarget.worldTranslation;u.vec2.transformMat2d(this._OutPoint,v,i);var m=u.vec2.set(u.vec2.create(),n._Length,0);u.vec2.subtract(this._OutDirection,this._OutPoint,m),u.vec2.normalize(this._OutDirection,this._OutDirection)}else if(n.firstBone){var b=n.firstBone,k=b.jelly;if(k&&k.inTarget){var S=k.inTarget.worldTranslation,O=u.vec2.subtract(u.vec2.create(),b.worldTranslation,S),w=u.vec2.transformMat2(this._OutDirection,O,i);u.vec2.normalize(w,w)}else{var _=u.vec2.set(u.vec2.create(),1,0),P=u.vec2.set(u.vec2.create(),1,0);u.vec2.transformMat2(_,_,b.worldTransform),u.vec2.transformMat2(P,P,n.worldTransform);var C=u.vec2.add(u.vec2.create(),_,P);u.vec2.negate(C,C);var E=u.vec2.transformMat2(this._OutDirection,C,i);u.vec2.normalize(E,E)}u.vec2.normalize(this._OutDirection,this._OutDirection);var T=u.vec2.scale(u.vec2.create(),this._OutDirection,this._EaseOut*n._Length*g);u.vec2.set(this._OutPoint,n._Length,0),u.vec2.add(this._OutPoint,this._OutPoint,T)}else{u.vec2.set(this._OutDirection,-1,0);var I=u.vec2.scale(u.vec2.create(),this._OutDirection,this._EaseOut*n._Length*g);u.vec2.set(this._OutPoint,n._Length,0),u.vec2.add(this._OutPoint,this._OutPoint,I)}this.updateJellies()}else c.default.warn("Failed to invert transform space",n.worldTransform)}},{key:"setParent",value:function(e){var n=this._Parent;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setParent",this).call(this,e),e!==n&&this.root&&this.root.markDependenciesDirty();var r=this._Bones;if(null===e){var o=!0,a=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){l.value.all(function(e){e.stageItem&&e.stageItem.removeFromStage()})}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}}else{if(e.stageItem&&e.stageItem.stage){var c=!0,d=!1,f=void 0;try{for(var h,p=r[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){h.value.all(function(t){t.stageItem&&t.stageItem.addToStage(e.stageItem.stage)})}}catch(e){d=!0,f=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw f}}}}}},{key:"read",value:function(e,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.jellies;if(r){this._HideJellies=n.hideJellies,this._HideBone=n.hideBone;var o=Number.parseFloat(n.easeIn),a=Number.parseFloat(n.easeOut);Number.isNaN(o)||(this._EaseIn=o),Number.isNaN(a)||(this._EaseOut=a);var s=Number.parseFloat(n.scaleIn),u=Number.parseFloat(n.scaleOut);Number.isNaN(s)||(this._ScaleIn=s),Number.isNaN(u)||(this._ScaleOut=u);var c=n.inTarget,d=n.outTarget;if(c||d){var f=this;e.whenNodesLoaded(function(){c&&(f.inTarget=e.getNode(c)),d&&(f.outTarget=e.getNode(d))})}this._Bones.length=0;var h=!0,p=!1,y=void 0;try{for(var v,m=r[Symbol.iterator]();!(h=(v=m.next()).done);h=!0){var g=v.value,b=e.addNodeType(l.default,null,g,!0);b&&(this._Bones.push(b),g.children&&e.recurseLoad(g.children,b))}}catch(e){p=!0,y=e}finally{try{!h&&m.return&&m.return()}finally{if(p)throw y}}}}},{key:"serializeProperties",value:function(e){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);n.hideJellies||delete n.hideJellies,n.hideBone||delete n.hideBone;var r=this._Bones;if(r){var o=[],a=!0,s=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;o.push(d.serialize(e))}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}n.jellies=o,this._InTarget?n.inTarget=this._InTarget.refId:delete n.inTarget,this._OutTarget?n.outTarget=this._OutTarget.refId:delete n.outTarget}return n}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.segments=this.segments,e.easeIn=this._EaseIn,e.easeOut=this._EaseOut,e.hideJellies=this._HideJellies,e.hideBone=this._HideBone,e.scaleIn=this._ScaleIn,e.scaleOut=this._ScaleOut,e.inTarget=this._InTarget,e.outTarget=this._OutTarget,e}},{key:"hideBone",get:function(){return this._HideBone},set:function(e){this._HideBone!==e&&(this._HideBone=e,this.markJellyDirty())}},{key:"hideJellies",get:function(){return this._HideJellies},set:function(e){this._HideJellies!==e&&(this._HideJellies=e,this.markJellyDirty())}},{key:"segments",get:function(){var e=this._Bones;return e&&e.length||0},set:function(e){var t=this,n=this.parent;1===e&&(e=2),e>16&&(e=16);var r=this._Bones;e!==r.length&&function(){for(var o=n.stageItem&&n.stageItem.stage,i=t._Pool,a=r.length;a<e;a++){var s=i.length?i.splice(i.length-1,1)[0]:t.actor.addNodeType(l.default,null,null,!0);s&&(s.length=30,s.translation=u.vec2.set(u.vec2.create(),50*a,0),r.push(s),s.setParent(t.parent),t.parent.onChildAdded(s),o&&s.all(function(e){e.stageItem&&e.stageItem.addToStage(o)}))}for(;r.length>e;){var c=r.splice(r.length-1,1)[0];i.push(c),o&&c.all(function(e){e.stageItem&&e.stageItem.removeFromStage()})}n.dispatch("childrenChanged"),t._Cache=null,t.markJellyDirty(),t.root&&t.root.markDependenciesDirty()}()}},{key:"bones",get:function(){return this._Bones}},{key:"tipPosition",get:function(){var e=this.parent;return u.vec2.set(u.vec2.create(),e._Length,0)}},{key:"easeIn",get:function(){return this._EaseIn},set:function(e){e!==this._EaseIn&&(this._EaseIn=e,this.markJellyDirty())}},{key:"easeOut",get:function(){return this._EaseOut},set:function(e){e!==this._EaseOut&&(this._EaseOut=e,this.markJellyDirty())}},{key:"scaleIn",get:function(){return this._ScaleIn},set:function(e){e!==this._ScaleIn&&(this._ScaleIn=e,this.markJellyDirty())}},{key:"scaleOut",get:function(){return this._ScaleOut},set:function(e){e!==this._ScaleOut&&(this._ScaleOut=e,this.markJellyDirty())}},{key:"unitControlLength",get:function(){return this.parent._Length*g}},{key:"inDirection",get:function(){return this._InDirection}},{key:"outDirection",get:function(){return this._OutDirection}},{key:"inPoint",get:function(){return this._InPoint}},{key:"outPoint",get:function(){return this._OutPoint}},{key:"inTarget",get:function(){return this._InTarget},set:function(e){if(this._InTarget!==e){if(e){var t=this.root.dependencyGraph;if(t&&(t.addDependency(this,e),!t.sort()))throw t.removeDependency(this,e),new f.default(e)}this.root&&this.root.markDependenciesDirty(),this._InTarget&&this._InTarget.stageItem.removeEventListener("removedFromStage",this.onTargetRemovedFromStage),this._InTarget=e,this._InTarget&&this._InTarget.stageItem.addEventListener("removedFromStage",this.onTargetRemovedFromStage),this.markJellyDirty()}}},{key:"outTarget",get:function(){return this._OutTarget},set:function(e){if(this._OutTarget!==e){if(e){var t=this.root.dependencyGraph;if(t&&(t.addDependency(this,e),!t.sort()))throw t.removeDependency(this,e),new f.default(e)}this.root&&this.root.markDependenciesDirty(),this._OutTarget&&this._OutTarget.stageItem.removeEventListener("removedFromStage",this.onTargetRemovedFromStage),this._OutTarget=e,this._OutTarget&&this._OutTarget.stageItem.addEventListener("removedFromStage",this.onTargetRemovedFromStage),this.markJellyDirty()}}}]),t}(),O=r.prototype,w="onTargetRemovedFromStage",_=[d.default],P=Object.getOwnPropertyDescriptor(r.prototype,"onTargetRemovedFromStage"),C=r.prototype,E={},Object.keys(P).forEach(function(e){E[e]=P[e]}),E.enumerable=!!E.enumerable,E.configurable=!!E.configurable,("value"in E||E.initializer)&&(E.writable=!0),E=_.slice().reverse().reduce(function(e,t){return t(O,w,e)||e},E),C&&void 0!==E.initializer&&(E.value=E.initializer?E.initializer.call(C):void 0,E.initializer=void 0),void 0===E.initializer&&(Object.defineProperty(O,w,E),E=null),r);t.default=T;var I=function(e){function t(e){y(this,t);var n=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return m(t,h.default),t}();T.StageItem=I},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=v(n(203)),i=v(n(197)),a=v(n(198)),s=v(n(219)),l=v(n(173)),u=n(333),c=v(n(195)),d=v(n(230)),f=v(n(252)),h=v(n(179)),p=v(n(268)),y=n(7);function v(e){return e&&e.__esModule?e:{default:e}}var m=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._CompensateBones=t,this._CompensateImages=n,this._ActorNodes=r}return r(e,[{key:"advance",value:function(e,t){for(var n=this._CompensateImages,r=this._CompensateBones,u=0;u<this._ActorNodes.length;u++){var c=this._ActorNodes[u],d=t;if(c.parent instanceof l.default){var f=c.parent.worldTransform,h=y.mat2d.invert(y.mat2d.create(),f);d=y.vec2.transformMat2(y.vec2.create(),t,h)}if(c.hasWorldTransformOverride){var p=c.worldTransform,v=y.mat2d.clone(p),m=y.mat2d.fromTranslation(y.mat2d.create(),t);c.overrideWorldTransform=y.mat2d.mul(y.mat2d.create(),p,m),c.constructor===o.default&&c.isConnectedToBones&&(c.compensateConnectedBones(v),c.overrideWorldTransform=v)}else c.translation=y.vec2.add(y.vec2.create(),c.translation,d);(this._CompensateImages||this._CompensateBones)&&function(){var e=[];if(c.eachChildRecursive(function(t){(n&&(t.constructor===o.default||t.constructor===i.default)||r&&(t.constructor===a.default||t.constructor===l.default||t.constructor===s.default))&&-1==e.indexOf(t)&&e.push(t)}),e.length)for(var t=0;t<e.length;t++){e[t].compensate()}}()}}},{key:"complete",value:function(){}}]),e}();t.default=m,m.make=function(e,t){for(var n=e.stage.settings,r=n.compensateBones,o=n.compensateImages,i=[],a=0;a<t.length;a++){var l=t[a];if(l.node)switch(l.constructor){case c.default:r||o||l.node.constructor!==s.default||i.push(l.node);break;case d.default:case f.default:case h.default:if(l.node.isConnectedToBones&&e.stage.appContext.editingAnimation)continue;case u.StageArtboard:case p.default:i.push(l.node)}}if(0!=i.length)return new m(r,o,i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={Local:0,Parent:1,World:2}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=c(n(195)),i=c(n(176)),a=n(7),s=c(n(203)),l=c(n(173)),u=c(n(219));c(n(328));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var n=0;n<e.children.length;n++){var r=e.children[n];if(t(r.joint))break;d(r.joint,t)}}var f=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._CompensateBones=t,this._CompensateImages=n,this._StageJoints=r,this._TransformMatrix=a.mat2d.create(),this._TopJoints=r.slice(0);for(var o=0;o<this._TopJoints.length;o++){var i=this._TopJoints[o];if(i.node.isConstrained||i.bone&&i.bone.isConstrained)this._TopJoints.splice(o,1),o--;else for(var s=i.parentJoint;s;){if(s&&-1!=this._TopJoints.indexOf(s)){this._TopJoints.splice(o,1),o--;break}s=s.parentJoint}}if(!t)for(var l=0;l<this._TopJoints.length;l++)d(this._TopJoints[l],function(e){if(e.node.isConstrained)return!0;-1===r.indexOf(e)&&r.push(e)})}return r(e,[{key:"retransformBones",value:function(){for(var e=[],t=this._CompensateImages,n=this._CompensateBones,r=0;r<this._TopJoints.length;r++){var i=this._TopJoints[r];if(o.default.alignChain(i,t),t||n)(i.bone&&i.node||i.node.parent).eachChildRecursive(function(r){switch(r.constructor){case s.default:case l.default:t&&-1==e.indexOf(r)&&e.push(r);break;case u.default:n&&-1==e.indexOf(r)&&e.push(r)}})}if(e.length)for(var a=0;a<e.length;a++){e[a].compensate()}}},{key:"preTransform",value:function(){for(var e=0;e<this._TopJoints.length;e++){var t=this._TopJoints[e];t.parentJoint&&(t=t.parentJoint),o.default.transformChain(t)}}},{key:"advance",value:function(e,t){this.skipPreTransform||this.preTransform();for(var n=0;n<this._StageJoints.length;n++){var r=this._StageJoints[n],o=r.renderTransform;this._TransformMatrix[4]=o[4]+t[0],this._TransformMatrix[5]=o[5]+t[1],r.renderTransform=this._TransformMatrix}this.retransformBones()}},{key:"complete",value:function(){}}]),e}();t.default=f,f.make=function(e,t){for(var n=e.stage.settings,r=n.compensateBones,a=n.compensateImages,s=[],l=0;l<t.length;l++){var c=t[l];if(c.constructor===i.default){if(!c.parentJoint)throw new Error("Parent Joint expected");-1==s.indexOf(c.parentJoint)&&s.push(c.parentJoint),-1==s.indexOf(c.joint)&&s.push(c.joint)}else if(c.constructor===o.default){if(!r&&!a&&c.node.constructor===u.default)continue;-1==s.indexOf(c)&&s.push(c)}}if(0!=s.length)return new f(r,a,s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getEasedMix",value:function(e){return e}},{key:"serialize",value:function(e){}},{key:"deserialize",value:function(e){}}],[{key:"ID",get:function(){return 1}},{key:"label",get:function(){return"Linear"}}]),e}();t.default=o,o.instance=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getEasedMix",value:function(e){return 0}},{key:"serialize",value:function(e){}},{key:"deserialize",value:function(e){}}],[{key:"ID",get:function(){return 0}},{key:"label",get:function(){return"Hold"}}]),e}();t.default=o,o.instance=new o},function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},s=b(r(428)),l=b(r(419)),u=b(r(518)),c=b(r(179)),d=b(r(236)),f=b(r(301)),h=b(r(265)),p=r(7),y=b(r(649)),v=b(r(2)),m=b(r(331)),g=b(r(525));function b(e){return e&&e.__esModule?e:{default:e}}var k,S,O,w,_,P,C=(o=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t._DragEdgeFrom=null,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,s.default),i(n,[{key:"validate",value:function(){return!!a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"validate",this).call(this)&&this.stage.soloItem instanceof c.default}},{key:"getEditing",value:function(e){var t=[];return e instanceof c.default&&t.push(e.node),t}},{key:"enable",value:function(){a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"enable",this).call(this);var e=this._Editing;this.stage;if(e){var t=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){i.value.showDeformed=!1}}catch(e){r=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw o}}}}},{key:"onEditingChanged",value:function(e){a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"onEditingChanged",this).call(this,e);var t=this._Editing;this.stage;this.disableForNodes(t),this.enableForNodes(e)}},{key:"enableForNodes",value:function(e){if(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.showDeformed=!1,a.addEventListener("childrenChanged",this.editingChildrenChanged),a.addEventListener("hasContourChanged",this.editingChildrenChanged)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}}},{key:"disableForNodes",value:function(e){if(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.showDeformed=!0,a.removeEventListener("childrenChanged",this.editingChildrenChanged),a.removeEventListener("hasContourChanged",this.editingChildrenChanged)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}}},{key:"editingChildrenChanged",value:function(){this._DragEdgeFrom=null}},{key:"disable",value:function(){a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"disable",this).call(this);var e=this._Editing;this.stage;this.disableForNodes(e)}},{key:"shouldHideGhost",value:function(e,t){return this.insertTarget,!1}},{key:"uvClampedWorld",value:function(e){var t=this._Editing;if(!t.size)return e;var n=t.values().next().value,r=E(n,e),o=n.asset;if(!o)return e;var i=o.width,a=o.height,s=i/2,l=a/2,u=[Math.max(0,Math.min(i,r[0]+s)),Math.max(0,Math.min(a,r[1]+l))];return T(n,r=[u[0]-s,u[1]-l])}},{key:"showGhostPoint",value:function(e){e=this.uvClampedWorld(e);var t=this._Editing;if(t.size){var r=t.values().next().value;if(a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"showGhostPoint",this).call(this,e),this._DragEdgeFrom&&!this._DragEdgeFrom.stage&&(this._DragEdgeFrom=null),!r.hasContour&&!this._DragEdgeFrom){var o=r.lastPoint;o&&(this._DragEdgeFrom=o.stageItem)}}}},{key:"getInsertTarget",value:function(e,t){var n=null,r=10/this.stage.scale,o=!0,i=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value,c=E(u,t),d=null,f=Number.MAX_VALUE,y=0,v=null,m=null,g=null,b=u.points,k=u.edges,S=!0,O=!1,w=void 0;try{for(var _,P=b[Symbol.iterator]();!(S=(_=P.next()).done);S=!0){var C=_.value,I=C.contour;if(I){var j=h.default.pointOnSegment(C.translation,I.translation,c[0],c[1]),A=j.point,D=j.t;(B=p.vec2.distance(A,c))<f&&(y=D,f=B,d={x:A[0],y:A[1],d:B},v=C,m=C.contour)}}}catch(e){O=!0,w=e}finally{try{!S&&P.return&&P.return()}finally{if(O)throw w}}var R=!0,M=!1,x=void 0;try{for(var F,L=k[Symbol.iterator]();!(R=(F=L.next()).done);R=!0){var N=F.value,z=N.from,V=N.to;if(z&&V){var B,H=h.default.pointOnSegment(z.translation,V.translation,c[0],c[1]),W=(A=H.point,H.t);(B=p.vec2.distance(A,c))<f&&(y=W,f=B,d={x:A[0],y:A[1],d:B},v=z,m=V,g=N)}}}catch(e){M=!0,x=e}finally{try{!R&&L.return&&L.return()}finally{if(M)throw x}}f<r&&(n={image:u,t:y,prev:v,next:m,worldPoint:T(u,p.vec2.fromValues(d.x,d.y)),point:d,splitEdge:g},r=f)}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}return n}},{key:"startDrag",value:function(e,t,r){return this._DragEdgeFrom=null,r.shiftKey&&(e||t.length)?(e instanceof f.default?this._DragEdgeFrom=e:this._DragEdgeFrom=t[0],!1):a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"startDrag",this).call(this,e,t,r)}},{key:"makeEdge",value:function(e,t,n){var r=this._Editing,o=this.stage;if(!r.size)return null;var i=r.values().next().value;if(i.hasContour){if(!e.isForced&&!t.isForced){var a=actor.addNodeType(u.default,i,{from:e.refId,to:t.refId});return a.stageItem.addToStage(o),a}}else n&&0!==t.pointIndex||(e.contour=t);return null}},{key:"release",value:function(e){var t=this._DragEdgeFrom,r=this._PointTransform,o=this._Editing,i=(this.stage,this.hoverPoint);if(o.size){o.values().next().value;if(t){if(i&&t!==i){i.node;this.makeEdge(t.node,i.node,!0)}else if(r){var s=p.mat2d.getTranslation(p.vec2.create(),r),l=this.insertTarget;if(l){var u=this.split(l,!0);u&&this.makeEdge(t.node,u,!0)}else this.addPoint(s,t)}this._DragEdgeFrom=null}a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"release",this).call(this,e)}}},{key:"draw",value:function(e){var t=this._DragEdgeFrom,r=this._PointTransform,o=this._Editing,i=this.stage,s=i.hoverItem;if(o.size){var l=o.values().next().value;if((s&&s instanceof f.default&&(s.node.isForced||!l.hasContour&&0!==s.node.pointIndex)||!l.hasContour&&this.insertTarget)&&(t=null),t&&t.stage&&(r||i.hoverItem instanceof f.default)){var u=e.skCanvas,c=t.worldTranslation,h=r?p.mat2d.getTranslation(p.vec2.create(),r):i.hoverItem.worldTranslation,y=d.default.StageContext.edgeStroke;u.save(),u.drawLine(c[0],c[1],h[0],h[1],y),u.restore()}a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"draw",this).call(this,e)}}},{key:"advanceDrag",value:function(e,t,r,o){a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"advanceDrag",this).call(this,e,t,r,o)}},{key:"click",value:function(e,t,n){e=this.uvClampedWorld(e);var r=this.stage,o=this.hoverPoint;if(r.hoverItem||o){if(r.hoverItem instanceof g.default){var i=new m.default(r,r.hoverItem.node.actor,[r.hoverItem],[],!0);i.silent=!0,i.start(),i.end()}}else{var a=this.insertTarget;a?this.split(a,!0):(this.addPoint(e,this._DragEdgeFrom),this._DragEdgeFrom=null)}}},{key:"onKeyDown",value:function(e){a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"onKeyDown",this).call(this,e),this._IsDeleting=e.altKey}},{key:"onKeyUp",value:function(e){a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"onKeyUp",this).call(this,e),this._IsDeleting=e.altKey}},{key:"addPoint",value:function(e,n){var r=this._Editing,o=this.stage;if(r.size){var i=r.values().next().value,a=(i.triangles,i.uvs,i.vertices,E(i,e)),s=i.asset;if(!s)return t;var u=s.width/2,c=s.height/2,d=[a[0]+u,a[1]+c];if(d){var f=actor.addNodeType(l.default,i,{translation:Array.from(a),uv:Array.from(d)});return f.stageItem.addToStage(o),n&&this.makeEdge(n.node,f,!1),o.selectItem(f.stageItem),i.hasContour&&i.computeTopology(),this.hideGhostPoint(),f}return null}}},{key:"split",value:function(e,t){var n=this.stage,r=e.image,o=e.point,i=e.prev,a=e.next,s=e.t,c=e.splitEdge,d=actor.addNodeType(l.default,r,{translation:[o.x,o.y],uv:Array.from(p.vec2.lerp(p.vec2.create(),i.uv,a.uv,s))},!1,c?void 0:r.children.indexOf(a));if(c){var f=new m.default(n,r.actor,[c.stageItem],[],!0);f.silent=!0,f.start(),f.end(),actor.addNodeType(u.default,r,{from:i.refId,to:d.refId}).stageItem.addToStage(n),actor.addNodeType(u.default,r,{from:d.refId,to:a.refId}).stageItem.addToStage(n)}else i.contour=d,d.contour=a;return d.stageItem.addToStage(this.stage),n.selectItem(d.stageItem),t&&r.computeTopology(),d}},{key:"transformers",get:function(){return[y.default]}},{key:"hoverPoint",get:function(){var e=this._PointTransform,t=this.stage;if(t.hoverItem instanceof f.default)return t.hoverItem;if(!e)return null;var n=p.vec2.fromValues(e[4],e[5]),r=p.vec2.transformMat2d(n,n,t.viewTransform),o=t.stageItems,i=!0,a=!1,s=void 0;try{for(var l,u=o[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value;if(c instanceof f.default&&p.vec2.squaredDistance(c.viewTranslation,r)<100)return c}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}return null}},{key:"isDeleting",get:function(){return this._IsDeleting}}]),n}(),k=o.prototype,S="editingChildrenChanged",O=[v.default],w=Object.getOwnPropertyDescriptor(o.prototype,"editingChildrenChanged"),_=o.prototype,P={},Object.keys(w).forEach(function(e){P[e]=w[e]}),P.enumerable=!!P.enumerable,P.configurable=!!P.configurable,("value"in P||P.initializer)&&(P.writable=!0),P=O.slice().reverse().reduce(function(e,t){return t(k,S,e)||e},P),_&&void 0!==P.initializer&&(P.value=P.initializer?P.initializer.call(_):void 0,P.initializer=void 0),void 0===P.initializer&&(Object.defineProperty(k,S,P),P=null),o);function E(e,t){var n=e.root.localTranslation(t);return p.vec2.transformMat2d(p.vec2.create(),n,e.inverseWorld)}function T(e,t){return e.root.renderTranslation(p.vec2.transformMat2d(p.vec2.create(),t,e.worldTransform))}n.default=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=(y(n(223)),y(n(225))),a=y(n(224)),s=y(n(228)),l=y(n(197)),u=(y(n(230)),n(7)),c=y(n(350)),d=n(288),f=y(n(17)),h=y(n(665)),p=y(n(264));function y(e){return e&&e.__esModule?e:{default:e}}var v=null,m=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,h.default),r(t,[{key:"blockMarquee",value:function(e){return!0}},{key:"cancel",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"cancel",this).call(this);var e=this._CreatedPath,n=this._CreatedShape;e&&(e.parent&&e.parent.remove(e),e.stageItem&&e.stageItem.removeFromStage()),n&&(n.stageItem&&n.stageItem.removeFromStage(),n.parent&&n.parent.remove(n)),this._CreatedShape=null,this._CreatedPath=null,this._ToPoint=null,this._CreatePoint=null}},{key:"enable",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this)}},{key:"disable",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}},{key:"validate",value:function(){return!this.stage.appContext.editingAnimation}},{key:"updateSelection",value:function(e){}},{key:"advanceDrag",value:function(e,t,n,r){this.stage;var o=this._CreatedPath;if(o||(o=this.createPath(n)),o.parent){this._ToPoint=u.vec2.clone(n);var i=this._ToPoint,a=this._CreatePoint;if(i&&a){var s=void 0,l=this._CreatedShape;if((s=l||o).parent){var c=u.mat2d.invert(u.mat2d.create(),s.parent.renderTransform);if(c){i=u.vec2.transformMat2d(u.vec2.create(),i,c),a=u.vec2.transformMat2d(u.vec2.create(),a,c),u.vec2.round(i,i),u.vec2.round(a,a);var d=u.vec2.subtract(u.vec2.create(),i,a),h=this.snap,p=h?Math.max(Math.abs(d[0]),Math.abs(d[1])):Math.abs(d[0]),y=h?p:Math.abs(d[1]);d[0]=p*Math.sign(d[0]),d[1]=y*Math.sign(d[1]),s.translation=u.vec2.add(u.vec2.create(),a,[.5*d[0],.5*d[1]]),o.width=p,o.height=y}else f.default.warn("Failed to invert transform space",s.parent.renderTransform)}else this.cancel()}}else this.cancel()}},{key:"release",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"release",this).call(this,e),this._CreatedPath&&this._CreatedPath.parent.onPathChanged(this._CreatedPath),this._CreatedShape=null,this._CreatedPath=null,this._ToPoint=null,this._CreatePoint=null}},{key:"createPath",value:function(e){var t=this.stage;if(!t)return null;var n=t.appContext.actor,r=t.selectedItems,o=r.filter(function(e){return-1===r.indexOf(e.node&&e.node.parent.stageItem)}),u=1===o.length?o[0].node:null,c=null;if(u&&(u instanceof l.default?u=u.parent:(u instanceof i.default||u instanceof s.default)&&(c=u=u.parent)),!c){if(u)for(;u&&!a.default.isRelationshipValid(u.constructor,l.default);)u=u.parent;if(!(c=n.addNodeType(l.default,u,{name:this.shapeName,translation:Array.from(e)})))return;c.stageItem.addToStage(this.stage),this._CreatedShape=c;var f=n.addNodeType(d.ColorStroke,c,{color:[.8,.8,.8,1],width:1});f&&f.stageItem.addToStage(this.stage);var h=n.addNodeType(d.ColorFill,c,{color:[.4,.4,.4,1]});h&&h.stageItem.addToStage(this.stage)}var p=n.addNodeType(this.pathType,c,{name:this.shapeName+" Path"});return p?(p.stageItem.addToStage(this.stage),p.calculateWorldTransform(),this._CreatedPath=p,p):void 0}},{key:"click",value:function(e,t,n){this._CreatePoint=u.vec2.clone(e)}},{key:"startDrag",value:function(e,n){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startDrag",this).call(this,e,n),!0}},{key:"draw",value:function(e){var t=this._ToPoint,n=this._CreatePoint,r=this.stage,o=this.stageContext;if(t&&n){var i=e.skCanvas,a=r.viewTransform,s=o._FillTextBackground,l=o._FillText,c=o._MarkerPath,d=o._MarkerStroke,f=o._BackgroundPath,h=o._Font;t=u.vec2.round(u.vec2.create(),t),n=u.vec2.round(u.vec2.create(),n);var y=u.vec2.subtract(u.vec2.create(),t,n),v=this.snap,m=v?Math.max(Math.abs(y[0]),Math.abs(y[1])):Math.abs(y[0]),g=v?m:Math.abs(y[1]);y[0]=m*Math.sign(y[0]),y[1]=g*Math.sign(y[1]);var b=u.vec2.min(u.vec2.create(),n,[n[0]+y[0],n[1]+y[1]]);i.restore();var k=u.vec2.transformMat2d(u.vec2.create(),b,a);c.rewind(),c.addRect(k[0],k[1],k[0]+m*r.scale,k[1]+g*r.scale),i.drawPath(c,d);var S=u.vec2.transformMat2d(u.vec2.create(),t,a),O=m+"x"+g,w=h.measureText(O),_=S[0]+10,P=S[1]+10;f.rewind(),f.addRect(_,P,_+w+10,P+12+10),i.drawPath(f,s);var C=p.default.makeTextBlob(O,h);i.drawTextBlob(C,Math.round(_+5),Math.round(P+12+5-2),l),i.save(),e.transform(a)}}},{key:"transformers",get:function(){return[c.default]}}]),t}();t.default=m,m.initializeStageContext=function(e,t){v=e.canvasKit,t._Font=p.default.makeFont(null,12);var n=new v.SkPaint;n.setAntiAlias(!0),n.setStyle(v.PaintStyle.Fill),n.setBlendMode(v.BlendMode.SrcOver),n.setColor(v.Color(0,0,0,.9)),t._FillTextBackground=n;var r=new v.SkPaint;r.setAntiAlias(!0),r.setStyle(v.PaintStyle.Fill),r.setStrokeWidth(1),r.setBlendMode(v.BlendMode.SrcOver),r.setColor(v.Color(255,255,255,1)),t._FillText=r;var o=new v.SkPaint;o.setAntiAlias(!0),o.setStyle(v.PaintStyle.Stroke),o.setStrokeWidth(1),o.setBlendMode(v.BlendMode.SrcOver),o.setColor(v.Color(0,0,0,.9)),t._MarkerStroke=o,t._MarkerPath=e.makePath(),t._BackgroundPath=e.makePath()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(228)),a=n(7),s=l(n(218));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Polygon",n._Sides=5,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"getOBB",value:function(e){var t=Number.MAX_VALUE,n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=-Number.MAX_VALUE;function i(i){e&&(i=a.vec2.transformMat2d(a.vec2.create(),i,e)),i[0]<t&&(t=i[0]),i[1]<n&&(n=i[1]),i[0]>r&&(r=i[0]),i[1]>o&&(o=i[1])}var s=this._Sides,l=this.width/2,u=this.height/2,c=-Math.PI/2,d=2*Math.PI/s;i([0,-u]);for(var f=0;f<s;f++)i([Math.cos(c)*l,Math.sin(c)*u]),c+=d;return[a.vec2.fromValues(t,n),a.vec2.fromValues(r,o)]}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n),this._Sides=Math.max(4,Number.parseFloat(n.sides)||5)}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.sides=this._Sides,e}},{key:"getPathPoints",value:function(){for(var e=[],t=this.width/2,n=this.height/2,r=this._Sides,o=-Math.PI/2,i=2*Math.PI/r,a=0;a<r;a++)e.push({pointType:s.default.Straight,translation:[Math.cos(o)*t,Math.sin(o)*n]}),o+=i;return e}},{key:"typeName",get:function(){return"Polygon"}},{key:"uiHierIconClass",get:function(){return"HierarchyImageIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"uiIcon",get:function(){return"icon-picture"}},{key:"sides",get:function(){return this._Sides},set:function(e){e!==this._Sides&&(this._Sides=Math.max(4,e),this.parent.onPathChanged(this),this.dispatch("shapePropChange"),this.markRenderPathDirty())}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(229),i=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(e,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.name=o.substring(0,t.MAX_LENGTH),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a,a.MAX_LENGTH=40},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"canSelect",value:function(e){return this.canSelectType(e.constructor)||e.drawAfterSelections}},{key:"canSelectType",value:function(e){return!0}}]),e}();t.default=o},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(224)),a=n(7),s=l(n(331));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Translation=a.vec2.create(),n._UV=a.vec2.create(),n._Contour=null,n._IsForced=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"read",value:function(e,n){var r=this;o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var i=n.translation;i&&i.constructor===Array&&2==i.length&&(this._Translation[0]=i[0],this._Translation[1]=i[1]),(i=n.uv)&&i.constructor===Array&&2==i.length&&(this._UV[0]=i[0],this._UV[1]=i[1]),this._IsForced=!0===n.isForced;var a=n.edge||n.contour;void 0!==a&&e.whenNodesLoaded(function(){var t=e.getNode(a);t&&(r._Contour=t)})}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return this._Contour&&(n.contour=this._Contour.refId),n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.translation=a.vec2.clone(this._Translation),e.uv=a.vec2.clone(this._UV),e.contour=this._Contour,e.isForced=this._IsForced,e}},{key:"setParent",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setParent",this).call(this,e),e&&(this._Image=e)}},{key:"onDelete",value:function(){var e=this,t=this._Image,n=this.contour;if(t){var r=t.points,o=t.edges,i=r.find(function(t){return t.contour===e});i&&(i.contour=n,this.contour=null);var a=o.filter(function(t){return t.from===e||t.to===e}).map(function(e){return e.stageItem});if(a.length&&t.stageItem.stage){var l=new s.default(t.stageItem.stage,this._Actor,a,[]);l.silent=!0,l.start(),l.end()}}}},{key:"pointIndex",get:function(){var e=this.parent&&this.parent.points;return e?e.indexOf(this):-1}},{key:"typeName",get:function(){return"Mesh Point"}},{key:"hideInHierarchy",get:function(){return!0}},{key:"uiHierIconClass",get:function(){return"HierarchyVertexIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionVertexIcon"}},{key:"uiIcon",get:function(){return"icon-vertex"}},{key:"translation",get:function(){var e=this.parent;if(!e||e.showDeformed)return this._Translation;var t=this.uv,n=e.asset,r=n.width/2,o=n.height/2;return[t[0]-r,t[1]-o]},set:function(e){var t=this.parent;if(!t||t.showDeformed){var n=this._Translation;a.vec2.isEqual(n,e)||(a.vec2.copy(n,e),this.stageItem&&this.stageItem.onTranslationChanged(),this.parent.invalidateMesh(),this.dispatch("posChange"))}else if(!this._IsForced){var r=this.uv,o=t.asset,i=o.width,s=o.height,l=i/2,u=s/2,c=[Math.max(0,Math.min(i,e[0]+l)),Math.max(0,Math.min(s,e[1]+u))];a.vec2.isEqual(r,c)||(a.vec2.copy(r,c),a.vec2.copy(this._Translation,[c[0]-l,c[1]-u]),this.stageItem&&this.stageItem.onTranslationChanged(),this.parent.debounceComputeTopology(),this.dispatch("posChange"))}}},{key:"uv",get:function(){return this._UV},set:function(e){a.vec2.copy(this._UV,e)}},{key:"contour",get:function(){return this._Contour},set:function(e){this._Contour=e,this.stageItem&&this.stageItem.updateContour(),this._Image&&this._Image.updateContour()}},{key:"isForced",get:function(){return this._IsForced},set:function(e){this._IsForced=e}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(347),s=(r=a)&&r.__esModule?r:{default:r};var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isCollapsed=!0,n._Children=[],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"silentlySetChildren",value:function(e){this._Children=e}},{key:"notifyChildrenChanged",value:function(e){e||(this.dispatch("childrenChanged",this),this._Actor&&this._Actor.notifyAssetChildrenChanged())}},{key:"add",value:function(e,t,n){var r=this._Children,o=r.indexOf(e);if(e.parent==this||-1!=o)throw new Error(e+" is already a child of "+this);e.parent&&e.parent.remove(e),e.setParent(this),void 0===n?r.push(e):r.splice(n,0,e),this.notifyChildrenChanged(t),this.onChildAdded&&this.onChildAdded(e)}},{key:"remove",value:function(e,t){var n=this._Children.indexOf(e);-1!=n&&(e.setParent(null),this._Children.splice(n,1)),this.onChildRemoved&&this.onChildRemoved(e),this.notifyChildrenChanged(t)}},{key:"eachChild",value:function(e){for(var t=0;t<this._Children.length;t++)e(this._Children[t])}},{key:"eachChildRecursive",value:function(e){for(var t=0;t<this._Children.length;t++){var n=this._Children[t];!1!==e(n)&&(n.eachChildRecursive&&n.eachChildRecursive(e))}}},{key:"all",value:function(e){if(!1!==i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"all",this).call(this,e))for(var n=0;n<this._Children.length;n++){var r=this._Children[n];!1!==e(r)&&(r.eachChildRecursive&&r.eachChildRecursive(e))}}},{key:"read",value:function(e,n,r){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n,r);var o=n.children;if(void 0!==o&&o.length)for(var a=0;a<o.length;a++){var s=o[a],l=this.resolveChildType(e,s.type);if(l){var u=new l(e,this);u.read(e,s),this.add(u,!0),e.addAsset(u)}}}},{key:"resolveChildType",value:function(e,t){return null}},{key:"serialize",value:function(){for(var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this),n=0;n<this._Children.length;n++){var r=this._Children[n].serialize();r&&(e.children||(e.children=[]),e.children.push(r))}return e}},{key:"serializeProperties",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this);return delete e.children,e}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.children=this._Children.slice(0),e}},{key:"children",get:function(){return this._Children},set:function(e){this._Children=e,this.notifyChildrenChanged()}},{key:"hierarchyChildren",get:function(){return this._Children}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.round(100*this.toInputValue(e))/100+"%"}},{key:"toInputValue",value:function(e){return 100*e}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e)/100;if(Number.isNaN(t))throw"Invalid input";return t}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"dragScale",get:function(){return.005}},{key:"dragFastScale",get:function(){return.012}},{key:"dragMin",get:function(){return 0}},{key:"dragMax",get:function(){return 1}},{key:"allowDrag",get:function(){return!0}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=n(7),a=k(n(665)),s=k(n(223)),l=k(n(179)),u=k(n(252)),c=k(n(230)),d=k(n(268)),f=k(n(176)),h=k(n(253)),p=k(n(195)),y=k(n(330)),v=k(n(266)),m=k(n(377)),g=k(n(519)),b=k(n(521));function k(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Handle=new g.default,n._Handle.customSelectionAction=function(){return!0},n._TranslateItem=null,n.filterDragSelection=s.default.filterChildren,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),r(t,[{key:"validate",value:function(){return!this.stage.soloItem}},{key:"findValidItem",value:function(e){for(var t=0;t<e.length;t++){var n=e[0];switch(n.constructor){case l.default:case u.default:case c.default:if(n.node&&n.node.isConnectedToBones&&this.stage.appContext.editingAnimation)continue;break;case y.default:case v.default:case h.default:continue}return n}return null}},{key:"updateSelection",value:function(e){e=s.default.filterChildren(e),this._TranslateItem=this.findValidItem(e),this._TranslateItem?this._Handle.stage||this._Handle.addToStage(this.stage):this._Handle.stage&&this._Handle.removeFromStage()}},{key:"updateHandle",value:function(){if(!this._TranslateItem)return!1;var e=i.mat2d.create(),t=e,n=this.stage.transformSpace,r=null;if(this._TranslateItem)switch(this._TranslateItem.constructor){case d.default:case l.default:case u.default:case c.default:(r=this._TranslateItem.node).isConnectedToBones?(e=r.getCentroidTransform(),t=r.renderTransform):e=t=r.renderTransform;break;case f.default:e=t=(r=this._TranslateItem.actorBone).renderTransform;break;case p.default:r=this._TranslateItem.node,e=this._TranslateItem.renderTransform,t=r.renderTransform}return n==m.default.Parent?t=r&&r.parent?r.parent.renderTransform:i.mat2d.create():n==m.default.World&&(t=i.mat2d.create()),this._Handle.alignToTransform(e,t),!0}},{key:"drawPrep",value:function(e){this.updateHandle()}},{key:"startDrag",value:function(e,n){return!!this.updateHandle()&&(this._Handle.lockAngle(),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startDrag",this).call(this,e,n))}},{key:"endDrag",value:function(){this._Handle.unlockAngle(),this._Handle.sliceAngle=0,o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"endDrag",this).call(this)}},{key:"advanceDrag",value:function(e,n,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"advanceDrag",this).call(this,e,n,r)}},{key:"disable",value:function(){this._Handle.stage&&this._Handle.removeFromStage(),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}},{key:"transformers",get:function(){return[b.default]}},{key:"handle",get:function(){return this._Handle}}]),t}();t.default=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=k(n(223)),a=n(7),s=k(n(520)),l=k(n(650)),u=k(n(1152)),c=k(n(179)),d=k(n(230)),f=k(n(252)),h=k(n(176)),p=k(n(253)),y=k(n(195)),v=k(n(268)),m=k(n(377)),g=k(n(330)),b=k(n(266));function k(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._TransformSpace=a.mat2d.create(),n._XHandle=new s.default,n._XHandle.color=[236/255,62/255,74/255,1],n._XHandle.hoverColor=[1,1,1,1],n._XHandle.rotationTransform=a.mat2d.fromRotation(a.mat2d.create(),Math.PI/2),n._YHandle=new s.default,n._YHandle.color=[104/255,254/255,217/255,1],n._YHandle.hoverColor=[1,1,1,1],n._TranslateItem,n._Modulation=a.vec2.set(a.vec2.create(),1,1),n._XHandle.customSelectionAction=function(){return!0},n._YHandle.customSelectionAction=function(){return!0},n.filterDragSelection=i.default.filterChildren,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"validate",value:function(){return!this.stage.soloItem}},{key:"findValidItem",value:function(e){for(var t=0;t<e.length;t++){var n=e[0];switch(n.constructor){case c.default:case d.default:case f.default:if(n.node&&n.node.isConnectedToBones&&this.stage.appContext.editingAnimation)continue;break;case g.default:case b.default:case p.default:continue}return n}return null}},{key:"updateSelection",value:function(e){e=i.default.filterChildren(e),this._TranslateItem=this.findValidItem(e),this._TranslateItem?this._XHandle.stage||(this._XHandle.addToStage(this.stage),this._YHandle.addToStage(this.stage)):this._XHandle.stage&&(this._XHandle.removeFromStage(),this._YHandle.removeFromStage())}},{key:"drawPrep",value:function(e){if(this._TranslateItem){var t=a.mat2d.create(),n=t,r=this.stage.transformSpace,o=null;switch(this._TranslateItem.constructor){case v.default:case c.default:case f.default:case d.default:(o=this._TranslateItem.node).isConnectedToBones?(t=o.getCentroidTransform(),n=o.renderTransform):t=n=o.renderTransform;break;case h.default:t=n=(o=this._TranslateItem.actorBone).renderTransform;break;case y.default:o=this._TranslateItem.node,t=this._TranslateItem.renderTransform,n=o.renderTransform}r==m.default.Parent?n=o&&o.parent?o.parent.renderTransform:a.mat2d.create():r==m.default.World&&(n=a.mat2d.create()),this._TransformSpace[0]=n[0],this._TransformSpace[1]=n[1],this._TransformSpace[2]=n[2],this._TransformSpace[3]=n[3],this._TransformSpace[4]=t[4],this._TransformSpace[5]=t[5],this._XHandle.alignToTransform(t,n),this._YHandle.alignToTransform(t,n)}}},{key:"onKeyDown",value:function(e){this.snap=e.shiftKey}},{key:"onKeyUp",value:function(e){this.snap=e.shiftKey}},{key:"startDrag",value:function(e,n){return!!this._TranslateItem&&(e==this._XHandle?(this._Modulation[0]=1,this._Modulation[1]=0):e==this._YHandle?(this._Modulation[0]=0,this._Modulation[1]=1):(this._Modulation[0]=1,this._Modulation[1]=1),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startDrag",this).call(this,e,n))}},{key:"endDrag",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"endDrag",this).call(this)}},{key:"advanceDrag",value:function(e,n,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"advanceDrag",this).call(this,e,n,r)}},{key:"disable",value:function(){this._XHandle.stage&&(this._XHandle.removeFromStage(),this._YHandle.removeFromStage()),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}},{key:"transformers",get:function(){return[l.default,u.default]}},{key:"modulation",get:function(){return this._Modulation}},{key:"transformSpace",get:function(){return this._TransformSpace}}]),t}();t.default=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(223)),i=a(n(1153));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"validate",value:function(){return!this.stage.soloItem||!!this.stage.appContext.editingWeights}},{key:"transformers",get:function(){return[i.default]}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=h(n(223)),a=h(n(179)),s=h(n(195)),l=h(n(176)),u=h(n(198)),c=h(n(219)),d=n(7),f=h(n(378));function h(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._SelectedJoint=null,n._SelectedNode=null,n._WasImageSelectionDisabled=!1,n._BaseEnable=n.enable,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"blockMarquee",value:function(e){return!0}},{key:"cancel",value:function(){}},{key:"validate",value:function(){return!this.stage.soloItem&&!this.stage.appContext.editingAnimation}},{key:"enable",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this);var e=this.stage.getLayerOptions(a.default);this._WasImageSelectionDisabled=e.disableSelection,e.disableSelection=!0,this.stage.setLayerOptions(a.default,e)}},{key:"disable",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this),this.cancel();var e=this.stage.getLayerOptions(a.default);e.disableSelection=this._WasImageSelectionDisabled,this.stage.setLayerOptions(a.default,e)}},{key:"updateSelection",value:function(e){this._SelectedJoint=null,this._SelectedNode=null;for(var t=0;t<e.length;t++){var n=e[t];n.constructor===s.default?this._SelectedJoint=n:n.constructor===l.default?this._SelectedJoint=n.joint:this._SelectedNode=n.node}null==this._SelectedNode&&this.stage.appContext.actor&&(this._SelectedNode=this.stage.appContext.actor.artboards.active)}},{key:"click",value:function(e,t,n){var r=this.stage.appContext.actor,o=r.artboards.active;if(!o)return this.stage.displayWarning({title:"No Artboard.",message:"Create an artboard to add elements on the stage."}),!1;if(t)return!1;if(this._CreatedJoint=null,!n.altKey&&this._SelectedJoint){var i=r.addNodeType(u.default,this._SelectedJoint.node,null);if(!i)return;var a=i.stageItem.joint;i.stageItem.addToStage(this.stage);var s=new f.default(!1,!1,[a]);s.preTransform(),i.stageItem.joint.renderTransform=d.mat2d.fromTranslation(d.mat2d.create(),e),s.skipPreTransform=!0,s.advance([0,0],[0,0]),s.skipPreTransform=!1,this.addActiveTransformer(s),this._CreatedJoint=a,this.stage.selectItem(this._CreatedJoint)}else{var l=r.addNodeType(c.default,this._SelectedJoint&&this._SelectedJoint.node||this._SelectedNode,{});if(!l)return;var h=l.stageItem,p=this._SelectedNode.worldTransform,y=d.mat2d.invert(d.mat2d.create(),p);l.translation=d.vec2.transformMat2d(d.vec2.create(),o.localTranslation(e),y),l.stageItem.addToStage(this.stage);var v=new f.default(!1,!1,[h]);v.preTransform(),h.renderTransform=d.mat2d.fromTranslation(d.mat2d.create(),e),v.skipPreTransform=!0,v.advance([0,0],[0,0]),v.skipPreTransform=!1,this.addActiveTransformer(v),this.stage.selectItem(l.stageItem)}}}]),t}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=d(n(223)),a=d(n(179)),s=d(n(176)),l=d(n(173)),u=n(7),c=d(n(376));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._WasImageSelectionDisabled=!1,n._WasBoneSelectionDisabled=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"enable",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this);var e=this.stage.getLayerOptions(a.default);this._WasImageSelectionDisabled=e.disableSelection,e.disableSelection=!0,this.stage.setLayerOptions(a.default,e);var n=this.stage.getLayerOptions(s.default);this._WasBoneSelectionDisabled=n.disableSelection,n.disableSelection=!0,this.stage.setLayerOptions(s.default,n)}},{key:"validate",value:function(){return!this.stage.soloItem&&!this.stage.appContext.editingAnimation}},{key:"disable",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this);var e=this.stage.getLayerOptions(a.default);e.disableSelection=this._WasImageSelectionDisabled,this.stage.setLayerOptions(a.default,e);var n=this.stage.getLayerOptions(s.default);n.disableSelection=this._WasBoneSelectionDisabled,this.stage.setLayerOptions(s.default,n)}},{key:"click",value:function(e,t){var n=this.stage.appContext.actor;if(!n.artboards.active)return this.stage.displayWarning({title:"No Artboard.",message:"Create an artboard to add elements on the stage."}),!1;if(t)return!1;var r=this.stage.selectedItems,o=n.addNodeType(l.default,r&&r.length&&r[0].node||null,null);if(o){o.stageItem.addToStage(this.stage);var i=o.parent.renderTransform,a=u.mat2d.invert(u.mat2d.create(),i);o.translation=u.vec2.transformMat2d(u.vec2.create(),e,a);var s=new c.default(!1,!1,[o]);return this.addActiveTransformer(s),this.stage.selectItem(o.stageItem),!0}}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=c(n(223)),a=c(n(179)),s=c(n(237)),l=n(7),u=c(n(376));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"enable",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this);var e=this.stage.getLayerOptions(a.default);this._WasImageSelectionDisabled=e.disableSelection,e.disableSelection=!0,this.stage.setLayerOptions(a.default,e)}},{key:"validate",value:function(){return!this.stage.appContext.editingAnimation}},{key:"disable",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this);var e=this.stage.getLayerOptions(a.default);e.disableSelection=this._WasImageSelectionDisabled,this.stage.setLayerOptions(a.default,e)}},{key:"click",value:function(e,t){var n=this.stage.appContext.actor;if(!n.artboards.active)return this.stage.displayWarning({title:"No Artboard.",message:"Create an artboard to add elements on the stage."}),!1;if(t)return!1;var r=this.stage.selectedItems,o=n.addNodeType(s.default,r&&r.length&&r[0].node||null,null);if(o){o.stageItem.addToStage(this.stage);var i=o.parent.renderTransform,a=l.mat2d.invert(l.mat2d.create(),i);o.translation=l.vec2.transformMat2d(l.vec2.create(),e,a);var c=new u.default(!1,!1,[o]);return this.addActiveTransformer(c),this.stage.selectItem(o.stageItem),!0}}}]),t}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=d(n(223)),s=d(n(236)),l=n(7),u=d(n(350)),c=d(n(2));function d(e){return e&&e.__esModule?e:{default:e}}var f,h,p,y,v,m,g=new Float32Array([1,0,0,0,1,0,0,0]),b=(r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Editing=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"blockMarquee",value:function(e){return!0}},{key:"enable",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this),this.updateEditing()}},{key:"disable",value:function(){this.setEditing(null),this.hideGhostPoint(),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this)}},{key:"validate",value:function(){return!this.stage.appContext.editingAnimation}},{key:"onEditingChanged",value:function(){}},{key:"setEditing",value:function(e){if(!function(e,t){if(!e||!t)return!1;if(e.size!==t.size)return!1;var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(!t.has(s))return!1}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return!0}(this._Editing,e)){if(this._Editing){var t=!0,n=!1,r=void 0;try{for(var o,i=this._Editing[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.stageItem.removeEventListener("removedFromStage",this.updateEditing)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}if(this.onEditingChanged(e),this._Editing=e,e){var a=!0,s=!1,l=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.stageItem.addEventListener("removedFromStage",this.updateEditing)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}}},{key:"updateEditing",value:function(){var e=this.stage.soloItem,t=this.getEditing(e);this.setEditing(new Set(t))}},{key:"updateSelection",value:function(e){this.updateEditing()}},{key:"updateSolo",value:function(e){this.updateEditing()}},{key:"showGhostPoint",value:function(e){this._PointTransform=l.mat2d.fromTranslation(l.mat2d.create(),e),this.stage.redraw()}},{key:"hideGhostPoint",value:function(){null!=this._PointTransform&&(this._PointTransform=null,this.stage.redraw())}},{key:"getInsertTarget",value:function(e,t){return null}},{key:"shouldHideGhost",value:function(e,t){return!1}},{key:"mouseMove",value:function(e,t,n,r){var o=this.stage,i=this._Editing;if(o.hoverItem)return this.insertTarget=null,void this.hideGhostPoint();if(!i)return this.insertTarget=null,void this.showGhostPoint(n);var a=this.getInsertTarget(i,n);if(this.insertTarget=a,this.shouldHideGhost(i,n))return this.insertTarget=null,void this.hideGhostPoint();this.showGhostPoint(a&&a.worldPoint||n)}},{key:"advanceDrag",value:function(e,n,r,o){this._SkipNextDrag?this._SkipNextDrag=!1:i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"advanceDrag",this).call(this,e,n,r,o)}},{key:"draw",value:function(e){this._PointTransform&&s.default.drawVertex(e,this.stage,1,!1,!1,this._PointTransform)}},{key:"transformers",get:function(){return[u.default]}}],[{key:"validateNode",value:function(e){return e&&e.stageItem&&null!==e.stageItem.stage?e:null}},{key:"DefaultSkinTransformWeights",get:function(){return g}}]),t}(),f=r.prototype,h="updateEditing",p=[c.default],y=Object.getOwnPropertyDescriptor(r.prototype,"updateEditing"),v=r.prototype,m={},Object.keys(y).forEach(function(e){m[e]=y[e]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=p.slice().reverse().reduce(function(e,t){return t(f,h,e)||e},m),v&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(v):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(f,h,m),m=null),r);t.default=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(228)),i=a(n(218));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Ellipse",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"getPathPoints",value:function(){var e=[],t=Math.max(0,this.width/2),n=Math.max(0,this.height/2);return e.push({pointType:i.default.Disconnected,in:[.552284749831*-t,-n],translation:[0,-n],out:[.552284749831*t,-n]}),e.push({pointType:i.default.Disconnected,in:[t,.552284749831*-n],translation:[t,0],out:[t,.552284749831*n]}),e.push({pointType:i.default.Disconnected,in:[.552284749831*t,n],translation:[0,n],out:[.552284749831*-t,n]}),e.push({pointType:i.default.Disconnected,in:[-t,.552284749831*n],translation:[-t,0],out:[-t,.552284749831*-n]}),e}},{key:"typeName",get:function(){return"Ellipse"}},{key:"uiHierIconClass",get:function(){return"HierarchyImageIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"uiIcon",get:function(){return"icon-picture"}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(5)),s=c(n(2)),l=c(n(353)),u=n(334);function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.colorPicker&&this.colorPicker.doClose(),this.context.nima.stage.addEventListener("selectionChanged",this.onStageSelection)}},{key:"componentWillUnmount",value:function(){this.context.nima.stage.removeEventListener("selectionChanged",this.onStageSelection),this.colorPicker&&this.onClosed(this.colorPicker)}},{key:"onStageSelection",value:function(e,t){var n=e.find(function(e){return e instanceof u.StageGradientPoint});n&&this.colorPicker&&this.colorPicker.selectGradientStop(n.colorIndex)}},{key:"setKey",value:function(e){e.stopPropagation(),this.props.onSetKey&&this.props.onSetKey(this.props.value)}},{key:"colorChanged",value:function(e,t){this.props.onValueChanged&&this.props.onValueChanged(e,t),t||this.context.nima.captureJournalEntry()}},{key:"cancelColorPicker",value:function(){this.colorPicker&&this.colorPicker.doClose()}},{key:"onOpened",value:function(e){this.colorPicker=e,this.context.nima.setCancelCallback(this.cancelColorPicker),this.props.onOpened&&this.props.onOpened(e)}},{key:"onClosed",value:function(e){this.context.nima.clearCancelCallback(this.cancelColorPicker),this.props.onClosed&&this.props.onClosed(e)}},{key:"setColorPicker",value:function(e){this.colorPicker=e}},{key:"setMarker",value:function(e){this.setState({marker:e})}},{key:"render",value:function(){var e;switch(this.props.keyState){default:case 0:e="SelectionPanelKey";break;case 1:e="SelectionPanelKeyChanged";break;case 2:e="SelectionPanelKeyed"}var t=this.props.allowChangeType;return void 0===t&&(t=!this.props.isAnimating),[this.props.marker?i.default.createElement("div",{ref:this.setMarker,key:"m",className:this.props.marker}):null,i.default.createElement("div",{key:"p",className:"SelectionPanelInputField"+(this.props.isEmpty?" SelectionPanelInputFieldDisabled":"")+(this.props.addClass?" "+this.props.addClass:"")},this.props.label?i.default.createElement("div",{className:"SelectionPanelInputLabel"},this.props.label):null,i.default.createElement(l.default,{ref:this.setColorPicker,isEmpty:this.props.isEmpty,disabled:this.props.disabled,placementMarker:this.state.marker,color:this.props.value,onColorChange:this.colorChanged,onOpened:this.onOpened,onClosed:this.onClosed,checkClose:this.props.checkClose,allowChangeType:t,allowDelete:!this.props.isAnimating}),i.default.createElement("div",{className:e+" ColorPickerKey",onMouseDown:this.setKey,style:{display:this.props.isAnimating?null:"none"}},i.default.createElement("div",null)))]}}]),t}()).prototype,"onStageSelection",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onStageSelection"),r.prototype),d(r.prototype,"setKey",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setKey"),r.prototype),d(r.prototype,"colorChanged",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"colorChanged"),r.prototype),d(r.prototype,"cancelColorPicker",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"cancelColorPicker"),r.prototype),d(r.prototype,"onOpened",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onOpened"),r.prototype),d(r.prototype,"onClosed",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onClosed"),r.prototype),d(r.prototype,"setColorPicker",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setColorPicker"),r.prototype),d(r.prototype,"setMarker",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setMarker"),r.prototype),r);t.default=f,f.contextTypes={nima:a.default.object}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(228)),i=n(7),a=s(n(218));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Triangle",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"getOBB",value:function(e){var t=Number.MAX_VALUE,n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=-Number.MAX_VALUE;function a(a){e&&(a=i.vec2.transformMat2d(i.vec2.create(),a,e)),a[0]<t&&(t=a[0]),a[1]<n&&(n=a[1]),a[0]>r&&(r=a[0]),a[1]>o&&(o=a[1])}var s=this.width/2,l=this.height/2;return a([0,-l]),a([s,l]),a([-s,l]),[i.vec2.fromValues(t,n),i.vec2.fromValues(r,o)]}},{key:"getPathPoints",value:function(){var e=[],t=this.width/2,n=this.height/2;return e.push({pointType:a.default.Straight,translation:[0,-n]}),e.push({pointType:a.default.Straight,translation:[t,n]}),e.push({pointType:a.default.Straight,translation:[-t,n]}),e}},{key:"typeName",get:function(){return"Triangle"}},{key:"uiHierIconClass",get:function(){return"HierarchyImageIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"uiIcon",get:function(){return"icon-picture"}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DistanceMode=t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(287)),a=n(7),s=l(n(269));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=function(e){function t(e){u(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Distance Constraint",n._Distance=100,n._Mode=f.Closer,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.distance;void 0!==r&&(this._Distance=Number.parseFloat(r));var i=n.mode;void 0!==i&&(this._Mode=f.fromString(i))}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.mode=this._Mode.toString(),n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.distance=this._Distance,e.mode=this._Mode,e}},{key:"onTargetOptionChanged",value:function(){this.resetDistance()}},{key:"resetDistance",value:function(){var e=this.target;if(e){var t=e.worldTranslation,n=this.parent.worldTranslation;this.distance=a.vec2.distance(t,n)}}},{key:"constrain",value:function(e){var t=this._Target;if(t){var n=this.parent,r=t.worldTranslation,o=n.worldTranslation,i=this.strength,s=this.mode,l=this.distance,u=a.vec2.subtract(a.vec2.create(),o,r),c=a.vec2.length(u);switch(s){case f.Closer:if(c<l)return!0;break;case f.Further:if(c>l)return!0}if(c<.001)return!0;a.vec2.scale(u,u,1/c),a.vec2.scale(u,u,l);var d=n.worldTransform,h=a.vec2.lerp(a.vec2.create(),o,a.vec2.add(a.vec2.create(),r,u),i);return d[4]=h[0],d[5]=h[1],!0}}},{key:"distance",get:function(){return this._Distance},set:function(e){this._Distance!==e&&(this._Distance=e,this.markDirty(),this.dispatch("changeDistanceConstraint"))}},{key:"mode",get:function(){return this._Mode},set:function(e){this._Mode!==e&&(this._Mode=e,this.markDirty(),this.dispatch("changeDistanceConstraint"))}}],[{key:"constraintName",get:function(){return"Distance"}},{key:"targetName",get:function(){return"Target"}}]),t}();t.default=c;var d=new Map,f=t.DistanceMode=function(){function e(t,n){u(this,e),this._Label=t,this._ID=n,d.set(t,this)}return r(e,[{key:"toString",value:function(){return this._Label}},{key:"id",get:function(){return this._ID}}],[{key:"fromString",value:function(e){return d.get(e)||s.default.World}}]),e}();f.Closer=new f("closer",0),f.Further=new f("further",1),f.Exact=new f("exact",2)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Decompose=function(e,t){var n=e[0],r=e[1],o=e[2],i=e[3],a=Math.atan2(r,n),s=n*n+r*r,l=Math.sqrt(s),u=(n*i-o*r)/l,c=Math.atan2(n*o+r*i,s);t[0]=e[4],t[1]=e[5],t[2]=l,t[3]=u,t[4]=a,t[5]=c},t.Compose=function(e,t){var n=t[4];0!==n?r.mat2d.fromRotation(e,n):r.mat2d.identity(e);e[4]=t[0],e[5]=t[1],r.mat2d.scale(e,e,[t[2],t[3]]);var o=t[5];0!==o&&(e[2]=e[0]*o+e[2],e[3]=e[1]*o+e[3])};var r=n(7)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(2)),s=c(n(5)),l=c(n(29)),u=c(n(384));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={editing:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"commitEdit",value:function(){var e=new u.default(this.context.nima.stage,this.context.nima.actor,this.props.item,this.inputText.value);e.start(),e.end(),this.context.nima.actor.revise(),this.endEdit(!1),this.forceUpdate()}},{key:"endEdit",value:function(){this.setState({editing:!1}),this.inputText&&this.inputText.removeEventListener("blur",this.commitEdit),clearTimeout(this.editTimeout)}},{key:"cancelEdit",value:function(){this.endEdit(!0)}},{key:"startEdit",value:function(){var e=this.props.item;return!e.isNameReadOnly&&(this.setState({editing:!0,editName:e.name}),!0)}},{key:"editKeyDown",value:function(e){switch(e.keyCode){case 13:this.inputText.blur();break;case 27:this.cancelEdit(),this.inputText.blur()}}},{key:"editTextChange",value:function(e){this.setState({editName:e.target.value})}},{key:"setInputText",value:function(e){var t=this.inputText;t&&t.removeEventListener("blur",this.commitEdit),this.inputText=e,e&&(e.focus(),e.setSelectionRange(0,e.value.length),e.addEventListener("blur",this.commitEdit))}},{key:"render",value:function(){var e=this.props.item;return i.default.createElement("div",{className:l.default.ItemName},this.state.editing?i.default.createElement("input",{ref:this.setInputText,type:"text",value:this.state.editName,onKeyDown:this.editKeyDown,onChange:this.editTextChange}):e.name)}}]),t}()).prototype,"commitEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commitEdit"),r.prototype),d(r.prototype,"endEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"endEdit"),r.prototype),d(r.prototype,"cancelEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"cancelEdit"),r.prototype),d(r.prototype,"startEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"startEdit"),r.prototype),d(r.prototype,"editKeyDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"editKeyDown"),r.prototype),d(r.prototype,"editTextChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"editTextChange"),r.prototype),d(r.prototype,"setInputText",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setInputText"),r.prototype),r);t.default=f,f.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(618),a=(r=i)&&r.__esModule?r:{default:r};var s=new Map,l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e._Idx++,e._Stack.push(this),this._Idx=e._Idx,this._Priority=1,this.set(t)}return o(e,[{key:"set",value:function(t,n){this._Type=t,this._Priority=n||1,e._Stack=a.default.sortBy(e._Stack,function(e){return e._Idx}),e._Stack=a.default.sortBy(e._Stack,function(e){return e._Priority}),e.updateCursor()}},{key:"remove",value:function(){var t=e._Stack.indexOf(this);-1!==t&&e._Stack.splice(t,1),e.updateCursor()}}],[{key:"updateCursor",value:function(){for(var t=e._Stack.length-1;t>=0;t--){var n=e._Stack[t];return void(document.body.style.cursor=n._Type)}document.body.style.cursor=""}},{key:"set",value:function(t,n,r){var o=s.get(t);o||(o=new e,s.set(t,o)),o.set(n,r)}},{key:"remove",value:function(e){var t=s.get(e);t&&(t.remove(),s.delete(e))}}]),e}();t.default=l,l._Stack=[],l._Idx=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(420)),i=s(n(267)),a=s(n(536));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Bitmap=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"resolveChildType",value:function(e,t){return t==a.default.dataType?a.default:null}},{key:"replaceWith",value:function(e,t){for(var n=this._Children,r=0;r<this._Children.length;r++)this._Children[r];var o=e.children,i=[];if(t.artboards.eachChildRecursive(function(e){if(-1!==n.indexOf(e.asset)){for(var t=!1,r=0;r<o.length;r++){var a=o[r];if(a.name==e.asset.name){e.asset=a,t=!0;break}}t||i.push(e.asset)}}),i.length){for(var a=this._Children.slice(0),s=0;s<a.length;s++){var l=a[s];-1===i.indexOf(l)&&this.remove(l,!0)}this.dispatch("childrenChanged",this)}else t.removeAsset(this)}},{key:"uiIcon",get:function(){return"icon-psd-asset"}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"uiHierThumbClass",get:function(){return"psdThumb"}},{key:"typeName",get:function(){return"Image Asset"}},{key:"bitmap",get:function(){return this._Bitmap}}]),t}();t.default=l,l.prototype.fromFile=i.default.prototype.fromFile,l.prototype.fromBase64=i.default.prototype.fromBase64,l.prototype.readRaw=i.default.prototype.readRaw},function(e,t,n){var r=n(1182);"string"==typeof r&&(r=[[e.i,r,""]]);var o={insertAt:"top",hmr:!0,transform:void 0};n(14)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.floor(100*e)/100}},{key:"toInputValue",value:function(e){return e}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e);if(t<0)throw"Invalid input";return t}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"defaultValue",get:function(){return 1}},{key:"allowDrag",get:function(){return!0}},{key:"dragScale",get:function(){return.005}},{key:"dragFastScale",get:function(){return.015}},{key:"dragMin",get:function(){return 0}},{key:"dragMax",get:function(){return 1}}]),e}();t.default=o},function(e,t,n){var r=n(1231);"string"==typeof r&&(r=[[e.i,r,""]]);var o={insertAt:"top",hmr:!0,transform:void 0};n(14)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(1241);"string"==typeof r&&(r=[[e.i,r,""]]);var o={insertAt:"top",hmr:!0,transform:void 0};n(14)(r,o);r.locals&&(e.exports=r.locals)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=O(n(1141)),i=O(n(634)),a=O(n(645)),s=O(n(348)),l=O(n(304)),u=O(n(349)),c=O(n(422)),d=O(n(423)),f=O(n(424)),h=O(n(425)),p=O(n(523)),y=O(n(426)),v=O(n(427)),m=O(n(524)),g=O(n(381)),b=O(n(526)),k=O(n(527)),S=O(n(666));function O(e){return e&&e.__esModule?e:{default:e}}var w=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.togglePlayPressTime=Date.now(),this.onAction=this.onAction.bind(this),this.onActionReleased=this.onActionReleased.bind(this)}return r(e,[{key:"onAction",value:function(e,t){if(t)switch(e){case _.PreviousItem:case _.NextItem:case _.BrushSizeUp:case _.BrushSizeDown:case _.BrushFeatherUp:case _.BrushFeatherDown:case _.BrushStrengthUp:case _.BrushStrengthDown:case _.NudgeRight:case _.NudgeLeft:case _.NudgeUp:case _.NudgeDown:case _.BumpRight:case _.BumpLeft:case _.BumpUp:case _.BumpDown:case _.NextFrame:case _.PreviousFrame:case _.Next10Frames:case _.Previous10Frames:case _.MoveSelectionPrevFrame:case _.MoveSelectionNextFrame:case _.MoveSelectionPrev10Frames:case _.MoveSelectionNext10Frames:break;default:return}switch(e){case _.ToggleEditMode:this.app.toggleEditMode();break;case _.PickParent:this.app.pickParent();break;case _.BringForward:this.app.incrementSelectionDrawOrder(1);break;case _.SendBackward:this.app.incrementSelectionDrawOrder(-1);break;case _.SendToFront:this.app.bumpSelectionDrawOrder(1);break;case _.SendToBack:this.app.bumpSelectionDrawOrder(-1);break;case _.HoverShowInHierarchy:this.app.editor.hoverShowInHierarchy();break;case _.SwitchMode:this.app.editor.toggleWorkspace();break;case _.KeySelected:this.app.keySelected(!0,!0,!0,!0);break;case _.KeySelectedTranslation:this.app.keySelected(!0,!1,!1,!1);break;case _.KeySelectedRotation:this.app.keySelected(!1,!0,!1,!1);break;case _.KeySelectedScale:this.app.keySelected(!1,!1,!0,!1);break;case _.KeySelectedLength:this.app.keySelected(!1,!1,!1,!0);break;case _.NudgeLeft:this.app.translateSelection([-1,0]);break;case _.NudgeRight:this.app.translateSelection([1,0]);break;case _.NudgeUp:this.app.translateSelection([0,-1]);break;case _.NudgeDown:this.app.translateSelection([0,1]);break;case _.BumpLeft:this.app.translateSelection([-10,0]);break;case _.BumpRight:this.app.translateSelection([10,0]);break;case _.BumpUp:this.app.translateSelection([0,-10]);break;case _.BumpDown:this.app.translateSelection([0,10]);break;case _.NextSelectionFilter:this.app.incSelectionFilter(1);break;case _.PreviousSelectionFilter:this.app.incSelectionFilter(-1);break;case _.ToggleRulers:this.app.setProjectPreference("showGuides",!this.app.getPreference("showGuides"));break;case _.ResetRulers:this.app.resetGuides();break;case _.Item1:this.app.selectIndexItem(0);break;case _.Item2:this.app.selectIndexItem(1);break;case _.Item3:this.app.selectIndexItem(2);break;case _.Item4:this.app.selectIndexItem(3);break;case _.Item5:this.app.selectIndexItem(4);break;case _.Item6:this.app.selectIndexItem(5);break;case _.Item7:this.app.selectIndexItem(6);break;case _.Item8:this.app.selectIndexItem(7);break;case _.Item9:this.app.selectIndexItem(8);break;case _.Item10:this.app.selectIndexItem(9);break;case _.NextItem:this.app.selectIndexItemNext();break;case _.PreviousItem:this.app.selectIndexItemPrevious();break;case _.BrushSizeUp:this.app.incBrushSize(t?10:1);break;case _.BrushSizeDown:this.app.incBrushSize(t?-10:-1);break;case _.BrushFeatherUp:this.app.incBrushFeather(t?10:1);break;case _.BrushFeatherDown:this.app.incBrushFeather(t?-10:-1);break;case _.BrushStrengthUp:this.app.incBrushStrength(.1);break;case _.BrushStrengthDown:this.app.incBrushStrength(-.1);break;case _.TogglePlay:this.togglePlayPressTime=Date.now();break;case _.Copy:this.app.copy();break;case _.Paste:return!0;case _.Cut:this.app.cut();break;case _.Delete:this.app.delete();break;case _.Cancel:this.app.cancel();break;case _.Undo:this.app.undo();break;case _.Deselect:this.app.deselect();break;case _.Redo:this.app.redo();break;case _.Find:this.app.find();break;case _.DrawMeshTool:this.app.stage.toolType=i.default;break;case _.SelectChildrenTool:this.app.stage.toolType===a.default?this.app.stage.tool.close():this.app.stage.toolType=a.default;break;case _.PaintWeightTool:this.app.stage.toolType=s.default;break;case _.VertexWeightTool:this.app.stage.toolType=l.default;break;case _.TranslateTool:this.app.stage.toolType=u.default;break;case _.RotateTool:this.app.stage.toolType=c.default;break;case _.ScaleTool:this.app.stage.toolType=d.default;break;case _.IKTool:this.app.stage.toolType=f.default;break;case _.BoneTool:this.app.stage.toolType=h.default;break;case _.ArtboardTool:this.app.stage.toolType=p.default;break;case _.NodeTool:this.app.stage.toolType=y.default;break;case _.SoloTool:this.app.stage.toolType=v.default;break;case _.PenTool:this.app.stage.selectTool(g.default)||this.app.stage.selectTool(m.default);break;case _.RectangleTool:this.app.stage.toolType=b.default;break;case _.EllipseTool:this.app.stage.toolType=k.default;break;case _.ZoomFit:this.app.zoomFit();break;case _.Group:this.app.group();break;case _.GroupSolo:this.app.groupSolo();break;case _.SelectAll:this.app.selectAll();break;case _.ZoomIn:var n=this.app.stage.zoom,r=(0,o.default)(n);r<=n&&(r*=2),this.app.stage.zoom=r;break;case _.ZoomOut:var S=this.app.stage.zoom,O=(0,o.default)(S);O>=S&&(O/=2),this.app.stage.zoom=O;break;case _.Zoom100:this.app.stage.zoom=1;break;case _.Pan:this.app.startPan();break;case _.TimelineStart:this.app.editingAnimation&&(this.app.editingAnimation.position=0,this.app.editingAnimation.showPlayhead());break;case _.TimelineEnd:this.app.editingAnimation&&(this.app.editingAnimation.position=this.app.editingAnimation.duration,this.app.editingAnimation.showPlayhead());break;case _.NextFrame:this.app.editingAnimation&&this.app.editingAnimation.moveFrames(1);break;case _.NextKeyFrame:this.app.editingAnimation&&this.app.editingAnimation.moveKeyFrames(!0);break;case _.PreviousFrame:this.app.editingAnimation&&this.app.editingAnimation.moveFrames(-1);break;case _.PreviousKeyFrame:this.app.editingAnimation&&this.app.editingAnimation.moveKeyFrames(!1);break;case _.Next10Frames:this.app.editingAnimation&&this.app.editingAnimation.moveFrames(10);break;case _.Previous10Frames:this.app.editingAnimation&&this.app.editingAnimation.moveFrames(-10);break;case _.ForceRevision:this.app.forceRevision();break;case _.ToggleShortcutsModal:this.app.editor.toggleShortcutsModal();break;case _.MoveSelectionPrevFrame:this.app.editingAnimation&&this.app.editingAnimation.moveSelectedFrames(-1);break;case _.MoveSelectionNextFrame:this.app.editingAnimation&&this.app.editingAnimation.moveSelectedFrames(1);break;case _.MoveSelectionPrev10Frames:this.app.editingAnimation&&this.app.editingAnimation.moveSelectedFrames(-10);break;case _.MoveSelectionNext10Frames:this.app.editingAnimation&&this.app.editingAnimation.moveSelectedFrames(10);break;case _.Duplicate:this.app.duplicate()}}},{key:"onActionReleased",value:function(e){switch(e){case _.TogglePlay:this.app.editor.state.showExportToEngine&&this.app.editor.exporter===S.default?this.app.editor.exportScreen.togglePause():this.app.editingAnimation&&Date.now()-this.togglePlayPressTime<200&&(this.app.editingAnimation.isPlaying=!this.app.editingAnimation.isPlaying);break;case _.Pan:this.app.stage.isPanning=!1}}}]),e}();t.default=w;var _={ArtboardTool:"artboard-tool",BoneTool:"bone-tool",Cancel:"cancel",ColliderTool:"collider-tool",Copy:"copy",Cut:"cut",Delete:"delete",Deselect:"deselect",DrawMeshTool:"draw-mesh-tool",Duplicate:"duplicate",Find:"find",ForceRevision:"force-revision",Group:"group",GroupSolo:"group-solo",IKTool:"ik-tool",MoveSelectionPrevFrame:"move-selection-prev-frame",MoveSelectionNextFrame:"move-selection-next-frame",MoveSelectionPrev10Frames:"move-selection-prev-10-frames",MoveSelectionNext10Frames:"move-selection-next-10-frames",Next10Frames:"next-10-frames",NextFrame:"next-frame",NextKeyFrame:"next-key-frame",NodeTool:"node-tool",PaintWeightTool:"paint-weight-tool",VertexWeightTool:"vertex-weight-tool",Pan:"pan",Paste:"paste",Previous10Frames:"prev-10-frames",PreviousFrame:"prev-frame",PreviousKeyFrame:"previous-key-frame",Redo:"redo",RotateTool:"rotate-tool",ScaleTool:"scale-tool",SelectAll:"select-all",SelectChildrenTool:"select-children-tool",ToggleShortcutsModal:"show-shortcuts-modal",SoloTool:"solo-tool",PenTool:"pen-tool",RectangleTool:"rectangle-tool",EllipseTool:"ellipse-tool",TimelineEnd:"timeline-end",TimelineStart:"timeline-start",TogglePlay:"toggle-play",TranslateTool:"translate-tool",Undo:"undo",Zoom100:"zoom-100",ZoomFit:"zoom-fit",ZoomIn:"zoom-in",ZoomOut:"zoom-out",BrushFeatherDown:"brush-feather-down",BrushFeatherUp:"brush-feather-up",BrushSizeDown:"brush-size-down",BrushSizeUp:"brush-size-up",BrushStrengthDown:"brush-strength-down",BrushStrengthUp:"brush-strength-up",Item1:"item1",Item10:"item10",Item2:"item2",Item3:"item3",Item4:"item4",Item5:"item5",Item6:"item6",Item7:"item7",Item8:"item8",Item9:"item9",KeySelected:"key-selected",KeySelectedLength:"key-selected-length",KeySelectedRotation:"key-selected-rotation",KeySelectedScale:"key-selected-scale",KeySelectedTranslation:"key-selected-translation",NextItem:"next-item",PreviousItem:"prev-item",BumpDown:"bump-down",BumpLeft:"bump-left",BumpRight:"bump-right",BumpUp:"bump-up",NudgeDown:"nudge-down",NudgeLeft:"nudge-left",NudgeRight:"nudge-right",NudgeUp:"nudge-up",ResetRulers:"reset-rulers",ToggleRulers:"toggle-rulers",AllSelectionFilter:"all-selection-filter",BoneSelectionFilter:"bone-selection-filter",ImageSelectionFilter:"image-selection-filter",NextSelectionFilter:"next-selection-filter",PreviousSelectionFilter:"previous-selection-filter",VertexSelectionFilter:"vertex-selection-filter",HoverShowInHierarchy:"hover-show-in-hierarchy",SwitchMode:"switch-mode",BringForward:"bring-forward",SendBackward:"send-backward",SendToBack:"send-to-back",SendToFront:"send-to-front",PickParent:"pick-parent",ToggleEditMode:"toggle-edit-mode"};w.Actions=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=l(n(168)),i=l(n(197)),a=l(n(225)),s=l(n(228));function l(e){return e&&e.__esModule?e:{default:e}}var u=null,c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"clip",value:function(e){for(var t=this.node,n=e.skCanvas,r=t,o=[];r;)r.clips&&o.push(r.clips),r=r.parent;if(t.root&&t.root.clip(e),o.length){var l=!0,c=!1,d=void 0;try{for(var f,h=o[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var p=f.value,y=e.makePath(!0),v=function(t){var n=new Set;t.all(function(e){e.constructor===i.default&&n.add(e)});var r=!0,o=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var d=u.value,f=!0,h=!1,p=void 0;try{for(var v,m=d.children[Symbol.iterator]();!(f=(v=m.next()).done);f=!0){var g=v.value;(g.constructor===a.default||g instanceof s.default)&&y.addPath(g.getPath(e),g.getPathTransform())}}catch(e){h=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(h)throw p}}}}catch(e){o=!0,l=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw l}}},m=!0,g=!1,b=void 0;try{for(var k,S=p[Symbol.iterator]();!(m=(k=S.next()).done);m=!0){var O=k.value;v(O)}}catch(e){g=!0,b=e}finally{try{!m&&S.return&&S.return()}finally{if(g)throw b}}y.isEmpty()||n.clipPath(y,u.ClipOp.Intersect,!0)}}catch(e){c=!0,d=e}finally{try{!l&&h.return&&h.return()}finally{if(c)throw d}}}}}],[{key:"initializeStageContext",value:function(e,t){u=e.canvasKit}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.node=t}return r(e,[{key:"name",get:function(){return this.node.name}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=s(n(173)),a=s(n(509));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._DrawOrder=0,n._AnimationDrawOrder=0,n._BlendMode=a.default.SrcOver,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"onRootChanged",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onRootChanged",this).call(this,e,n),e&&e.drawOrder.removeDrawable(this),n&&n.drawOrder.addDrawable(this)}},{key:"onChildrenChanged",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildrenChanged",this).call(this),this.forceRedraw()}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.drawOrder;void 0!==r&&(this._DrawOrder=r);var i=n.blendMode;void 0!==i&&(this._BlendMode=a.default.fromString(i))}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.blendMode=this._BlendMode,e.drawOrder=this._DrawOrder,e}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.blendMode=this._BlendMode.toString(),n}},{key:"onBlendModeChanged",value:function(e){this.forceRedraw()}},{key:"nullFrame",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"nullFrame",this).call(this);return e.frameDrawOrder=null,e}},{key:"rigDrawOrder",get:function(){return this._DrawOrder},set:function(e){this._DrawOrder=e}},{key:"drawOrder",get:function(){return this.useAnimationValues?this._AnimationDrawOrder:this._DrawOrder},set:function(e){if(this.useAnimationValues){if(e!=this._AnimationDrawOrder){var t=this._AnimationDrawOrder;this.frameDrawOrder=e,this.dispatch("animateDrawOrder",{from:t,to:e}),this.dispatch("drawOrderChange")}}else this._DrawOrder!=e&&(this.dispatch("drawOrderChange"),this._DrawOrder=e,this.forceRedraw())}},{key:"blendMode",get:function(){return this._BlendMode},set:function(e){this._BlendMode!==e&&(this._BlendMode=e,this.dispatch("blendModeChange"),this.onBlendModeChanged(e))}},{key:"frameDrawOrder",get:function(){return this._AnimationDrawOrder},set:function(e){this._AnimationDrawOrder!=e&&(this._AnimationDrawOrder=e,this.dispatch("drawOrderChange"))}},{key:"hierarchySortOrder",get:function(){return this.drawOrder},set:function(e){this.drawOrder=e}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=new Map,i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Label=t,o.set(t,this)}return r(e,[{key:"toString",value:function(){return this._Label}}],[{key:"fromString",value:function(t){return o.get(t)||e.Empty}}]),e}();t.default=i,i.Empty=new i("empty"),i.Target=new i("target")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=new Map,i=[],a=new Map,s=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._LegibleID=n,this._Label=r,this._ID=t,o.set(n,this),i.push(this),a.set(t,this)}return r(e,[{key:"toString",value:function(){return this._LegibleID}},{key:"id",get:function(){return this._ID}},{key:"label",get:function(){return this._Label}},{key:"legibleID",get:function(){return this._LegibleID}}],[{key:"fromString",value:function(t){return o.get(t)||e.SrcOver}},{key:"fromID",value:function(t){return a.get(t)||e.SrcOver}},{key:"setCanvasKit",value:function(t){var n=t.BlendMode;e.Clear.sk=n.Clear,e.Src.sk=n.Src,e.Dst.sk=n.Dst,e.SrcOver.sk=n.SrcOver,e.DstOver.sk=n.DstOver,e.SrcIn.sk=n.SrcIn,e.DstIn.sk=n.DstIn,e.SrcOut.sk=n.SrcOut,e.DstOut.sk=n.DstOut,e.SrcATop.sk=n.SrcATop,e.DstATop.sk=n.DstATop,e.Xor.sk=n.Xor,e.Plus.sk=n.Plus,e.Modulate.sk=n.Modulate,e.Screen.sk=n.Screen,e.Overlay.sk=n.Overlay,e.Darken.sk=n.Darken,e.Lighten.sk=n.Lighten,e.ColorDodge.sk=n.ColorDodge,e.ColorBurn.sk=n.ColorBurn,e.HardLight.sk=n.HardLight,e.SoftLight.sk=n.SoftLight,e.Difference.sk=n.Difference,e.Exclusion.sk=n.Exclusion,e.Multiply.sk=n.Multiply,e.Hue.sk=n.Hue,e.Saturation.sk=n.Saturation,e.Color.sk=n.Color,e.Luminosity.sk=n.Luminosity}},{key:"all",get:function(){return i}}]),e}();t.default=s,s.Clear=new s(0,"clear","Clear"),s.Src=new s(1,"src","Src"),s.Dst=new s(2,"dst","Dst"),s.SrcOver=new s(3,"srcOver","Src Over"),s.DstOver=new s(4,"dstOver","Dst Over"),s.SrcIn=new s(5,"srcIn","Src In"),s.DstIn=new s(6,"dstIn","Dst In"),s.SrcOut=new s(7,"srcOut","Src Out"),s.DstOut=new s(8,"dstOut","Dst Out"),s.SrcATop=new s(9,"srcATop","Src A Top"),s.DstATop=new s(10,"dstATop","Dst A Top"),s.Xor=new s(11,"xor","Xor"),s.Plus=new s(12,"plus","Plus"),s.Modulate=new s(13,"modulate","Modulate"),s.Screen=new s(14,"screen","Screen"),s.Overlay=new s(15,"overlay","Overlay"),s.Darken=new s(16,"darken","Darken"),s.Lighten=new s(17,"lighten","Lighten"),s.ColorDodge=new s(18,"colorDodge","Color Dodge"),s.ColorBurn=new s(19,"colorBurn","Color Burn"),s.HardLight=new s(20,"hardLight","Hard Light"),s.SoftLight=new s(21,"softLight","Soft Light"),s.Difference=new s(22,"difference","Difference"),s.Exclusion=new s(23,"exclusion","Exclusion"),s.Multiply=new s(24,"multiply","Multiply"),s.Hue=new s(25,"hue","Hue"),s.Saturation=new s(26,"saturation","Saturation"),s.Color=new s(27,"color","Color"),s.Luminosity=new s(28,"luminosity","Luminosity")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=new Map,i=new Map,a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Label=t,this._ID=n,this._NumericId=r,o.set(t,this),i.set(n,this)}return r(e,[{key:"toString",value:function(){return this._Label}},{key:"id",get:function(){return this._ID}},{key:"numericId",get:function(){return this._NumericId}},{key:"label",get:function(){return this._Label}}],[{key:"fromName",value:function(t){return o.get(t)||e.NonZero}},{key:"fromID",value:function(t){return i.get(t)||e.NonZero}}]),e}();t.default=a,a.EvenOdd=new a("Even-Odd","evenodd",0),a.NonZero=new a("Non-Zero","nonzero",1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=new Map,i=new Map,a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Label=t,this._ID=n,this._NumericId=r,o.set(t,this),i.set(n,this)}return r(e,[{key:"toString",value:function(){return this._Label}},{key:"id",get:function(){return this._ID}},{key:"numericId",get:function(){return this._NumericId}},{key:"label",get:function(){return this._Label}}],[{key:"fromName",value:function(t){return o.get(t)||e.Butt}},{key:"fromID",value:function(t){return i.get(t)||e.Butt}}]),e}();t.default=a,a.Butt=new a("Butt","butt",0),a.Round=new a("Round","round",1),a.Square=new a("Square","square",2)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=new Map,i=new Map,a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Label=t,this._ID=n,this._NumericId=r,o.set(t,this),i.set(n,this)}return r(e,[{key:"toString",value:function(){return this._Label}},{key:"id",get:function(){return this._ID}},{key:"numericId",get:function(){return this._NumericId}},{key:"label",get:function(){return this._Label}}],[{key:"fromName",value:function(t){return o.get(t)||e.Butt}},{key:"fromID",value:function(t){return i.get(t)||e.Butt}}]),e}();t.default=a,a.Miter=new a("Miter","miter",0),a.Round=new a("Round","round",1),a.Bevel=new a("Bevel","bevel",2)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=n(7),a=u(n(374)),s=u(n(515)),l=u(n(17));function u(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return function(t){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t._ConnectedBones=[],t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e),r(n,[{key:"read",value:function(e,t){var r=this;o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"read",this).call(this,e,t);var s=t.connectedBones;if(s){var u=t.overrideWorldTransform;e.whenNodesLoaded(function(){for(var t=0;t<s.length;t++){var n=s[t];if(n.constructor===Object){var o=e.getNode(n.id);o?o instanceof a.default?(r._ConnectedBones.push({node:o,length:n.length||o.length,bind:new Float32Array(n.bind),ibind:i.mat2d.invert(i.mat2d.create(),n.bind)}),-1===o.skins.indexOf(r)&&o.skins.push(r)):console.log("NON BONE IN BONE LIST?"):console.log("NO NODE WITH REFID WHILE LOOKING FOR BONE",n)}}r._ConnectedBones.length&&(u?r.overrideWorldTransform=new Float32Array(u):l.default.warn("Connected bones but no owd: "+r.name)),r.onReadComplete()})}}},{key:"onReadComplete",value:function(){this.updateSkin()}},{key:"markDeformDirty",value:function(){this._Skin&&this._Skin.markDeformDirty()}},{key:"serializeProperties",value:function(e){var t=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"serializeProperties",this).call(this,e);if(delete t.connectedBones,this._ConnectedBones.length){for(var r=[],i=0;i<this._ConnectedBones.length;i++){var a=this._ConnectedBones[i];r.push({id:a.node.refId,bind:Array.prototype.slice.call(a.bind),length:a.length})}t.connectedBones=r}return t}},{key:"serializeInteractive",value:function(){var e=o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"serializeInteractive",this).call(this);return this.hasWorldTransformOverride?e.overrideWorldTransform=this.worldTransform:e.overrideWorldTransform=null,e.connectedBones=this._ConnectedBones.slice(0),e}},{key:"findConnectedBone",value:function(e){for(var t=0;t<this._ConnectedBones.length;t++)if(this._ConnectedBones[t].node==e)return t;return-1}},{key:"getCentroidTransform",value:function(){return this.worldTransform}},{key:"connectBone",value:function(e,t){return!!(e&&e instanceof a.default)&&-1===this.findConnectedBone(e)&&(0==this._ConnectedBones.length&&(this.overrideWorldTransform=this.worldTransform),i.mat2d.invert(i.mat2d.create(),this.worldTransform)?(this._ConnectedBones.push({node:e,length:e.length,bind:i.mat2d.clone(e.worldTransform),ibind:i.mat2d.invert(i.mat2d.create(),e.worldTransform)}),-1===e.skins.indexOf(this)&&e.skins.push(this),e.stageItem&&e.stageItem.updateConnectionState(),t||this.onConnectedBoneChange(),this.forceRedraw(),this.updateSkin(),!0):void console.warn("Failed to get inverse of skin."))}},{key:"onConnectedBoneChange",value:function(){this.dispatch("connectedBoneChange")}},{key:"willRemoveWeightedBoneIndex",value:function(e,t){}},{key:"didRemoveWeightedBoneIndex",value:function(e,t){}},{key:"disconnectBone",value:function(e,t){var n=this.findConnectedBone(e);if(-1!==n){var r=e.skins.indexOf(this);-1!==r&&e.skins.splice(r,1),this.dispatch("boneDisconnected",e);var o=this._ConnectedBones[n];this.willRemoveWeightedBoneIndex(n,o.node),this._ConnectedBones.splice(n,1),this.didRemoveWeightedBoneIndex(n,o.node),0===this._ConnectedBones.length&&(this.overrideWorldTransform=null,this.compensate()),e.stageItem&&e.stageItem.updateConnectionState(),t||this.onConnectedBoneChange(),this.forceRedraw()}this.updateSkin()}},{key:"compensateConnectedBones",value:function(e){if(this.hasWorldTransformOverride){var t=this.calculateWorldTransform(),n=i.mat2d.invert(i.mat2d.create(),t),r=i.mat2d.mul(i.mat2d.create(),e,n);if(this._ConnectedBones.length)for(var o=0;o<this._ConnectedBones.length;o++){var a=this._ConnectedBones[o],s=a.node.worldTransform,l=i.mat2d.mul(i.mat2d.create(),r,s),u=i.mat2d.invert(i.mat2d.create(),l),c=i.mat2d.mul(i.mat2d.create(),s,a.ibind),d=i.mat2d.mul(i.mat2d.create(),u,c),f=i.mat2d.invert(i.mat2d.create(),d);this._ConnectedBones[o]={node:a.node,bind:f,ibind:d}}this.markDeformDirty()}}},{key:"copyBind",value:function(){if(!this._ConnectedBones.length)return null;var e=new Map,t=!0,n=!1,r=void 0;try{for(var o,i=this._ConnectedBones[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.set(a.node,{bind:a.bind,ibind:a.ibind})}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return e}},{key:"setBind",value:function(e){if(this._ConnectedBones.length){var t=!0,n=!1,r=void 0;try{for(var o,i=this._ConnectedBones[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=e.get(a.node);s&&(a.bind=s.bind,a.ibind=s.ibind)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.markDeformDirty()}}},{key:"onChildrenChanged",value:function(){o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"onChildrenChanged",this).call(this);var e=this.children.find(function(e){return e instanceof s.default});this._Skin!==e&&(this._Skin=e)}},{key:"updateSkin",value:function(){this._ConnectedBones&&this._ConnectedBones.length>0?this._Skin||this.actor.addNodeType(s.default,this,null,!0):this._Skin&&this.remove(this._Skin),this.root&&this.root.markDependenciesDirty()}},{key:"connectedBones",get:function(){return this._ConnectedBones},set:function(e){var t=this._ConnectedBones;this._ConnectedBones=e,this.onConnectedBoneChange(),this.forceRedraw(),this.markDeformDirty(),this.updateSkin(),setTimeout(function(){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0)(f=i.value.node).stageItem&&f.stageItem.updateConnectionState()}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}var s=!0,l=!1,u=void 0;try{for(var c,d=e[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f;(f=c.value.node).stageItem&&f.stageItem.updateConnectionState()}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}},0)}},{key:"isConnectedToBones",get:function(){return this._ConnectedBones&&this._ConnectedBones.length}},{key:"boneTransformsArray",get:function(){return this._Skin&&this._Skin.boneTransformsArray||null}},{key:"skin",get:function(){return this._Skin}}]),n}()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(224)),i=n(7),a=s(n(168));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=function(e){function t(e){l(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._BoneTransformsArray=null,n.hideInHierarchy=!0,n}return c(t,o.default),r(t,[{key:"onDirty",value:function(e){}},{key:"update",value:function(e,t){this.updateBoneArrays(),this.parent.updateDeform()}},{key:"updateDependencies",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDependencies",this).call(this,e);var n=this._Parent;if(n){e.addDependency(this,n);var r=n.connectedBones;if(r&&r.length){var o=!0,i=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value.node;e.addDependency(this,u);var c=u.allConstraints;if(c){var d=!0,f=!1,h=void 0;try{for(var p,y=c[Symbol.iterator]();!(d=(p=y.next()).done);d=!0){var v=p.value;e.addDependency(this,v)}}catch(e){f=!0,h=e}finally{try{!d&&y.return&&y.return()}finally{if(f)throw h}}}}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}}}}},{key:"markDeformDirty",value:function(){var e=this.root;if(e){var t=e.dependencyGraph;t&&t.addDirt(this,8)}}},{key:"updateBoneArrays",value:function(){var e=this.parent&&this.parent.connectedBones;if(e){var t=6*(e.length+1),n=this._BoneTransformsArray;n&&n.length===t||(this._BoneTransformsArray=n=new Float32Array(t),n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0);for(var r=6,o=0;o<e.length;o++){var a=e[o],s=a.node.worldTransform,l=i.mat2d.mul(i.mat2d.create(),s,a.ibind);n[r++]=l[0],n[r++]=l[1],n[r++]=l[2],n[r++]=l[3],n[r++]=l[4],n[r++]=l[5]}}}},{key:"boneTransformsArray",get:function(){return this._BoneTransformsArray}}]),t}();t.default=d;var f=function(e){function t(e){l(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return c(t,a.default),t}();d.StageItem=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=f(n(168)),a=f(n(301)),s=f(n(236)),l=n(302),u=f(n(275)),c=f(n(218)),d=f(n(17));function f(e){return e&&e.__esModule?e:{default:e}}var h=null,p=null,y=null,v=null;function m(e,t){var n=new Set(e),r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;n.add(l)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,null));return n._PersistentStage=e,n.drawAfterSelections=!0,n.isHandle=!0,n.hitDetectOnMesh=!1,n.isSelectable=!1,n._HoverIndex=-1,n._Selection=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"customHitDetect",value:function(e,t){return!1}},{key:"updateSelection",value:function(e){}},{key:"draw",value:function(e,t){var n=this.selection,r=this._PersistentStage.scale;if(n){var o=e.skCanvas,i=!0,a=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value,f=c.node,m=c.renderTransform;if(f.isConnectedToBones){var g=f.parent.connectedBones;p.setStrokeWidth(7.5/r);var b=m[4],k=m[5],S=40/r,O=20/r;o.drawOval(h.XYWHRect(b-O,k-O,S,S),p),y.setStrokeWidth(2/r);var w=24.75/r;o.drawOval(h.LTRBRect(b-w,k-w,b+w,k+w),y);var _=15.25/r;o.drawOval(h.LTRBRect(b-_,k-_,b+_,k+_),y);var P=c.weightBuffer,C=c.weightBufferIndex,E=0;v.setStrokeWidth(9.5/r);for(var T=20/r,I=h.LTRBRect(b-T,k-T,b+T,k+T),j=C,A=C+4;j<A;j++){var D=360*P[j+4],R=P[j];if(0!==R&&0!==D){var M=g[R-1].node.stageItem.fillColor;M?v.setColor(M):d.default.warn("No color for bone?"),o.drawArc(I,E,D,!1,v),E+=D}}}}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}}},{key:"incWeight",value:function(e,n,o){var i=this.selection,a=this._PersistentStage;if(i){var s=new Set,l=e?null:new Map,u=!0,c=!1,d=void 0;try{for(var f,h=i[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value,y=p.node;if(y.isConnectedToBones){var v=p.weightBuffer,m=p.weightBufferIndex,g=y.parent.connectedBones,b=g.findIndex(function(e){return e.node===n})+1;if(0!==b){l&&l.set(p,p.worldTranslation);for(var k=0,S=m,O=m+4;S<O;S++)if(v[S]===b){k=v[S+4];break}t.setPointWeight(v,m,g,n,k+o),s.add(y.parent),p.onWeightChanged()}}}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}if(l){var w=!0,_=!1,P=void 0;try{for(var C,E=l[Symbol.iterator]();!(w=(C=E.next()).done);w=!0){var T=C.value,I=r(T,2),j=I[0],A=I[1];j.worldTranslation=A}}catch(e){_=!0,P=e}finally{try{!w&&E.return&&E.return()}finally{if(_)throw P}}}var D=!0,R=!1,M=void 0;try{for(var x,F=s[Symbol.iterator]();!(D=(x=F.next()).done);D=!0){x.value.onWeightsChanged()}}catch(e){R=!0,M=e}finally{try{!D&&F.return&&F.return()}finally{if(R)throw M}}a.redraw()}}},{key:"setWeight",value:function(e,n){var r=this.selection,o=this._PersistentStage;if(r){var i=new Set,a=!0,s=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,f=d.node;if(f.isConnectedToBones){var h=d.weightBuffer,p=d.weightBufferIndex,y=f.parent.connectedBones;-1!==y.findIndex(function(t){return t.node===e})&&(t.setPointWeight(h,p,y,e,n),i.add(f.parent),d.onWeightChanged())}}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}var v=!0,m=!1,g=void 0;try{for(var b,k=i[Symbol.iterator]();!(v=(b=k.next()).done);v=!0){b.value.onWeightsChanged()}}catch(e){m=!0,g=e}finally{try{!v&&k.return&&k.return()}finally{if(m)throw g}}o.redraw()}}},{key:"normalizePath",value:function(e){var n=e.isConnectedToBones,r=e.connectedBones;if(!n)return!1;var o=!0,i=!1,a=void 0;try{for(var s,l=e.children[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var d=s.value;if(d.constructor===u.default){var f=d.weights,h=d.pointType;t.normalizeVertexWeight(f,0,-1,r),h!==c.default.Straight&&(t.normalizeVertexWeight(f,8,-1,r),t.normalizeVertexWeight(f,16,-1,r))}}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}}},{key:"hasSelection",get:function(){var e=this.selection;return e&&e.length>0}},{key:"selection",get:function(){return this._PersistentStage.filterSelectedItems(function(e){return e.constructor===a.default||e.constructor===l.StagePathControlIn||e.constructor===l.StagePathControlOut||e.constructor===s.default})}},{key:"weightableBones",get:function(){var e=this.selection,t=new Set,n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;t=m(t,new Set(s.node.parent.connectedBones.map(function(e){return e.node})))}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return t}},{key:"selectedWeights",get:function(){var e=new Map,t=this.selection;if(!t)return e;var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l=s.node;if(l.isConnectedToBones)for(var u=s.weightBuffer,c=s.weightBufferIndex,d=l.parent.connectedBones,f=c,h=c+4;f<h;f++){var p=u[f],y=0===p?null:d[p-1].node,v=u[f+4],m=e.get(y);void 0===m?e.set(y,v):m!==v&&e.set(y,!1)}}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return e}}],[{key:"initializeStageContext",value:function(e,t){h=e.canvasKit,(p=new h.SkPaint).setAntiAlias(!0),p.setStyle(h.PaintStyle.Stroke),p.setBlendMode(h.BlendMode.SrcOver),p.setColor(h.Color(0,0,0,.32)),(y=p.copy()).setColor(h.Color(255,255,255,.8)),v=p.copy();var n=h.MakeBlurMaskFilter(h.BlurStyle.Normal,10,!1);p.setMaskFilter(n)}},{key:"adjustIndexForRemovedBone",value:function(e,t,n,r){var o=n.findIndex(function(e){return e.node===r})+1;if(0!==o)for(var i=t,a=t+4;i<a;i++)e[i]===o&&(e[i]=0,e[i+4]=0),e[i]>o&&(e[i]=e[i]-1)}},{key:"setPointWeight",value:function(e,n,r,o,i){var a=1e3,s=0,l=!1;i=Math.min(1,Math.max(0,i));for(var u=0,c=n,d=n+4;c<d;c++){var f=e[c]-1;if((-1===f?null:r[f].node)===o){u=c,e[c+4]=i,l=!0;break}e[c+4]<a&&(a=e[c+4],s=c)}if(!l&&i>0){var h=r.findIndex(function(e){return e.node===o})+1;u=s,e[s]=h,e[s+4]=Math.max(0,i)}return t.normalizeVertexWeight(e,n,u,r),!0}},{key:"removeDeadWeight",value:function(e,t){for(var n=t,r=t+4;n<r;n++)e[n+4]<=Number.EPSILON&&(e[n]=0,e[n+4]=0)}},{key:"normalizeVertexWeight",value:function(e,n,r,o){for(var i=0,a=n,s=n+4;a<s;a++)0!=e[a]?i+=e[a+4]:e[a+4]=0;if(Math.abs(i-1)<Number.EPSILON)return!1;if(i<=0){var l=-1===r?0:o.findIndex(function(t,n){return n+1!==e[r]});return e[n]=l+1,e[n+1]=0,e[n+2]=0,e[n+3]=0,e[n+4]=1,e[n+5]=0,e[n+6]=0,e[n+7]=0,!0}var u=0,c=i;if(-1!==r&&(u=Math.min(1,Math.max(0,e[r+4])),e[r+4]=u,(c=i-u)<=0)){for(var d=o.findIndex(function(t,n){return n+1!==e[r]}),f=n,h=n+4;f<h;f++)if(f!==r){e[f]=d+1,e[f+4]=1-u;break}return t.removeDeadWeight(e,n),!0}for(var p=(1-u)/c,y=n,v=n+4;y<v;y++)y!==r&&(e[y+4]*=p);return t.removeDeadWeight(e,n),!0}}]),t}();t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(224)),a=l(n(275)),s=n(7);function l(e){return e&&e.__esModule?e:{default:e}}var u=new Float32Array(6),c=new Float32Array([1,0,0,0,1,0,0,0]),d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Translation=s.vec2.create(),n._AnimationTranslation=s.vec2.create(),n._UseAnimationValues=!1,n._UV=s.vec2.create(),n._Weights=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"validateWeightBuffer",value:function(e){var t=this._Weights,n=this.isConnectedToBones?8:0;if(0===n&&null!==t)e&&console.warn("Expected weights to be null for a point in",this.parent.name),this._Weights=null;else if(null==t||t.length!==n){e&&console.warn("Expected weights to be",n," instead of ",t&&t.length||null," for a point in",this.parent.name);var r=new Float32Array(c);if(null!==t)for(var o=0,i=Math.min(r.length,t.length);o<i;o++)r[o]=t[o];this._Weights=r}}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.translation;r&&r.constructor===Array&&2==r.length&&(this._Translation[0]=r[0],this._Translation[1]=r[1]),(r=n.uv)&&r.constructor===Array&&2==r.length&&(this._UV[0]=r[0],this._UV[1]=r[1]),(r=n.weights)&&r.constructor===Array&&(this._Weights=new Float32Array(r))}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.translation=s.vec2.clone(this._Translation),e.uv=s.vec2.clone(this._UV),e.weights=null===this._Weights?null:new Float32Array(this._Weights),e}},{key:"setParent",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setParent",this).call(this,e),e&&(this._Image=e)}},{key:"getSkinTransform",value:function(e,t){return a.default.computeSkinTransform(e,this._Weights,t)}},{key:"skin",value:function(e,t){var n=this._Weights,r=this.translation,o=e[0]*r[0]+e[2]*r[1]+e[4],i=e[1]*r[0]+e[3]*r[1]+e[5],a=u;a.fill(0);for(var s=0;s<4;s++){var l=n[s],c=n[s+4];if(c>0)for(var d=6*l,f=0;f<6;f++)a[f]+=t[d+f]*c}return new Float32Array([a[0]*o+a[2]*i+a[4],a[1]*o+a[3]*i+a[5]])}},{key:"weights",get:function(){return this._Weights},set:function(e){this._Weights=e,this.parent.onWeightsChanged(),this.stageItem.onWeightChanged()}},{key:"pointIndex",get:function(){var e=this.parent&&this.parent.points;return e?e.indexOf(this):-1}},{key:"typeName",get:function(){return"Mesh Deform Point"}},{key:"hideInHierarchy",get:function(){return!0}},{key:"uiHierIconClass",get:function(){return"HierarchyVertexIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionVertexIcon"}},{key:"uiIcon",get:function(){return"icon-vertex"}},{key:"translation",get:function(){return this._UseAnimationValues?this._AnimationTranslation:this._Translation},set:function(e){var t=this._UseAnimationValues?this._AnimationTranslation:this._Translation;s.vec2.isEqual(t,e)||(s.vec2.copy(t,e),this.stageItem&&this.stageItem.onTranslationChanged(),this.parent.invalidateMesh(),this.dispatch("posChange"))}},{key:"frameTranslation",get:function(){return this._AnimationTranslation},set:function(e){s.vec2.copy(this._AnimationTranslation,e)}},{key:"rigTranslation",get:function(){return this._Translation}},{key:"useAnimationValues",get:function(){return this._UseAnimationValues},set:function(e){this._UseAnimationValues!==e&&(this._UseAnimationValues=e,e&&s.vec2.copy(this._AnimationTranslation,this._Translation),this.parent.invalidateMesh())}},{key:"isConnectedToBones",get:function(){return this.parent.isConnectedToBones}},{key:"rigDeform",get:function(){return s.vec2.clone(this._Translation)}},{key:"frameDeform",get:function(){return s.vec2.clone(this._AnimationTranslation)},set:function(e){s.vec2.copy(this._AnimationTranslation,e),this.stageItem&&this.stageItem.onTranslationChanged()}},{key:"uvTranslation",get:function(){var e=this.uv,t=this.parent;if(!t)return e;var n=t.asset,r=n.width/2,o=n.height/2;return[e[0]-r,e[1]-o]}},{key:"uv",get:function(){return this._UV},set:function(e){s.vec2.copy(this._UV,e)}}]),t}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(224),s=(r=a)&&r.__esModule?r:{default:r};n(7);var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._From=null,n._To=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"updateStageItem",value:function(){var e=this.parent,t=this.stageItem;t&&(e&&!e.showDeformed?t.addToStage(e.stageItem.stage):t.removeFromStage())}},{key:"onAddedToActor",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onAddedToActor",this).call(this),this.updateStageItem()}},{key:"read",value:function(e,n){var r=this;i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var o=n.from,a=n.to;void 0!==o&&void 0!==a&&e.whenNodesLoaded(function(){var t=e.getNodeWithRefId(o);t&&(r._From=t);var n=e.getNodeWithRefId(a);n&&(r._To=n)})}},{key:"serializeProperties",value:function(e){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return this._From&&(n.from=this._From.refId),this._To&&(n.to=this._To.refId),n}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.from=this._From,e.to=this._To,e}},{key:"setParent",value:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setParent",this).call(this,e),e&&(this._Image=e)}},{key:"typeName",get:function(){return"Mesh Edge"}},{key:"hideInHierarchy",get:function(){return!0}},{key:"uiHierIconClass",get:function(){return"HierarchyVertexIcon"}},{key:"uiSelectionIconClass",get:function(){return"SelectionVertexIcon"}},{key:"uiIcon",get:function(){return"icon-vertex"}},{key:"from",get:function(){return this._From},set:function(e){this._From=e,this.stageItem&&this.stageItem.updateTransform(),this._Image&&this._Image.updateContour()}},{key:"to",get:function(){return this._To},set:function(e){this._To=e,this.stageItem&&this.stageItem.updateTransform(),this._Image&&this._Image.updateContour()}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(7),a=n(168),s=(r=a)&&r.__esModule?r:{default:r};var l=[255,161,0,1],u=[255,255,255,1],c=void 0;function d(e){return e/Math.PI*180}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.drawAfterSelections=!0,n.isHandle=!0,n.hitDetectOnMesh=!1,n.isSelectable=!0,n._IsMinimalistMode=!0===e,n._BackgroundOpacity=1,n._VertexBuffer=null,n._IndexBuffer=null,n._SliceAngle=0,n._CachedSliceAngle=0,n._LockedAngle=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"onAddedToStage",value:function(e){this.setMinMax([-t.outerRadius,-t.outerRadius],[t.outerRadius,t.outerRadius])}},{key:"customHitDetect",value:function(e,n){var r=Math.sqrt(e*e+n*n);return Math.abs(t.outerRadius-r)<=t.proximityThreshold}},{key:"lockAngle",value:function(){this._LockedAngle=i.mat2d.getRotation(this.renderTransform)}},{key:"unlockAngle",value:function(){this._LockedAngle=null}},{key:"alignToTransform",value:function(e,t){if(this.stage){var n=i.mat2d.fromRotation(i.mat2d.create(),null===this._LockedAngle?i.mat2d.getRotation(t):this._LockedAngle);n[4]=e[4],n[5]=e[5];var r=1/this.stage.scale,o=i.mat2d.fromScaling(i.mat2d.create(),[r,r]),a=this.rotationTransform;a&&i.mat2d.mul(o,a,o),this.renderTransform=i.mat2d.mul(i.mat2d.create(),n,o)}}},{key:"draw",value:function(e,n){var r=e.skCanvas,o=this.renderTransform,i=this._SliceAngle,a=this._IsMinimalistMode,s=this.stageContext,f=s._Fill,h=s._Stroke,p=s._HandleMinimalPath,y=s._HandlePath,v=n?u:l,m=c.Color(v[0],v[1],v[2],v[3]);if(h.setColor(m),r.save(),e.transform(o),0!==i){var g=i;f.setColor(c.multiplyByAlpha(c.Color(l[0],l[1],l[2],l[3]),.7));for(var b=t.innerRadius,k=t.outerRadius,S=c.LTRBRect(-b,-b,b,b),O=c.LTRBRect(-k,-k,k,k),w=g/Math.PI,_=Math.ceil(Math.abs(w)),P=0,C=Math.sign(g-0),E=0;E<_;E++){var T=E===_-1?Math.PI*(w%1):C*Math.PI,I=P+T,j=[Math.cos(P)*b,Math.sin(P)*b],A=[Math.cos(I)*k,Math.sin(I)*k],D=e.makePath(!0);D.moveTo(j[0],j[1]);var R=d(P),M=d(T);D.arcTo(S,R,M,!1),D.lineTo(A[0],A[1]),D.arcTo(O,R+M,-M,!1),D.lineTo(j[0],j[1]),P=I,r.drawPath(D,f)}}r.drawPath(a?p:y,h),r.restore()}},{key:"color",get:function(){return l},set:function(e){i.vec4.copy(l,e)}},{key:"sliceAngle",get:function(){return this._SliceAngle},set:function(e){this._SliceAngle=e}}],[{key:"innerRadius",get:function(){return 5}},{key:"outerRadius",get:function(){return 50}},{key:"proximityThreshold",get:function(){return 5}}]),t}();t.default=f,f.initializeStageContext=function(e,t){c=e.canvasKit;var n=f.innerRadius,r=f.outerRadius,o=new c.SkPaint;o.setAntiAlias(!1),o.setStyle(c.PaintStyle.Fill),o.setBlendMode(c.BlendMode.SrcOver),o.setColor(c.Color(0,0,0,1)),t._Fill=o;var i=new c.SkPaint;i.setAntiAlias(!0),i.setStyle(c.PaintStyle.Stroke),i.setBlendMode(c.BlendMode.SrcOver),i.setColor(c.Color(0,0,0,1)),i.setStrokeWidth(1.5),t._Stroke=i;var a=e.makePath();a.addArc(c.LTRBRect(-n,-n,n,n),0,360),a.moveTo(n,0),a.lineTo(r,0),a.addArc(c.LTRBRect(-r,-r,r,r),0,360),t._HandlePath=a;var s=e.makePath();s.addArc(c.LTRBRect(-r,-r,r,r),0,360),t._HandleMinimalPath=s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(168),a=(r=i)&&r.__esModule?r:{default:r},s=n(7);var l=null,u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.drawAfterSelections=!0,e.isHandle=!0,e.hitDetectOnMesh=!1,e.isSelectable=!0,e._Color=s.vec4.create(),e._HoverColor=s.vec4.create(),e.color=[1,0,0,1],e.hoverColor=[1,1,0,1],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"onAddedToStage",value:function(e){this.setMinMax([-4,-38],[4,0])}},{key:"alignToTransform",value:function(e,t){if(this.stage)if(e===t){var n=s.vec2.create(),r=s.mat2d.decompose(n,e),o=s.mat2d.fromRotation(s.mat2d.create(),r);o[4]=e[4],o[5]=e[5];var i=1/this.stage.scale,a=s.mat2d.fromScaling(s.mat2d.create(),[i*Math.sign(n[0]),i*Math.sign(n[1])]),l=this.rotationTransform;l&&s.mat2d.mul(a,l,a),this.renderTransform=s.mat2d.mul(s.mat2d.create(),o,a)}else{var u=s.mat2d.fromRotation(s.mat2d.create(),s.mat2d.getRotation(t));u[4]=e[4],u[5]=e[5];var c=1/this.stage.scale,d=s.mat2d.fromScaling(s.mat2d.create(),[c,c]),f=this.rotationTransform;f&&s.mat2d.mul(d,f,d),this.renderTransform=s.mat2d.mul(s.mat2d.create(),u,d)}}},{key:"draw",value:function(e,t){var n=e.skCanvas,r=this.renderTransform,o=this.stageContext,i=o._Fill,a=o._HandlePath,s=t?this._HoverColor:this._Color;n.save(),e.transform(r),i.setColor(l.Color(Math.round(255*s[0]),Math.round(255*s[1]),Math.round(255*s[2]),s[3])),n.drawPath(a,i),n.restore()}},{key:"color",get:function(){return this._Color},set:function(e){s.vec4.copy(this._Color,e),this._ColorString="rgba("+Math.round(255*this._Color[0])+","+Math.round(255*this._Color[1])+","+Math.round(255*this._Color[2])+", "+this._Color[3]+")"}},{key:"hoverColor",get:function(){return this._HoverColor},set:function(e){s.vec4.copy(this._HoverColor,e),this._HoverColorString="rgba("+Math.round(255*this._HoverColor[0])+","+Math.round(255*this._HoverColor[1])+","+Math.round(255*this._HoverColor[2])+", "+this._HoverColor[3]+")"}}]),t}();t.default=u,u.initializeStageContext=function(e,t){var n=new(l=e.canvasKit).SkPaint;n.setAntiAlias(!0),n.setStyle(l.PaintStyle.Fill),n.setBlendMode(l.BlendMode.SrcOver),n.setColor(l.Color(0,0,0,1)),t._Fill=n,t._HandlePath=e.linePath([.6,0,-.6,0,-.6,-30,-4,-30,-4,-38,4,-38,4,-30,.6,-30],!0,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7),i=f(n(203)),a=f(n(197)),s=f(n(198)),l=f(n(219)),u=f(n(173)),c=f(n(195)),d=f(n(179));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t,n,r,a,s,l,u,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Tool=t,this._Handle=n,this._CompensateBones=r,this._CompensateImages=a,this._ActorNodes=s,this._RotationPivot=l,this._IsComplex=u,this._LastAngle=o.vec2.getAngle(o.vec2.subtract(o.vec2.create(),c,this._RotationPivot)),this._StartAngle=this._LastAngle,this._AccumulatedAngle=0;for(var d=s.slice(0),f=0;f<d.length;f++)for(var h=d[f];h.parent;){if(-1!=d.indexOf(h.parent)){d.splice(f,1),f--;break}h=h.parent}var p=[],y=!0,v=!1,m=void 0;try{for(var g,b=d[Symbol.iterator]();!(y=(g=b.next()).done);y=!0){var k=g.value,S={node:k,transform:o.mat2d.clone(k.worldTransform),rotation:k.rotation};k.constructor===i.default&&k.isConnectedToBones&&(S.bind=k.copyBind()),p.push(S)}}catch(e){v=!0,m=e}finally{try{!y&&b.return&&b.return()}finally{if(v)throw m}}this._TopActorNodes=p}return r(e,[{key:"setRotationDelta",value:function(e){var t=o.mat2d.create(),n=o.mat2d.create(),r=o.mat2d.create();r[4]=this._RotationPivot[0],r[5]=this._RotationPivot[1],n[4]=-this._RotationPivot[0],n[5]=-this._RotationPivot[1];for(var d=o.mat2d.fromRotation(o.mat2d.create(),e),f=this._TopActorNodes,h=this._CompensateImages,p=this._CompensateBones,y=0;y<f.length;y++){var v=f[y],m=v.node;if(this._IsComplex)if(o.mat2d.mul(t,n,v.transform),o.mat2d.mul(t,d,t),o.mat2d.mul(t,r,t),m.hasWorldTransformOverride){var g=m.worldTransform,b=o.mat2d.clone(g);m.overrideWorldTransform=t,m.constructor===i.default&&m.isConnectedToBones&&(m.setBind(v.bind),m.compensateConnectedBones(b),m.overrideWorldTransform=b)}else{var k=o.mat2d.invert(o.mat2d.create(),m.parent.worldTransform);o.mat2d.mul(t,t,k);var S=o.vec2.create();m.rotation=o.mat2d.decompose(S,t),m.scale=S,m.translation=o.mat2d.getTranslation(o.vec2.create(),t)}else m.rotation=v.rotation+e;if(!h||m.constructor!==s.default&&m.constructor!==l.default||m.all(function(e){e.constructor!==s.default&&e.constructor!==l.default||c.default.compensateSkinnedImages(e)}),(h||p)&&function(){var e=[];if(m.eachChildRecursive(function(t){(h&&(t.constructor===i.default||t.constructor===a.default)||p&&(t.constructor===s.default||t.constructor===u.default))&&-1==e.indexOf(t)&&e.push(t)}),e.length)for(var t=0;t<e.length;t++){e[t].compensate()}}(),m.constructor===s.default&&p)for(var O=m.stageItem.joint,w=0;w<O.children.length;w++){var _=O.children[w];c.default.alignChain(_.joint)}}}},{key:"onSnapChange",value:function(e){this.setAngleFromAccumulation()}},{key:"setAngleFromAccumulation",value:function(){var e=this._AccumulatedAngle;if(this._Tool.snap){var t=Math.PI/4;e=Math.round(e/t)*t}this._Handle.sliceAngle=e,this.setRotationDelta(e)}},{key:"advance",value:function(e,t,n){var r=o.vec2.getAngle(o.vec2.subtract(o.vec2.create(),n,this._RotationPivot)),i=r-this._LastAngle;i>Math.PI?i=2*Math.PI-i:i<-Math.PI&&(i=2*Math.PI+i);this._AccumulatedAngle;this._AccumulatedAngle+=i,this._LastAngle=r,this.setAngleFromAccumulation()}},{key:"complete",value:function(){}}]),e}();t.default=h,h.make=function(e,t){for(var n=[],r=0;r<t.length;r++){var a=t[r];if(a.node&&(a.constructor!==d.default||!a.node.isConnectedToBones||!e.stage.appContext.editingAnimation))if(a.constructor!==c.default||a.isRoot)-1==n.indexOf(a.node)&&n.push(a.node);else for(var s=0;s<a.children.length;s++){var l=a.children[s];-1==n.indexOf(l.node)&&n.push(l.node)}}if(0!=n.length){var u=n[0],f=o.mat2d.getTranslation(o.vec2.create(),e.handle.renderTransform),p=!1;switch(u.constructor){case i.default:p=u.isConnectedToBones}return new h(e,e.handle,e.stage.settings.compensateBones,e.stage.settings.compensateImages,n,f,p,e.stage.worldMouse)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(168),a=(r=i)&&r.__esModule?r:{default:r};var s=null,l=null,u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.isSelectable=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"draw",value:function(e,t){var n=e.skCanvas,r=this.stageContext,o=this.renderTransform;n.save(),e.transform(o),n.drawPath(r.path,l),n.restore()}}],[{key:"initializeStageContext",value:function(e,t){s=e.canvasKit,(l=new s.SkPaint).setAntiAlias(!0),l.setStyle(s.PaintStyle.Fill),l.setBlendMode(s.BlendMode.SrcOver),l.setColor(s.Color(255,0,0,1));var n=[-5,0,0,-5,5,0,0,5];t.path=e.linePath(n,!0,!1),t.points=n}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(223)),a=(l(n(179)),l(n(195)),l(n(176)),l(n(198)),l(n(219)),n(7)),s=(l(n(378)),l(n(351)));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._CreatePoint=null,n._ToPoint=null,n._Artboard=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"blockMarquee",value:function(e){return!0}},{key:"cancel",value:function(){}},{key:"validate",value:function(){return!this.stage.soloItem&&!this.stage.appContext.editingAnimation}},{key:"release",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"release",this).call(this,e),this._CreatePoint=null,this._ToPoint=null,this._Artboard=null}},{key:"click",value:function(e,t,n){this._CreatePoint=a.vec2.clone(e)}},{key:"startDrag",value:function(e,n){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startDrag",this).call(this,e,n),!0}},{key:"advanceDrag",value:function(e,t,n,r){var o=this._Artboard,i=this.stage.appContext.actor;if(!o){if(this._Artboard=o=i.addNodeType(s.default,null,{name:this.shapeName,translation:Array.from(r),width:1,height:1},!0),!o)return;o.name="Artboard",i.addArtboard(o),o.stageItem.addToStage(this.stage)}this._ToPoint=a.vec2.clone(n);var l=this._ToPoint,u=this._CreatePoint;l=a.vec2.round(a.vec2.create(),l),u=a.vec2.round(a.vec2.create(),u);var c=a.vec2.subtract(a.vec2.create(),l,u),d=a.vec2.min(a.vec2.create(),l,u),f=Math.abs(c[0]),h=Math.abs(c[1]);o.translation=d,o.width=f,o.height=h}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=m(n(428)),a=m(n(197)),s=m(n(225)),l=m(n(275)),u=m(n(218)),c=m(n(230)),d=m(n(252)),f=m(n(265)),h=m(n(179)),p=(m(n(236)),n(7)),y=m(n(513)),v=(m(n(350)),n(288));m(n(2));function m(e){return e&&e.__esModule?e:{default:e}}function g(e){return[e.x,e.y]}function b(e){return e.o||e}var k=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"validate",value:function(){return!!o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"validate",this).call(this)&&!(this.stage.soloItem instanceof h.default)}},{key:"onEditingChanged",value:function(){var e=this._CreatedPath;if(e){var t=e.points,n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.stageItem.radiusScale=1}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}this._CreatedPath=null}},{key:"getEditing",value:function(e){var t=[];if(e instanceof c.default){var n=!0,r=!1,o=void 0;try{for(var i,a=e.node.children[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;l.constructor===s.default&&t.push(l)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}else e instanceof d.default&&t.push(e.node);return t}},{key:"getInsertTarget",value:function(e,t){var n=null,r=10/this.stage.scale,o=!0,i=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value,d=c.stageItem.makeRenderPoints();if(d.length){for(var h=c.isConnectedToBones,v=c.isClosed,m=c.root,g=m.localTranslation(t),b=h?g:p.vec2.transformMat2d(p.vec2.create(),g,c.inverseWorld),k=null,S=Number.MAX_VALUE,O=null,w=null,_=null,P=0,C=v?d.length:d.length-1,E=d.length;P<C;P++){var T=d[P],I=d[(P+1)%E],j=I.pointType===u.default.Straight?null:I.in,A=T.pointType===u.default.Straight?null:T.out;if(null===j&&null===A){var D=f.default.pointOnSegment(T.translation,I.translation,b[0],b[1]).point,R=p.vec2.distance(D,b);R<S&&(S=R,k={x:D[0],y:D[1],d:R},O=T,_=null)}else{null===A&&(A=T.translation),null===j&&(j=I.translation);var M=new y.default(T.translation[0],T.translation[1],A[0],A[1],j[0],j[1],I.translation[0],I.translation[1]),x=M.project({x:b[0],y:b[1]});x.d<S&&(S=x.d,k=x,O=T,w=I,_=M)}}S<r&&(n={path:c,prev:O,next:w,worldPoint:m.renderTranslation(h?p.vec2.fromValues(k.x,k.y):p.vec2.transformMat2d(p.vec2.create(),[k.x,k.y],c.worldTransform)),point:k,curve:_},r=S)}}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}return n}},{key:"optimize",value:function(e){for(var t=!0;t;){t=!1;for(var n=e.points,r=n.length,o=1,i=e.isClosed?r+1:r;o<i;o++){var a=n[(o-1)%r],s=n[o%r];if(p.vec2.equals(a.translation,s.translation)){e.remove(s),a.out=s.out,s.stageItem.removeFromStage(),t=!0;break}}}}},{key:"makePoint",value:function(e,t,n){var r=this.stage.appContext.actor;if(e.isConnectedToBones){var o=l.default.computeSkinTransform(e.boneTransformsArray,i.default.DefaultSkinTransformWeights,0),a=p.mat2d.invert(p.mat2d.create(),o);if(a){var s=8;n.pointType!==u.default.Straight.id&&(s=24);for(var c=new Float32Array(s),d=0;d<s;d++)c[d]=i.default.DefaultSkinTransformWeights[d%8];n.weights=Array.from(c),p.vec2.transformMat2d(n.translation,p.vec2.transformMat2d(p.vec2.create(),n.translation,a),e.inverseWorld),n.translation=Array.from(n.translation),n.in&&(p.vec2.transformMat2d(n.in,p.vec2.transformMat2d(p.vec2.create(),n.in,a),e.inverseWorld),n.in=Array.from(n.in)),n.out&&(p.vec2.transformMat2d(n.out,p.vec2.transformMat2d(p.vec2.create(),n.out,a),e.inverseWorld),n.out=Array.from(n.out))}else console.warn("Unable to get inverse of skin transform")}var f=r.addNodeType(l.default,e,n,!1,t);return f?(f.validateWeightBuffer(!1),f.stageItem.addToStage(this.stage),f):null}},{key:"split",value:function(e){var t=void 0,n=e.path;if(!e.curve)return t=n.children.indexOf(b(e.prev))+1,void this.makePoint(n,t,{pointType:u.default.Straight.id,translation:g(e.point)});var r=e.next.e,o=e.prev.e;if(r&&o)if(e.next.o===e.prev.o){var i=n.children.indexOf(b(e.prev));n.remove(e.prev.o),e.prev.o.stageItem.removeFromStage();var a=this.makePoint(n,i,{pointType:u.default.Disconnected.id,in:Array.from(e.prev.in),translation:Array.from(e.prev.translation),out:Array.from(e.prev.out)}),s=this.makePoint(n,i+1,{pointType:u.default.Disconnected.id,in:Array.from(e.next.in),translation:Array.from(e.next.translation),out:Array.from(e.next.out)});e.prev=a,e.next=s,r=o=!1,t=n.children.indexOf(b(e.prev))+1}else t=n.children.indexOf(b(e.prev))+1;else t=r?n.children.indexOf(b(e.prev))+1:o?n.children.indexOf(b(e.next)):n.children.indexOf(b(e.prev))+1;var l=n.points,c=l.indexOf(b(e.prev)),d=e.curve.split(e.point.t);if(!o){var f=b(e.prev);f.pointType!==u.default.Straight&&(f.pointType=u.default.Disconnected,n.isConnectedToBones?f.stageItem.controlOut.worldTranslation=g(d.left.points[1]):f.out=g(d.left.points[1]))}if(!r){var h=b(l[(c+1)%l.length]);h.pointType!==u.default.Straight&&(h.pointType=u.default.Disconnected,n.isConnectedToBones?h.stageItem.controlIn.worldTranslation=g(d.right.points[2]):h.in=g(d.right.points[2]))}this.makePoint(e.path,t,{pointType:u.default.Disconnected.id,in:g(d.left.points[2]),translation:g(d.left.points[3]),out:g(d.right.points[1])});this.optimize(e.path)}},{key:"createPath",value:function(e){var t=this.stage.appContext,n=t.actor,r=this._Editing&&Array.from(this._Editing),o=r&&r.length>0&&r[0].parent;if(!o){var i=this.stage.selectedItems.find(function(e){return e.constructor===c.default});i&&(o=i.node,t.editingShape=i)}if(!o){var l=n.artboards.active;if(!(o=n.addNodeType(a.default,l,{name:"New Shape",translation:Array.from(l.localTranslation(e))})))return;o.stageItem.addToStage(this.stage),t.editingShape=o.stageItem}var u=n.addNodeType(s.default,o,{name:"Path"});if(u){u.stageItem.addToStage(this.stage),u.calculateWorldTransform(),this.updateEditing(),this._CreatedPath=u;var d=n.addNodeType(v.ColorStroke,o,{color:[1,1,1,1],width:1});d&&d.stageItem.addToStage(this.stage)}}},{key:"startDrag",value:function(e,n){var r=this._ClickCreatedPoint;if(r){var i=this.stage.worldMouse,a=this.stage.appContext.actor.artboards.active,s=p.vec2.transformMat2d(p.vec2.create(),a.localTranslation(i),r.parent.inverseWorld);r.out=s;var l=p.vec2.subtract(p.vec2.create(),r.translation,r.out);r.in=p.vec2.add(p.vec2.create(),r.translation,l),r.pointType=u.default.Mirror,r.stageItem.udpateControlPoints(),r.stageItem.onTransformed(),this.stage.selectItem(r.stageItem.controlOut),this._SkipNextDrag=!0,n=this.stage.selectedItems}return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"startDrag",this).call(this,e,n)}},{key:"click",value:function(e,t,n){var r=i.default.validateNode(this._CreatedPath);if(t&&r){var o=r.points;if(o.length)-1!==this.stage.selectedItems.indexOf(o[0].stageItem)&&(r.isClosed=!0,o[0].stageItem.radiusScale=1,this._CreatedPath=null)}this._ClickCreatedPoint=null;var a=this.insertTarget;if(a)this.split(a);else{var s=this.stage;if(!s.hoverItem){r||this.createPath(e);var c=this._CreatedPath,d=s.appContext.actor,f=d.artboards.active,h=p.vec2.transformMat2d(p.vec2.create(),f.localTranslation(e),c.inverseWorld),y=c.points,v=y.length?y[y.length-1]:null,m=v?p.vec2.subtract(p.vec2.create(),h,v.translation):p.vec2.fromValues(h[0]-20,h[1]);p.vec2.normalize(m,m),p.vec2.scale(m,m,20);var g=d.addNodeType(l.default,c,{pointType:u.default.Straight.id,in:Array.from(p.vec2.subtract(p.vec2.create(),h,m)),translation:Array.from(h),out:Array.from(p.vec2.add(p.vec2.create(),h,m))});v||(g.stageItem.radiusScale=1.5),this._ClickCreatedPoint=g,g.stageItem.addToStage(this.stage)}}}}]),t}();t.default=k},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=l(n(168)),i=l(n(265)),a=l(n(236)),s=l(n(381));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"customHitDetectEarly",value:function(e,t){if(this.stage.toolType!==s.default||!this.stage.tool.isDeleting)return!1;var n=this.node,r=this.stage,o=n.from,a=n.to;if(!o||!a)return!1;var l=8/r.scale,u=l*l;return i.default.squaredDistanceToSegment(o.stageItem.worldTranslation,a.stageItem.worldTranslation,e,t)<u}},{key:"draw",value:function(e,t){if(!t&&!this.isSelected)if(this._Highlight)this.drawSelection(e,t);else{var n=e.skCanvas,r=this.node,o=r.from,i=r.to;if(o&&i){var s=o.stageItem.worldTranslation,l=i.stageItem.worldTranslation,u=(this.willDelete,a.default.StageContext.edgeStroke);n.drawLine(s[0],s[1],l[0],l[1],u)}}}},{key:"drawSelection",value:function(e,t){var n=e.skCanvas,r=this.node,o=this.stage,i=r.from,s=r.to;if(i&&s){var l=i.stageItem.worldTranslation,u=s.stageItem.worldTranslation,c=a.default.StageContext,d=c.deleteStroke,f=c.selectedStroke;d.setStrokeWidth(1/o.scale),n.drawLine(l[0],l[1],u[0],u[1],t?d:f)}}},{key:"isAutomatic",get:function(){return!1}},{key:"parent",get:function(){return this.node.parent.stageItem}},{key:"vtxA",get:function(){return this.node.from},set:function(e){this.node.from=e}},{key:"vtxB",get:function(){return this.node.to},set:function(e){this.node.to=e}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(382)),i=a(n(335));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._EditingShape=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"advanceDrag",value:function(e,n,r,o){(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"advanceDrag",this).call(this,e,n,r,o);this.stage,this._CreatedPath}},{key:"shapeName",get:function(){return"Rectangle"}},{key:"pathType",get:function(){return i.default}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(382)),i=a(n(429));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"advanceDrag",value:function(e,n,r,o){(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"advanceDrag",this).call(this,e,n,r,o);this.stage,this._CreatedPath}},{key:"shapeName",get:function(){return"Ellipse"}},{key:"pathType",get:function(){return i.default}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(421),a=(r=i)&&r.__esModule?r:{default:r};var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,null,[{key:"dragMin",get:function(){return.15}},{key:"dragMax",get:function(){return 8}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=d(n(287)),a=n(7),s=d(n(198)),l=d(n(173)),u=n(434),c=d(n(17));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var h=function(e){function t(e){f(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="IK Constraint",n._InvertDirection=!1,n._InfluencedBones=[],n._Solver=null,n._SolverType=y,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"onAdded",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onAdded",this).call(this),this.parent&&this.influenceBone(this.parent),this.updatePeerConstrained()}},{key:"onAddedToActor",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onAddedToActor",this).call(this),this.updatePeerConstrained()}},{key:"onRemovedFromActor",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onRemovedFromActor",this).call(this),this.updatePeerConstrained()}},{key:"updatePeerConstrained",value:function(){var e=this.isRemoved,t=this._InfluencedBones;if(t){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;e?s.removePeerConstraint(this):s.addPeerConstraint(this)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}}},{key:"updateDependencies",value:function(e){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDependencies",this).call(this,e);var n=!0,r=!1,i=void 0;try{for(var a,s=this._InfluencedBones[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value;e.addDependency(this,u)}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}if(this._Target&&e.addDependency(this,this._Target),this.updatePeerConstrained(),this._Solver){var c=this._Solver._FKChain;if(c.length){var d=c[c.length-1],f=!0,h=!1,p=void 0;try{for(var y,v=c[Symbol.iterator]();!(f=(y=v.next()).done);f=!0){var m=y.value;if(m!==d){var g=m.bone.children,b=function(t){return t instanceof l.default?c.find(function(e){return e.bone===t})?"continue":void e.addDependency(t,d.bone):"continue"},k=!0,S=!1,O=void 0;try{for(var w,_=g[Symbol.iterator]();!(k=(w=_.next()).done);k=!0)b(w.value)}catch(e){S=!0,O=e}finally{try{!k&&_.return&&_.return()}finally{if(S)throw O}}}}}catch(e){h=!0,p=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw p}}}}}},{key:"update",value:function(){}},{key:"onDirty",value:function(){this.markDirty()}},{key:"markDirty",value:function(){var e=this._Solver;if(e&&e._FKChain){var t=!0,n=!1,r=void 0;try{for(var o,i=e._FKChain[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.bone.markTransformDirty()}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.invertDirection;void 0!==r&&(this._InvertDirection=r);var i=n.influencedBones;if(i){var a=this;e.whenNodesLoaded(function(){for(var t=0;t<i.length;t++){var n=i[t];if(n){if(n.constructor===String||n.constructor===Number){var r=e.getNode(n);r?r.constructor===s.default?(a._InfluencedBones.push(r),-1===r.targets.indexOf(a)&&r.targets.push(a)):console.log("NON BONE IN BONE LIST?"):console.log("NO NODE WITH REFID WHILE LOOKING FOR BONE",n)}}else console.warn("Bad bone in bones array?",i)}a._InfluencedBones.sort(function(e,t){return e.treeDepth-t.treeDepth}),a.resetSolver()})}}},{key:"influenceBone",value:function(e,t){if(!e||e.constructor!==s.default)return!1;if(-1!==this._InfluencedBones.indexOf(e))return!1;var n=this._InfluencedBones;return n.push(e),n.sort(function(e,t){return e.treeDepth-t.treeDepth}),this.root.markDependenciesDirty(),this.resetSolver(),-1===e.targets.indexOf(this)&&e.targets.push(this),t||this.dispatch("influencedBoneChange"),!0}},{key:"resetSolver",value:function(){this._Solver=new this._SolverType(this,this._InfluencedBones)}},{key:"removeBoneInfluence",value:function(e,t){var n=this._InfluencedBones.indexOf(e);if(-1!==n){var r=e.targets.indexOf(this);-1!==r&&e.targets.splice(r,1),this._InfluencedBones.splice(n,1),this.resetSolver(),t||this.dispatch("influencedBoneChange")}}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);if(delete n.influencedBones,this._InfluencedBones.length){for(var r=[],i=0;i<this._InfluencedBones.length;i++){var a=this._InfluencedBones[i];r.push(a.refId)}n.influencedBones=r}return n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.invertDirection=this._InvertDirection,e.influencedBones=this._InfluencedBones.slice(0),e}},{key:"constrain",value:function(e){if(this._Solver&&this._Target){var t=a.mat2d.getTranslation(a.vec2.create(),this._Target.worldTransform);return this._Solver.solve(t,this.strength),!0}return!1}},{key:"solver",get:function(){return this._Solver}},{key:"solverType",get:function(){return this._SolverType},set:function(e){e!=this._SolverType&&(this._SolverType=e,this.resetSolver())}},{key:"influencedBones",get:function(){return this._InfluencedBones},set:function(e){this._InfluencedBones=e,this.dispatch("connectedBonesChanged"),this.resetSolver()}},{key:"invertDirection",get:function(){return this._InvertDirection},set:function(e){this._InvertDirection!=e&&(this._InvertDirection=e,this.dispatch("invertDirectionChange",e),this.markDirty(),this.stageItem&&this.stageItem.stage&&this.stageItem.stage.redraw())}}],[{key:"constraintName",get:function(){return"IK"}},{key:"targetName",get:function(){return"IK Target"}}]),t}();t.default=h;var p=2*Math.PI,y=function(){function e(t,n){var r=this;if(f(this,e),this._Target=t,this._Tip=n[n.length-1],this._B1=n[0],this._B1c=this._Tip,n.length>1)for(;this._B1c&&this._B1c.parent!=this._B1;)this._B1c=this._B1c.parent;var o=this._Tip,i=this._FKChain=[];for(this._BoneData=[];o&&o!=this._B1.parent;)i.unshift({bone:o,ikAngle:0,transformComponents:new Float32Array(6),in:!1}),o=o.parent;for(var a=i.length<3,s=0;s<i.length;s++){var l=i[s];l.idx=s,l.in=a}var u=function(e){var t=r._FKChain.find(function(t){return t.bone===e});if(!t)return console.warn("Bone not in chain?",t,e),"continue";r._BoneData.push(t)},c=!0,d=!1,h=void 0;try{for(var p,y=n[Symbol.iterator]();!(c=(p=y.next()).done);c=!0)u(p.value)}catch(e){d=!0,h=e}finally{try{!c&&y.return&&y.return()}finally{if(d)throw h}}if(!a)for(var v=this._BoneData,m=0;m<v.length-1;m++){var g=v[m];g.in=!0,i[g.idx+1].in=!0}}return r(e,[{key:"solve1",value:function(e,t){var n=e.parentWorldInverse,r=e.bone.worldTranslation,o=a.vec2.copy(a.vec2.create(),t),i=a.vec2.subtract(a.vec2.create(),o,r),s=a.vec2.transformMat2(a.vec2.create(),i,n),l=Math.atan2(s[1],s[0]);return v(e,l),e.ikAngle=l,!0}},{key:"solve2",value:function(e,t,n){var r=e.bone,o=t.bone,i=this._FKChain,s=i[e.idx+1],l=e.parentWorldInverse,u=r.worldTranslation,c=s.bone.worldTranslation,d=o.tipWorldTranslation,f=a.vec2.copy(a.vec2.create(),n);u=a.vec2.transformMat2d(u,u,l),c=a.vec2.transformMat2d(c,c,l),d=a.vec2.transformMat2d(d,d,l),f=a.vec2.transformMat2d(f,f,l);var h=a.vec2.subtract(a.vec2.create(),d,c),p=a.vec2.length(h),y=a.vec2.subtract(a.vec2.create(),c,u),m=a.vec2.length(y),g=a.vec2.subtract(a.vec2.create(),f,u),b=a.vec2.length(g),k=Math.acos(Math.max(-1,Math.min(1,(-p*p+m*m+b*b)/(2*m*b)))),S=Math.acos(Math.max(-1,Math.min(1,(p*p+m*m-b*b)/(2*p*m)))),O=void 0,w=void 0;if(o.parent!=r){var _=i[e.idx+2].parentWorldInverse;c=s.bone.worldTranslation,d=o.tipWorldTranslation;var P=a.vec2.subtract(a.vec2.create(),d,c),C=a.vec2.transformMat2(a.vec2.create(),P,_),E=-Math.atan2(C[1],C[0]);this._Target.invertDirection?(O=Math.atan2(g[1],g[0])-k,w=-S+Math.PI+E):(O=k+Math.atan2(g[1],g[0]),w=S-Math.PI+E)}else this._Target.invertDirection?(O=Math.atan2(g[1],g[0])-k,w=-S+Math.PI):(O=k+Math.atan2(g[1],g[0]),w=S-Math.PI);if(v(e,O),v(s,w),s!==t){var T=t.bone;a.mat2d.mul(T.worldTransform,T.parent.worldTransform,T.transform)}return e.ikAngle=O,s.ikAngle=w,!0}},{key:"solve",value:function(e,t){var n=this._BoneData;if(n.length){this._Tip;for(var r=this._FKChain,o=0;o<r.length;o++){var i=r[o],s=i.bone.parent.worldTransform,l=a.mat2d.invert(a.mat2d.create(),s);l||(c.default.debug("mat2d.invert failed - "+(s&&s[0]+" "+s[1]+" "+s[2]+" "+s[3]+" "+s[4]+s[5])),l=a.mat2d.create());var d=a.mat2d.mul(i.bone.transform,l,i.bone.worldTransform);(0,u.Decompose)(d,i.transformComponents),i.parentWorldInverse=l}if(1===n.length)this.solve1(n[0],e);else if(2==n.length)this.solve2(n[0],n[1],e);else for(var f=n[n.length-1],h=0;h<n.length-1;h++){var y=n[h];this.solve2(y,f,e);for(var m=y.idx+1;m<r.length-1;m++){var g=r[m],b=g.bone.parent.worldTransform;g.parentWorldInverse=a.mat2d.invert(a.mat2d.create(),b)}}var k=t;if(1!=k){var S=!0,O=!1,w=void 0;try{for(var _,P=r[Symbol.iterator]();!(S=(_=P.next()).done);S=!0){var C=_.value;if(C.in){var E=C.transformComponents[4]%p,T=C.ikAngle%p-E;T>Math.PI?T-=p:T<-Math.PI&&(T+=p),v(C,E+T*k)}else{var I=C.bone;C.ikAngle=C.transformComponents[4]%p,a.mat2d.mul(I.worldTransform,I.parent.worldTransform,I.transform)}}}catch(e){O=!0,w=e}finally{try{!S&&P.return&&P.return()}finally{if(O)throw w}}}}}},{key:"getChain",value:function(){return this._FKChain}},{key:"getWorld",value:function(){if(!this._B1)return a.mat2d.create();var e=a.mat2d.clone(this._B1.parent.worldTransform);if(this._B1.parent.length){var t=a.mat2d.fromTranslation(a.mat2d.create(),[this._B1.parent.length,0]);a.mat2d.mul(e,e,t)}return e}}]),e}();function v(e,t){var n=e.bone.parent.worldTransform,r=e.bone.transform,o=e.transformComponents;0===t?a.mat2d.identity(r):a.mat2d.fromRotation(r,t),r[4]=o[0],r[5]=o[1];var i=o[2],s=o[3];r[0]*=i,r[1]*=i,r[2]*=s,r[3]*=s;var l=o[5];0!==l&&(r[2]=r[0]*l+r[2],r[3]=r[1]*l+r[3]),a.mat2d.mul(e.bone.worldTransform,n,r)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=u(n(287)),a=n(7),s=u(n(269)),l=n(434);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Scale Constraint",n._CopyX=!0,n._CopyY=!0,n._EnableMinX=!1,n._EnableMinY=!1,n._EnableMaxX=!1,n._EnableMaxY=!1,n._Offset=!1,n._Min=a.vec2.set(a.vec2.create(),-1,-1),n._Max=a.vec2.set(a.vec2.create(),1,1),n._Scale=a.vec2.set(a.vec2.create(),1,1),n._SourceSpace=s.default.World,n._DestSpace=s.default.World,n._MinMaxSpace=s.default.World,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"markDirty",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"markDirty",this).call(this),this.dispatch("changeConstraint")}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.sourceSpace;void 0!==r&&(this._SourceSpace=s.default.fromString(r)),void 0!==(r=n.destSpace)&&(this._DestSpace=s.default.fromString(r)),void 0!==(r=n.minMaxSpace)&&(this._MinMaxSpace=s.default.fromString(r));var i=n.copyX;void 0!==i&&(this._CopyX=!!i),void 0!==(i=n.copyY)&&(this._CopyY=!!i),void 0!==(i=n.enableMinX)&&(this._EnableMinX=!!i),void 0!==(i=n.enableMinY)&&(this._EnableMinY=!!i),void 0!==(i=n.enableMaxX)&&(this._EnableMaxX=!!i),void 0!==(i=n.enableMaxY)&&(this._EnableMaxY=!!i),void 0!==(i=n.offset)&&(this._Offset=!!i),void 0!==(i=n.minX)&&(this._Min[0]=Number.parseFloat(i)),void 0!==(i=n.minY)&&(this._Min[1]=Number.parseFloat(i)),void 0!==(i=n.maxX)&&(this._Max[0]=Number.parseFloat(i)),void 0!==(i=n.maxY)&&(this._Max[1]=Number.parseFloat(i)),void 0!==(i=n.scaleX)&&(this._Scale[0]=Number.parseFloat(i)),void 0!==(i=n.scaleY)&&(this._Scale[1]=Number.parseFloat(i))}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.sourceSpace=this._SourceSpace.toString(),n.destSpace=this._DestSpace.toString(),n.minMaxSpace=this._MinMaxSpace.toString(),n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.sourceSpace=this._SourceSpace,e.destSpace=this._DestSpace,e.minMaxSpace=this._MinMaxSpace,e.copyX=this._CopyX,e.copyY=this._CopyY,e.enableMinX=this._EnableMinX,e.enableMinY=this._EnableMinY,e.enableMaxX=this._EnableMaxX,e.enableMaxY=this._EnableMaxY,e.offset=this._Offset,e.minX=this._Min[0],e.minY=this._Min[1],e.maxX=this._Max[0],e.maxY=this._Max[1],e.scaleX=this._Scale[0],e.scaleY=this._Scale[1],e}},{key:"constrain",value:function(e){var t=this._Target,n=this.parent,r=n.parent,o=this.strength,i=this._SourceSpace,u=this._DestSpace,c=this._MinMaxSpace,d=new Float32Array(6),f=new Float32Array(6),h=n.worldTransform,p=a.mat2d.create();if((0,l.Decompose)(h,d),t){if(a.mat2d.copy(p,t.worldTransform),i===s.default.Local){var y=t.parent;if(y){var v=a.mat2d.invert(a.mat2d.create(),y.worldTransform);v&&(p=a.mat2d.mul(v,v,p))}}(0,l.Decompose)(p,f),this._CopyX?(f[2]*=this._Scale[0],this._Offset&&(f[2]*=n.scale[0])):f[2]=u===s.default.Local?1:d[2],this._CopyY?(f[3]*=this._Scale[1],this._Offset&&(f[3]*=n.scale[1])):f[3]=u===s.default.Local?0:d[3],u===s.default.Local&&r&&((0,l.Compose)(p,f),a.mat2d.mul(p,r.worldTransform,p),(0,l.Decompose)(p,f))}else a.mat2d.copy(p,h),f[0]=d[0],f[1]=d[1],f[2]=d[2],f[3]=d[3],f[4]=d[4],f[5]=d[5];var m=!(c!==s.default.Local||!r);if(m){(0,l.Compose)(p,f);var g=a.mat2d.invert(a.mat2d.create(),r.worldTransform);g?(a.mat2d.mul(p,g,p),(0,l.Decompose)(p,f)):m=!1}this._EnableMaxX&&f[2]>this._Max[0]&&(f[2]=this._Max[0]),this._EnableMinX&&f[2]<this._Min[0]&&(f[2]=this._Min[0]),this._EnableMaxY&&f[3]>this._Max[1]&&(f[3]=this._Max[1]),this._EnableMinY&&f[3]<this._Min[1]&&(f[3]=this._Min[1]),m&&((0,l.Compose)(p,f),a.mat2d.mul(p,r.worldTransform,p),(0,l.Decompose)(p,f));var b=1-o;return f[4]=d[4],f[0]=d[0],f[1]=d[1],f[2]=d[2]*b+f[2]*o,f[3]=d[3]*b+f[3]*o,f[5]=d[5],(0,l.Compose)(n.worldTransform,f),!0}},{key:"sourceSpace",get:function(){return this._SourceSpace},set:function(e){this._SourceSpace!==e&&(this._SourceSpace=e,this.markDirty())}},{key:"destSpace",get:function(){return this._DestSpace},set:function(e){this._DestSpace!==e&&(this._DestSpace=e,this.markDirty())}},{key:"minMaxSpace",get:function(){return this._MinMaxSpace},set:function(e){this._MinMaxSpace!==e&&(this._MinMaxSpace=e,this.markDirty())}},{key:"copyX",get:function(){return this._CopyX},set:function(e){this._CopyX!==e&&(this._CopyX=e,this.markDirty())}},{key:"copyY",get:function(){return this._CopyY},set:function(e){this._CopyY!==e&&(this._CopyY=e,this.markDirty())}},{key:"enableMinX",get:function(){return this._EnableMinX},set:function(e){this._EnableMinX!==e&&(this._EnableMinX=e,this.markDirty())}},{key:"enableMinY",get:function(){return this._EnableMinY},set:function(e){this._EnableMinY!==e&&(this._EnableMinY=e,this.markDirty())}},{key:"enableMaxX",get:function(){return this._EnableMaxX},set:function(e){this._EnableMaxX!==e&&(this._EnableMaxX=e,this.markDirty())}},{key:"enableMaxY",get:function(){return this._EnableMaxY},set:function(e){this._EnableMaxY!==e&&(this._EnableMaxY=e,this.markDirty())}},{key:"offset",get:function(){return this._Offset},set:function(e){this._Offset!==e&&(this._Offset=e,this.markDirty())}},{key:"minX",get:function(){return this._Min[0]},set:function(e){this._Min[0]!==e&&(this._Min[0]=e,this.markDirty())}},{key:"minY",get:function(){return this._Min[1]},set:function(e){this._Min[1]!==e&&(this._Min[1]=e,this.markDirty())}},{key:"maxX",get:function(){return this._Max[0]},set:function(e){this._Max[0]!==e&&(this._Max[0]=e,this.markDirty())}},{key:"maxY",get:function(){return this._Max[1]},set:function(e){this._Max[1]!==e&&(this._Max[1]=e,this.markDirty())}},{key:"scaleX",get:function(){return this._Scale[0]},set:function(e){this._Scale[0]!==e&&(this._Scale[0]=e,this.markDirty())}},{key:"scaleY",get:function(){return this._Scale[1]},set:function(e){this._Scale[1]!==e&&(this._Scale[1]=e,this.markDirty())}}],[{key:"constraintName",get:function(){return"Scale"}},{key:"targetName",get:function(){return"Scale Source"}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=c(n(287)),a=n(7),s=c(n(269)),l=n(434),u=c(n(660));function c(e){return e&&e.__esModule?e:{default:e}}var d=2*Math.PI,f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Rotation Constraint",n._Copy=!0,n._EnableMin=!1,n._EnableMax=!1,n._Offset=!1,n._Min=-d,n._Max=d,n._Scale=1,n._SourceSpace=s.default.World,n._DestSpace=s.default.World,n._MinMaxSpace=s.default.World,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"markDirty",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"markDirty",this).call(this),this.dispatch("changeConstraint")}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.sourceSpace;void 0!==r&&(this._SourceSpace=s.default.fromString(r)),void 0!==(r=n.destSpace)&&(this._DestSpace=s.default.fromString(r)),void 0!==(r=n.minMaxSpace)&&(this._MinMaxSpace=s.default.fromString(r));var i=n.copy;void 0!==i&&(this._Copy=!!i),void 0!==(i=n.enableMin)&&(this._EnableMin=!!i),void 0!==(i=n.enableMax)&&(this._EnableMax=!!i),void 0!==(i=n.offset)&&(this._Offset=!!i),void 0!==(i=n.min)&&(this._Min=Number.parseFloat(i)),void 0!==(i=n.max)&&(this._Max=Number.parseFloat(i)),void 0!==(i=n.scale)&&(this._Scale=Number.parseFloat(i))}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.sourceSpace=this._SourceSpace.toString(),n.destSpace=this._DestSpace.toString(),n.minMaxSpace=this._MinMaxSpace.toString(),n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.sourceSpace=this._SourceSpace,e.destSpace=this._DestSpace,e.minMaxSpace=this._MinMaxSpace,e.copy=this._Copy,e.enableMin=this._EnableMin,e.enableMax=this._EnableMax,e.offset=this._Offset,e.min=this._Min,e.max=this._Max,e.scale=this._Scale,e}},{key:"constrain",value:function(e){var t=this._Target,n=this.parent,r=n.parent,o=this.strength,i=this._SourceSpace,u=this._DestSpace,c=this._MinMaxSpace,f=new Float32Array(6),h=new Float32Array(6),p=n.worldTransform,y=a.mat2d.create();if((0,l.Decompose)(p,f),t){if(a.mat2d.copy(y,t.worldTransform),i===s.default.Local){var v=t.parent;if(v){var m=a.mat2d.invert(a.mat2d.create(),v.worldTransform);m&&(y=a.mat2d.mul(m,m,y))}}(0,l.Decompose)(y,h),this._Copy?(h[4]*=this._Scale,this._Offset&&(h[4]+=n.rotation)):h[4]=u===s.default.Local?0:f[4],u===s.default.Local&&r&&((0,l.Compose)(y,h),a.mat2d.mul(y,r.worldTransform,y),(0,l.Decompose)(y,h))}else a.mat2d.copy(y,p),h[0]=f[0],h[1]=f[1],h[2]=f[2],h[3]=f[3],h[4]=f[4],h[5]=f[5];var g=!(c!==s.default.Local||!r);if(g){(0,l.Compose)(y,h);var b=a.mat2d.invert(a.mat2d.create(),r.worldTransform);b?(a.mat2d.mul(y,b,y),(0,l.Decompose)(y,h)):g=!1}this._EnableMax&&h[4]>this._Max&&(h[4]=this._Max),this._EnableMin&&h[4]<this._Min&&(h[4]=this._Min),g&&((0,l.Compose)(y,h),a.mat2d.mul(y,r.worldTransform,y),(0,l.Decompose)(y,h));var k=f[4]%d,S=h[4]%d-k;return S>Math.PI?S-=d:S<-Math.PI&&(S+=d),h[4]=k+S*o,h[0]=f[0],h[1]=f[1],h[2]=f[2],h[3]=f[3],h[5]=f[5],(0,l.Compose)(n.worldTransform,h),!0}},{key:"sourceSpace",get:function(){return this._SourceSpace},set:function(e){this._SourceSpace!==e&&(this._SourceSpace=e,this.markDirty())}},{key:"destSpace",get:function(){return this._DestSpace},set:function(e){this._DestSpace!==e&&(this._DestSpace=e,this.markDirty())}},{key:"minMaxSpace",get:function(){return this._MinMaxSpace},set:function(e){this._MinMaxSpace!==e&&(this._MinMaxSpace=e,this.markDirty())}},{key:"copy",get:function(){return this._Copy},set:function(e){this._Copy!==e&&(this._Copy=e,this.markDirty())}},{key:"enableMin",get:function(){return this._EnableMin},set:function(e){this._EnableMin!==e&&(this._EnableMin=e,this.markDirty())}},{key:"enableMax",get:function(){return this._EnableMax},set:function(e){this._EnableMax!==e&&(this._EnableMax=e,this.markDirty())}},{key:"offset",get:function(){return this._Offset},set:function(e){this._Offset!==e&&(this._Offset=e,this.markDirty())}},{key:"min",get:function(){return this._Min},set:function(e){this._Min!==e&&(this._Min=e,this.markDirty())}},{key:"max",get:function(){return this._Max},set:function(e){this._Max!==e&&(this._Max=e,this.markDirty())}},{key:"scale",get:function(){return this._Scale},set:function(e){this._Scale!==e&&(this._Scale=e,this.markDirty())}}],[{key:"converter",get:function(){return u.default}},{key:"constraintName",get:function(){return"Rotation"}},{key:"targetName",get:function(){return"Rotation Source"}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=u(n(287)),a=n(7),s=n(434),l=u(n(269));function u(e){return e&&e.__esModule?e:{default:e}}var c=2*Math.PI,d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Transform Constraint",n._SourceSpace=l.default.World,n._DestSpace=l.default.World,n._ComponentsA=new Float32Array(6),n._ComponentsB=new Float32Array(6),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.sourceSpace;void 0!==r&&(this._SourceSpace=l.default.fromString(r)),void 0!==(r=n.destSpace)&&(this._DestSpace=l.default.fromString(r))}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.sourceSpace=this._SourceSpace.toString(),n.destSpace=this._DestSpace.toString(),n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.sourceSpace=this._SourceSpace,e.destSpace=this._DestSpace,e}},{key:"constrain",value:function(e){var t=this._Target;if(t){var n=this.parent,r=this._ComponentsA,o=this._ComponentsB,i=this.strength,u=this._SourceSpace,d=this._DestSpace,f=n.worldTransform,h=a.mat2d.clone(t.worldTransform);if(u===l.default.Local){var p=t.parent;if(p){var y=a.mat2d.invert(a.mat2d.create(),p.worldTransform);y&&(h=a.mat2d.mul(y,y,h))}}if(d===l.default.Local){var v=n.parent;v&&a.mat2d.mul(h,v.worldTransform,h)}(0,s.Decompose)(f,r),(0,s.Decompose)(h,o);var m=r[4]%c,g=o[4]%c-m;g>Math.PI?g-=c:g<-Math.PI&&(g+=c);var b=1-i;return o[4]=m+g*i,o[0]=r[0]*b+o[0]*i,o[1]=r[1]*b+o[1]*i,o[2]=r[2]*b+o[2]*i,o[3]=r[3]*b+o[3]*i,o[5]=r[5]*b+o[5]*i,(0,s.Compose)(n.worldTransform,o),!0}}},{key:"sourceSpace",get:function(){return this._SourceSpace},set:function(e){this._SourceSpace!==e&&(this._SourceSpace=e,this.markDirty(),this.dispatch("changeTransformConstraint"))}},{key:"destSpace",get:function(){return this._DestSpace},set:function(e){this._DestSpace!==e&&(this._DestSpace=e,this.markDirty(),this.dispatch("changeTransformConstraint"))}}],[{key:"constraintName",get:function(){return"Transform"}},{key:"targetName",get:function(){return"Transform Source"}}]),t}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=l(n(287)),a=n(7),s=l(n(269));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="Translation Constraint",n._CopyX=!0,n._CopyY=!0,n._EnableMinX=!1,n._EnableMinY=!1,n._EnableMaxX=!1,n._EnableMaxY=!1,n._Offset=!1,n._Min=a.vec2.set(a.vec2.create(),-100,-100),n._Max=a.vec2.set(a.vec2.create(),100,100),n._Scale=a.vec2.set(a.vec2.create(),1,1),n._SourceSpace=s.default.World,n._DestSpace=s.default.World,n._MinMaxSpace=s.default.World,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"markDirty",value:function(){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"markDirty",this).call(this),this.dispatch("changeConstraint")}},{key:"read",value:function(e,n){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.sourceSpace;void 0!==r&&(this._SourceSpace=s.default.fromString(r)),void 0!==(r=n.destSpace)&&(this._DestSpace=s.default.fromString(r)),void 0!==(r=n.minMaxSpace)&&(this._MinMaxSpace=s.default.fromString(r));var i=n.copyX;void 0!==i&&(this._CopyX=!!i),void 0!==(i=n.copyY)&&(this._CopyY=!!i),void 0!==(i=n.enableMinX)&&(this._EnableMinX=!!i),void 0!==(i=n.enableMinY)&&(this._EnableMinY=!!i),void 0!==(i=n.enableMaxX)&&(this._EnableMaxX=!!i),void 0!==(i=n.enableMaxY)&&(this._EnableMaxY=!!i),void 0!==(i=n.offset)&&(this._Offset=!!i),void 0!==(i=n.minX)&&(this._Min[0]=Number.parseFloat(i)),void 0!==(i=n.minY)&&(this._Min[1]=Number.parseFloat(i)),void 0!==(i=n.maxX)&&(this._Max[0]=Number.parseFloat(i)),void 0!==(i=n.maxY)&&(this._Max[1]=Number.parseFloat(i)),void 0!==(i=n.scaleX)&&(this._Scale[0]=Number.parseFloat(i)),void 0!==(i=n.scaleY)&&(this._Scale[1]=Number.parseFloat(i))}},{key:"serializeProperties",value:function(e){var n=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);return n.sourceSpace=this._SourceSpace.toString(),n.destSpace=this._DestSpace.toString(),n.minMaxSpace=this._MinMaxSpace.toString(),n}},{key:"serializeInteractive",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.sourceSpace=this._SourceSpace,e.destSpace=this._DestSpace,e.minMaxSpace=this._MinMaxSpace,e.copyX=this._CopyX,e.copyY=this._CopyY,e.enableMinX=this._EnableMinX,e.enableMinY=this._EnableMinY,e.enableMaxX=this._EnableMaxX,e.enableMaxY=this._EnableMaxY,e.offset=this._Offset,e.minX=this._Min[0],e.minY=this._Min[1],e.maxX=this._Max[0],e.maxY=this._Max[1],e.scaleX=this._Scale[0],e.scaleY=this._Scale[1],e}},{key:"constrain",value:function(e){var t=this._Target,n=this.parent,r=n.parent,o=this.strength,i=this._SourceSpace,l=this._DestSpace,u=this._MinMaxSpace,c=n.worldTransform,d=a.mat2d.getTranslation(a.vec2.create(),c),f=a.vec2.create();if(t){var h=a.mat2d.clone(t.worldTransform);if(i===s.default.Local){var p=t.parent;if(p){var y=a.mat2d.invert(a.mat2d.create(),p.worldTransform);y&&(h=a.mat2d.mul(y,y,h))}}a.mat2d.getTranslation(f,h),this._CopyX?(f[0]*=this._Scale[0],this._Offset&&(f[0]+=n.translation[0])):f[0]=l===s.default.Local?0:d[0],this._CopyY?(f[1]*=this._Scale[1],this._Offset&&(f[1]+=n.translation[1])):f[1]=l===s.default.Local?0:d[1],l===s.default.Local&&r&&a.vec2.transformMat2d(f,f,r.worldTransform)}else a.vec2.copy(f,d);var v=!(u!==s.default.Local||!r);if(v){var m=a.mat2d.invert(a.mat2d.create(),r.worldTransform);m?a.vec2.transformMat2d(f,f,m):v=!1}this._EnableMaxX&&f[0]>this._Max[0]&&(f[0]=this._Max[0]),this._EnableMinX&&f[0]<this._Min[0]&&(f[0]=this._Min[0]),this._EnableMaxY&&f[1]>this._Max[1]&&(f[1]=this._Max[1]),this._EnableMinY&&f[1]<this._Min[1]&&(f[1]=this._Min[1]),v&&a.vec2.transformMat2d(f,f,r.worldTransform);var g=1-o;return c[4]=d[0]*g+f[0]*o,c[5]=d[1]*g+f[1]*o,!0}},{key:"sourceSpace",get:function(){return this._SourceSpace},set:function(e){this._SourceSpace!==e&&(this._SourceSpace=e,this.markDirty())}},{key:"destSpace",get:function(){return this._DestSpace},set:function(e){this._DestSpace!==e&&(this._DestSpace=e,this.markDirty())}},{key:"minMaxSpace",get:function(){return this._MinMaxSpace},set:function(e){this._MinMaxSpace!==e&&(this._MinMaxSpace=e,this.markDirty())}},{key:"copyX",get:function(){return this._CopyX},set:function(e){this._CopyX!==e&&(this._CopyX=e,this.markDirty())}},{key:"copyY",get:function(){return this._CopyY},set:function(e){this._CopyY!==e&&(this._CopyY=e,this.markDirty())}},{key:"enableMinX",get:function(){return this._EnableMinX},set:function(e){this._EnableMinX!==e&&(this._EnableMinX=e,this.markDirty())}},{key:"enableMinY",get:function(){return this._EnableMinY},set:function(e){this._EnableMinY!==e&&(this._EnableMinY=e,this.markDirty())}},{key:"enableMaxX",get:function(){return this._EnableMaxX},set:function(e){this._EnableMaxX!==e&&(this._EnableMaxX=e,this.markDirty())}},{key:"enableMaxY",get:function(){return this._EnableMaxY},set:function(e){this._EnableMaxY!==e&&(this._EnableMaxY=e,this.markDirty())}},{key:"offset",get:function(){return this._Offset},set:function(e){this._Offset!==e&&(this._Offset=e,this.markDirty())}},{key:"minX",get:function(){return this._Min[0]},set:function(e){this._Min[0]!==e&&(this._Min[0]=e,this.markDirty())}},{key:"minY",get:function(){return this._Min[1]},set:function(e){this._Min[1]!==e&&(this._Min[1]=e,this.markDirty())}},{key:"maxX",get:function(){return this._Max[0]},set:function(e){this._Max[0]!==e&&(this._Max[0]=e,this.markDirty())}},{key:"maxY",get:function(){return this._Max[1]},set:function(e){this._Max[1]!==e&&(this._Max[1]=e,this.markDirty())}},{key:"scaleX",get:function(){return this._Scale[0]},set:function(e){this._Scale[0]!==e&&(this._Scale[0]=e,this.markDirty())}},{key:"scaleY",get:function(){return this._Scale[1]},set:function(e){this._Scale[1]!==e&&(this._Scale[1]=e,this.markDirty())}}],[{key:"constraintName",get:function(){return"Translation"}},{key:"targetName",get:function(){return"Translation Source"}}]),t}();t.default=u},function(e,t,n){var r=n(1169);"string"==typeof r&&(r=[[e.i,r,""]]);var o={insertAt:"top",hmr:!0,transform:void 0};n(14)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=s(n(347)),a=s(n(267));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._ImgSrc=null,n._Content=null,n._ParsedContent=null,n._SVG=null,n._Width=0,n._Height=0,n._OriginX=0,n._OriginY=0,n._Bitmap=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"read",value:function(e,n,r){o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n,r);var i=n.content;void 0!==i&&(this._Content=i);var a=n.svg;void 0!==a&&(this._SVG=a);var s=n.width;void 0!==s&&(this._Width=s);var l=n.height;void 0!==l&&(this._Height=l);var u=n.originX;void 0!==u&&(this._OriginX=u);var c=n.originY;void 0!==c&&(this._OriginY=c)}},{key:"serialize",value:function(){var e=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this);return e.content=this._Content,e.svg=this._SVG,e.width=this._Width,e.height=this._Height,e.originX=this._OriginX,e.originY=this._OriginY,e}},{key:"serializeInteractive",value:function(){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this)}},{key:"readRaw",value:function(e,t,n){if(t.svg){var r=this,o=new Image,i=t.width,a=t.height;o.onload=function(){i||(i=this.width),a||(a=this.height);var e=document.createElement("canvas");e.width=i,e.height=a,e.getContext("2d").drawImage(this,0,0),e.toBlob(function(e){r.imgSrc=URL.createObjectURL(e);var t=new FileReader;t.onload=function(){r.file=this.result,n(!0)},t.readAsArrayBuffer(e)},"image/png")},o.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}else n(!1)}},{key:"content",get:function(){this._ParsedContent||(this._ParsedContent=JSON.parse(this._Content));var e=new Map;return function t(n){var r=n.id,o=n.children;if(void 0!==r){var i=e.get(r);if(void 0!==i)n.id=i;else{var a=Date.now()+"-im-"+r;e.set(r,a),n.id=a}}if(o){var s=!0,l=!1,u=void 0;try{for(var c,d=o[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)t(c.value)}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}return n}(this._ParsedContent)}},{key:"imgSrc",get:function(){return this._ImgSrc},set:function(e){this._ImgSrc!=e&&(this._ImgSrc=e,this.dispatch("update"))}},{key:"uiHierIconClass",get:function(){return this.isMissing?"HierarchyMissingImageIcon":null}},{key:"uiSelectionIconClass",get:function(){return"SelectionImageIcon"}},{key:"selectionIcon",get:function(){return"icon-picture"}},{key:"typeName",get:function(){return"SVG Asset"}},{key:"uiIcon",get:function(){return this.isMissing?"icon-missing-large":"icon-picture"}},{key:"uiHierThumbClass",get:function(){return this.isMissing?null:"imageThumb"}}]),t}();t.default=l,l.prototype.fromFile=a.default.prototype.fromFile,l.prototype.fromBase64=a.default.prototype.fromBase64},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(267),s=(r=a)&&r.__esModule?r:{default:r};var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._LayeredAsset=n,r._Left=0,r._Top=0,r._Width=0,r._Height=0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"read",value:function(e,n,r){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n,r),this._Width=n.width,this._Height=n.height,this._Left=n.left,this._Top=n.top}},{key:"serialize",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this);return e.width=this._Width,e.height=this._Height,e.left=this._Left,e.top=this._Top,e}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.width=this._Width,e.height=this._Height,e.left=this._Left,e.top=this._Top,e}},{key:"canBeReplacedBy",value:function(e){switch(e.constructor){case s.default:case t:return!0}return!1}},{key:"left",get:function(){return this._Left}},{key:"top",get:function(){return this._Top}}],[{key:"dataType",get:function(){return"image/layer"}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),a=u(n(5)),s=u(n(2)),l=u(n(436));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var d=(c((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={active:!1,hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setResizeGrabber",value:function(e){this.resizeGrabber=e}},{key:"click",value:function(e){this.props.onMouseDown&&this.props.onMouseDown(e),l.default.set(this,this.props.isHorizontal?"ns-resize":"ew-resize"),this.setState({active:!0}),window.addEventListener("mouseup",this.release,!0),this.context.nima.isDragging=!0}},{key:"release",value:function(){this.setState({active:!1}),window.removeEventListener("mouseup",this.release,!0),this.context.nima.isDragging=!1,l.default.remove(this)}},{key:"enter",value:function(){var e=this;clearTimeout(this.timeout),l.default.set(this,this.props.isHorizontal?"ns-resize":"ew-resize"),this.timeout=setTimeout(function(){e.setState({hover:!0})},300)}},{key:"leave",value:function(){clearTimeout(this.timeout),l.default.remove(this),this.setState({hover:!1})}},{key:"setLeft",value:function(e){this.resizeGrabber.style.left=e+"px"}},{key:"setRight",value:function(e){this.resizeGrabber.style.right=e+"px"}},{key:"setBottom",value:function(e){this.resizeGrabber.style.bottom=e+"px"}},{key:"hide",value:function(e){this.resizeGrabber.style.display=e?"none":null}},{key:"render",value:function(){return i.default.createElement("div",{ref:this.setResizeGrabber,className:"resizeGrabber"+(this.props.isHorizontal?" horizontalResizeGrabber":"")+(this.state.active||this.state.hover?" resizeGrabberActive":"")+(this.props.addClass?" "+this.props.addClass:""),onMouseDown:this.click,onMouseEnter:this.enter,onMouseLeave:this.leave})}}]),t}()).prototype,"setResizeGrabber",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setResizeGrabber"),r.prototype),c(r.prototype,"click",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"click"),r.prototype),c(r.prototype,"release",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"release"),r.prototype),c(r.prototype,"enter",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"enter"),r.prototype),c(r.prototype,"leave",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"leave"),r.prototype),r);t.default=d,d.contextTypes={nima:a.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(5)),s=c(n(2)),l=c(n(216)),u=c(n(1183));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:null,isInteracting:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"select",value:function(){this.props.onSelect&&this.props.onSelect(this.props.idx)}},{key:"changeWeight",value:function(e,t){var n=this;clearTimeout(this.timeout);var r=this.props.onWeightChanged;r&&r(this.props.bone,e),this.setState({value:e,isInteracting:!0}),this.timeout=setTimeout(function(){n.setState({isInteracting:!1})},25)}},{key:"commit",value:function(){var e=this;if(this.state.isInteracting){var t=this.props.onWeightChanged;t&&t(this.props.bone,this.state.value||0),clearTimeout(this.timeout),this.timeout=setTimeout(function(){e.setState({isInteracting:!1})},25)}this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e=this.props,t=e.color,n=e.isSelected,r=this.state.value,o="BonePaintRow"+(n?" BonePaintRowSelected":"");return i.default.createElement("div",{onMouseDown:this.select,className:o},i.default.createElement("svg",null,i.default.createElement("polygon",{style:{fill:t},points:"0 0 5 0 13 13 0 5 0 0"})),i.default.createElement("div",{className:"BonePaintTitle"},this.props.bone.name),null!==r?i.default.createElement(l.default,{converter:u.default,value:void 0===r?0:r,dragScale:.01,onValueChanged:this.changeWeight,onValueCommit:this.commit}):null)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.value===t.value||t.isInteracting?null:{value:e.value,isInteracting:!1}}}]),t}()).prototype,"select",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"select"),r.prototype),d(r.prototype,"changeWeight",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"changeWeight"),r.prototype),d(r.prototype,"commit",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),r);t.default=f,f.contextTypes={nima:a.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(2)),s=c(n(5)),l=c(n(384)),u=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"nodeUpdate",value:function(){this.forceUpdate()}},{key:"setNode",value:function(e){this.node!==e&&(this.node&&this.node.removeEventListener("update",this.nodeUpdate),this.node=e,e&&e.addEventListener("update",this.nodeUpdate))}},{key:"componentWillReceiveProps",value:function(e){e.bone!=this.props.bone&&this.setNode(e.bone)}},{key:"componentDidMount",value:function(){this.setNode(this.props.node)}},{key:"componentWillUnmount",value:function(){this.setNode(null),clearTimeout(this.selectTimeout)}},{key:"commitEdit",value:function(){if(this.props.node){var e=new l.default(this.context.nima.stage,this.context.nima.actor,this.props.node,this.inputText.value);e.start(),e.end(),this.endEdit(!1)}}},{key:"endEdit",value:function(e){this.setState({editing:!1}),this.inputText&&this.inputText.removeEventListener("blur",this.commitEdit),clearTimeout(this.editTimeout)}},{key:"cancelEdit",value:function(){this.endEdit(!0)}},{key:"startEdit",value:function(){this.setState({editing:!0,editName:this.props.node.name});var e=this;clearTimeout(this.editTimeout),this.editTimeout=setTimeout(function(){e.inputText.focus(),e.inputText.setSelectionRange(0,e.inputText.value.length),e.inputText.addEventListener("blur",e.commitEdit)},0)}},{key:"editKeyDown",value:function(e){switch(e.keyCode){case 13:this.inputText.blur();break;case 27:this.cancelEdit(),this.inputText.blur()}}},{key:"editTextChange",value:function(e){this.setState({editName:e.target.value})}},{key:"select",value:function(){this.node&&this.context.nima.stage.selectItem(this.node.stageItem)}},{key:"textMouseDown",value:function(e){e.stopPropagation(),clearTimeout(this.selectTimeout);var t=Date.now();this.lastMouseDown&&t-this.lastMouseDown<200?this.startEdit():this.selectTimeout=setTimeout(this.select,230),this.lastMouseDown=t}},{key:"mouseEnter",value:function(){this.props.node&&this.props.node.stageItem&&this.props.node.stageItem.stage&&(this.context.nima.stage.hoverItem=this.props.node.stageItem)}},{key:"mouseLeave",value:function(){this.props.node&&this.props.node.stageItem&&this.props.node.stageItem.stage&&this.context.nima.stage.hoverItem===this.props.node.stageItem&&(this.context.nima.stage.hoverItem=null)}},{key:"setInputText",value:function(e){this.inputText=e}},{key:"suppressEvent",value:function(e){e.stopPropagation()}},{key:"remove",value:function(){this.props.onRemove(this.props.node)}},{key:"render",value:function(){var e=this.props,t=e.node,n=e.onRemove;return i.default.createElement("div",{className:"MeshBoneRow",onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave,onMouseDown:this.select},i.default.createElement("svg",{className:"TimelineIcon TimelineBoneIcon"},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#"+t.uiIcon)})),this.state.editing?i.default.createElement("input",{ref:this.setInputText,type:"text",value:this.state.editName,onKeyDown:this.editKeyDown,onChange:this.editTextChange}):i.default.createElement("div",{className:"MeshBone",onMouseDown:this.textMouseDown},t.name),n?i.default.createElement("svg",{className:"DeleteRow",onMouseDown:this.suppressEvent,onClick:this.remove},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-delete")})):null)}}]),t}()).prototype,"nodeUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"nodeUpdate"),r.prototype),d(r.prototype,"commitEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commitEdit"),r.prototype),d(r.prototype,"endEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"endEdit"),r.prototype),d(r.prototype,"cancelEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"cancelEdit"),r.prototype),d(r.prototype,"startEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"startEdit"),r.prototype),d(r.prototype,"editKeyDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"editKeyDown"),r.prototype),d(r.prototype,"editTextChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"editTextChange"),r.prototype),d(r.prototype,"select",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"select"),r.prototype),d(r.prototype,"textMouseDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"textMouseDown"),r.prototype),d(r.prototype,"mouseEnter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseEnter"),r.prototype),d(r.prototype,"mouseLeave",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseLeave"),r.prototype),d(r.prototype,"setInputText",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setInputText"),r.prototype),d(r.prototype,"suppressEvent",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"suppressEvent"),r.prototype),d(r.prototype,"remove",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"remove"),r.prototype),r);t.default=f,f.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(2)),s=c(n(5)),l=c(n(384)),u=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"itemUpdate",value:function(){this.forceUpdate()}},{key:"setItem",value:function(e){this.item!==e&&(this.item&&(this.item.removeEventListener("update",this.itemUpdate),this.item.removeEventListener("keyState",this.itemUpdate)),this.item=e,e&&(e.addEventListener("update",this.itemUpdate),e.addEventListener("keyState",this.itemUpdate)))}},{key:"componentWillReceiveProps",value:function(e){e.item!=this.props.item&&this.setItem(e.item)}},{key:"componentWillMount",value:function(){this.setItem(this.props.item)}},{key:"componentWillUnmount",value:function(){this.setItem(null)}},{key:"commitEdit",value:function(){var e=this.context,t=this.inputText;if(t){var n=e.nima,r=new l.default(n.stage,n.actor,this.props.item,t.value);r.start(),r.end(),this.endEdit(!1)}}},{key:"endEdit",value:function(e){this.setState({editing:!1}),this.inputText&&this.inputText.removeEventListener("blur",this.commitEdit),clearTimeout(this.editTimeout)}},{key:"cancelEdit",value:function(){this.endEdit(!0)}},{key:"startEdit",value:function(){this.setState({editing:!0,editName:this.props.item.name});var e=this;clearTimeout(this.editTimeout),this.editTimeout=setTimeout(function(){e.inputText.focus(),e.inputText.setSelectionRange(0,e.inputText.value.length),e.inputText.addEventListener("blur",e.commitEdit)},0)}},{key:"editKeyDown",value:function(e){switch(e.keyCode){case 13:this.inputText.blur();break;case 27:this.cancelEdit(),this.inputText.blur()}}},{key:"editTextChange",value:function(e){this.setState({editName:e.target.value})}},{key:"select",value:function(){this.item&&this.context.nima.stage.selectItem(this.item.stageItem)}},{key:"textMouseDown",value:function(e){e.stopPropagation(),clearTimeout(this.selectTimeout);var t=Date.now();this.lastMouseDown&&t-this.lastMouseDown<200?this.startEdit():this.selectTimeout=setTimeout(this.select,230),this.lastMouseDown=t}},{key:"deleteItem",value:function(e){e.stopPropagation(),this.props.onDelete&&this.props.onDelete(this.props.item)}},{key:"setKey",value:function(e){e.stopPropagation(),this.props.setKey&&this.props.setKey(this.props.item)}},{key:"setInputText",value:function(e){this.inputText=e}},{key:"render",value:function(){var e,t=this.props.isAnimating,n=this.props.item;switch(this.keyState){case 0:e="SelectionPanelKey";break;case 1:e="SelectionPanelKeyChanged";break;case 2:e="SelectionPanelKeyed"}return i.default.createElement("div",{className:t?"MeshBoneRow MeshBoneRowAnim":"MeshBoneRow",onClick:this.select},i.default.createElement("svg",{className:"TimelineIcon TimelineEventIcon"},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#"+n.uiIcon)})),this.state.editing?i.default.createElement("input",{type:"text",ref:this.setInputText,value:this.state.editName,onKeyDown:this.editKeyDown,onChange:this.editTextChange}):i.default.createElement("div",{className:"MeshBone",onClick:this.textMouseDown},n.name),i.default.createElement("svg",{className:"DeleteRow",style:{display:t?"none":null},onClick:this.deleteItem},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-delete")})),this.props.setKey?i.default.createElement("div",{className:e,style:{display:t?null:"none"},onClick:this.setKey},i.default.createElement("div",null)):null)}},{key:"keyState",get:function(){return 0}}]),t}()).prototype,"itemUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"itemUpdate"),r.prototype),d(r.prototype,"commitEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commitEdit"),r.prototype),d(r.prototype,"endEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"endEdit"),r.prototype),d(r.prototype,"cancelEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"cancelEdit"),r.prototype),d(r.prototype,"startEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"startEdit"),r.prototype),d(r.prototype,"editKeyDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"editKeyDown"),r.prototype),d(r.prototype,"editTextChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"editTextChange"),r.prototype),d(r.prototype,"select",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"select"),r.prototype),d(r.prototype,"textMouseDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"textMouseDown"),r.prototype),d(r.prototype,"deleteItem",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"deleteItem"),r.prototype),d(r.prototype,"setKey",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setKey"),r.prototype),d(r.prototype,"setInputText",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setInputText"),r.prototype),r);t.default=f,f.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(223),a=(r=i)&&r.__esModule?r:{default:r};var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._LastToolType=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"enable",value:function(){this._LastToolType=this.stage.toolType,function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this)}},{key:"close",value:function(){this.stage.tool instanceof t&&(this.stage.toolType=this._LastToolType)}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(3));function l(e){return e&&e.__esModule?e:{default:e}}var u,c,d,f,h,p,y=(r=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"toggleCheck",value:function(){this.props.onValueChange(!this.props.value)}},{key:"render",value:function(){return i.default.createElement("div",{className:"Checkbox",onClick:this.toggleCheck},i.default.createElement("svg",{className:"CheckboxCheck",style:{opacity:this.props.value?1:0}},i.default.createElement("use",{xlinkHref:s.default.make("/images/symbol-defs.svg#icon-check-small")})))}}]),t}(),u=r.prototype,c="toggleCheck",d=[a.default],f=Object.getOwnPropertyDescriptor(r.prototype,"toggleCheck"),h=r.prototype,p={},Object.keys(f).forEach(function(e){p[e]=f[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=d.slice().reverse().reduce(function(e,t){return t(u,c,e)||e},p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(u,c,p),p=null),r);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(168),a=(r=i)&&r.__esModule?r:{default:r},s=n(7);var l=null,u=null,c=null,d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"updateHighlights",value:function(e){var t=this.node;e.highlight(this);var n=t.influencedBones;if(n){var r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;e.highlight(l.stageItem)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}}}},{key:"draw",value:function(e,t,n){var r=this.stage,o=this.node;if(o&&o.isEnabled){o.root;if(1!==o.strength){var i=o.solver;if(i){for(var a=i._FKChain,l=[],d=[],f=null,p=null,y=0;y<a.length;y++){var v=a[y],m=v.transformComponents[4],g=v.ikAngle;p=h(p,v,m),l.push(s.mat2d.getTranslation(s.vec2.create(),p)),f=h(f,v,g),d.push(s.mat2d.getTranslation(s.vec2.create(),f)),y===a.length-1&&(s.mat2d.mul(p,p,s.mat2d.fromTranslation(s.mat2d.create(),[v.bone.length,0])),l.push(s.mat2d.getTranslation(s.vec2.create(),p)),s.mat2d.mul(f,f,s.mat2d.fromTranslation(s.mat2d.create(),[v.bone.length,0])),d.push(s.mat2d.getTranslation(s.vec2.create(),f)))}var b=e.skCanvas;c.setStrokeWidth(2/r.scale*r.screenScale),u.setStrokeWidth(2/r.scale*r.screenScale),b.drawPath(e.linePath(l,!1,!0),c),b.drawPath(e.linePath(d,!1,!0),u)}}}}},{key:"highlight",get:function(){return this.isVisible},set:function(e){this.isVisible=e}}],[{key:"initializeStageContext",value:function(e,t){l=e.canvasKit,(u=new l.SkPaint).setAntiAlias(!0),u.setStyle(l.PaintStyle.Stroke),u.setStrokeWidth(1),u.setBlendMode(l.BlendMode.SrcOver),u.setColor(l.Color(255,91,91,.5)),(c=u.copy()).setColor(l.Color(35,60,100,.5))}}]),t}();t.default=d;var f=s.mat2d.create();function h(e,t,n,r){var o=e||t.bone.parent.renderTransform,i=t.transformComponents;0===n?s.mat2d.identity(f):s.mat2d.fromRotation(f,n),f[4]=i[0],f[5]=i[1],void 0!==r&&(f[4]+=r);var a=i[2],l=i[3];f[0]*=a,f[1]*=a,f[2]*=l,f[3]*=l;var u=i[5];return 0!==u&&(f[2]=f[0]*u+f[2],f[3]=f[1]*u+f[3]),null===e&&(e=s.mat2d.clone(f)),s.mat2d.mul(e,o,f),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(168),a=(r=i)&&r.__esModule?r:{default:r};var s=null,l=null,u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"updateHighlights",value:function(e){e.highlight(this)}},{key:"draw",value:function(e,t,n){var r=this.node;if(r&&r.isEnabled){var o=r.target?r.target.renderTransform:r.parent.renderTransform,i=e.skCanvas;i.save(),e.transform(o);var a=r.distance;i.drawOval(s.LTRBRect(-a,-a,a,a),l),i.restore()}}},{key:"highlight",get:function(){return this.isVisible},set:function(e){this.isVisible=e,function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var s=i.set;void 0!==s&&s.call(o,r)}return r}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"highlight",e,this)}}],[{key:"initializeStageContext",value:function(e,t){s=e.canvasKit,(l=new s.SkPaint).setAntiAlias(!0),l.setStyle(s.PaintStyle.Stroke),l.setStrokeWidth(1),l.setBlendMode(s.BlendMode.SrcOver),l.setColor(s.Color(255,91,91,1))}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(168)),i=s(n(269)),a=n(7);function s(e){return e&&e.__esModule?e:{default:e}}var l=null,u=null,c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"updateHighlights",value:function(e){this.node;e.highlight(this)}},{key:"draw",value:function(e,t,n){var r=this.node,o=this.stage;if(r&&r.isEnabled&&(r.enableMinX||r.enableMaxX||r.enableMinY||r.enableMinY)){var s=340282.3,c=r.enableMinX?r.minX:-s,d=r.enableMinY?r.minY:-s,f=r.enableMaxX?r.maxX:s,h=r.enableMaxY?r.maxY:s,p=e.skCanvas,y=r.parent;y&&(y=y.parent),p.save();var v=r.minMaxSpace===i.default.Local&&y?y.renderTransform:a.mat2d.create();e.transform(v),u.setStrokeWidth(1.1/o.scale*o.screenScale),p.drawRect(l.LTRBRect(c,d,f,h),u),p.restore()}}},{key:"highlight",get:function(){return this.isVisible},set:function(e){this.isVisible=e,function e(t,n,r,o){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var s=i.set;void 0!==s&&s.call(o,r)}return r}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"highlight",e,this)}}]),t}();t.default=c,c.initializeStageContext=function(e,t){l=e.canvasKit,(u=new l.SkPaint).setAntiAlias(!0),u.setStyle(l.PaintStyle.Stroke),u.setStrokeWidth(1),u.setBlendMode(l.BlendMode.SrcOver),u.setColor(l.Color(255,91,91,1))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=X(n(1)),a=X(n(28)),s=X(n(5)),l=X(n(593)),u=X(n(504)),c=X(n(316)),d=X(n(1158)),f=X(n(2)),h=X(n(1159)),p=X(n(1160)),y=X(n(1161)),v=X(n(368)),m=X(n(1162)),g=X(n(537)),b=X(n(209)),k=X(n(370)),S=X(n(1221)),O=X(n(1222)),w=X(n(1236)),_=X(n(1246)),P=X(n(1249)),C=X(n(1255)),E=X(n(1256)),T=X(n(1257)),I=X(n(1261)),j=X(n(1264)),A=X(n(1268)),D=X(n(1269)),R=X(n(1621)),M=X(n(349)),x=X(n(176)),F=X(n(195)),L=X(n(19)),N=X(n(16)),z=X(n(449)),V=X(n(632)),B=X(n(1622)),H=X(n(162)),W=X(n(23)),K=X(n(666)),G=X(n(17)),U=X(n(1625));function X(e){return e&&e.__esModule?e:{default:e}}function Y(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var J=(Y((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));window.editor=n;var r=!0!==l.default.chrome&&!0!==l.default.firefox&&!0!==l.default.safari;return n.listeningForMenuClose=!1,n.state={animationIsResizing:!1,contextMenus:[],error:null,exportOpen:!1,meshMode:!1,settingsOpen:!1,showBrowserWarning:r,showCrashError:!1,showExportToEngine:!1,showGuides:!1,siteMenuOpen:!1,isFilesModalOpen:!1,isFilesModalClosing:!1,isPropertiesModalOpen:!1,isPropertiesModalClosing:!1,isShortcutsModalOpen:!1,isShortcutsModalClosing:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.ddid=0,this.dropDownPopups=[],this.isMeshMode=!1;try{this.nima=new D.default(this,this.props.user,this.props.preferences,this.props.buildNumber,this.props.file,this.props.staticPath)}catch(t){if(console.log("Flare boot error",t),t&&t.constructor===R.default)return void(this.state.error=U.default.WebGLDisabled);var e=t&&t.constructor&&t.constructor.toString&&t.constructor.toString()||"unknown";return G.default.warn("Flare failed to instance due to an unhandled error. Error constructor "+e),void(this.state.error=U.default.Unknown)}this.shortcuts=new u.default(this.nima),this.keyMap=new c.default(this.shortcuts.onAction,this.shortcuts.onActionReleased);var t=this;this.tooltip={enter:function(e){t.tooltipRef&&t.tooltipRef.showFor(e)},leave:function(e){t.tooltipRef&&t.tooltipRef.hideFor(e)},click:function(e){t.tooltipRef&&t.tooltipRef.hideImmediatelyFor(e)}},!0===l.default.mac?this.keyMap.parse(d.default.OSX):this.keyMap.parse(d.default.Windows),this.nima.stage.toolType=M.default;var n=this._Preferences=this.nima.getPreference("editor")||{};this._PreferencesTimeout=null,this.filePanelWidth=n.filePanelWidth||300,this.selectionPanelWidth=n.selectionPanelWidth||234,this.animationPanelHeight=n.animationPanelHeight||260,window.location.hash&&0===window.location.hash.indexOf("#files")&&this.showFilesModal(window.location.hash&&window.location.hash.toString())}},{key:"showFilesModal",value:function(e,t){clearTimeout(this.closeFilesTimeout),this.setState({siteMenuOpen:!1,chooseLocation:t||null,isFilesModalOpen:!0,isFilesModalClosing:!1,filesModalPath:e&&e.constructor===String?e:null})}},{key:"closeFilesModal",value:function(){this.state.chooseLocation&&this.state.chooseLocation(null),this.setState({isFilesModalOpen:!1,isFilesModalClosing:!0});var e=this;clearTimeout(this.closeFilesTimeout),this.closeFilesTimeout=setTimeout(function(){e.setState({isFilesModalClosing:!1})},300)}},{key:"showPropertiesModal",value:function(){clearTimeout(this.closePropertiesTimeout),this.setState({isPropertiesModalOpen:!0,isPropertiesModalClosing:!1})}},{key:"closePropertiesModal",value:function(){this.setState({isPropertiesModalOpen:!1,isPropertiesModalClosing:!0});var e=this;clearTimeout(this.closePropertiesTimeout),this.closePropertiesTimeout=setTimeout(function(){e.setState({isPropertiesModalClosing:!1})},300);var t=this.props.file;this.nima._ExpiredAlert&&(t.isPublic||H.default.isPaid)&&(this.nima._ExpiredAlert.hide(),this.nima._ExpiredAlert=null)}},{key:"closeModal",value:function(){var e=this.state,t=e.exportOpen,n=e.showExportToEngine,r=e.isFilesModalOpen,o=e.isPropertiesModalOpen,i=e.isShortcutsModalOpen;t?this.leaveExportShot():n?this.toggleShowExportToEngine():r?this.closeFilesModal():o?this.closePropertiesModal():i&&this.closeShortcutsModal()}},{key:"toggleShortcutsModal",value:function(){this.state.isShortcutsModalOpen?this.closeShortcutsModal():this.showShortcutsModal()}},{key:"showShortcutsModal",value:function(){clearTimeout(this.closeShortcutsTimeout),this.setState({isShortcutsModalOpen:!0,isShortcutsModalClosing:!1})}},{key:"closeShortcutsModal",value:function(){this.setState({isShortcutsModalOpen:!1,isShortcutsModalClosing:!0});var e=this;clearTimeout(this.closeShortcutsTimeout),this.closeShortcutsTimeout=setTimeout(function(){e.setState({isShortcutsModalClosing:!1})},300)}},{key:"bindingString",value:function(e){var t=this.keyMap.getKeyBinding(e);if(!t)return"?";var n=N.default.isOSX,r="";return t.command&&(r+=n?"⌘":"win"),t.shift&&(0!=r.length&&(r+=" "),r+="shift"),t.ctrl&&(0!=r.length&&(r+=" "),r+="ctrl"),t.alt&&(0!=r.length&&(r+=" "),r+="alt"),0!=r.length&&(r+=" "),(r+=c.default.index.getName(t.code)).toUpperCase()}},{key:"setFilePanel",value:function(e){this.filePanel=e}},{key:"setFilePanelResizer",value:function(e){this.filePanelResizer=e}},{key:"componentDidMount",value:function(){if(this.nima&&(this.nima.addEventListener("ready",this.nimaReady),this.nima.addEventListener("keyDown",this.keyMap.onKeyDown),this.nima.addEventListener("keyUp",this.keyMap.onKeyUp),this.nima.addEventListener("fileRenamed",this.onFileRenamed),this.nima.stage.addEventListener("selectionChanged",this.debounceUpdateSelectionPanelItem),this.nima.addEventListener("selectionChanged",this.debounceUpdateSelectionPanelItem),this.nima.addEventListener("fileLoaded",this.fileLoaded),this.nima.addEventListener("editingAnimationChanged",this.editingAnimationChanged),this.nima.isReady&&this.nimaReady()),!this.state.error){window.addEventListener("resize",this.windowResize),window.addEventListener("paste",this.onPaste),this.filePanel.setAnimationMode(this.isAnimationOpen?this.state.animation:null),this.resizePanels(),this.visibleStageResize();var e=this.props,t=e.file;e.user.isPaid||t.isPublic?t.showProperties&&this.showPropertiesModal():this.showPropertiesModal()}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.windowResize),window.removeEventListener("paste",this.onPaste),this.nima&&(this.nima.removeEventListener("ready",this.nimaReady),this.nima.removeEventListener("keyDown",this.keyMap.onKeyDown),this.nima.removeEventListener("keyUp",this.keyMap.onKeyUp),this.nima.removeEventListener("fileRenamed",this.onFileRenamed),this.nima.stage.removeEventListener("selectionChanged",this.debounceUpdateSelectionPanelItem),this.nima.removeEventListener("selectionChanged",this.debounceUpdateSelectionPanelItem),this.nima.removeEventListener("fileLoaded",this.fileLoaded),this.nima.removeEventListener("editingAnimationChanged",this.editingAnimationChanged),this.nima.cleanup(),this.nima=null)}},{key:"savePreference",value:function(e,t){var n=this.nima,r=this._Preferences;r[e]=t,clearTimeout(this._PreferencesTimeout),this._PreferencesTimeout=setTimeout(function(){n.setCharacterPreference("editor",r)},750)}},{key:"getStateForLog",value:function(){return{exportOpen:this.state.exportOpen,animationIsResizing:this.state.animationIsResizing,settingsOpen:this.state.settingsOpen,siteMenuOpen:this.state.siteMenuOpen,isAnimationOpen:this.isAnimationOpen||!1,isMeshMode:this.isMeshMode||!1,stageRect:this.stageRect}}},{key:"setContextMenuItemData",value:function(e){this.contextMenuItemData=e}},{key:"clearContextMenuItemData",value:function(e){this.contextMenuItemData===e&&(this.contextMenuItemData=null)}},{key:"removeContextMenus",value:function(e){e&&(e.stopPropagation(),e.preventDefault());var t=!1;return this.contextMenuItemData&&(this.contextMenuItemData.select?this.contextMenuItemData.select(this.contextMenuItemData):t=!0),!t&&(this.setState({contextMenus:[]}),this.listenForContextMenuClose(!1),!1)}},{key:"listenForContextMenuClose",value:function(e){if(e){if(this.listeningForMenuClose)return;return window.addEventListener("click",this.removeContextMenus,!0),void(this.listeningForMenuClose=!0)}this.listeningForMenuClose&&(window.removeEventListener("click",this.removeContextMenus,!0),this.listeningForMenuClose=!1)}},{key:"onContextMenuAdded",value:function(){this.state.contextMenus.length&&this.listenForContextMenuClose(!0)}},{key:"showContextMenu",value:function(e){var t=this;this.setState(function(e){return t.contextMenuItemData=null,(0,L.default)(t.onContextMenuAdded),{contextMenus:[]}}),this.addContextMenu(e)}},{key:"addContextMenu",value:function(e){e&&e.items&&e.items.length&&this.setState(function(t){return t.contextMenus.push(e),{contextMenus:t.contextMenus}})}},{key:"removeContextMenu",value:function(e){var t=this.state.contextMenus,n=t.indexOf(e);-1!=n&&(t.splice(n,1),this.setState({contextMenus:t}))}},{key:"addDropDownPopup",value:function(e){e.id=this.ddid++,this.dropDownPopups.push(e);var t=i.default.createElement(A.default,{data:e,onHide:this.removeDropDownPopup,onHiding:this.hidingDropDownPopup}),n=document.createElement("div");return this.dropDownPopupsDiv.appendChild(n),e.component=a.default.render(t,n),e.container=n,e}},{key:"setVerticalRuler",value:function(e){this.verticalRuler=e}},{key:"setHorizontalRuler",value:function(e){this.horizontalRuler=e}},{key:"setStagePanel",value:function(e){this.stagePanel=e}},{key:"setTooltip",value:function(e){this.tooltipRef=e}},{key:"setExportShot",value:function(e){this.exportShot=e}},{key:"setExportEngineModal",value:function(e){this.exportEngineModal=e}},{key:"setExportImageSeqModal",value:function(e){this.exportImageSeqModal=e}},{key:"setSettingsPanel",value:function(e){this.settingsPanel=e}},{key:"setAnimationPanel",value:function(e){this.animationPanel=e}},{key:"setMenu",value:function(e){this.menu=e}},{key:"setAlertContainer",value:function(e){this.alertContainer=e}},{key:"setSelectionResizer",value:function(e){this.selectionResizer=e}},{key:"setSelectionPanel",value:function(e){this.selectionPanel=e}},{key:"setToolbar",value:function(e){this.toolbar=e}},{key:"setFlareToolbar",value:function(e){this.flareToolbar=e}},{key:"hidingDropDownPopup",value:function(e){e.onClosed&&e.onClosed()}},{key:"removeDropDownPopup",value:function(e){var t=this.dropDownPopups,n=t.indexOf(e);-1!=n&&(t.splice(n,1),a.default.unmountComponentAtNode(e.container),e.container.parentNode.removeChild(e.container))}},{key:"windowResize",value:function(){this.visibleStageResize()}},{key:"fileLoaded",value:function(e){this.setState({actor:e});var t=this.workspace||this._Preferences.workspace;t&&this.switchWorkspace(t)}},{key:"onHierarchyPanelsResized",value:function(e){this._Preferences.grabberY!==e&&this.savePreference("grabberY",e)}},{key:"resizePanels",value:function(){this.updateFilePanelSize(this.filePanelWidth),this.updateSelectionPanelSize(window.innerWidth-this.selectionPanelWidth),this.animationPanel.setHeight(this.animationPanelHeight)}},{key:"toggleWorkspace",value:function(){this.nima.stage.soloItem||this.switchWorkspace("AnimateButton"===this.workspace?"SetupButton":"AnimateButton")}},{key:"updateStageRect",value:function(e){if(this.stagePanel){var t=this.stagePanel.getBoundingClientRect();this.stagePanelRect=t;var n={left:this.stagePanelRect.left,right:this.stagePanelRect.right,width:this.stagePanelRect.width+(this.isMeshMode?this.filePanelWidth:0),height:this.stagePanelRect.height,bottom:this.stagePanelRect.bottom};this.stageRect&&this.stageRect.left==n.left&&this.stageRect.right==n.right&&this.stageRect.width==n.width&&this.stageRect.height==n.height&&this.stageRect.bottom==n.bottom||(this.stageRect=n,e||this.nima.dispatch("stageRectChanged",this.stageRect))}}},{key:"visibleStageResize",value:function(){this.updateStageRect(!1)}},{key:"nimaReady",value:function(){this.nima.loadFile()}},{key:"onFileRenamed",value:function(e){var t=this.props.file;t.name=e.name,t.slug=e.slug,t.previewPage=e.previewPage,history.replaceState("","","/a/"+this.props.user.username+"/files/"+t.product+"/"+e.slug)}},{key:"updateSelectionPanel",value:function(){this.selectionPanel&&this.selectionPanel.forceUpdate()}},{key:"revalidateSelectionPanel",value:function(){this.selectionPanel&&this.selectionPanel.revalidate()}},{key:"debounceKeyFramesSelected",value:function(){(0,L.default)(this.onKeyFramesSelected)}},{key:"onKeyFramesSelected",value:function(){var e=this.nima.editingAnimation;if(e){var t=this.selectionPanel;t&&t.setSelectedKeyFrames(e.selectedKeyFrames)}}},{key:"debounceUpdateSelectionPanelItem",value:function(e){(0,L.default)(this.updateSelectionPanelItem,[e])}},{key:"updateSelectionPanelItem",value:function(e){var t=this.selectionPanel;if(t){var n=null;if(this.holdSelection)n=this.holdSelection;else{this.nima.selectedItems.length&&(n=this.nima.selectedItems);var r=this.nima.stage.getFilteredSelectedItems();r.length&&(n=n?n.concat(r):r)}t.setSelectedItem(n,e)}}},{key:"holdSelectedItem",value:function(e){this.holdSelection=e,this.updateSelectionPanelItem()}},{key:"clearHoldSelectedItem",value:function(e){this.holdSelection==e&&(this.holdSelection=null,this.updateSelectionPanelItem())}},{key:"getChildContext",value:function(){return{nima:this.nima,tooltip:this.tooltip,keyMap:this.keyMap,contextMenu:this.contextMenu,editor:this}}},{key:"hoverShowInHierarchy",value:function(){this.filePanel.bringHoverIntoView()}},{key:"switchWorkspace",value:function(e){if(this.workspace=e,this.state.actor){this.filePanel&&this.filePanel.workspaceToggle.toggleChanged(e),this.isAnimationOpen=!1;var t=null,n=this.nima.actor.artboards.active;if(n){var r=n.animations;"AnimateButton"==e?(this.isAnimationOpen=!0,(t=this.lastEditingAnimation)&&-1===r.indexOf(t)&&(t=null),null==t&&(t=this.nima.animations.length?this.nima.animations[0]:n.createAnimation()),this.nima.editingAnimation=t):this.nima.editingAnimation=null,this.animationPanel.setIsOpen(this.isAnimationOpen),this.filePanel.setAnimationMode(this.isAnimationOpen?t:null),this.selectionPanel.setAnimationMode(this.isAnimationOpen?t:null),this.toolbar.setAnimationMode(this.isAnimationOpen?t:null),this.flareToolbar.setAnimationMode(this.isAnimationOpen?t:null),this.stagePanel.style.bottom=this.isAnimationOpen?this.animationPanelHeight+"px":0,this._Preferences.workspace!==e&&this.savePreference("workspace",e);var o=this,i=!0;if(this.state.showGuides){window.requestAnimationFrame(function e(){o.visibleStageResize(),i&&window.requestAnimationFrame(e)}),this.visibleStageResize()}setTimeout(function(){i=!1,o.visibleStageResize()},400)}else G.default.warn(this.nima.actor.artboards.children.length)}}},{key:"editingAnimationChanged",value:function(){this.nima.editingAnimation?"AnimateButton"!==this.workspace&&this.switchWorkspace("AnimateButton"):"AnimateButton"===this.workspace&&this.switchWorkspace("SetupButton");var e=this.nima.editingAnimation;this.lastEditingAnimation&&(this.lastEditingAnimation.removeEventListener("frameSelect",this.debounceKeyFramesSelected),this.lastEditingAnimation.removeEventListener("selectKeyFrames",this.debounceKeyFramesSelected)),e&&(e.addEventListener("frameSelect",this.debounceKeyFramesSelected),e.addEventListener("selectKeyFrames",this.debounceKeyFramesSelected)),e&&(this.lastEditingAnimation=e),this.animationPanel.setAnimation(e),this.filePanel.setEditingAnimation(e)}},{key:"selectAnimation",value:function(e){this.nima.editingAnimation!=e&&(this.nima.editingAnimation=e)}},{key:"deleteAnimation",value:function(e){e.root.removeAnimation(e);var t=this.nima.actor.artboards.active.animations;0==t.length?(this.filePanel.forceSetupWorkspace(),this.nima.editingAnimation=null):this.nima.editingAnimation==e&&(e=t[0],this.nima.editingAnimation=e)}},{key:"startResizeSelection",value:function(e){window.addEventListener("mousemove",this.resizeSelection,!0),window.addEventListener("mouseup",this.endResizeSelection,!0),this.setState({animationIsResizing:!0})}},{key:"resizeSelection",value:function(e){this.updateSelectionPanelSize(e.clientX)}},{key:"updateSelectionPanelSize",value:function(e){var t=this.state.settingsOpen?P.default.width:0;this.selectionPanelWidth=Math.max(234,Math.min(window.innerWidth-e-t,window.innerWidth-this.filePanelWidth-585)),this.selectionPanel.setWidth(this.selectionPanelWidth),this.filePanel.setSelectionPanelWidth(this.selectionPanelWidth),this.animationPanel.setRight(this.selectionPanelWidth),this.flareToolbar.setRight(this.selectionPanelWidth),this.stagePanel.style.right=this.selectionPanelWidth+"px",this.selectionResizer.setRight(this.selectionPanelWidth+t),this.state.showGuides&&this.visibleStageResize()}},{key:"endResizeSelection",value:function(e){window.removeEventListener("mousemove",this.resizeSelection,!0),window.removeEventListener("mouseup",this.endResizeSelection,!0),this.setState({animationIsResizing:!1}),this.visibleStageResize(),this.savePreference("selectionPanelWidth",this.selectionPanelWidth)}},{key:"startResizeAnimation",value:function(e){window.addEventListener("mousemove",this.resizeAnimation,!0),window.addEventListener("mouseup",this.endResizeAnimation,!0),this.setState({animationIsResizing:!0})}},{key:"resizeAnimation",value:function(e){this.animationPanelHeight=Math.max(260,Math.min(window.innerHeight,window.innerHeight-e.clientY)),this.updateAnimationPanelSize()}},{key:"updateAnimationPanelSize",value:function(){if(this.animationPanel.setHeight(this.animationPanelHeight),this.stagePanel.style.bottom=this.animationPanelHeight+"px",this.state.showGuides)this.stagePanel.style.transition="none",this.visibleStageResize();else{var e=this;clearTimeout(this.vsr),this.vsr=setTimeout(function(){e.visibleStageResize()},100)}}},{key:"endResizeAnimation",value:function(e){this.stagePanel.style.transition="",window.removeEventListener("mousemove",this.resizeAnimation,!0),window.removeEventListener("mouseup",this.endResizeAnimation,!0),this.setState({animationIsResizing:!1}),this.visibleStageResize(),this.savePreference("animationPanelHeight",this.animationPanelHeight)}},{key:"startResizefilePanel",value:function(e){window.addEventListener("mousemove",this.resizefilePanel,!0),window.addEventListener("mouseup",this.endResizefilePanel,!0)}},{key:"resizefilePanel",value:function(e){this.updateFilePanelSize(e.clientX)}},{key:"updateFilePanelSize",value:function(e){this.filePanelWidth=Math.max(300,Math.min(window.innerWidth-this.selectionPanelWidth-585,e)),this.filePanel&&this.filePanel.setWidth(this.filePanelWidth),this.selectionPanel&&this.selectionPanel.setFilePanelWidth(this.filePanelWidth),this.animationPanel&&this.animationPanel.setLeft(this.filePanelWidth),this.flareToolbar&&this.flareToolbar.setLeft(this.filePanelWidth),this.filePanelResizer&&this.filePanelResizer.setLeft(this.filePanelWidth),this.stagePanel&&(this.stagePanel.style.left=this.filePanelWidth+"px")}},{key:"endResizefilePanel",value:function(e){window.removeEventListener("mousemove",this.resizefilePanel,!0),window.removeEventListener("mouseup",this.endResizefilePanel,!0),this.visibleStageResize(),this.animationPanel.resize(),this.savePreference("filePanelWidth",this.filePanelWidth)}},{key:"getAccurateStageRect",value:function(){return this.state.exportOpen?this.exportShot.getStageRect():this.stageRect}},{key:"getStageRect",value:function(){return this.state.exportOpen?this.exportShot.getStageRect():this.stageRect}},{key:"find",value:function(){this.filePanel.find()}},{key:"zoomFit",value:function(){this.exportScreen&&this.exportScreen.zoomFit?this.exportScreen.zoomFit():this.nima.stage.zoomFit(1)}},{key:"incSelectionFilter",value:function(e){this.toolbar.incSelectionFilter(e)}},{key:"meshMode",value:function(e){if(this.isMeshMode=e,this.filePanel.setMeshMode(e),this.toolbar.setMeshMode(e),e)this.stagePanel.style.transition="left 0.4s cubic-bezier(0.8, 0, 0, 1)",this.stagePanel.style.left=this.selectionPanelWidth+"px",this.filePanelResizer.hide(!0),this.selectionResizer.hide(!0),this.stagePanelRect&&(this.stageRect={left:this.stagePanelRect.left-this.filePanelWidth,width:this.stagePanelRect.width+this.filePanelWidth,height:this.stagePanelRect.height,bottom:this.stagePanelRect.bottom},this.nima.dispatch("stageRectChanged",this.stageRect));else{this.stagePanel.style.left=this.filePanelWidth+"px";var t=this;setTimeout(function(){t.visibleStageResize(),t.stagePanel.style.transition=null,t.filePanelResizer.hide(!1),t.selectionResizer.hide(!1)},400)}}},{key:"weightsMode",value:function(e){if(this.isMeshMode=e,this.filePanel.setMeshMode(e),this.toolbar.setWeightsMode(e),e)this.stagePanel.style.transition="left 0.4s cubic-bezier(0.8, 0, 0, 1)",this.stagePanel.style.left=this.selectionPanelWidth+"px",this.filePanelResizer.hide(!0),this.selectionResizer.hide(!0),this.stagePanelRect&&(this.stageRect={left:this.stagePanelRect.left-this.filePanelWidth,width:this.stagePanelRect.width+this.filePanelWidth,height:this.stagePanelRect.height,bottom:this.stagePanelRect.bottom},this.nima.dispatch("stageRectChanged",this.stageRect));else{this.stagePanel.style.left=this.filePanelWidth+"px";var t=this;setTimeout(function(){t.visibleStageResize(),t.stagePanel.style.transition=null,t.filePanelResizer.hide(!1),t.selectionResizer.hide(!1)},400)}}},{key:"settingsToggled",value:function(){var e=!this.state.settingsOpen;if(this.setState({settingsOpen:e}),e){var t=P.default.width;this.stagePanel.style.marginRight=t+20+"px",this.animationPanel.setRight(t+this.selectionPanelWidth),this.selectionPanel.setRight(t),this.selectionResizer.setRight(this.selectionPanelWidth+t),this.flareToolbar.setMarginRight(t)}else this.stagePanel.style.marginRight=null,this.animationPanel.setRight(this.selectionPanelWidth),this.selectionResizer.setRight(this.selectionPanelWidth),this.selectionPanel.setRight(0),this.flareToolbar.setMarginRight(0);this.animationPanel.resizeFor(.4);var n=this;if(this.state.showGuides){window.requestAnimationFrame(function e(){n.visibleStageResize(),window.requestAnimationFrame(e)}),this.visibleStageResize()}setTimeout(function(){n.visibleStageResize()},400)}},{key:"showExportMenu",value:function(e,t){this.nima.showContextMenu({x:t.clientX,y:t.clientY,items:[{name:"Export",select:this.toggleShowExportToEngine},{name:"Download File",select:this.toggleShowShareProject}]})}},{key:"gotoExportShot",value:function(){this.nima.setCancelCallback(this.leaveExportShot),this.wasEditingAnimation=this.nima.editingAnimation,this.nima.editingAnimation=null,this.filePanel.translatePanelOut(!0),this.selectionPanel.translatePanelOut(!0),this.toolbar.translatePanelOut(!0,this.state.settingsOpen),this.filePanelResizer.hide(!0),this.selectionResizer.hide(!0),this.settingsPanel.translatePanelOut(!0,this.state.settingsOpen),this.animationPanel.setIsOpen(!1),this.animationPanel.setExport(!0),this.selectionPanel.setAnimationMode(!1);var e=this.nima.stage.settings;this.wasShowingGridAxisBeforeExport=e.showGridAxis,this.wasShowingGridSubdivisionsBeforeExport=e.showGridSubdivisions,e.showGridAxis=!1,e.showGridSubdivisions=!1;var t=this.nima.stage.getLayerOptions(x.default),n=this.nima.stage.getLayerOptions(F.default);this.wasBoneDrawingDisabledBeforeExport=t.disableDraw,t.disableDraw=!0,n.disableDraw=!0,this.nima.stage.isDragDisabled=!0,this.nima.stage.redraw(),this.exportShot.updateValues(),this.setState({exportOpen:!0,isShowingExport:!0}),this.nima.isExporting=!0,clearTimeout(this.exportTimeout)}},{key:"showCrash",value:function(){this.setState({showCrashError:!0})}},{key:"leaveExportShot",value:function(){this.nima.clearCancelCallback(this.leaveExportShot),this.nima.editingAnimation=this.wasEditingAnimation,this.filePanel.translatePanelOut(!1),this.selectionPanel.translatePanelOut(!1),this.toolbar.translatePanelOut(!1,this.state.settingsOpen),this.filePanelResizer.hide(!1),this.selectionResizer.hide(!1),this.settingsPanel.translatePanelOut(!1,this.state.settingsOpen),this.animationPanel.setIsOpen(this.isAnimationOpen),this.animationPanel.setExport(!1),this.selectionPanel.setAnimationMode(this.isAnimationOpen?this.nima.editingAnimation:null),this.exportShot.exitExport(),this.nima.stage.isDragDisabled=this.wasSelectionDisabledBeforeExport;var e=this.nima.stage.getLayerOptions(x.default),t=this.nima.stage.getLayerOptions(F.default);e.disableDraw=this.wasBoneDrawingDisabledBeforeExport,t.disableDraw=this.wasBoneDrawingDisabledBeforeExport;var n=this.nima.stage.settings;n.showGridAxis=this.wasShowingGridAxisBeforeExport,n.showGridSubdivisions=this.wasShowingGridSubdivisionsBeforeExport,this.setState({exportOpen:!1}),this.nima.stage.redraw(),this.nima.isExporting=!1,clearTimeout(this.exportTimeout);var r=this;this.exportTimeout=setTimeout(function(){r.setState({isShowingExport:!1})},400)}},{key:"prepareShotPreview",value:function(){document.getElementById("canvas").style.transform="translate3D(0, -144px, 0)"}},{key:"exitShotPreview",value:function(){this.nima.style.transform=null}},{key:"toggleSiteMenu",value:function(){this.setState({siteMenuOpen:!this.state.siteMenuOpen})}},{key:"logoClick",value:function(){this.state.siteMenuOpen?window.location="/":this.setState({siteMenuOpen:!this.state.siteMenuOpen})}},{key:"loadMenu",value:function(){this.menu.getMenuData()}},{key:"setDropdownPopupsDiv",value:function(e){this.dropDownPopupsDiv=e}},{key:"drawRulers",value:function(){this.verticalRuler&&this.verticalRuler.drawTicks(),this.horizontalRuler&&this.horizontalRuler.drawTicks()}},{key:"serializeGuides",value:function(){var e={};return this.verticalRuler&&(e.vertical=this.verticalRuler.serialize()),this.horizontalRuler&&(e.horizontal=this.horizontalRuler.serialize()),e.vertical||e.horizontal?e:null}},{key:"preferencesUpdated",value:function(){this.setState({showGuides:this.nima.getPreference("showGuides")}),this.settingsPanel.updatePreferences()}},{key:"resetGuides",value:function(){this.verticalRuler&&this.verticalRuler.reset(),this.horizontalRuler&&this.horizontalRuler.reset()}},{key:"deserializeGuides",value:function(e){this.verticalRuler&&this.verticalRuler.deserialize(e.vertical),e&&e.horizontal&&this.horizontalRuler&&this.horizontalRuler.deserialize(e.horizontal)}},{key:"getGuides",value:function(){if(!this.state.showGuides||this.state.isShowingExport)return null;var e=[];return this.verticalRuler&&(e=e.concat(this.verticalRuler.guides)),this.horizontalRuler&&(e=e.concat(this.horizontalRuler.guides)),e}},{key:"toggleShowExportImageSequence",value:function(){this.state.showExportToEngine||(this.exporter=I.default),this.toggleShowExport()}},{key:"toggleShowShareProject",value:function(){this.state.showExportToEngine||(this.exporter=E.default),this.toggleShowExport(),W.default.event("file","download","flare")}},{key:"toggleShowExportToEngine",value:function(){this.state.showExportToEngine||(this.exporter=T.default),this.toggleShowExport()}},{key:"toggleShowExport",value:function(){if(this.nima.hasCopyAccess){var e=!this.state.showExportToEngine;if(e)switch(this.setState({showExportToEngine:e}),this.exporter){case T.default:W.default.event("file","export","flare");break;case E.default:W.default.event("file","export-project","flare");break;case I.default:W.default.event("file","export-image-seq","flare")}else{var t=this;this.exportDisplayTimeout=setTimeout(function(){t.setState({showExportToEngine:e})},400)}}}},{key:"showAlert",value:function(e){this.alertContainer.add(e)}},{key:"continueUsingUnoptimizedBrowser",value:function(){this.setState({showBrowserWarning:!1})}},{key:"setExportScreen",value:function(e){this.exportScreen=e}},{key:"onPaste",value:function(e){this.nima.paste(e)}},{key:"render",value:function(){if(this.state.error)return i.default.createElement(y.default,{error:this.state.error});for(var e=[],t=0;t<this.state.contextMenus.length;t++){var n=this.state.contextMenus[t];e.push(i.default.createElement(j.default,{key:"cx"+t,data:n,onHide:this.removeContextMenu}))}var r=null;if(this.state.showExportToEngine)switch(this.exporter){case E.default:r=i.default.createElement(E.default,{ref:this.setExportScreen,onExportComplete:this.toggleShowExport});break;case T.default:r=i.default.createElement(T.default,{ref:this.setExportScreen,onExportComplete:this.toggleShowExport});break;case I.default:r=i.default.createElement(I.default,{ref:this.setExportScreen,onExportComplete:this.toggleShowExport});break;case K.default:r=i.default.createElement(K.default,{ref:this.setExportScreen,username:this.props.user.username,verified:this.props.isVerified,name:this.props.user.name,avatar:this.props.user.avatar,onExportComplete:this.toggleShowExport})}var o=this.props.file;return i.default.createElement("div",{className:"UIPanels"},this.state.isFilesModalOpen||this.state.isFilesModalClosing?i.default.createElement(z.default,{key:"files",defaultFilename:o.title,onChooseLocation:this.state.chooseLocation,path:this.state.filesModalPath,isOpen:this.state.isFilesModalOpen,isClosing:this.state.isFilesModalClosing,onClose:this.closeFilesModal}):null,this.state.isPropertiesModalOpen||this.state.isPropertiesModalClosing?i.default.createElement(V.default,{isOpen:this.state.isPropertiesModalOpen,isClosing:this.state.isPropertiesModalClosing,onClose:this.closePropertiesModal,file:o}):null,this.state.isShortcutsModalOpen||this.state.isShortcutsModalClosing?i.default.createElement(B.default,{isOpen:this.state.isShortcutsModalOpen,isClosing:this.state.isShortcutsModalClosing,onClose:this.closeShortcutsModal}):null,this.state.showCrashError?i.default.createElement(h.default,null):null,this.state.showBrowserWarning?i.default.createElement(p.default,{onContinueAnyway:this.continueUsingUnoptimizedBrowser}):null,i.default.createElement(v.default,{ref:this.setMenu,onClose:this.toggleSiteMenu,onShowFilesModal:this.showFilesModal,onLogoClick:this.logoClick,siteMenuOpen:this.state.siteMenuOpen,file:o,username:this.props.user.username,name:this.props.user.name,avatar:this.props.user.avatar}),i.default.createElement(m.default,{ref:this.setFilePanel,onShowPropertiesModal:this.showPropertiesModal,onLogoHover:this.loadMenu,onLogoClick:this.logoClick,siteMenuOpen:this.state.siteMenuOpen,file:o,profileName:this.props.user.name,onSwitchedToggle:this.switchWorkspace,width:this.filePanelWidth,selectionPanelWidth:this.selectionPanelWidth,onHierarchyPanelsResized:this.onHierarchyPanelsResized}),i.default.createElement(g.default,{ref:this.setFilePanelResizer,onMouseDown:this.startResizefilePanel,addClass:"HierarchyResizer"}),i.default.createElement(g.default,{ref:this.setSelectionResizer,onMouseDown:this.startResizeSelection,addClass:"SelectionResizer"}),i.default.createElement(b.default,{ref:this.setSelectionPanel,filePanelWidth:this.filePanelWidth,width:this.selectionPanelWidth,animationPanelHeight:this.animationPanelHeight,animationIsResizing:this.state.animationIsResizing,onMeshMode:this.meshMode,onWeightsMode:this.weightsMode}),i.default.createElement("div",{ref:this.setStagePanel,className:"StagePanel"},i.default.createElement(k.default,{ref:this.setAlertContainer,showGuides:this.state.showGuides,showModal:this.hasModalOpen}),i.default.createElement(S.default,{ref:this.setVerticalRuler,isVertical:!1,isVisible:!this.state.isShowingExport&&!this.state.showExportToEngine&&this.state.showGuides}),i.default.createElement(S.default,{ref:this.setHorizontalRuler,isVertical:!0,isVisible:!this.state.isShowingExport&&!this.state.showExportToEngine&&this.state.showGuides})),i.default.createElement(O.default,{ref:this.setAnimationPanel,animationIsResizing:this.state.animationIsResizing,onClickResizeGrabber:this.startResizeAnimation,height:this.animationPanelHeight,actor:this.state.actor,onAnimationSelected:this.selectAnimation,onDeleteAnimation:this.deleteAnimation,settingsOpen:this.state.settingsOpen,filePanelWidth:this.filePanelWidth,selectionPanelWidth:this.selectionPanelWidth}),i.default.createElement(_.default,{ref:this.setFlareToolbar,onGotoExport:this.showExportMenu,settingsOpen:this.state.settingsOpen,onSettingsToggled:this.settingsToggled}),i.default.createElement(w.default,{ref:this.setToolbar,onSettingsToggled:this.settingsToggled,onGotoExport:this.showExportMenu,settingsOpen:this.state.settingsOpen}),i.default.createElement(P.default,{ref:this.setSettingsPanel,onSettingsToggled:this.settingsToggled,isOpen:this.state.settingsOpen,onShowShortcutsModal:this.showShortcutsModal}),r,i.default.createElement(C.default,{ref:this.setTooltip}),e,i.default.createElement("div",{ref:this.setDropdownPopupsDiv}))}},{key:"hasModalOpen",get:function(){return this.state.exportOpen||this.state.showExportToEngine||this.state.isFilesModalOpen||this.state.isPropertiesModalOpen||this.state.isShortcutsModalOpen}}]),t}()).prototype,"showFilesModal",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"showFilesModal"),r.prototype),Y(r.prototype,"closeFilesModal",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"closeFilesModal"),r.prototype),Y(r.prototype,"showPropertiesModal",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"showPropertiesModal"),r.prototype),Y(r.prototype,"closePropertiesModal",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"closePropertiesModal"),r.prototype),Y(r.prototype,"closeModal",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"closeModal"),r.prototype),Y(r.prototype,"toggleShortcutsModal",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleShortcutsModal"),r.prototype),Y(r.prototype,"showShortcutsModal",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"showShortcutsModal"),r.prototype),Y(r.prototype,"closeShortcutsModal",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"closeShortcutsModal"),r.prototype),Y(r.prototype,"bindingString",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"bindingString"),r.prototype),Y(r.prototype,"setFilePanel",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setFilePanel"),r.prototype),Y(r.prototype,"setFilePanelResizer",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setFilePanelResizer"),r.prototype),Y(r.prototype,"removeContextMenus",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"removeContextMenus"),r.prototype),Y(r.prototype,"onContextMenuAdded",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onContextMenuAdded"),r.prototype),Y(r.prototype,"removeContextMenu",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"removeContextMenu"),r.prototype),Y(r.prototype,"addDropDownPopup",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"addDropDownPopup"),r.prototype),Y(r.prototype,"setVerticalRuler",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setVerticalRuler"),r.prototype),Y(r.prototype,"setHorizontalRuler",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setHorizontalRuler"),r.prototype),Y(r.prototype,"setStagePanel",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setStagePanel"),r.prototype),Y(r.prototype,"setTooltip",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setTooltip"),r.prototype),Y(r.prototype,"setExportShot",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setExportShot"),r.prototype),Y(r.prototype,"setExportEngineModal",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setExportEngineModal"),r.prototype),Y(r.prototype,"setExportImageSeqModal",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setExportImageSeqModal"),r.prototype),Y(r.prototype,"setSettingsPanel",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setSettingsPanel"),r.prototype),Y(r.prototype,"setAnimationPanel",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setAnimationPanel"),r.prototype),Y(r.prototype,"setMenu",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setMenu"),r.prototype),Y(r.prototype,"setAlertContainer",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setAlertContainer"),r.prototype),Y(r.prototype,"setSelectionResizer",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setSelectionResizer"),r.prototype),Y(r.prototype,"setSelectionPanel",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setSelectionPanel"),r.prototype),Y(r.prototype,"setToolbar",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setToolbar"),r.prototype),Y(r.prototype,"setFlareToolbar",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setFlareToolbar"),r.prototype),Y(r.prototype,"hidingDropDownPopup",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"hidingDropDownPopup"),r.prototype),Y(r.prototype,"removeDropDownPopup",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"removeDropDownPopup"),r.prototype),Y(r.prototype,"windowResize",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"windowResize"),r.prototype),Y(r.prototype,"fileLoaded",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"fileLoaded"),r.prototype),Y(r.prototype,"onHierarchyPanelsResized",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onHierarchyPanelsResized"),r.prototype),Y(r.prototype,"resizePanels",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"resizePanels"),r.prototype),Y(r.prototype,"nimaReady",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"nimaReady"),r.prototype),Y(r.prototype,"onFileRenamed",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onFileRenamed"),r.prototype),Y(r.prototype,"debounceKeyFramesSelected",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"debounceKeyFramesSelected"),r.prototype),Y(r.prototype,"onKeyFramesSelected",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyFramesSelected"),r.prototype),Y(r.prototype,"debounceUpdateSelectionPanelItem",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"debounceUpdateSelectionPanelItem"),r.prototype),Y(r.prototype,"updateSelectionPanelItem",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"updateSelectionPanelItem"),r.prototype),Y(r.prototype,"switchWorkspace",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"switchWorkspace"),r.prototype),Y(r.prototype,"editingAnimationChanged",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"editingAnimationChanged"),r.prototype),Y(r.prototype,"selectAnimation",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"selectAnimation"),r.prototype),Y(r.prototype,"deleteAnimation",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"deleteAnimation"),r.prototype),Y(r.prototype,"startResizeSelection",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"startResizeSelection"),r.prototype),Y(r.prototype,"resizeSelection",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"resizeSelection"),r.prototype),Y(r.prototype,"updateSelectionPanelSize",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"updateSelectionPanelSize"),r.prototype),Y(r.prototype,"endResizeSelection",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"endResizeSelection"),r.prototype),Y(r.prototype,"startResizeAnimation",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"startResizeAnimation"),r.prototype),Y(r.prototype,"resizeAnimation",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"resizeAnimation"),r.prototype),Y(r.prototype,"updateAnimationPanelSize",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"updateAnimationPanelSize"),r.prototype),Y(r.prototype,"endResizeAnimation",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"endResizeAnimation"),r.prototype),Y(r.prototype,"startResizefilePanel",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"startResizefilePanel"),r.prototype),Y(r.prototype,"resizefilePanel",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"resizefilePanel"),r.prototype),Y(r.prototype,"updateFilePanelSize",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"updateFilePanelSize"),r.prototype),Y(r.prototype,"endResizefilePanel",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"endResizefilePanel"),r.prototype),Y(r.prototype,"meshMode",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"meshMode"),r.prototype),Y(r.prototype,"weightsMode",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"weightsMode"),r.prototype),Y(r.prototype,"settingsToggled",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"settingsToggled"),r.prototype),Y(r.prototype,"showExportMenu",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"showExportMenu"),r.prototype),Y(r.prototype,"gotoExportShot",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"gotoExportShot"),r.prototype),Y(r.prototype,"leaveExportShot",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"leaveExportShot"),r.prototype),Y(r.prototype,"prepareShotPreview",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"prepareShotPreview"),r.prototype),Y(r.prototype,"exitShotPreview",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"exitShotPreview"),r.prototype),Y(r.prototype,"toggleSiteMenu",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleSiteMenu"),r.prototype),Y(r.prototype,"logoClick",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"logoClick"),r.prototype),Y(r.prototype,"loadMenu",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"loadMenu"),r.prototype),Y(r.prototype,"setDropdownPopupsDiv",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setDropdownPopupsDiv"),r.prototype),Y(r.prototype,"toggleShowExportImageSequence",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleShowExportImageSequence"),r.prototype),Y(r.prototype,"toggleShowShareProject",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleShowShareProject"),r.prototype),Y(r.prototype,"toggleShowExportToEngine",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleShowExportToEngine"),r.prototype),Y(r.prototype,"toggleShowExport",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleShowExport"),r.prototype),Y(r.prototype,"continueUsingUnoptimizedBrowser",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"continueUsingUnoptimizedBrowser"),r.prototype),Y(r.prototype,"setExportScreen",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"setExportScreen"),r.prototype),Y(r.prototype,"onPaste",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onPaste"),r.prototype),r);t.default=J,J.childContextTypes={nima:s.default.object,tooltip:s.default.object,keyMap:s.default.object,contextMenu:s.default.object,editor:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=c(n(223)),a=c(n(265)),s=c(n(640)),l=c(n(330)),u=n(7);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.alwaysMarquee=!0,n._SuppressDragOperation=!1,n._IsDrawingContour=!0,n._SelectedVertex=null,n._CheckingInclusion=!1,n._IsOverMesh=!1,n._CheckCount=0,n._ScheduledDoAfterInclusion=null,n._DragEdgeFrom=null,n._IsDeleting=!1,n._HaveDeleteTarget=!1,n._HaveAddTarget=!1,n._ClickDeleted=!1,n._LastMarkedItems=[],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"allowDrag",value:function(){return!this._DragEdgeFrom&&!this._HaveDeleteTarget}},{key:"cancelDrag",value:function(){if(this._IsDrawingContour)return!1;var e=null!==this._DragEdgeFrom;this._DragEdgeFrom=null;var t=this.stage.soloItem;if(t){var n=t.meshEditor;n.hideGhostPoint(),n.hideGhostEdge()}return e}},{key:"updateState",value:function(){var e=this.stage.soloItem,t=!e.meshEditor.isContourClosed;if(this._IsDrawingContour!=t&&(this._IsDrawingContour=t,this.alwaysMarquee=this._IsDrawingContour),this._IsDeleting&&e){var n=e.meshEditor;n.hideGhostPoint(),n.hideGhostEdge()}}},{key:"cancel",value:function(){return this.cancelDrag()}},{key:"validate",value:function(){var e=this.stage.soloItem;return!!e&&!!e.meshEditor}},{key:"enable",value:function(){var e=this.stage.soloItem;return!!e&&(!!e.meshEditor&&(this.hoverItemChange(this.stage.hoverItem),void o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this)))}},{key:"disable",value:function(){this.hoverItemChange(null),this._DragEdgeFrom=null;var e=this.stage.soloItem;if(e){var n=e.meshEditor;n&&(n.hideGhostPoint(),n.hideGhostEdge())}o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this),this.cancel()}},{key:"hoverItemChange",value:function(e){var t=this.stage.soloItem;if(t){for(var n=t.meshEditor,r=0;r<this._LastMarkedItems.length;r++)this._LastMarkedItems[r].willDelete=!1;if(this._LastMarkedItems.length&&this.stage.redraw(),this._LastMarkedItems.length=0,this._HaveDeleteTarget=!1,this._IsDeleting&&e){if(this._LastMarkedItems.push(e),e.constructor===l.default)for(var o=n.getConnectedEdges(e),i=0;i<o.length;i++){var a=o[i];a.willDelete=!0,this._LastMarkedItems.push(a)}else e.isInternal||(this._LastMarkedItems.push(e.vtxA),e.vtxA.willDelete=!0,this._LastMarkedItems.push(e.vtxB),e.vtxB.willDelete=!0);e.willDelete=!0,this._HaveDeleteTarget=!0,this.stage.redraw()}}}},{key:"updateSelection",value:function(e){this._SelectedVertex=null;for(var t=0;t<e.length;t++){var n=e[t];n.constructor===l.default&&(this._SelectedVertex=n)}}},{key:"onKeyDown",value:function(e){18!==e.keyCode||this._IsDeleting||(this._IsDeleting=!0,this.updateState(),this.hoverItemChange(this.stage.hoverItem))}},{key:"onKeyUp",value:function(e){18===e.keyCode&&this._IsDeleting&&(this._IsDeleting=!1,this.updateState(),this.hoverItemChange(null),this._LastMouse&&this.mouseMove(this._LastMouse.mouseMove,this._LastMouse.worldMouseMove,this._LastMouse.worldMouse))}},{key:"advanceDrag",value:function(e,n,r,i){this._SuppressDragOperation||o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"advanceDrag",this).call(this,e,n,r,i)}},{key:"mouseMove",value:function(e,t,n){this._LastMouse={mouseMove:u.vec2.clone(e),worldMouseMove:u.vec2.clone(t),worldMouse:u.vec2.clone(n)},this.updateState();var r=this.stage.soloItem.meshEditor;if(this._HaveAddTarget=!1,!this._IsDeleting){if(this._IsDrawingContour)this.stage.hoverItem&&this.stage.hoverItem.constructor===l.default?r.hideGhostPoint():(this.stage.hoverItem&&this.stage.hoverItem.constructor===a.default&&(n=a.default.pointOnSegment(this.stage.hoverItem.vtxA.worldPosition,this.stage.hoverItem.vtxB.worldPosition,n[0],n[1]).point),r.updateGhostPoint(n)),this.stage.hoverItem&&(this.stage.hoverItem.constructor===a.default||this.stage.hoverItem.constructor===l.default&&this.stage.hoverItem!==r.firstContourVertex)?r.hideGhostEdge():r.updateGhostEdge(this.stage.hoverItem===r.firstContourVertex?this.stage.hoverItem:null);else{if(this.stage.hoverItem&&this.stage.hoverItem.constructor===l.default)this._CheckingInclusion=!1,this._IsOverMesh=!0,r.hideGhostPoint(),this._DragEdgeFrom&&r.updateGhostEdge(this.stage.hoverItem,this._DragEdgeFrom);else if(this.stage.hoverItem&&this.stage.hoverItem.constructor===a.default)n=a.default.pointOnSegment(this.stage.hoverItem.vtxA.worldPosition,this.stage.hoverItem.vtxB.worldPosition,n[0],n[1]).point,r.updateGhostPoint(n),this._CheckingInclusion=!1,this._IsOverMesh=!0,this._DragEdgeFrom&&r.updateGhostEdge(null,this._DragEdgeFrom);else if(r.contourOnly)r.hideGhostPoint();else{this._CheckingInclusion=!0,this._CheckCount++;var o=this;r.isPointOverMesh(r.getLocalPoint(n),(i=this._CheckCount,function(e){o._CheckingInclusion&&i!==o._CheckCount||(o._CheckingInclusion=!1,o._IsOverMesh=e,e?(o._HaveAddTarget=!0,r.updateGhostPoint(n),o._DragEdgeFrom&&r.updateGhostEdge(null,o._DragEdgeFrom),o._ScheduledDoAfterInclusion&&!o._IsDrawingContour&&o._ScheduledDoAfterInclusion()):r.hideGhostPoint(),o._ScheduledDoAfterInclusion=null)}))}this._DragEdgeFrom||r.hideGhostEdge()}var i;return!0}}},{key:"doAfterInclusion",value:function(e){this._CheckingInclusion?this._ScheduledDoAfterInclusion=e:this._IsOverMesh&&e()}},{key:"release",value:function(e,n){var r,i,s=this.stage.soloItem.meshEditor;if(this._IsDeleting||this._ClickDeleted)   ;else if(this._IsDrawingContour)!n&&this.stage.hoverItem===s.firstContourVertex&&s.contourVerticesCount>0?s.ghostEdge&&s.ghostEdge.collisionEdge?s.insertContourPoint(s.ghostEdge.collisionEdge,s.ghostEdge.vtxB.worldPosition):s.canCloseContour&&s.closeContour():!n&&this._SuppressDragOperation&&(this.stage.hoverItem&&this.stage.hoverItem.constructor===a.default?(e=a.default.pointOnSegment(this.stage.hoverItem.vtxA.worldPosition,this.stage.hoverItem.vtxB.worldPosition,e[0],e[1]).point,s.insertContourPoint(this.stage.hoverItem,e)):s.ghostEdge&&s.ghostEdge.collisionEdge?s.insertContourPoint(s.ghostEdge.collisionEdge,s.ghostEdge.vtxB.worldPosition):s.appendContourPoint(e));else{if(this._DragEdgeFrom&&this._DragEdgeFrom!=this.stage.hoverItem)if(s.hideGhostPoint(),s.hideGhostEdge(),this.stage.hoverItem&&this.stage.hoverItem.constructor===l.default){var c=this.stage.hoverItem;s.edgeExists(this._DragEdgeFrom,c)||s.addEdge(this._DragEdgeFrom,c)}else if(this.stage.hoverItem&&this.stage.hoverItem.constructor===a.default){var d=this.stage.hoverItem;e=a.default.pointOnSegment(d.vtxA.worldPosition,d.vtxB.worldPosition,e[0],e[1]).point;var f=s.splitEdge(d,e);this._DragEdgeFrom!==d.vtxA&&this._DragEdgeFrom!==d.vtxB&&s.addEdge(this._DragEdgeFrom,f)}else this.doAfterInclusion((r=u.vec2.clone(e),i=this._DragEdgeFrom,function(){var e=s.addPoint(r,!1,!0);s.addEdge(i,e)}));this._DragEdgeFrom=null}o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"release",this).call(this,e,n)}},{key:"blockMarquee",value:function(e){return this._HaveAddTarget}},{key:"marqueeStarted",value:function(){this.stage.soloItem.meshEditor.hideGhostPoint()}},{key:"click",value:function(e,t,n){var r,o=this.stage.soloItem.meshEditor;if(this._ClickDeleted=!1,this._IsDeleting)this._ClickDeleted=!0,this.stage.hoverItem&&o.delete(this.stage.hoverItem);else if(this._IsDrawingContour){if(this.stage.hoverItem&&this.stage.hoverItem.constructor===l.default)return void(this._SuppressDragOperation=!1);this._SuppressDragOperation=!0}else if(t){if(n.shiftKey&&(this._DragEdgeFrom=this._SelectedVertex),this.stage.hoverItem&&this.stage.hoverItem.constructor===l.default)n.shiftKey?(this._DragEdgeFrom=this.stage.hoverItem,this.stage.selectItem(this._DragEdgeFrom)):this.stage.selectItem(this.stage.hoverItem);else if(this.stage.hoverItem&&this.stage.hoverItem.constructor===a.default){e=a.default.pointOnSegment(this.stage.hoverItem.vtxA.worldPosition,this.stage.hoverItem.vtxB.worldPosition,e[0],e[1]).point;var i=o.splitEdge(this.stage.hoverItem,e);n.shiftKey?this._DragEdgeFrom=i:o.hideGhostPoint(),this.stage.selectItem(i)}o.contourOnly&&(this._DragEdgeFrom=null)}else if(!o.contourOnly)if(o.ghostEdge&&o.ghostEdge.collisionEdge)   ;else{var s=this,c=n.shiftKey;this.doAfterInclusion((r=u.vec2.clone(e),function(){c?(s._DragEdgeFrom=o.addPoint(r),s.stage.selectItem(s._DragEdgeFrom)):(s.stage.selectItem(o.addPoint(r)),o.hideGhostPoint())}))}}},{key:"transformers",get:function(){return[s.default]}}]),t}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=new Map,i=new Map,a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Label=t,this._ID=n,this._NumericId=r,o.set(t,this),i.set(n,this)}return r(e,[{key:"toString",value:function(){return this._Label}},{key:"id",get:function(){return this._ID}},{key:"numericId",get:function(){return this._NumericId}},{key:"label",get:function(){return this._Label}}],[{key:"fromString",value:function(e){return o.get(e)||s}},{key:"fromID",value:function(e){return i.get(e)||s}},{key:"Off",get:function(){return s}},{key:"Sequential",get:function(){return l}},{key:"Synced",get:function(){return u}}]),e}();t.default=a;var s=new a("Off","off",0),l=new a("Sequential","sequential",1),u=new a("Synced","synced",2)},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return[e[0],e[2],e[4],e[1],e[3],e[5]]};"undefined"!=typeof document&&document.createElementNS("http://www.w3.org/2000/svg","svg")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(i(n(2)),i(n(168)));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isSelectable=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"onAddedToStage",value:function(e){this.onTransformed()}},{key:"onTransformed",value:function(){this.renderTransform=this.node.renderTransform}},{key:"draw",value:function(e,t){this.renderTransform;this.node.stageItem.drawContour(e)}}],[{key:"initializeStageContext",value:function(e,t,n){}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=l(n(265)),i=l(n(330)),a=n(7),s=l(n(376));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=function(){function e(t,n,r){u(this,e),this._Stage=t,this._MeshEditor=n,this._Vertices=r,this._AccumMove=a.vec2.create()}return r(e,[{key:"advance",value:function(e,t,n,r){e=a.vec2.add(a.vec2.create(),this._MeshEditor.getLocalMove(t),this._AccumMove);for(var o=a.vec2.create(),i=0,s=0,l=0;l<this._Vertices.length;l++){var u=this._Vertices[l];a.vec2.add(o,u.position,e);var c=this._MeshEditor.constrainLocal(o),d=c[0]-o[0],f=c[1]-o[1];Math.abs(d)>Math.abs(i)&&(i=d),Math.abs(f)>Math.abs(s)&&(s=f)}for(var h=new Array(this._Vertices.length),p=a.vec2.set(a.vec2.create(),e[0]+i,e[1]+s),y=0;y<this._Vertices.length;y++){var v=this._Vertices[y];h[y]=a.vec2.clone(v.position),v.position=a.vec2.add(o,v.position,p)}if(this._MeshEditor.doesAnyEdgeIntersect()){for(var m=0;m<this._Vertices.length;m++){this._Vertices[m].position=h[m]}return this._AccumMove[0]=e[0],void(this._AccumMove[1]=e[1])}this._AccumMove[0]=-i,this._AccumMove[1]=-s,this._MeshEditor.markMeshDirty()}},{key:"complete",value:function(){}}]),e}();t.default=c;var d=function(){function e(t,n){u(this,e),this._Stage=t,this._Vertices=n}return r(e,[{key:"advance",value:function(e,t,n,r){for(var o=a.vec2.create(),i=0;i<this._Vertices.length;i++){var s=this._Vertices[i];s.deformWorld=a.vec2.add(o,s.worldPosition,t)}}},{key:"complete",value:function(){}}]),e}();c.make=function(e,t){for(var n=[],r=[],a=0;a<t.length;a++){var l=t[a];switch(l.constructor){case o.default:var u=l.vtxA;if(u.isDeformer){-1===r.indexOf(u)&&r.push(u),u=l.vtxB,-1===r.indexOf(u)&&r.push(u);continue}-1===n.indexOf(u)&&n.push(u),u=l.vtxB,-1===n.indexOf(u)&&n.push(u);break;case i.default:if(l.isDeformer){r.push(l);continue}n.push(l)}}return 0!=n.length?new c(e.stage,e.stage.soloItem.meshEditor,n):0!=r.length?(e.suppressTransformer(s.default),new d(e.stage,r)):void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(18),a=(r=i)&&r.__esModule?r:{default:r};var s=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._Name=null,e._IsSelected=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"setName",value:function(e,t){this._Name=e,t||(this.dispatch("update",this),this.dispatch("nameChanged",e))}},{key:"name",get:function(){return this._Name},set:function(e){this.setName(e)}},{key:"isSelected",get:function(){return this._IsSelected},set:function(e){this._IsSelected!=e&&(this._IsSelected=e,this.dispatch("selectedChange",e))}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={MipMapped:1,ClampToEdge:2,MultiplyAlpha:4,LinearFilter:8,FlipY:16}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(264),a=(r=i)&&r.__esModule?r:{default:r};var s=null,l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,null,[{key:"graphics",get:function(){return s||(s=new a.default).setSize(e.iconWidth,e.iconHeight),s}},{key:"iconScale",get:function(){return 4}},{key:"iconStroke",get:function(){return 1}},{key:"padding",get:function(){return 2}},{key:"iconWidth",get:function(){return 15*e.iconScale}},{key:"iconHeight",get:function(){return 15*e.iconScale}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},i=c(n(223)),a=c(n(195)),s=c(n(176)),l=c(n(646)),u=c(n(171));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Parent=null,n._Alert=null,n._LastToolType=null,n._SelectedChildren=[],n._MadeNotSectable=[],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),r(t,[{key:"makeSelectableAgain",value:function(){for(var e=0;e<this._MadeNotSectable.length;e++)this._MadeNotSectable[e].isSelectable=!0;this._MadeNotSectable.length=0}},{key:"cancel",value:function(){this._Parent&&this.makeSelectableAgain(),this._SelectedChildren.length?(this._SelectedChildren.length=0,this.stage.clearSelections()):(this.stage.clearSelections(),this.stage.toolType=this._LastToolType)}},{key:"updateSelection",value:function(e){this._SelectedChildren.length=0;for(var t=0;t<e.length;t++){var n=e[t];switch(n.constructor){case s.default:case a.default:continue}n.node&&n.node!==this._Parent.node&&this._SelectedChildren.push(n.node)}var r=this._SelectedChildren.length>0;this._Alert.enableButton(1,r),this._Alert.accentButton(1,r)}},{key:"close",value:function(){this.stage.toolType=this._LastToolType}},{key:"enable",value:function(){this._LastToolType=this.stage.toolType,o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enable",this).call(this),this.stage.clearSelections();for(var e=this.stage.stageItems,n=0;n<e.length;n++){var r=e[n];r.node&&r.node!=this._Parent.node&&r.constructor!==a.default||(e.splice(n,1),n--)}var i=this;this._Alert=this.stage.appContext.alert({title:"Pick Children",message:"Pick the children for "+this._Parent.node.name+".",type:u.default.Types.State,buttons:[{label:"CANCEL",action:function(e,t){i.cancel(),i.stage.toolType=i._LastToolType}},{label:"DONE",isDisabled:!0,action:function(e,t){i.close()}}]})}},{key:"validate",value:function(){if(this.stage.appContext.editingAnimation)return!1;var e=this.stage.selectedItems;if(!e.length||!e[0].node||!e[0].node.isNode)return!1;var t=this.stage.stageItems;this._Parent=e[0];for(var n=0;n<t.length;n++){var r=t[n];r!==this._Parent&&r.constructor!==a.default||-1!==this._MadeNotSectable.indexOf(r)||!r.isSelectable||(this._MadeNotSectable.push(r),r.isSelectable=!1)}if(this._Parent.node&&this._Parent.node.stageItem){var o=this._Parent.node.stageItem;-1===this._MadeNotSectable.indexOf(o)&&o.isSelectable&&(this._MadeNotSectable.push(o),o.isSelectable=!1)}return!0}},{key:"disable",value:function(){if(this._Alert.hide(),o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disable",this).call(this),this._Parent){var e=this._Parent.node;if(this.makeSelectableAgain(),this._SelectedChildren.length){"Bone"===e.name&&(e.name=(this._SelectedChildren[0].name||"Item")+" Bone");var n=new l.default(this.stage,this.stage.appContext.actor,this._SelectedChildren,e);n.silent=!1,n.start(),n.end(),this._SelectedChildren.length=0}this.stage.selectItem(this._Parent)}}},{key:"click",value:function(e){}}]),t}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(229)),o=a(n(198)),i=a(n(219));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e,n,r,a){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),null===a)throw new Error("Parent should never be null.");var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),l=!0,u=!1,c=void 0;try{for(var d,f=r[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var h=d.value;if(h.isValidParent(a)&&(h.parent!==a&&h!==a)){if(a.isChildOf(h))if(a.constructor===o.default){for(var p=a.parent;p&&p.constructor!==i.default;)p=p.parent;p&&p.constructor===i.default&&(h.parent.add(p),p.compensate())}else h.parent.add(a),a.compensate();a.add(h),h.isNode&&h.compensate()}}}catch(e){u=!0,c=e}finally{try{!l&&f.return&&f.return()}finally{if(u)throw c}}return s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(208),i=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"SkinWorker.js"))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a,a.call=function(e,t,n){a.instance||(a.instance=new a),a.instance.call(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(168),a=(r=i)&&r.__esModule?r:{default:r},s=n(7);var l=null,u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.drawAfterSelections=!0,e.isHandle=!0,e.hitDetectOnMesh=!1,e.isSelectable=!0,e._Color=s.vec4.create(),e._HoverColor=s.vec4.create(),e.color=[1,0,0,1],e.hoverColor=[1,1,0,1],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"onAddedToStage",value:function(e){this.setMinMax([-5,-107],[5,0])}},{key:"alignToTransform",value:function(e,t){if(this.stage)if(e===t){var n=s.vec2.create(),r=s.mat2d.decompose(n,e),o=s.mat2d.fromRotation(s.mat2d.create(),r);o[4]=e[4],o[5]=e[5];var i=1/this.stage.scale,a=s.mat2d.fromScaling(s.mat2d.create(),[i*Math.sign(n[0]),i*Math.sign(n[1])]),l=this.rotationTransform;l&&s.mat2d.mul(a,l,a),this.renderTransform=s.mat2d.mul(s.mat2d.create(),o,a)}else{var u=s.mat2d.fromRotation(s.mat2d.create(),s.mat2d.getRotation(t));u[4]=e[4],u[5]=e[5];var c=1/this.stage.scale,d=s.mat2d.fromScaling(s.mat2d.create(),[c,c]),f=this.rotationTransform;f&&s.mat2d.mul(d,f,d),this.renderTransform=s.mat2d.mul(s.mat2d.create(),u,d)}}},{key:"draw",value:function(e,t){var n=e.skCanvas,r=this.renderTransform,o=this.stageContext,i=o._Fill,a=o._HandlePath,s=t?this._HoverColor:this._Color;n.save(),e.transform(r),i.setColor(l.Color(Math.round(255*s[0]),Math.round(255*s[1]),Math.round(255*s[2]),s[3])),n.drawPath(a,i),n.restore()}},{key:"color",get:function(){return this._Color},set:function(e){s.vec4.copy(this._Color,e)}},{key:"hoverColor",get:function(){return this._HoverColor},set:function(e){s.vec4.copy(this._HoverColor,e)}}]),t}();t.default=u,u.initializeStageContext=function(e,t){var n=new(l=e.canvasKit).SkPaint;n.setAntiAlias(!0),n.setStyle(l.PaintStyle.Fill),n.setBlendMode(l.BlendMode.SrcOver),n.setColor(l.Color(0,0,0,1)),t._Fill=n,t._HandlePath=e.linePath([.6,0,-.6,0,-.6,-100,-5,-100,0,-107,5,-100,.6,-100],!0,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(301),a=(r=i)&&r.__esModule?r:{default:r},s=n(7);var l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Stage=t;for(var r=this._Meshes=new Set,o=[],i=0;i<n.length;i++){var a=n[i];o.push(a),r.add(a.node.parent)}this._Vertices=o}return o(e,[{key:"advance",value:function(t,n,r,o){e.translate(this._Vertices,n);var i=!0,a=!1,s=void 0;try{for(var l,u=this._Meshes[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){l.value.triggerAutoKeyFrameVertices()}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}},{key:"complete",value:function(){}}],[{key:"translate",value:function(e,t){var n=s.vec2.create(),r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;u.worldTranslation=s.vec2.add(n,u.worldTranslation,t)}}catch(e){o=!0,i=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}}}]),e}();t.default=l,l.make=function(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r];switch(o.constructor){case a.default:n.push(o)}}if(0!=n.length)return new l(e.stage,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7),i=p(n(203)),a=p(n(197)),s=p(n(198)),l=p(n(173)),u=p(n(351)),c=p(n(219)),d=p(n(195)),f=p(n(179)),h=p(n(17));function p(e){return e&&e.__esModule?e:{default:e}}var y=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Modulation=t,this._CompensateBones=n,this._CompensateImages=r,this._ActorNodes=o,this._TransformSpace=i;for(var a=o.slice(0),s=0;s<a.length;s++)for(var l=a[s];l.parent;){if(-1!=a.indexOf(l.parent)){a.splice(s,1),s--;break}l=l.parent}this._TopActorNodes=a}return r(e,[{key:"advance",value:function(e,t){var n=[t[0],-t[1]],r=.001*(n[0]+n[1]),u=void 0,f=void 0,p=void 0,y=void 0,v=this;if(this._TransformSpace){if(u=o.mat2d.create(),!(f=o.mat2d.invert(o.mat2d.create(),this._TransformSpace)))return void h.default.warn("Failed to invert transform space",this._TransformSpace);if(p=o.mat2d.copy(o.mat2d.create(),this._TransformSpace),1===this._Modulation[0]&&1===this._Modulation[1])y=o.mat2d.fromScaling(o.mat2d.create(),[1+r*this._Modulation[0],1+r*this._Modulation[1]]);else{var m=o.vec2.transformMat2(o.vec2.create(),n,f);y=o.mat2d.fromScaling(o.mat2d.create(),[1+.001*m[0]*this._Modulation[0],1+.001*m[1]*this._Modulation[1]])}}for(var g=0;g<this._TopActorNodes.length;g++){var b=this._TopActorNodes[g],k=void 0;if(b.renderTransform){if(b.constructor===i.default&&b.isConnectedToBones&&(k=o.mat2d.clone(b.renderTransform)),this._TransformSpace)if(o.mat2d.mul(u,f,b.renderTransform),o.mat2d.mul(u,y,u),o.mat2d.mul(u,p,u),b.hasWorldTransformOverride)b.overrideWorldTransform=u;else{var S=o.mat2d.invert(o.mat2d.create(),b.parent.renderTransform);o.mat2d.mul(u,S,u);var O=o.vec2.create();b.rotation=o.mat2d.decompose(O,u),b.scale=O,b.translation=o.mat2d.getTranslation(o.vec2.create(),u)}else b.scale=o.vec2.add(o.vec2.create(),b.scale,[r*this._Modulation[0],r*this._Modulation[1]]);if(b.constructor===i.default&&b.isConnectedToBones&&(b.compensateConnectedBones(k),b.overrideWorldTransform=k),!this._CompensateImages||b.constructor!==s.default&&b.constructor!==c.default||b.all(function(e){e.constructor!==s.default&&e.constructor!==c.default||d.default.compensateSkinnedImages(e)}),b.constructor===s.default&&this._CompensateBones)for(var w=b.stageItem.joint,_=0;_<w.children.length;_++){var P=w.children[_];d.default.alignChain(P.joint)}(this._CompensateImages||this._CompensateBones)&&function(){var e=[];if(b.eachChildRecursive(function(t){(v._CompensateImages&&(t.constructor===i.default||t.constructor===a.default)||v._CompensateBones&&(t.constructor===s.default||t.constructor===l.default))&&-1==e.indexOf(t)&&e.push(t)}),e.length)for(var t=0;t<e.length;t++){e[t].compensate()}}()}else h.default.warn("Missing render transform: "+b.name)}}},{key:"complete",value:function(){}}]),e}();t.default=y,y.make=function(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r];if(o.node&&!(o.constructor===f.default&&o.node.isConnectedToBones&&e.stage.appContext.editingAnimation||o.node.constructor===u.default))if(o.constructor===d.default)for(var i=0;i<o.children.length;i++){var a=o.children[i];-1==n.indexOf(a.node)&&n.push(a.node)}else-1==n.indexOf(o.node)&&n.push(o.node)}if(0!=n.length)return new y(e.snap?[1,1]:e.modulation,e.stage.settings.compensateBones,e.stage.settings.compensateImages,n,e.transformSpace)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=void 0,r=void 0,o=1,i=e.length;o<i;o++){for(r=e[o],n=o-1;n>=0&&t(r,e[n])<0;)e[n+1]=e[n],n--;e[n+1]=r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=k(n(2)),a=k(n(18)),s=k(n(289)),l=k(n(19)),u=k(n(653)),c=k(n(655)),d=k(n(656)),f=k(n(657)),h=k(n(658)),p=k(n(1150)),y=k(n(659)),v=k(n(197)),m=k(n(660)),g=k(n(421)),b=k(n(661));function k(e){return e&&e.__esModule?e:{default:e}}function S(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var O=(S((r=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r._Node=e,r._Animation=n,r._IsExpanded=!1,r._HasHover=!1,r._IsSelected=!1,r._KeyFrameGroups=[],r._BaseGroup=null,r._RowCount=0,r._PropertyGroups=[],r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"clear",value:function(){for(var e=0;e<this._KeyFrameGroups.length;e++){this._KeyFrameGroups[e].removeEventListener("update",this.updateGroup)}this._KeyFrameGroups.length=0,this._BaseGroup=null,(0,l.default)(this.updateGroup)}},{key:"addGroup",value:function(e){null===this._BaseGroup&&(this._BaseGroup=e),this._KeyFrameGroups.push(e),e.addEventListener("update",this.updateGroup),(0,l.default)(this.updateGroup)}},{key:"translateX",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stageItem.stage,o=n.actor,i=new u.default(r,o,n.stageItem,e);i.silent=t,i.start(),i.end()}}},{key:"translateY",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stageItem.stage,o=n.actor,i=new c.default(r,o,n.stageItem,e);i.silent=t,i.start(),i.end()}}},{key:"setWidth",value:function(e,t){var n=this._Node;n.stageItem&&(n.width=e,t||n.stageItem.stage.appContext.captureJournalEntry())}},{key:"setHeight",value:function(e,t){var n=this._Node;n.stageItem&&(n.height=e,t||n.stageItem.stage.appContext.captureJournalEntry())}},{key:"setRotationRef",value:function(e){this.rotationRef=e}},{key:"rotate",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stageItem.stage,o=n.actor,i=e-this.rotationRef.propertyValue,a=new d.default(r,o,n.stageItem,i);a.silent=t,a.start(),a.end()}}},{key:"scaleX",value:function(e,t){var n=this._Node;n.stageItem&&(n.scale=[e,n.scale[1]],t||n.stageItem.stage.appContext.captureJournalEntry())}},{key:"scaleY",value:function(e,t){var n=this._Node;n.stageItem&&(n.scale=[n.scale[0],e],t||n.stageItem.stage.appContext.captureJournalEntry())}},{key:"changeCollisionEnabled",value:function(e,t,n){var r=this._Node;r.stageItem&&(r.isCollisionEnabled=1===e,t||r.stageItem.stage.appContext.captureJournalEntry())}},{key:"changeIntValue",value:function(e,t,n){var r=this._Node;r.stageItem&&(n.node.intValue=e,t||r.stageItem.stage.appContext.captureJournalEntry())}},{key:"changeFloatValue",value:function(e,t,n){var r=this._Node;r.stageItem&&(n.node.floatValue=e,t||r.stageItem.stage.appContext.captureJournalEntry())}},{key:"changeStringValue",value:function(e,t,n){var r=this._Node;r.stageItem&&(n.node.stringValue=e,t||r.stageItem.stage.appContext.captureJournalEntry())}},{key:"changeBooleanValue",value:function(e,t,n){var r=this._Node;r.stageItem&&(n.node.booleanValue=1===e,t||r.stageItem.stage.appContext.captureJournalEntry())}},{key:"changeActiveChild",value:function(e,t,n){var r=this._Node;r.stageItem&&(n.node.activeChildIndex=e-1,t||r.stageItem.stage.appContext.captureJournalEntry())}},{key:"elongate",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stageItem.stage,o=n.actor,i=new f.default(r,o,[n.stageItem],e);i.silent=t,i.start(),i.end()}}},{key:"changeCornerRadius",value:function(e,t){var n=this._Node;n.stageItem&&(n.cornerRadius=e,t||n.stageItem.stage.appContext.captureJournalEntry())}},{key:"changeInnerRadius",value:function(e,t){var n=this._Node;n.stageItem&&(n.innerRadius=e,t||n.stageItem.stage.appContext.captureJournalEntry())}},{key:"changeOpacity",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stageItem.stage,o=n.actor,i=new h.default(r,o,n.stageItem,e);i.silent=t,i.start(),i.end()}}},{key:"changeStrokeWidth",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stroke;if(r)if(r.width=e,!t)n.stageItem.stage.appContext.captureJournalEntry()}}},{key:"changeStrokeStart",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stroke;if(r)if(r.trimStart=e,!t)n.stageItem.stage.appContext.captureJournalEntry()}}},{key:"changeStrokeEnd",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stroke;if(r)if(r.trimEnd=e,!t)n.stageItem.stage.appContext.captureJournalEntry()}}},{key:"changeStrokeOffset",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stroke;if(r)if(r.trimOffset=e,!t)n.stageItem.stage.appContext.captureJournalEntry()}}},{key:"changeStrokeOpacity",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stroke;if(r)if(r.opacity=e,!t)n.stageItem.stage.appContext.captureJournalEntry()}}},{key:"changeFillOpacity",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.fill;if(r)if(r.opacity=e,!t)n.stageItem.stage.appContext.captureJournalEntry()}}},{key:"changeSequence",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stageItem.stage,o=n.actor,i=new y.default(r,o,n.stageItem,e);i.silent=t,i.start(),i.end()}}},{key:"changeStrength",value:function(e,t){var n=this._Node;n.stageItem&&(n.strength=e,t||n.stageItem.stage.appContext.captureJournalEntry())}},{key:"changeDrawOrder",value:function(e,t){var n=this._Node;if(n.stageItem){var r=n.stageItem.stage,o=n.actor,i=new p.default(r,o,n.stageItem,e);i.silent=t,i.start(),i.end()}}},{key:"updateGroup",value:function(){for(var e=this._KeyFrameGroups,t=[],n=1,r=0;r<e.length;r++){var o=e[r],i=o.props;if(i.framePosX||i.framePosY){var a={label:"Translation",props:[]};t.push(a),i.framePosX&&(a.props.push({label:"X",event:"animatePosX",key:"framePosX",onValueChanged:this.translateX,frameList:i.framePosX}),n++),i.framePosY&&(a.props.push({label:"Y",event:"animatePosY",key:"framePosY",onValueChanged:this.translateY,frameList:i.framePosY}),n++)}if(i.frameWidth||i.frameHeight){var l={label:"Size",props:[]};t.push(l),i.frameWidth&&(l.props.push({label:"Width",event:"animateWidth",key:"frameWidth",onValueChanged:this.setWidth,frameList:i.frameWidth}),n++),i.frameHeight&&(l.props.push({label:"Height",event:"animateHeight",key:"frameHeight",onValueChanged:this.setHeight,frameList:i.frameHeight}),n++)}if(i.frameRotation){var u={label:"Rotation",props:[{label:"",event:"animateRotation",key:"frameRotation",converter:m.default,ref:this.setRotationRef,onValueChanged:this.rotate,frameList:i.frameRotation}]};t.push(u),n++}if(i.frameScaleX||i.frameScaleY){var c={label:"Scale",props:[]};t.push(c),i.frameScaleX&&(c.props.push({label:"X",event:"animateScaleX",key:"frameScaleX",onValueChanged:this.scaleX,frameList:i.frameScaleX}),n++),i.frameScaleY&&(c.props.push({label:"Y",event:"animateScaleY",key:"frameScaleY",onValueChanged:this.scaleY,frameList:i.frameScaleY}),n++)}if(i.frameCornerRadius){var d={label:"Corner Radius",props:[{label:"",event:"animateCornerRadius",key:"frameCornerRadius",onValueChanged:this.changeCornerRadius,frameList:i.frameCornerRadius}]};t.push(d),n++}if(i.frameInnerRadius){var f={label:"Inner Radius",props:[{label:"",event:"animateInnerRadius",key:"frameInnerRadius",onValueChanged:this.changeInnerRadius,frameList:i.frameInnerRadius}]};t.push(f),n++}if(i.frameOpacity){var h={label:"Opacity",props:[{label:"",event:"animateOpacity",key:"frameOpacity",onValueChanged:this.changeOpacity,frameList:i.frameOpacity}]};t.push(h),n++}if(i.frameSequence){var p={label:"Frame",props:[{label:"",event:"animateSequence",key:"frameSequence",onValueChanged:this.changeSequence,frameList:i.frameSequence}]};t.push(p),n++}if(i.frameStrength){var y={label:"Strength",props:[{label:"",event:"animateStrength",key:"frameStrength",onValueChanged:this.changeStrength,frameList:i.frameStrength}]};t.push(y),n++}if(i.frameLength){var k={label:"Length",props:[{label:"",event:"animateLength",key:"frameLength",onValueChanged:this.elongate,frameList:i.frameLength}]};t.push(k),n++}if(i.frameIsCollisionEnabled){var S={label:"Enabled",props:[{node:o.node,label:"",event:"animateCollisionEnabled",key:"frameIsCollisionEnabled",onValueChanged:this.changeCollisionEnabled,frameList:i.frameIsCollisionEnabled,isText:!0,enumerationIndex:function(e){return e.node.isCollisionEnabled?1:0},enumeration:["False","True"]}]};t.push(S),n++}if(i.frameIntValue&&o.node.propertyType===s.default.Type.Integer){var O={label:o.node.name,props:[{node:o.node,label:"",event:"animateIntValue",key:"frameIntValue",decimals:0,onValueChanged:this.changeIntValue,frameList:i.frameIntValue}]};t.push(O),n++}if(i.frameFloatValue&&o.node.propertyType===s.default.Type.Float){var w={label:o.node.name,props:[{node:o.node,label:"",event:"animateFloatValue",key:"frameFloatValue",onValueChanged:this.changeFloatValue,frameList:i.frameFloatValue}]};t.push(w),n++}if(i.frameStringValue&&o.node.propertyType===s.default.Type.String){var _={label:o.node.name,props:[{node:o.node,label:"",event:"animateStringValue",key:"frameStringValue",isText:!0,onValueChanged:this.changeStringValue,frameList:i.frameStringValue}]};t.push(_),n++}if(i.frameBooleanValue&&o.node.propertyType===s.default.Type.Boolean){var P={label:o.node.name,props:[{node:o.node,label:"",event:"animateBooleanValue",key:"frameBooleanValue",isText:!0,onValueChanged:this.changeBooleanValue,frameList:i.frameBooleanValue,enumerationIndex:function(e){return e.node.booleanValue?1:0},enumeration:["False","True"]}]};t.push(P),n++}if(i.frameActiveChild){var C={label:"Active Child",props:[{node:o.node,label:"",event:"animateActiveChild",key:"frameActiveChild",isText:!0,onValueChanged:this.changeActiveChild,frameList:i.frameActiveChild,enumerationIndex:function(e){return e.node.activeChildIndex+1},get enumeration(){var e=this.node,t=[{label:"None",value:0}],n=!0,r=!1,o=void 0;try{for(var i,a=e.children[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;t.push({label:s.name,child:s,value:s.refId})}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return t}}]};t.push(C),n++}if(i.frameDrawOrder){var E={label:"Draw Order",props:[{label:"",event:"animateDrawOrder",key:"frameDrawOrder",onValueChanged:this.changeDrawOrder,frameList:i.frameDrawOrder}]};t.push(E),n++}if(i.frameTrigger){var T={label:"Trigger",props:[{label:"",key:"frameTrigger",frameList:i.frameTrigger}]};t.push(T),n++}if(i.framePathVertices){var I={label:"Vertices",props:[{label:"",event:"animatePathVertices",key:"framePathVertices",onValueChanged:null,frameList:i.framePathVertices}]};t.push(I),n++}if(i.frameImageVertices){var j={label:"Vertices",props:[{label:"",event:"animateImageVertices",key:"frameImageVertices",onValueChanged:null,frameList:i.frameImageVertices}]};t.push(j),n++}if(o.node.paintFill===v.default.PaintType.Color&&i.frameFillColor){var A={label:"Fill Color",props:[{label:"",event:"animateFillColor",key:"frameFillColor",onValueChanged:null,frameList:i.frameFillColor}]};t.push(A),n++}if(o.node.paintFill===v.default.PaintType.LinearGradient&&i.frameFillGradient){var D={label:"Fill Gradient",props:[{label:"",event:"animateFillGradient",key:"frameFillGradient",onValueChanged:null,frameList:i.frameFillGradient}]};t.push(D),n++}if(o.node.paintFill===v.default.PaintType.RadialGradient&&i.frameFillRadial){var R={label:"Fill Radial",props:[{label:"",event:"animateFillRadial",key:"frameFillRadial",onValueChanged:null,frameList:i.frameFillRadial}]};t.push(R),n++}if(o.node.paintFill!==v.default.PaintType.None&&i.frameFillOpacity){var M={label:"Fill Opacity",props:[{label:"",event:"animateFillOpacity",key:"frameFillOpacity",onValueChanged:this.changeFillOpacity,frameList:i.frameFillOpacity}]};t.push(M),n++}if(o.node.paintStroke===v.default.PaintType.Color&&i.frameStrokeColor){var x={label:"Stroke Color",props:[{label:"",event:"animateStrokeColor",key:"frameStrokeColor",onValueChanged:null,frameList:i.frameStrokeColor}]};t.push(x),n++}if(o.node.paintStroke===v.default.PaintType.LinearGradient&&i.frameStrokeGradient){var F={label:"Stroke Gradient",props:[{label:"",event:"animateStrokeGradient",key:"frameStrokeGradient",onValueChanged:null,frameList:i.frameStrokeGradient}]};t.push(F),n++}if(o.node.paintStroke===v.default.PaintType.RadialGradient&&i.frameStrokeRadial){var L={label:"Stroke Radial",props:[{label:"",event:"animateStrokeRadial",key:"frameStrokeRadial",onValueChanged:null,frameList:i.frameStrokeRadial}]};t.push(L),n++}if(o.node.paintStroke!==v.default.PaintType.None&&i.frameStrokeWidth){var N={label:"Stroke Width",props:[{label:"",event:"animateStrokeWidth",key:"frameStrokeWidth",onValueChanged:this.changeStrokeWidth,frameList:i.frameStrokeWidth}]};t.push(N),n++}if(o.node.paintStroke!==v.default.PaintType.None&&i.frameStrokeOpacity){var z={label:"Stroke Opacity",props:[{label:"",event:"animateStrokeOpacity",key:"frameStrokeOpacity",onValueChanged:this.changeStrokeOpacity,frameList:i.frameStrokeOpacity}]};t.push(z),n++}if(o.node.paintStroke!==v.default.PaintType.None&&i.frameStrokeStart){var V={label:"Stroke Start",props:[{label:"",event:"animateStrokeStart",key:"frameStrokeStart",converter:g.default,onValueChanged:this.changeStrokeStart,frameList:i.frameStrokeStart}]};t.push(V),n++}if(o.node.paintStroke!==v.default.PaintType.None&&i.frameStrokeEnd){var B={label:"Stroke End",props:[{label:"",event:"animateStrokeEnd",key:"frameStrokeEnd",converter:g.default,onValueChanged:this.changeStrokeEnd,frameList:i.frameStrokeEnd}]};t.push(B),n++}if(o.node.paintStroke!==v.default.PaintType.None&&i.frameStrokeOffset){var H={label:"Stroke Offset",props:[{label:"",event:"animateStrokeOffset",key:"frameStrokeOffset",converter:b.default,onValueChanged:this.changeStrokeOffset,frameList:i.frameStrokeOffset}]};t.push(H),n++}}this._RowCount=n,this._PropertyGroups=t,this.dispatch("update"),this._Animation.dispatchUpdateEditableRows()}},{key:"rowCount",get:function(){return this._RowCount}},{key:"propertyGroups",get:function(){return this._PropertyGroups}},{key:"node",get:function(){return this._Node}},{key:"animation",get:function(){return this._Animation}},{key:"baseKeyFrameGroup",get:function(){return this._BaseGroup}},{key:"keyFrameGroups",get:function(){return this._KeyFrameGroups}},{key:"hasHover",get:function(){return this._HasHover},set:function(e){this._HasHover!=e&&(this._HasHover=e,this.dispatch("hover"),this._Animation.dispatch("update"))}},{key:"isSelected",get:function(){return this._IsSelected},set:function(e){this._IsSelected!=e&&(this._IsSelected=e,this.dispatch("selected",this._IsSelected),this._Animation.dispatch("update"))}},{key:"isExpanded",get:function(){return this._IsExpanded},set:function(e){this._IsExpanded!=e&&(this._IsExpanded=e,this.dispatch("expand",e),this._Animation.dispatch("expand",this))}}]),t}()).prototype,"translateX",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"translateX"),r.prototype),S(r.prototype,"translateY",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"translateY"),r.prototype),S(r.prototype,"setWidth",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"setWidth"),r.prototype),S(r.prototype,"setHeight",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"setHeight"),r.prototype),S(r.prototype,"setRotationRef",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"setRotationRef"),r.prototype),S(r.prototype,"rotate",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"rotate"),r.prototype),S(r.prototype,"scaleX",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"scaleX"),r.prototype),S(r.prototype,"scaleY",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"scaleY"),r.prototype),S(r.prototype,"changeCollisionEnabled",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeCollisionEnabled"),r.prototype),S(r.prototype,"changeIntValue",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeIntValue"),r.prototype),S(r.prototype,"changeFloatValue",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeFloatValue"),r.prototype),S(r.prototype,"changeStringValue",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeStringValue"),r.prototype),S(r.prototype,"changeBooleanValue",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeBooleanValue"),r.prototype),S(r.prototype,"changeActiveChild",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeActiveChild"),r.prototype),S(r.prototype,"elongate",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"elongate"),r.prototype),S(r.prototype,"changeCornerRadius",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeCornerRadius"),r.prototype),S(r.prototype,"changeInnerRadius",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeInnerRadius"),r.prototype),S(r.prototype,"changeOpacity",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeOpacity"),r.prototype),S(r.prototype,"changeStrokeWidth",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeStrokeWidth"),r.prototype),S(r.prototype,"changeStrokeStart",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeStrokeStart"),r.prototype),S(r.prototype,"changeStrokeEnd",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeStrokeEnd"),r.prototype),S(r.prototype,"changeStrokeOffset",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeStrokeOffset"),r.prototype),S(r.prototype,"changeStrokeOpacity",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeStrokeOpacity"),r.prototype),S(r.prototype,"changeFillOpacity",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeFillOpacity"),r.prototype),S(r.prototype,"changeSequence",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeSequence"),r.prototype),S(r.prototype,"changeStrength",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeStrength"),r.prototype),S(r.prototype,"changeDrawOrder",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeDrawOrder"),r.prototype),S(r.prototype,"updateGroup",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"updateGroup"),r.prototype),r);t.default=O},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(229)),o=i(n(654));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));a._StageItem=r;var s=void 0;return(s=a._StageItem.node)&&(s.translation=[i,s.translation[1]],(0,o.default)(a._Stage.settings.compensateBones,a._Stage.settings.compensateImages,s)),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(t||e){var a=[];if(n.eachChild(function(n){(t&&(n.constructor===r.default||n.constructor===i.default)||e&&n.constructor===o.default)&&-1==a.indexOf(n)&&a.push(n)}),a.length)for(var s=0;s<a.length;s++){var l=a[s];l.compensate()}}};var r=a(n(203)),o=a(n(198)),i=a(n(173));function a(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(229)),o=i(n(654));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));a._StageItem=r;var s=void 0;return(s=a._StageItem.node)&&(s.translation=[s.translation[0],i],(0,o.default)(a._Stage.settings.compensateBones,a._Stage.settings.compensateImages,s)),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(229)),o=i(n(521));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));(a._StageItem=r,a._StageItem&&a._StageItem.node)&&new o.default(null,null,a._Stage.settings.compensateBones,a._Stage.settings.compensateImages,[a._StageItem.node],a._StageItem.node.worldTranslation,!1,[0,0]).setRotationDelta(i);return a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(229)),o=n(7),i=a(n(378));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e,n,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),l=0;l<r.length;l++){var u=r[l],c=new i.default(e.settings.compensateBones,e.settings.compensateImages,[u.joint]),d=o.mat2d.getTranslation(o.vec2.create(),u.parentJoint.renderTransform),f=o.mat2d.getTranslation(o.vec2.create(),u.joint.renderTransform),h=o.vec2.subtract(o.vec2.create(),f,d),p=a-o.vec2.length(h);0===o.vec2.length(h)&&(h=[1,0]);var y=o.vec2.normalize(o.vec2.create(),h),v=o.vec2.scale(y,y,p);c.advance(null,v)}return s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(229),i=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(e,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.node.opacity=o,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(229),i=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(e,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.node.sequence=o,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.floor(180*e/Math.PI*100)/100+" °"}},{key:"toInputValue",value:function(e){return 180*e/Math.PI}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e)/180*Math.PI;if(Number.isNaN(t))throw"Invalid input";return t}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"allowDrag",get:function(){return!0}},{key:"dragScale",get:function(){return.1/180*Math.PI}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(421),a=(r=i)&&r.__esModule?r:{default:r};var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,null,[{key:"dragMin",get:function(){return-Number.MAX_VALUE}},{key:"dragMax",get:function(){return Number.MAX_VALUE}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(18)),i=a(n(663));a(n(197));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r._Node=e,r._Animation=n,r._EmptyProperties={},r._Properties={},r._PropertiesList=[],r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"triggerEvents",value:function(e,t){for(var n=0;n<this._PropertiesList.length;n++){var r=this._PropertiesList[n];if(r.findTriggeredFrames){var o=r.findTriggeredFrames(e,t);o&&o.length&&this._Animation.dispatch("triggerEvent",this._Node)}}}},{key:"interpolate",value:function(e){for(var t=0;t<this._PropertiesList.length;t++){var n=this._PropertiesList[t];n.interpolate&&n.interpolate(e)}}},{key:"removeProperty",value:function(e){var t=this._Properties[e];if(t){delete this._Properties[e];var n=this._PropertiesList.indexOf(t);-1!=n&&(this._PropertiesList.splice(n,1),0==this._PropertiesList.length&&this._Animation.hideKeyedNode(this)),this.dispatch("update",this._Properties)}}},{key:"getKeyFrames",value:function(e){if(!this.node.canKeyFrame(e))return null;var t=this._Properties[e];return t||(t=this._EmptyProperties[e])&&(delete this._EmptyProperties[e],this._Properties[e]=t,this._PropertiesList.push(t),this.dispatch("update",this._Properties)),t||(this._Properties[e]=t=new i.default(this,this._Animation,e),this._PropertiesList.push(t),1==this._PropertiesList.length&&this._Animation.showKeyedNode(this),this.dispatch("update",this._Properties),this._Animation.dispatch("update")),t}},{key:"serialize",value:function(){for(var e={},t=0;t<this._PropertiesList.length;t++){var n=this._PropertiesList[t];e[n.property]=n.serialize()}return e}},{key:"deserialize",value:function(e,t){for(var n in t){var r,o=t[n];if("framePaths"!==n){if("frameActiveChildIndex"===n){n="frameActiveChild";var a=this._Node.children;if(a.length){var s=!0,l=!1,u=void 0;try{for(var c,d=o[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,h=a[f.v-1];f.v=h?h.refId:-1}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}}this._Properties[n]=r=new i.default(this,this._Animation,n),this._PropertiesList.push(r),r.deserialize(e,o)}else console.log("DISCARDING OLD VERTICES.")}}},{key:"updateVisibility",value:function(){0==this._PropertiesList.length&&this._Animation.hideKeyedNode(this)}},{key:"hideProperty",value:function(e){"frameDrawOrder"===e.property?this._Animation.orderKeyState=0:this._Node[e.property+"KS"]=0,this._EmptyProperties[e.property]=e;var n=this._PropertiesList.indexOf(e);if(-1!=n){this._PropertiesList.splice(n,1),delete this._Properties[e.property],0==this._PropertiesList.length&&this._Animation.hideKeyedNode(this);var r=t.RigPropertyLookup[e.property];r&&(this._Node[e.property]=this._Node[r]),this.dispatch("update",this._Properties)}}},{key:"showProperty",value:function(e){delete this._EmptyProperties[e.property],-1==this._PropertiesList.indexOf(e)&&(this._PropertiesList.push(e),this._Properties[e.property]=e,1==this._PropertiesList.length&&this._Animation.showKeyedNode(this),this.dispatch("update",this._Properties))}},{key:"props",get:function(){return this._Properties}},{key:"propsList",get:function(){return this._PropertiesList}},{key:"node",get:function(){return this._Node}},{key:"animation",get:function(){return this._Animation}}]),t}();function l(e,t){return{id:e,key:t}}t.default=s,s.Properties={unknown:l(0,"unknown"),framePosX:l(1,"posX"),framePosY:l(2,"posY"),frameScaleX:l(3,"scaleX"),frameScaleY:l(4,"scaleY"),frameRotation:l(5,"rotation"),frameOpacity:l(6,"opacity"),frameDrawOrder:l(7,"drawOrder"),frameLength:l(8,"length"),frameImageVertices:l(9,"imageVertices"),frameStrength:l(10,"strength"),frameTrigger:l(11,"trigger"),frameIntValue:l(12,"intValue"),frameFloatValue:l(13,"floatValue"),frameStringValue:l(14,"stringValue"),frameBooleanValue:l(15,"boolValue"),frameIsCollisionEnabled:l(16,"isCollisionEnabled"),frameSequence:l(17,"sequence"),frameActiveChild:l(18,"activeChild"),framePathVertices:l(19,"pathVertices"),frameFillColor:l(20,"fillColor"),frameFillGradient:l(21,"fillGradient"),frameFillRadial:l(22,"fillRadial"),frameStrokeColor:l(23,"strokeColor"),frameStrokeGradient:l(24,"strokeGradient"),frameStrokeRadial:l(25,"strokeRadial"),frameStrokeWidth:l(26,"strokeWidth"),frameStrokeOpacity:l(27,"strokeOpacity"),frameFillOpacity:l(28,"fillOpacity"),frameWidth:l(29,"width"),frameHeight:l(30,"height"),frameCornerRadius:l(31,"cornerRadius"),frameInnerRadius:l(32,"innerRadius"),frameStrokeStart:l(33,"strokeStart"),frameStrokeEnd:l(34,"strokeEnd"),frameStrokeOffset:l(35,"strokeOffset")},s.RigPropertyLookup={framePosX:"rigPosX",framePosY:"rigPosY",frameScaleX:"rigScaleX",frameScaleY:"rigScaleY",frameRotation:"rigRotation",frameOpacity:"rigOpacity",frameDrawOrder:"rigDrawOrder",frameLength:"rigLength",frameImageVertices:"rigImageVertices",frameStrength:"rigStrength",frameIntValue:"rigIntValue",frameFloatValue:"rigFloatValue",frameStringValue:"rigStringValue",frameBooleanValue:"rigBooleanValue",frameIsCollisionEnabled:"rigIsCollisionEnabled",frameSequence:"rigSequence",frameActiveChild:"rigActiveChild",framePathVertices:"rigPathVertices",frameFillColor:"rigFillColor",frameFillGradient:"rigFillGradient",frameFillRadial:"rigFillRadial",frameStrokeColor:"rigStrokeColor",frameStrokeGradient:"rigStrokeGradient",frameStrokeRadial:"rigStrokeRadial",frameStrokeWidth:"rigStrokeWidth",frameStrokeOpacity:"rigStrokeOpacity",frameFillOpacity:"rigFillOpacity",frameWidth:"rigWidth",frameHeight:"rigHeight",frameCornerRadius:"rigCornerRadius",frameInnerRadius:"rigInnerRadius",frameStrokeStart:"rigStrokeStart",frameStrokeEnd:"rigStrokeEnd",frameStrokeOffset:"rigStrokeOffset"},s.ExportPropertyLookup={Unknown:0,PosX:1,PosY:2,ScaleX:3,ScaleY:4,Rotation:5,Opacity:6,DrawOrder:7,Length:8,VertexDeform:9,ConstraintStrength:10,Trigger:11,IntProperty:12,FloatProperty:13,StringProperty:14,BooleanProperty:15,IsCollisionEnabled:16,Sequence:17,ActiveChildIndex:18,PathVertices:19,FillColor:20,FillGradient:21,FillRadial:22,StrokeColor:23,StrokeGradient:24,StrokeRadial:25,StrokeWidth:26,StrokeOpacity:27,FillOpacity:28,ShapeWidth:29,ShapeHeight:30,CornerRadius:31,InnerRadius:32}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=h(n(18)),i=h(n(651)),a=h(n(664)),s=h(n(254)),l=n(7),u=h(n(17)),c=h(n(379)),d=h(n(380)),f=h(n(352));function h(e){return e&&e.__esModule?e:{default:e}}var p=new Map;p.set(c.default.ID,c.default),p.set(d.default.ID,d.default),p.set(f.default.ID,f.default);var y=function(e){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));o._Group=e,o._Animation=n,o._Property=r,o._KeyFrames=[],o._FrameValue=0,o._In=0,o._HasHover=!1,o._IsSelected=!1,o.setGraphValue="frameRotation"==r?o.setRotationGraphValue:o.getGraphValue,o.getGraphValue="frameRotation"==r?o.getRotationGraphValue:o.getGraphValue;var i=[87/255,165/255,225/255,.3];switch(r){case"frameStringValue":case"frameBooleanValue":case"frameIsCollisionEnabled":case"frameActiveChild":o.interpolate=o.interpolateHoldKeyFrame;break;case"frameTrigger":o.interpolate=o.interpolateKeyFrame,o.findTriggeredFrames=o.findPassedFrames;break;case"frameDrawOrder":o.interpolate=o.interpolateOrder;break;case"frameImageVertices":o.interpolate=o.interpolateImageVertices;break;case"framePathVertices":o.interpolate=o.interpolatePathVertices;break;case"frameFillGradient":case"frameFillRadial":case"frameFillColor":case"frameStrokeColor":case"frameStrokeGradient":case"frameStrokeRadial":o.interpolate=o.interpolateFloat32ArrayKeyFrame;break;default:o.interpolate=o.interpolateKeyFrame}switch(r){case"framePosX":case"frameScaleX":i=[236/255,62/255,74/255,1];break;case"framePosY":case"frameScaleY":i=[103/255,254/255,217/255,1];break;case"frameRotation":i=[1,161/255,0,1]}return o._Color=i,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"setGraphValue",value:function(e){return e}},{key:"getGraphValue",value:function(e){return e}},{key:"setRotationGraphValue",value:function(e){return e/180*Math.PI}},{key:"getRotationGraphValue",value:function(e){return e/Math.PI*180}},{key:"serializeFrame",value:function(e){var n=t.serializeFrameValue(this.property,e.value),r={t:e.time,v:n,i:e._Interpolator.constructor.ID};return e._Interpolator.serialize(r),r}},{key:"serialize",value:function(){for(var e=[],t=0;t<this._KeyFrames.length;t++){var n=this._KeyFrames[t];e.push(this.serializeFrame(n))}return e}},{key:"deserialize",value:function(e,n){for(var r={},o=0,i=0;i<n.length;i++){var s=n[i],l=t.deserializeFrameValue(e,this.property,s),u=new a.default(this._Group,this._Animation,this,s.t,l);u._Interpolator=t.deserializeInterpolator(s),r[u.time]?o++:(r[u.time]=1,this._KeyFrames.push(u))}o&&console.log("GOT DUPES",o),this.syncPreviousNextKeyFrames()}},{key:"interpolatePathVertices",value:function(e){if(this._KeyFrames.length){var t=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1);if(0==t){var n=this._KeyFrames[0];this._Group.node[this._Property+"KS"]=e==n.time?2:0,this._FrameValue=n.value}else if(t<this._KeyFrames.length){var r=this._KeyFrames[t-1],o=this._KeyFrames[t],i=r._Interpolator.getEasedMix((e-r.time)/(o.time-r.time));if(1==i)this._Group.node[this._Property+"KS"]=2,this._FrameValue=o.value;else{this._Group.node[this._Property+"KS"]=0;var a=r.value,u=new Map;r.value.forEach(function(e,t){a.set(t,e)}),o.value.forEach(function(e,t){var n=a.get(t),r=void 0;n?(r={pos:l.vec2.lerp(l.vec2.create(),n.pos,e.pos,i)},n.in&&e.in&&(r.in=l.vec2.lerp(l.vec2.create(),n.in,e.in,i)),n.out&&e.out&&(r.out=l.vec2.lerp(l.vec2.create(),n.out,e.out,i)),void 0===n.radius&&void 0===e.radius||(r.radius=(void 0===n.radius?t.rigRadius:n.radius)*(1-i)+(void 0===e.radius?t.rigRadius:e.radius)*i)):r=e,u.set(t,r)}),this._FrameValue=u}}else{var c=this._KeyFrames[t-1];this._Group.node[this._Property+"KS"]=e==c.time?2:0,this._FrameValue=c.value}}}},{key:"interpolateImageVertices",value:function(e){if(this._KeyFrames.length){var t=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1);if(0==t){var n=this._KeyFrames[0];this._Group.node[this._Property+"KS"]=e==n.time?2:0,this._FrameValue=n.value}else if(t<this._KeyFrames.length){var r=this._KeyFrames[t-1],o=this._KeyFrames[t],i=r._Interpolator.getEasedMix((e-r.time)/(o.time-r.time));if(1==i)this._Group.node[this._Property+"KS"]=2,this._FrameValue=o.value;else{this._Group.node[this._Property+"KS"]=0;var a=r.value,u=new Map;r.value.forEach(function(e,t){a.set(t,e)}),o.value.forEach(function(e,t){var n=a.get(t),r=void 0;r=n?l.vec2.lerp(l.vec2.create(),n,e,i):e,u.set(t,r)}),this._FrameValue=u}}else{var c=this._KeyFrames[t-1];this._Group.node[this._Property+"KS"]=e==c.time?2:0,this._FrameValue=c.value}}}},{key:"interpolateOrder",value:function(e){if(this._KeyFrames.length){var t=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1);if(0==t){var n=this._KeyFrames[0];this._Animation.orderKeyState=e==n.time?2:0,this._FrameValue=n.value}else if(t<this._KeyFrames.length){var r=this._KeyFrames[t-1],o=this._KeyFrames[t];1==(e-r.time)/(o.time-r.time)?(this._Animation.orderKeyState=2,this._FrameValue=o.value):(this._Animation.orderKeyState=0,this._FrameValue=r.value)}else{var i=this._KeyFrames[t-1];this._Animation.orderKeyState=e==i.time?2:0,this._FrameValue=i.value}}}},{key:"getInterpolatedValue",value:function(e){if(!this._KeyFrames.length)return 0;var t=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1);if(0==t)return this._KeyFrames[0]._Value;if(t<this._KeyFrames.length){var n=this._KeyFrames[t-1],r=this._KeyFrames[t];return e==r.time?r._Value:n.interpolate(e)}return this._KeyFrames[t-1]._Value}},{key:"findPassedFrames",value:function(e,t){var n=s.default.KeyFrameLocation(t,this._KeyFrames,0,this._KeyFrames.length-1);if(0===n)return this._KeyFrames.length>0&&this._KeyFrames[0].time===t?[this._KeyFrames[0]]:null;for(var r=[],o=n-1;o>=0;o--){var i=this._KeyFrames[o];if(!(i.time>e))break;r.push(i)}return r}},{key:"interpolateHoldKeyFrame",value:function(e){if(this._KeyFrames.length){var t=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1);if(0==t){var n=this._KeyFrames[0];this._Group.node[this._Property+"KS"]=n.time==e?2:0,this._FrameValue=n._Value}else if(t<this._KeyFrames.length){var r=this._KeyFrames[t-1],o=this._KeyFrames[t];e==o.time?(this._Group.node[this._Property+"KS"]=2,this._FrameValue=o._Value):(this._Group.node[this._Property+"KS"]=0,this._FrameValue=r._Value)}else{var i=this._KeyFrames[t-1];this._Group.node[this._Property+"KS"]=e==i.time?2:0,this._FrameValue=i._Value}}}},{key:"interpolateFloat32ArrayKeyFrame",value:function(e){if(this._KeyFrames.length){var t=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1);if(0==t){var n=this._KeyFrames[0];this._Group.node[this._Property+"KS"]=n.time==e?2:0,this._FrameValue=n._Value}else if(t<this._KeyFrames.length){var r=this._KeyFrames[t-1],o=this._KeyFrames[t];if(e==o.time)this._Group.node[this._Property+"KS"]=2,this._FrameValue=o._Value;else{var i=r._Interpolator.getEasedMix((e-r.time)/(o.time-r.time));this._Group.node[this._Property+"KS"]=0,this._FrameValue=s.default.InterpolateFloat32Array(r._Value,o._Value,i)}}else{var a=this._KeyFrames[t-1];this._Group.node[this._Property+"KS"]=e==a.time?2:0,this._FrameValue=a._Value}}}},{key:"interpolateKeyFrame",value:function(e){if(this._KeyFrames.length){var t=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1);if(0==t){var n=this._KeyFrames[0];this._Group.node[this._Property+"KS"]=n.time==e?2:0,this._FrameValue=n._Value}else if(t<this._KeyFrames.length){var r=this._KeyFrames[t-1],o=this._KeyFrames[t];e==o.time?(this._Group.node[this._Property+"KS"]=2,this._FrameValue=o._Value):(this._Group.node[this._Property+"KS"]=0,this._FrameValue=r.interpolate(e))}else{var i=this._KeyFrames[t-1];this._Group.node[this._Property+"KS"]=e==i.time?2:0,this._FrameValue=i._Value}}}},{key:"getValue",value:function(e){var t=this.getKey(e);return t?t.value:null}},{key:"getKey",value:function(e){var t,n=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1);return n<this._KeyFrames.length&&(t=this._KeyFrames[n]).time===e?t:null}},{key:"updateValue",value:function(e,t){var n,r=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1);return r<this._KeyFrames.length&&(n=this._KeyFrames[r]).time===e?(n.value=t,this.dispatch("update",n)):(n=new a.default(this._Group,this._Animation,this,e,t),this._KeyFrames.splice(r,0,n),this.syncPreviousNextKeyFrames(),this.dispatch("add",n),this._Group.dispatch("add",n),this._Animation.dispatch("update"),this._Animation.onKeyFrameAdded(n)),n}},{key:"syncPreviousNextKeyFrames",value:function(){for(var e=null,t=0;t<this._KeyFrames.length;t++){var n=this._KeyFrames[t];n._Idx=t,e?(n.prv!=e&&(n._Dirty=!0),e.nxt!=n&&(e._Dirty=!0),n.prv=e,e.nxt=n):(null!=n.prv&&(n._Dirty=!0),n.prv=null),e=n}e&&(null!=e.nxt&&(e._Dirty=!0),e.nxt=null)}},{key:"reSort",value:function(){(0,i.default)(this._KeyFrames,function(e,t){return e.time-t.time}),this.syncPreviousNextKeyFrames()}},{key:"getClosestKey",value:function(e,t){var n=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1),r=n-1,o=t||Number.MAX_Value,i=-1;if(r>=0&&r<this._KeyFrames.length){var a=Math.abs(e-this._KeyFrames[r].time);a<o&&(o=a,i=r)}var l=n;if(l>=0&&l<this._KeyFrames.length){var u=Math.abs(e-this._KeyFrames[l].time);u<o&&(o=u,i=l)}return-1==i?null:this._KeyFrames[i]}},{key:"getKeysInRange",value:function(e,t){var n=s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1),r=s.default.KeyFrameLocation(t,this._KeyFrames,0,this._KeyFrames.length-1);return this._KeyFrames.slice(n,r)}},{key:"getKeysInRangeIdx",value:function(e,t){return{start:s.default.KeyFrameLocation(e,this._KeyFrames,0,this._KeyFrames.length-1),end:s.default.KeyFrameLocation(t,this._KeyFrames,0,this._KeyFrames.length-1)}}},{key:"setKey",value:function(){this.updateValue(this._Animation.position,this._Group.node[this._Property]),this._Group.node[this._Property+"KS"]=2}},{key:"removeKey",value:function(){var e=this.getKey(this._Animation.position);return!!e&&(e.remove(),this._Animation.dispatch("update"),!0)}},{key:"setPositionToNextKey",value:function(){var e=s.default.KeyFrameLocation(this._Animation.position,this._KeyFrames,0,this._KeyFrames.length-1);if(e<this._KeyFrames.length){var t=this._KeyFrames[e];this._Animation.position==t.time&&e+1<this._KeyFrames.length&&(t=this._KeyFrames[e+1]),this._Animation.position=t.time}}},{key:"setPositionToPreviousKey",value:function(){var e=s.default.KeyFrameLocation(this._Animation.position,this._KeyFrames,0,this._KeyFrames.length-1);if(e-1<this._KeyFrames.length&&e-1>=0){var t=this._KeyFrames[e-1];this._Animation.position==t.time&&e-2>=0&&(t=this._KeyFrames[e-2]),this._Animation.position=t.time}}},{key:"add",value:function(e){var t=0==this._KeyFrames.length;return this._KeyFrames.push(e),t&&this._Group.showProperty(this),!0}},{key:"remove",value:function(e){var t=this._KeyFrames.indexOf(e);return-1!=t&&(this._KeyFrames.splice(t,1),0==this._KeyFrames.length&&this._Group.hideProperty(this),this.syncPreviousNextKeyFrames(),!0)}},{key:"cssColor",get:function(){return this._CssColor?this._CssColor:(this._CssColor="rgba("+Math.round(255*this.color[0])+","+Math.round(255*this.color[1])+","+Math.round(255*this.color[2])+","+this.color[3]+")",this._CssColor)}},{key:"color",get:function(){return this._Color}},{key:"group",get:function(){return this._Group}},{key:"hasHover",get:function(){return this._HasHover},set:function(e){this._HasHover!=e&&(this._HasHover=e,this.dispatch("hover"),this._Animation.dispatch("update"))}},{key:"isSelected",get:function(){return this._IsSelected},set:function(e){this._IsSelected!=e&&(this._IsSelected=e,this.dispatch("selected",this._IsSelected),this._Animation.dispatch("update"))}},{key:"frameValue",get:function(){return this._FrameValue}},{key:"keyFrames",get:function(){return this._KeyFrames}},{key:"property",get:function(){return this._Property}},{key:"animation",get:function(){return this._Animation}}]),t}();t.default=y,y.serializeFrameValue=function(e,t){if(null===t)t=0;else if(void 0===t)u.default.warn("undefined property value: "+e),t=0;else if("frameImageVertices"===e){if(t){var n={};t.forEach(function(e,t){t&&(n[t.refId]=[e[0],e[1]])}),t=n}}else if("framePathVertices"===e){if(t){var r={};t.forEach(function(e,t){if(t){var n={pos:[e.pos[0],e.pos[1]]};e.in&&(n.in=[e.in[0],e.in[1]]),e.out&&(n.out=[e.out[0],e.out[1]]),void 0!==e.radius&&(n.radius=e.radius),r[t.refId]=n}}),t=r}}else if("frameActiveChild"===e)t=t?t.refId:0;else if(t.constructor===Object){var o={};for(var i in t)o[i]=t[i].v;t=o}else t.constructor===Float32Array&&(t=Array.prototype.slice.call(t));return t},y.deserializeInterpolator=function(e){var t=p.get(e.i||0)||c.default;if(t.instance)return t.instance;var n=new t;return n.deserialize(e),n},y.deserializeFrameValue=function(e,t,n){var r=n.v;if(null!=r){if("frameActiveChild"===t)r=e.getNodeWithRefId(r);else if("frameImageVertices"===t){var o=new Map;for(var i in r){var a=r[i],s=e.getNodeWithRefId(i);s&&o.set(s,new Float32Array(a))}r=o}else if("framePathVertices"===t){var l=new Map;for(var u in r){var c=r[u],d=e.getNodeWithRefId(u);if(d){var f={pos:new Float32Array(c.pos)};c.in&&(f.in=new Float32Array(c.in)),c.out&&(f.out=new Float32Array(c.out)),void 0!==c.radius&&(f.radius=c.radius),l.set(d,f)}}r=l}else if(r.constructor===Object){var h={};for(var p in r){var y=e.getNodeWithRefId(p);y&&(h[y.refId]={obj:y,v:r[p]})}r=h}else r.constructor===Array&&(r=new Float32Array(r));return r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(18)),i=s(n(1151)),a=s(n(379));s(n(380)),s(n(352));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s._Group=e,s._Animation=n,s._List=r,s._Time=o,s._Interpolator=a.default.instance,s._Value=i,s.refId=t.ID++,s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"remove",value:function(){this._List.remove(this),this._Animation.onKeyFrameDeleted(this)}},{key:"setFullFrameTime",value:function(e){var t=this._Animation,n=Math.round(e*t.fps)/t.fps;this._Time!=n&&(this.time=n)}},{key:"interpolate",value:function(e){var t=this.nxt,n=this._Interpolator.getEasedMix((e-this._Time)/(t._Time-this._Time)),r=1-n;return this._Value*r+t._Value*n}},{key:"startInterpolatorPropertyChange",value:function(){this._InterpolatorData||(this._InterpolatorData={},this._Interpolator.serialize(this._InterpolatorData))}},{key:"commitInterpolatorPropertyChange",value:function(){if(this._InterpolatorData){var e={};this._Interpolator.serialize(e),this._Animation.onKeyFramePropChanged(this,"InterProp",this._InterpolatorData,e,!0),this._InterpolatorData=null}}},{key:"group",get:function(){return this._Group}},{key:"_InterProp",get:function(){return this._InterpolatorData},set:function(e){this._Interpolator.deserialize(e)}},{key:"row",get:function(){return this._List}},{key:"time",get:function(){return this._Time},set:function(e){this._Time!=e&&(this._Animation.onKeyFramePropChanged(this,"Time",this._Time,e,!0),this._Time=e,this._Dirty=!0,this.prv&&(this.prv._Dirty=!0))}},{key:"value",get:function(){return(0,i.default)(this._Value)},set:function(e){null!==e&&(this._Value!=e||null!=e&&e.constructor===Object)&&(this._Animation.onKeyFramePropChanged(this,"Value",this._Value,e),this._Value=e,this._Dirty=!0,this.prv&&(this.prv._Dirty=!0))}},{key:"hasValueGraph",get:function(){var e=this._Value;if(void 0===e)return!1;switch(e.constructor){case Object:case Float32Array:case Map:return!1}return!0}},{key:"graphValueBounds",get:function(){var e=this._List.getGraphValue(this._Value);return[e,e]}},{key:"graphValue",get:function(){return this._List.getGraphValue(this._Value)},set:function(e){this.value=this._List.setGraphValue(e)}},{key:"interpolator",get:function(){return this._Interpolator},set:function(e){this._Interpolator!==e&&(this._Animation.onKeyFramePropChanged(this,"Interpolator",this._Interpolator,e),this._Interpolator=e,this.dispatch("propChange"))}}],[{key:"InterpolationType",get:function(){return u}}]),t}();t.default=l;var u={Hold:0,Linear:1,Bezier:2};l.ID=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(223),a=(r=i)&&r.__esModule?r:{default:r};var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Snap=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"onKeyDown",value:function(e){this.snap=e.shiftKey}},{key:"onKeyUp",value:function(e){this.snap=e.shiftKey}},{key:"snap",get:function(){return this._Snap},set:function(e){if(this._Snap!==e){this._Snap=e;var t=!0,n=!1,r=void 0;try{for(var o,i=this._ActiveTransformers[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.onSnapChange&&a.onSnapChange(e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=C(n(1)),a=C(n(2)),s=C(n(5)),l=C(n(164)),u=C(n(1154)),c=C(n(430)),d=C(n(238)),f=C(n(216)),h=C(n(364)),p=C(n(172)),y=C(n(528)),v=n(294),m=C(n(668)),g=n(7),b=n(409),k=C(n(259)),S=C(n(171)),O=C(n(220)),w=C(n(244)),_=C(n(353)),P=C(n(3));function C(e){return e&&e.__esModule?e:{default:e}}function E(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var T=(0,b.SortableElement)(function(e){var t=e.value,n=e.selectedAnimation,r=e.checkedAnimations,o=e.firstAnimation,a=e.toggleExportAnimation,s=e.selectAnimation,l=e.isSorting;return i.default.createElement(u.default,{data:t,isSelectable:!0,value:r.has(t),label:t.name,isSelected:t===n,onSelected:s,onValueChange:a,isCover:!l&&t===o})}),I=(0,b.SortableContainer)(function(e){var t=e.items,n=e.checkedAnimations,r=e.firstAnimation,o=e.selectedAnimation,a=e.selectAnimation,s=e.toggleExportAnimation,l=e.isSorting;return i.default.createElement("ul",null,t.map(function(e,t){return i.default.createElement(T,{key:t,index:t,value:e,checkedAnimations:n,firstAnimation:r,selectedAnimation:o,toggleExportAnimation:s,selectAnimation:a,isSorting:l})}))}),j=(E((r=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o=r._Preferences=n.nima.getPreference("modal")||{};return r.state={allowFork:o.allowfork||!1,animationPosition:0,animations:[],backgroundColor:o.bgclr?new Float32Array(o.bgclr):new Float32Array([.4,.4,.4,1]),canPublish:!1,coverPosition:o.cover||0,exportAnimations:new Set,isLoading:!0,isModalClosing:!1,isModalOpen:!1,isPaused:!0,isPublishing:!1,isSorting:!1,licenseOptions:[],selectedAnimation:null,selectedLicenseIndex:o.license||0,shareSource:o.sharesource||!1,showGuides:!1,showPanTip:!1,title:o.title||"",zoom:o.zoom||1},r._ActorData=null,r._RuntimeGraphics=null,r._RuntimeGraphicsExtension=null,r._RuntimeActor=null,r._ActorInstance=null,r._ActorAnimation=null,r._ViewTransform=g.mat2d.create(),r._RuntimeAnimationIndex=-1,r._RuntimeAnimation=null,r._AnimationTime=0,r._LastAdvanceTime=Date.now(),r._ViewOffsetX=0,r._ViewOffsetY=0,r._ViewScale=1,r._TargetViewOffsetX=0,r._TargetViewOffsetY=0,r._TargetViewScale=1,r._ScreenScale=1,r._LastMouseX=0,r._LastMouseY=0,r._ShowGuides=!1,r._OverrideAnimationPosition=null,r._ForceRender=!1,r._IsRendering=!1,r._RenderCapture=[],r._LastBackgroundColor=new Uint8Array([0,0,0]),r._PreferencesTimeout=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=w.default.all[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;"CC BY"!==a[0]?e.push({label:a[1].label,hoverTitle:a[1].title,hoverDesc:a[1].description,hoverIcon:a[1].iconsString,value:!0,active:!1}):e.push({label:a[1].label,hoverTitle:a[1].title,hoverDesc:a[1].description,hoverIcon:a[1].iconsString,value:!1,active:!0})}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.setState({licenseOptions:e})}},{key:"componentDidMount",value:function(){this.openModal(),this.context.nima.setCancelCallback(this.closeModal)}},{key:"componentDidUpdate",value:function(){this.updateCanPublish()}},{key:"updateCanPublish",value:function(){var e=this.props.verified&&this.state.exportAnimations.size>0&&null!==this._RuntimeActor&&this.state.title.length>2&&!this.body.wasEmpty;this.state.canPublish!==e&&this.setState({canPublish:e})}},{key:"onBodyPopulated",value:function(e){this.updateCanPublish();var t=this.body.serialize();this.savePreference("body",t)}},{key:"hideGuides",value:function(){this.showGuides(!1,!1)}},{key:"scheduleHideGuides",value:function(e){clearTimeout(this._GuidesTimeout),this._GuidesTimeout=setTimeout(this.hideGuides,e||1e3)}},{key:"showGuides",value:function(e,t){clearTimeout(this._GuidesTimeout),t&&this.scheduleHideGuides(),this._ShowGuides!==e&&(this.setState({showGuides:e}),this._ShowGuides=e)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("focus",this.startRenderLoop),window.removeEventListener("mousemove",this.pan,!0),window.removeEventListener("mouseup",this.stopPan,!0),window.removeEventListener("mousemove",this.dragCover,!0),window.removeEventListener("mouseup",this.stopDragCover,!0),window.removeEventListener("mousemove",this.dragPlayhead,!0),window.removeEventListener("mouseup",this.stopDragPlayhead,!0),this._ActorData=null,this.context.nima.clearCancelCallback(this.closeModal),this.disposeRuntime(),clearTimeout(this.loadTimeout)}},{key:"savePreference",value:function(e,t){var n=this.context.nima,r=this._Preferences;r[e]=t,clearTimeout(this._PreferencesTimeout),this._PreferencesTimeout=setTimeout(function(){n.setCharacterPreference("modal",r)},750)}},{key:"clearPreferences",value:function(){this.context.nima.setCharacterPreference("modal",{})}},{key:"disposeRuntime",value:function(){this._ActorInstance&&(this._ActorInstance.dispose(this._RuntimeGraphics),this._ActorInstance=null),this._RuntimeActor&&(this._RuntimeActor.dispose(this._RuntimeGraphics),this._RuntimeActor=null),this._RuntimeGraphics&&(this._RuntimeGraphics.dispose(),this._RuntimeGraphics=null),this.RuntimeGraphicsExtension&&(this._RuntimeGraphicsExtension.dispose(),this._RuntimeGraphicsExtension=null)}},{key:"initRuntime",value:function(){if(this.disposeRuntime(),this.canvas&&this._ActorData){this._RuntimeGraphics=new v.Graphics(this.canvas);var e=new v.ActorLoader,t=this;e.load(this._ActorData,function(e){if(t._RuntimeGraphics)if(e){t._RuntimeActor=e,t._RuntimeActor.initialize(t._RuntimeGraphics),t._ActorInstance=t._RuntimeActor.makeInstance(),t._ActorInstance.initialize(t._RuntimeGraphics),t._ActorInstance.advance(1);var n=t._ActorInstance.computeAABB();console.log("INSTANCE",t._ActorInstance,n);var r=n[2]-n[0]||540,o=n[3]-n[1]||303,i=n[0]+.5*r,a=n[1]+.5*o;t._RuntimeGraphics.setSize(540,303);var s=Math.min(540/r,303/o),l=t._Preferences;t._TargetViewScale=l.zoom||s,t._TargetViewOffsetX=l.offsetx||-i*s+270,t._TargetViewOffsetY=l.offsety||-a*s+151.5,t._ViewOffsetX=t._TargetViewOffsetX,t._ViewOffsetY=t._TargetViewOffsetY,t._ViewScale=2*s,t.setState({isLoading:!1,isPaused:!1,showPanTip:!0,zoom:t._TargetViewScale}),t.startRenderLoop()}else console.log("FAILED TO LOAD RUNTIME ACTOR")})}}},{key:"startRenderLoop",value:function(){this._IsRendering||(this._LastAdvanceTime=Date.now(),window.removeEventListener("focus",this.startRenderLoop),window.addEventListener("focus",this.startRenderLoop),window.requestAnimationFrame(this.advance),this._IsRendering=!0)}},{key:"togglePause",value:function(){this.state.isPaused?(this.setState({isPaused:!1}),this.startRenderLoop()):this.setState({isPaused:!0})}},{key:"advance",value:function(){var e=this._RuntimeGraphics;if(document.hasFocus()&&e&&this._ActorInstance){var t=Date.now(),n=(t-this._LastAdvanceTime)/1e3;this._LastAdvanceTime=t;var r=this._TargetViewScale-this._ViewScale,o=this._TargetViewOffsetX-this._ViewOffsetX,i=this._TargetViewOffsetY-this._ViewOffsetY,a=Math.min(1,15*n),s=!1;Math.abs(r)>1e-5&&(s=!0,r*=a),Math.abs(o)>.01&&(s=!0,o*=a),Math.abs(i)>.01&&(s=!0,i*=a);var l=this.context.nima.actor.animations,u=l.indexOf(this.state.selectedAnimation),c=this.state.backgroundColor,d=this.state.isPaused;if(!g.vec3.exactEquals(this._LastBackgroundColor,c)||0!==this._RenderCapture.length||!d||s||this._ForceRender||u!==this._RuntimeAnimationIndex){g.vec3.copy(this._LastBackgroundColor,c);var f=void 0,h=this._RenderCapture.length&&this._RenderCapture.splice(0,1)[0],p=this._OverrideAnimationPosition;if(h?(this._RuntimeGraphics.setSize(h.width,h.height),f=h.viewTransform,u=l.indexOf(h.animation),this._OverrideAnimationPosition=h.animationPosition):(this._ViewOffsetX+=o,this._ViewOffsetY+=i,this._ViewScale+=r,(f=this._ViewTransform)[0]=this._ViewScale,f[3]=this._ViewScale,f[4]=this._ViewOffsetX,f[5]=this._ViewOffsetY),u!==this._RuntimeAnimationIndex&&(this._ActorInstance&&this._ActorInstance.dispose(e),this._ActorInstance=this._RuntimeActor.makeInstance(),this._ActorInstance.initialize(e),u<this._ActorInstance._Animations.length&&(this._RuntimeAnimationIndex=u,this._RuntimeAnimation=this._ActorInstance._Animations[u],this._AnimationTime=0)),this._ShowGuides&&(n*=.15),this._RuntimeAnimation){var y=void 0;null!==this._OverrideAnimationPosition?y=this._OverrideAnimationPosition*this._RuntimeAnimation._Duration:(d?y=this._AnimationTime:(this._AnimationTime+=n,y=this._AnimationTime=this._AnimationTime%this._RuntimeAnimation._Duration),this.setState({animationPosition:y/this._RuntimeAnimation._Duration})),this._RuntimeAnimation.apply(y,this._ActorInstance,1)}this._ActorInstance&&this._ActorInstance.advance(n),e.clear(c),e.setView(f),this._ActorInstance&&this._ActorInstance.draw(e),e.flush(),h?(this._OverrideAnimationPosition=p,h.complete(h,this._RuntimeGraphics.canvas),this._RuntimeGraphics.setSize(540,303),this.advance()):window.requestAnimationFrame(this.advance)}else this._IsRendering=!1}else this._IsRendering=!1}},{key:"loadActor",value:function(){var e=this.context.nima.actor;if(e.isLoadingBitmaps)e.isMissingBitmaps?this.context.nima.alert({title:"Missing Images",message:"You cannot export a shot with missing images."}):this.loadTimeout=setTimeout(this.loadActor,1e3);else{var t=e.animations,n=new m.default({animations:t,atlasPadding:2,atlasPowerOfTwo:!0,atlasSquare:!1,cropAnimationsToWorkArea:!0,cropImages:!0,isZipExport:!1,maxAtlasHeight:2048,maxAtlasWidth:2048,maxImageHeight:1024,maxImageWidth:1024}),r=this;n.export(e,function(e){r._ActorData=e,r.initRuntime()})}}},{key:"openModal",value:function(){var e=this._Preferences,t=this.context.nima.actor,n=t.animations.slice(0),r=t.animations.reduce(function(e,t){return e.set(t.refId,t),e},new Map),o=new Set;if(e.animations){var i=!0,a=!1,s=void 0;try{for(var l,u=e.animations[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value,d=r.get(c.id);d&&(c.isUnchecked||o.add(d))}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}else{var f=[],h=!0,p=!1,y=void 0;try{for(var v,m=n[Symbol.iterator]();!(h=(v=m.next()).done);h=!0){var g=v.value;f.push({id:g.refId}),o.add(g)}}catch(e){p=!0,y=e}finally{try{!h&&m.return&&m.return()}finally{if(p)throw y}}this.savePreference("animations",f)}this.setState({animations:n,exportAnimations:o,isLoading:!0,isModalOpen:!0,isModalClosing:!1,selectedAnimation:r[e.selectedAnimation]||n[0]});var b=this;setTimeout(function(){b.loadActor()},500)}},{key:"closeModal",value:function(){this.setState({isModalOpen:!1,isModalClosing:!0}),this.props.onExportComplete()}},{key:"selectAnimation",value:function(e){this.startRenderLoop(),this.setState({selectedAnimation:e}),this.savePreference("selectedAnimation",e.refId)}},{key:"toggleExportAnimation",value:function(e,t){var n=new Set(this.state.exportAnimations);e?n.add(t):n.delete(t);var r=this.state.animations.map(function(e){return{id:e.refId,isUnchecked:!n.has(e)}});this.savePreference("animations",r),this.setState({exportAnimations:n})}},{key:"toggleShareSource",value:function(e){var t={shareSource:e};e||(t.allowFork=!1),this.savePreference("sharesource",e),this.setState(t)}},{key:"toggleAllowFork",value:function(e){var t={allowFork:e};e&&(t.shareSource=!0,this.savePreference("sharesource",!0)),this.savePreference("allowfork",e),this.setState(t)}},{key:"changeBgColor",value:function(e){this.startRenderLoop(),this.setState({backgroundColor:e.value}),this.savePreference("bgclr",Array.prototype.slice.call(e.value))}},{key:"setCanvas",value:function(e){this.canvas=e,e&&(e.width=540,e.height=303,this.initRuntime())}},{key:"mouseWheel",value:function(e){if(this.canvas){var t=-e.deltaY/1e3*2;e.ctrlKey&&(t/=15);var n=this.canvas.getBoundingClientRect();return this.zoomTo((e.clientX-n.left)*this._ScreenScale,(e.clientY-n.top)*this._ScreenScale,this._TargetViewScale+t),this.showGuides(!0,!0),this.startRenderLoop(),!0}}},{key:"zoomTo",value:function(e,t,n){n=Math.min(8,Math.max(.1,n));var r=this._TargetViewScale;this._TargetViewScale=n;var o=this._TargetViewScale/r,i=e-this._TargetViewOffsetX,a=t-this._TargetViewOffsetY,s=i*o,l=a*o;this._TargetViewOffsetX+=i-s,this._TargetViewOffsetY+=a-l,this.savePreference("zoom",this._TargetViewScale),this.setState({zoom:this._TargetViewScale})}},{key:"startPan",value:function(e){this.state.isLoading||(e.preventDefault(),e.stopPropagation(),this.setState({showPanTip:!1}),window.addEventListener("mousemove",this.pan,!0),window.addEventListener("mouseup",this.stopPan,!0),this.showGuides(!0),this._LastMouseX=e.clientX,this._LastMouseY=e.clientY,this._ForceRender=!0,this.startRenderLoop())}},{key:"pan",value:function(e){e.preventDefault(),e.stopPropagation();var t=e.clientX-this._LastMouseX,n=e.clientY-this._LastMouseY;this._LastMouseX=e.clientX,this._LastMouseY=e.clientY,this._TargetViewOffsetX+=t*this._ScreenScale,this._TargetViewOffsetY+=n*this._ScreenScale,this.savePreference("offsetx",this._TargetViewOffsetX),this.savePreference("offsety",this._TargetViewOffsetY)}},{key:"stopPan",value:function(e){this.setState({showPanTip:!1}),this.scheduleHideGuides(500),this._ForceRender=!1,window.removeEventListener("mousemove",this.pan,!0),window.removeEventListener("mouseup",this.stopPan,!0)}},{key:"onSortStart",value:function(){this.setState({isSorting:!0})}},{key:"onSortEnd",value:function(e){var t=e.oldIndex,n=e.newIndex,r=(0,b.arrayMove)(this.state.animations,t,n);this.setState({animations:r,isSorting:!1});var o,i=this._Preferences.animations;o=(0,b.arrayMove)(i,t,n),this.savePreference("animations",o)}},{key:"zoomFit",value:function(){if(this._ActorInstance){var e=this._ActorInstance.computeAABB(),t=e[2]-e[0],n=e[3]-e[1],r=e[0]+.5*t,o=e[1]+.5*n,i=Math.min(540/t,303/n);this._TargetViewScale=i,this._TargetViewOffsetX=-r*i+270,this._TargetViewOffsetY=-o*i+151.5,this.setState({zoom:this._TargetViewScale}),this.startRenderLoop()}}},{key:"setZoom",value:function(e){this.zoomTo(270,151.5,e)}},{key:"startDragCover",value:function(e){e.preventDefault(),e.stopPropagation(),this._ForceRender=!0,this.startRenderLoop(),this._OverrideAnimationPosition=this.state.coverPosition,window.addEventListener("mousemove",this.dragCover,!0),window.addEventListener("mouseup",this.stopDragCover,!0)}},{key:"dragCover",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.track.getBoundingClientRect();this._OverrideAnimationPosition=Math.min(1,Math.max(0,(e.clientX-t.left)/t.width)),this.setState({coverPosition:this._OverrideAnimationPosition}),this.savePreference("cover",this._OverrideAnimationPosition)}},{key:"stopDragCover",value:function(e){this._RuntimeAnimation&&(this._AnimationTime=this._OverrideAnimationPosition*this._RuntimeAnimation._Duration),this._ForceRender=!1,this._OverrideAnimationPosition=null,window.removeEventListener("mousemove",this.dragCover,!0),window.removeEventListener("mouseup",this.stopDragCover,!0)}},{key:"startDragPlayhead",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.track.getBoundingClientRect(),n=Math.min(1,Math.max(0,(e.clientX-t.left)/t.width));this._RuntimeAnimation&&(this._AnimationTime=n*this._RuntimeAnimation._Duration),this._ForceRender=!0,this.startRenderLoop(),window.addEventListener("mousemove",this.dragPlayhead,!0),window.addEventListener("mouseup",this.stopDragPlayhead,!0)}},{key:"dragPlayhead",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.track.getBoundingClientRect(),n=Math.min(1,Math.max(0,(e.clientX-t.left)/t.width));this._RuntimeAnimation&&(this._AnimationTime=n*this._RuntimeAnimation._Duration)}},{key:"stopDragPlayhead",value:function(e){this._OverrideAnimationPosition=null,this._ForceRender=!1,window.removeEventListener("mousemove",this.dragPlayhead,!0),window.removeEventListener("mouseup",this.stopDragPlayhead,!0)}},{key:"setTrack",value:function(e){this.track=e}},{key:"inputTitle",value:function(e){var t=e.target.value;this.setState({title:t});this.savePreference("title",t)}},{key:"captureFrame",value:function(e,t,n,r,o,i){this._RenderCapture.push({width:e,height:t,viewTransform:n,animation:r,animationPosition:o,complete:i})}},{key:"getCover",value:function(e){var t=this.state,n=t.animations,r=t.exportAnimations,o=t.coverPosition,i=n.find(function(e){return r.has(e)}),a=g.mat2d.create();a[0]=2*this._TargetViewScale,a[3]=2*this._TargetViewScale,a[4]=2*this._TargetViewOffsetX,a[5]=2*this._TargetViewOffsetY,this.captureFrame(1080,606,a,i,o,function(t,n){n.toBlob(function(t){var n,r=new FileReader;r.onload=function(){n=this.result,e&&e(new Uint8Array(n))},r.readAsArrayBuffer(t)})})}},{key:"saveShotRevision",value:function(e){var t=this.context.nima;t.revisionManager.systemSave("Published Shot",function(){},function(t){e(t)},[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this.state.exportAnimations)))||t.alert({type:S.default.Types.Default,title:"Error",message:"An error occurred while attempting to save your data for publication.",buttons:[]})}},{key:"publish",value:function(){var e=this,t=this.context.nima,n=[],r=this.state.exportAnimations,o=!0,i=!1,a=void 0;try{for(var s,l=this.state.animations[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value;r.has(u)&&n.push(u)}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}var c=t.actor;this.setState({isPublishing:!0}),this.saveShotRevision(function(r){e.getCover(function(o){var i=e._TargetViewScale,a=e._ViewTransform;new m.default({animations:n,atlasPadding:2,atlasPowerOfTwo:!0,atlasSquare:!1,cropImages:!0,cropAnimationsToWorkArea:!0,isZipExport:!1,maxAtlasHeight:2048,maxAtlasWidth:2048,maxImageHeight:1024,maxImageWidth:1024,view:{center:[(a[4]-270)/-i,(a[5]-151.5)/-i],size:[540/i,303/i]},wantWriter:!0}).export(c,function(n){var i=n.toArrayBuffer(),a={title:e.state.title,body:e.body.serialize(),shareSource:e.state.shareSource,allowFork:e.state.allowFork,revisionKey:r,public:{background:Array.prototype.slice.call(e.state.backgroundColor).map(function(e){return Math.round(255*e)}),license:e.state.licenseOptions[e.state.selectedLicenseIndex].label}},s=JSON.stringify(a),l=new k.default;l.writeString(s),l.writeUint32(i.length),l.write(i),l.writeUint32(o.length),l.write(o);var u=l.toBlob("application/octet-binary"),c=new XMLHttpRequest;c.open("POST","/api/editor/shot",!0),c.onload=function(){200==this.status?(e.closeModal(),e.clearPreferences(),setTimeout(function(){t.alert({type:S.default.Types.Avatar,avatar:t.user.avatar,title:"Posted",message:"Your shot has been posted!",buttons:null})},800)):(t.alert({title:"Error",message:"An error occurred while submitting your shot, please try again."}),e.setState({isPublishing:!1}))},c.onerror=function(){t.alert({title:"Error",message:"A network error occurred while submitting your shot, please try again."}),e.setState({isPublishing:!1})},c.send(u)})})})}},{key:"setBody",value:function(e){this.body=e;var t=this._Preferences;e&&t.body&&this.body.deserialize(t.body)}},{key:"selectLicense",value:function(e){this.setState({selectedLicenseIndex:e}),this.savePreference("license",e)}},{key:"render",value:function(){var e=this.state,t=e.selectedAnimation,n=e.animations,r=e.backgroundColor,o=e.shareSource,a=e.allowFork,s=e.zoom,u=e.exportAnimations,v=e.isSorting,m=e.coverPosition,g=e.animationPosition,b=e.isLoading,k=n.find(function(e){return u.has(e)});return r={type:_.default.Mode.Solid,value:r},i.default.createElement(l.default,{addClass:"ExportShotModal",isOpen:this.state.isModalOpen,isClosing:this.state.isModalClosing,onClose:this.closeModal},i.default.createElement("div",{className:"ExportShotOptionsCol"},i.default.createElement("div",{className:"ModalHeader"},i.default.createElement("svg",{className:"ModalIcon ExportShotModalIcon"},i.default.createElement("use",{xlinkHref:P.default.make("/images/symbol-defs.svg#icon-shots")})),i.default.createElement("div",{className:"ModalHeadline"},"Share a Shot"),i.default.createElement("div",{className:"ModalSubHeadline"},"Publish your file to showcase a rich preview of your work.")),i.default.createElement("div",{className:"ModalContent"},i.default.createElement("div",{className:"ModalGroupProperty"},i.default.createElement("div",{className:"ModalGroupPropertyTitle"},"Share Source"),i.default.createElement(d.default,{addClass:"ContrastToggle",isOn:o,onToggle:this.toggleShareSource})),i.default.createElement("div",{className:"ModalGroupProperty"},i.default.createElement("div",{className:"ModalGroupPropertyTitle"},"Allow Fork"),i.default.createElement(d.default,{addClass:"ContrastToggle",isOn:a,onToggle:this.toggleAllowFork})),i.default.createElement("div",{className:"ModalGroupProperty ModalGroupLicense",style:{height:this.state.allowFork?"39px":"0"}},i.default.createElement("div",{className:"ModalGroupPropertyTitle",style:{width:"100px",flex:"initial"}},"Artwork License"),i.default.createElement(O.default,{addClass:"DropdownAutoWidth",options:this.state.licenseOptions,selectedIndex:this.state.selectedLicenseIndex,onSelectionChanged:this.selectLicense,disabled:null})),i.default.createElement("div",{className:"ModalGroupProperty"},i.default.createElement("div",{className:"ModalGroupPropertyTitle"},"Background Color"),i.default.createElement(c.default,{value:r,isAnimating:!1,allowChangeType:!1,onValueChanged:this.changeBgColor,onValueCommit:null,disabled:!1,addClass:"ContrastInput"})),i.default.createElement("div",{className:"ModalGroupProperty"},i.default.createElement("div",{className:"ModalGroupPropertyTitle"},"Zoom"),i.default.createElement(f.default,{value:s,converter:y.default,onValueChanged:this.setZoom,addClass:"ContrastInput"})))),i.default.createElement("div",{className:"ExportShotPreviewCol"},i.default.createElement("div",{className:"ExportShotContainer",onMouseDown:this.startPan,onWheel:this.mouseWheel},i.default.createElement("canvas",{ref:this.setCanvas}),i.default.createElement("div",{className:"ExportShotCanvasOverlay"},i.default.createElement("div",{className:"ExportShotGuides",style:{opacity:this.state.showGuides?1:0}},i.default.createElement("div",{className:"ExportShotThirdLeftGuide"}),i.default.createElement("div",{className:"ExportShotThirdRightGuide"}),i.default.createElement("div",{className:"ExportShotThirdTopGuide"}),i.default.createElement("div",{className:"ExportShotThirdBottomGuide"})),this.state.showPanTip||b?i.default.createElement("div",{className:"ExportShotCanvasTip"},b?"Loading...":"Pan/Zoom to Setup Your Shot"):null)),i.default.createElement("div",{className:"ExportShotPlaybackControls"},i.default.createElement("svg",{onClick:this.togglePause,className:"PlayButton"},i.default.createElement("use",{xlinkHref:P.default.make("/images/symbol-defs.svg#icon-"+(this.state.isPaused?"play":"pause"))})),i.default.createElement("div",{className:"ExportShotPlaybackTransport"},i.default.createElement("div",{className:"ExportShotPlaybackTrack",ref:this.setTrack}),i.default.createElement("div",{className:"ExportShotPlaybackScrubber",style:{left:100*g+"%"},onMouseDown:this.startDragPlayhead}),t!==k||b?null:i.default.createElement("div",{className:"ExportShotCoverScrubber",onMouseDown:this.startDragCover,style:{left:100*m+"%"}},i.default.createElement("div",{className:"ShotCoverBadge"},"COVER")))),i.default.createElement("div",{className:"ExportShotUserProfile"},i.default.createElement("div",{className:this.props.avatar?"CommentAvatar":"CommentAvatarEmpty",style:{background:this.props.avatar?"url('"+this.props.avatar+"')":null,backgroundSize:this.props.avatar?"cover":null}},this.props.avatar?null:i.default.createElement("svg",null,i.default.createElement("use",{xlinkHref:P.default.make("/images/symbol-defs.svg#icon-avatar")}))),this.props.name||this.props.username),i.default.createElement("input",{type:"text",className:"ExportShotTitle",placeholder:"Title",value:this.state.title,onChange:this.inputTitle}),i.default.createElement(h.default,{onInputChanged:this.onBodyPopulated,ref:this.setBody,onSubmit:null,defaultText:"Say something...",isEditable:!0}),i.default.createElement(p.default,{disabled:!this.state.canPublish||this.state.isPublishing,label:this.props.verified?"PUBLISH SHOT":"VERIFY YOUR EMAIL",onPress:this.publish,accentBtn:!0})),i.default.createElement("div",{className:"ExportShotAnimationsCol"},i.default.createElement("div",{className:"ModalGroupTitle"},"Animations"),i.default.createElement("div",{className:"ModalGroupSubTitle"},"Drag and drop to sort. The top-most animation will be used as a cover image for your shot."),i.default.createElement("div",{className:"ExportShotAnimationsList"},i.default.createElement(I,{lockAxis:"y",helperClass:"ExportShotAnimationGhost",distance:10,items:n,selectedAnimation:t,checkedAnimations:u,firstAnimation:k,toggleExportAnimation:this.toggleExportAnimation,selectAnimation:this.selectAnimation,onSortStart:this.onSortStart,onSortEnd:this.onSortEnd,isSorting:v}))))}}]),t}()).prototype,"onBodyPopulated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onBodyPopulated"),r.prototype),E(r.prototype,"hideGuides",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"hideGuides"),r.prototype),E(r.prototype,"startRenderLoop",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"startRenderLoop"),r.prototype),E(r.prototype,"togglePause",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"togglePause"),r.prototype),E(r.prototype,"advance",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"advance"),r.prototype),E(r.prototype,"loadActor",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"loadActor"),r.prototype),E(r.prototype,"openModal",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"openModal"),r.prototype),E(r.prototype,"closeModal",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"closeModal"),r.prototype),E(r.prototype,"selectAnimation",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectAnimation"),r.prototype),E(r.prototype,"toggleExportAnimation",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleExportAnimation"),r.prototype),E(r.prototype,"toggleShareSource",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleShareSource"),r.prototype),E(r.prototype,"toggleAllowFork",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleAllowFork"),r.prototype),E(r.prototype,"changeBgColor",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeBgColor"),r.prototype),E(r.prototype,"setCanvas",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setCanvas"),r.prototype),E(r.prototype,"mouseWheel",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseWheel"),r.prototype),E(r.prototype,"startPan",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"startPan"),r.prototype),E(r.prototype,"pan",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"pan"),r.prototype),E(r.prototype,"stopPan",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"stopPan"),r.prototype),E(r.prototype,"onSortStart",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onSortStart"),r.prototype),E(r.prototype,"onSortEnd",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onSortEnd"),r.prototype),E(r.prototype,"setZoom",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setZoom"),r.prototype),E(r.prototype,"startDragCover",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"startDragCover"),r.prototype),E(r.prototype,"dragCover",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"dragCover"),r.prototype),E(r.prototype,"stopDragCover",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"stopDragCover"),r.prototype),E(r.prototype,"startDragPlayhead",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"startDragPlayhead"),r.prototype),E(r.prototype,"dragPlayhead",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"dragPlayhead"),r.prototype),E(r.prototype,"stopDragPlayhead",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"stopDragPlayhead"),r.prototype),E(r.prototype,"setTrack",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTrack"),r.prototype),E(r.prototype,"inputTitle",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputTitle"),r.prototype),E(r.prototype,"publish",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"publish"),r.prototype),E(r.prototype,"setBody",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setBody"),r.prototype),E(r.prototype,"selectLicense",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectLicense"),r.prototype),r);t.default=j,j.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return"#"+this.toInputValue(e)}},{key:"toInputValue",value:function(e){return((1<<24)+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1)}},{key:"fromDisplayValue",value:function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,r){return t+t+n+n+r+r});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!t)throw"Invalid input";return new Float32Array([parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255])}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"defaultValue",get:function(){return new Float32Array([1,1,1,1])}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.WRITER_FORMATS=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=G(n(198)),a=G(n(224)),s=G(n(429)),l=G(n(337)),u=G(n(203)),c=G(n(303)),d=G(n(173)),f=G(n(237)),h=G(n(225)),p=G(n(515)),y=G(n(275)),v=G(n(383)),m=G(n(335)),g=G(n(336)),b=G(n(432)),k=G(n(219)),S=G(n(197)),O=n(288),w=G(n(289)),_=G(n(375)),P=G(n(218)),C=G(n(662)),E=G(n(332)),T=G(n(433)),I=G(n(529)),j=G(n(530)),A=G(n(531)),D=G(n(532)),R=G(n(533)),M=n(7),x=G(n(310)),F=G(n(367)),L=G(n(254)),N=G(n(352)),z=G(n(271)),V=G(n(16)),B=G(n(365)),H=G(n(259)),W=G(n(366)),K=G(n(285));function G(e){return e&&e.__esModule?e:{default:e}}function U(e,t){return{id:e,key:t}}var X={Nodes:U(1,"nodes"),ActorNode:U(2,"node"),ActorBone:U(3,"bone"),ActorRootBone:U(4,"rootBone"),ActorImage:U(5,"image"),View:U(6,"view"),Animation:U(7,"animation"),Animations:U(8,"animations"),Atlases:U(9,"atlases"),Atlas:U(10,"atlas"),ActorEvent:U(12,"event"),CustomIntProperty:U(13,"customInt"),CustomFloatProperty:U(14,"customFloat"),CustomStringProperty:U(15,"customString"),CustomBooleanProperty:U(16,"customBool"),ActorImageSequence:U(22,"imageSequence"),ActorNodeSolo:U(23,"solo"),JellyComponent:U(28,"jelly"),ActorJellyBone:U(29,"jellyBone"),ActorIKConstraint:U(30,"ikConstraint"),ActorDistanceConstraint:U(31,"distanceConstraint"),ActorTranslationConstraint:U(32,"translationConstraint"),ActorRotationConstraint:U(33,"rotationConstraint"),ActorScaleConstraint:U(34,"scaleConstraint"),ActorTransformConstraint:U(35,"transformConstraint"),ActorShape:U(100,"shape"),ActorPath:U(101,"path"),ColorFill:U(102,"colorFill"),ColorStroke:U(103,"colorStroke"),GradientFill:U(104,"gradientFill"),GradientStroke:U(105,"gradientStroke"),RadialGradientFill:U(106,"radialGradientFill"),RadialGradientStroke:U(107,"radialGradientStroke"),ActorEllipse:U(108,"ellipse"),ActorRectangle:U(109,"rectangle"),ActorTriangle:U(110,"triangle"),ActorStar:U(111,"star"),ActorPolygon:U(112,"polygon"),ActorSkin:U(113,"skin"),ActorArtboard:U(114,"artboard"),Artboards:U(115,"artboards")},Y=t.WRITER_FORMATS={JSON:"JSON",BINARY:"Binary"},J={JSON:{writer:K.default,block:W.default},Binary:{writer:H.default,block:B.default}};function q(e,t,n,r){t.writeString(n.name,"name");var o=0;n.parent&&(o=r.get(n.parent)),t.writeId(o,"parent")}function Q(e,t,n,r){q(0,t,n,r),t.writeFloat32Array(n.rigTranslation,"translation"),t.writeFloat32(n.rigRotation,"rotation"),t.writeFloat32Array(n.rigScale,"scale"),t.writeFloat32(n.rigOpacity,"opacity"),t.writeBool(n.isCollapsedVisibility,"isCollapsed");var o=n.clips&&n.clips.length||0;t.openArray("clips"),t.writeUint8length(o);for(var i=0;i<o;i++){var a=n.clips[i];t.writeId(r.get(a),"clip")}t.closeArray()}function Z(e,t,n,r){var o=new e.block(X.ActorNodeSolo);Q(0,o,n,r),o.writeUint32(n.rigActiveChildIndex,"activeChild"),t.writeBlock(o)}function $(e,t,n,r){var o=new e.block(X.ActorJellyBone);q(0,o,n,r),o.writeFloat32(n.rigOpacity,"opacity"),o.writeBool(n.isCollapsedVisibility,"isCollapsed"),t.writeBlock(o)}function ee(e,t,n,r){!function(e,t,n,r){q(0,t,n,r),t.writeFloat32(n.rigStrength,"strength"),t.writeUint8(n.isEnabled,"isEnabled")}(0,t,n,r);var o=n.target,i=o?r.get(o):void 0;t.writeId(i,"target")}function te(e,t,n,r){var o=new e.block(X.ActorIKConstraint);ee(0,o,n,r),o.writeBool(n.invertDirection,"isInverted");var i=n.influencedBones;o.openArray("bones"),o.writeUint8length(i.length);for(var a=0;a<i.length;a++){var s=i[a];o.writeId(r.get(s))}o.closeArray(),t.writeBlock(o)}function ne(e,t,n,r){var o=new e.block(X.ActorDistanceConstraint);ee(0,o,n,r),o.writeFloat32(n.distance,"distance"),o.writeUint8(n.mode.id,"modeId"),t.writeBlock(o)}function re(e,t,n,r){ee(0,t,n,r),n.copyX?(t.writeBool(!0,"copyX"),t.writeFloat32(n.scaleX,"scaleX")):t.writeBool(!1,"copyX"),n.enableMinX?(t.writeBool(!0,"enableMinX"),t.writeFloat32(n.minX,"minX")):t.writeBool(!1,"enableMinX"),n.enableMaxX?(t.writeBool(!0,"enableMaxX"),t.writeFloat32(n.maxX,"maxX")):t.writeBool(!1,"enableMaxX"),n.copyY?(t.writeBool(!0,"copyY"),t.writeFloat32(n.scaleY,"scaleY")):t.writeBool(!1,"copyY"),n.enableMinY?(t.writeBool(!0,"enableMinY"),t.writeFloat32(n.minY,"minY")):t.writeBool(!1,"enableMinY"),n.enableMaxY?(t.writeBool(!0,"enableMaxY"),t.writeFloat32(n.maxY,"maxY")):t.writeBool(!1,"enableMaxY"),t.writeBool(n.offset,"offset"),t.writeUint8(n.sourceSpace.id,"sourceSpaceId"),t.writeUint8(n.destSpace.id,"destSpaceId"),t.writeUint8(n.minMaxSpace.id,"minMaxSpaceId")}function oe(e,t,n,r){var o=new e.block(X.ActorTranslationConstraint);re(0,o,n,r),t.writeBlock(o)}function ie(e,t,n,r){var o=new e.block(X.ActorScaleConstraint);re(0,o,n,r),t.writeBlock(o)}function ae(e,t,n,r){var o=new e.block(X.ActorRotationConstraint);ee(0,o,n,r),n.copy?(o.writeBool(!0,"copy"),o.writeFloat32(n.scale,"scale")):o.writeBool(!1,"copy"),n.enableMin?(o.writeBool(!0,"enableMin"),o.writeFloat32(n.min,"min")):o.writeBool(!1,"enableMin"),n.enableMax?(o.writeBool(!0,"enableMax"),o.writeFloat32(n.max,"max")):o.writeUint8(!1,"enableMax"),o.writeBool(n.offset,"offset"),o.writeUint8(n.sourceSpace.id,"sourceSpaceId"),o.writeUint8(n.destSpace.id,"destSpaceId"),o.writeUint8(n.minMaxSpace.id,"minMaxSpaceId"),t.writeBlock(o)}function se(e,t,n,r){var o=new e.block(X.ActorTransformConstraint);ee(0,o,n,r),o.writeUint8(n.sourceSpace.id,"sourceSpaceId"),o.writeUint8(n.destSpace.id,"destSpaceId"),t.writeBlock(o)}function le(e,t,n,r){var o=new e.block(X.JellyComponent);q(0,o,n,r),o.writeFloat32(n.easeIn,"easeIn"),o.writeFloat32(n.easeOut,"easeOut"),o.writeFloat32(n.scaleIn,"scaleIn"),o.writeFloat32(n.scaleOut,"scaleOut");var i=n.inTarget,a=n.outTarget;o.writeId(r.get(i),"inTarget"),o.writeId(r.get(a),"outTarget"),t.writeBlock(o)}function ue(e,t,n,r){var o=new e.block(X.ActorBone);Q(0,o,n,r),o.writeFloat32(n.rigLength,"length"),t.writeBlock(o)}function ce(e,t,n,r){var o=new e.block(X.ActorRootBone);Q(0,o,n,r),t.writeBlock(o)}function de(e,t,n,r){var o=new e.block(X.ActorNode);Q(0,o,n,r),t.writeBlock(o)}function fe(e,t,n,r){var o=new e.block(X.ActorShape);be(e,o,n,n.isVisible,r),t.writeBlock(o)}function he(e,t,n,r){Q(0,t,n,r),t.writeFloat32(n.width,"width"),t.writeFloat32(n.height,"height")}function pe(e,t,n,r){var o=new e.block(X.ActorRectangle);he(0,o,n,r),o.writeFloat32(n.cornerRadius,"cornerRadius"),t.writeBlock(o)}function ye(e,t,n,r){var o=new e.block(X.ActorStar);he(0,o,n,r),o.writeUint32(n._Points,"points"),o.writeFloat32(n._InnerRadius,"innerRadius"),t.writeBlock(o)}function ve(e,t,n,r){var o=new e.block(X.ActorTriangle);he(0,o,n,r),t.writeBlock(o)}function me(e,t,n,r){var o=new e.block(X.ActorPolygon);he(0,o,n,r),o.writeUint32(n._Sides,"sides"),t.writeBlock(o)}function ge(e,t,n,r){var o=new e.block(X.ActorEllipse);he(0,o,n,r),t.writeBlock(o)}function be(e,t,n,r,o){Q(0,t,n,o),t.writeBool(r,"isVisible"),t.writeUint8(n.blendMode.id,"blendMode"),t.writeUint16(n.drawOrder,"drawOrder")}function ke(e,t,n,r){var o=n.connectedBones;if(o&&o.length){t.openArray("bones"),t.writeUint8length(o.length);for(var i=0;i<o.length;i++){var a=o[i];t.openObject("bone"),t.writeId(r.get(a.node),"component"),t.writeFloat32Array(a.bind,"bind"),t.closeObject()}t.closeArray(),t.writeFloat32Array(n.worldTransform||M.mat2d.create(),"worldTransform")}else t.openArray("bones"),t.writeUint8length(0),t.closeArray()}function Se(e,t,n,r){var o=new e.block(X.ActorSkin);q(0,o,n,r),t.writeBlock(o)}function Oe(e,t,n,r){var o=new e.block(X.ActorPath);Q(0,o,n,r),ke(0,o,n,r),o.writeBool(n.isVisible,"isVisible"),o.writeBool(n.isClosed,"isClosed");var i=n.children.reduce(function(e,t){return e+(t.constructor===y.default?1:0)},0);o.openArray("points"),o.writeUint16length(i);var a=n.connectedBones&&n.connectedBones.length>0,s=!0,l=!1,u=void 0;try{for(var c,d=n.children[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;if(f.constructor===y.default){switch(f.validateWeightBuffer(!1),o.openObject("point"),o.writeUint8(f.pointType.numericId,"pointType"),o.writeFloat32Array(f.rigTranslation,"translation"),f.pointType){case P.default.Straight:o.writeFloat32(f.rigRadius,"radius");break;default:o.writeFloat32Array(f.rigIn,"in"),o.writeFloat32Array(f.rigOut,"out")}a&&o.writeFloat32Array(f.weights,"weights"),o.closeObject()}}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}o.closeArray(),t.writeBlock(o)}function we(e,t,n,r){q(0,t,n,r),t.writeFloat32(n.rigOpacity,"opacity")}function _e(e,t,n,r){var o=new e.block(X.ColorFill);we(0,o,n,r),o.writeFloat32Array(n.rigColor,"color"),o.writeUint8(n.fillRule.numericId,"fillRule"),t.writeBlock(o)}function Pe(e,t,n,r){we(0,t,n,r),t.writeUint8(n.numColorStops,"numColorStops"),t.writeFloat32Array(n.rigColorStops,"colorStops"),t.writeFloat32Array(n.rigStart,"start"),t.writeFloat32Array(n.rigEnd,"end")}function Ce(e,t,n,r){Pe(0,t,n,r),t.writeFloat32(n.rigSecondaryRadiusScale,"secondaryRadiusScale")}function Ee(e,t,n,r){var o=new e.block(X.GradientFill);Pe(0,o,n,r),o.writeUint8(n.fillRule.numericId,"fillRule"),t.writeBlock(o)}function Te(e,t,n,r){var o=new e.block(X.GradientStroke);Pe(0,o,n,r),je(o,n),t.writeBlock(o)}function Ie(e,t,n,r){var o=new e.block(X.RadialGradientFill);Ce(0,o,n,r),o.writeUint8(n.fillRule.numericId,"fillRule"),t.writeBlock(o)}function je(e,t){e.writeFloat32(t.rigWidth,"width"),e.writeUint8(t.cap.numericId,"cap"),e.writeUint8(t.join.numericId,"join"),e.writeUint8(t.trim.numericId,"trim"),t.isTrimmed&&(e.writeFloat32(t.rigTrimStart,"start"),e.writeFloat32(t.rigTrimEnd,"end"),e.writeFloat32(t.rigTrimOffset,"offset"))}function Ae(e,t,n,r){var o=new e.block(X.RadialGradientStroke);Ce(0,o,n,r),je(o,n),t.writeBlock(o)}function De(e,t,n,r){var o=new e.block(X.ColorStroke);we(0,o,n,r),o.writeFloat32Array(n.rigColor,"color"),je(o,n),t.writeBlock(o)}function Re(e,t,n,r){var o=new e.block(n.isSequence?X.ActorImageSequence:X.ActorImage),i=n.asset,a=n.isVisible,s=n.isSequence,l=n.bitmap;s&&i&&(i=i.children[0]);var u=i&&e.assetLookup[i.refId];Number.isInteger(u)||(u=-1);var c=a&&i&&(s&&i.children.length>0||l)&&u>-1;if(be(0,o,n,c,r),ke(0,o,n,r),c){var d=function(e,t,n,r,o,i,a,s){for(var l=e.minU,u=e.minV,c=e.maxU-e.minU,d=e.maxV-e.minV,f=h.width,p=h.height,y=e.x/f,v=e.y/p,m=e.width/f,g=e.height/p,b=0;b<t;b++){var k=(n[r]-l)/c,S=(n[r+1]-u)/d;if(e.rotated){var O=k;k=S,S=O}i[a]=y+k*m,i[a+1]=v+S*g,a+=s,r+=o}},f=e.assetData[u].packing,h=e.atlases[f.atlas];o.writeUint8(f.atlas,"atlas");var p=n.getExportMeshBuffer(),y=n.getExportWeightBuffer(),v=n.connectedBones,m=n.tris,g=p.length/4,b=null;if(s){var k=2,S=0;b=new Float32Array(2*g);for(var O=0;O<g;O++)b[S++]=p[k],b[S++]=p[k+1],k+=4}if(d(f,g,p,2,4,p,2,4),y&&y.length/8==g&&v&&v.length){for(var w=new Float32Array(12*g),_=0,P=0,C=0,E=0;E<g;E++)w[_++]=p[P++],w[_++]=p[P++],w[_++]=p[P++],w[_++]=p[P++],w[_++]=y[C++],w[_++]=y[C++],w[_++]=y[C++],w[_++]=y[C++],w[_++]=y[C++],w[_++]=y[C++],w[_++]=y[C++],w[_++]=y[C++];p=w}if(o.writeUint32(g,"numVertices"),o.writeFloat32Array(p,"vertices"),o.writeUint32(m.length/3,"numTriangles"),o.writeUint16Array(m,"triangles"),n.isSequence){var T=n.asset.children;o.openArray("frames"),o.writeUint16length(T.length);for(var I=1;I<T.length;I++){var j=T[I],A=e.assetLookup[j.refId],D=e.assetData[A].packing;o.openObject("frame"),o.writeUint8(D.atlas,"atlas");var R=new Float32Array(2*g);d(D,g,b,0,2,R,0,2),o.writeFloat32Array(R,"uv"),o.closeObject()}o.closeArray()}}t.writeBlock(o)}function Me(e,t,n,r){var i=0,s=n.keyedNodes,l=new e.block(X.Animation),u=n.duration,c=0,d=u;if(e.options.cropAnimationsToWorkArea&&n.isWorkAreaActive)u=n.workAreaEnd-n.workAreaStart,c=n.workAreaStart,d=n.workAreaEnd;else if(e.options.maxKeyFrameTimeIsDuration){for(var f=0,h=0;h<s.length;h++)for(var p=s[h].propsList,v=0;v<p.length;v++)for(var m=p[v].keyFrames,g=0;g<m.length;g++){var b=m[g].time;b>=c&&b<=d&&b>f&&(f=b-c)}u=f-c}l.writeString(n.name,"name"),l.writeUint8(n.fps,"fps"),l.writeFloat32(u,"duration"),l.writeBool(n.loop,"isLooping");for(var k=new Map,S=0;S<s.length;S++){var w=s[S],_=k.get(w.node);_||(_=[],k.set(w.node,_));for(var E=w.propsList,T=0;T<E.length;T++){var I=E[T],j=w.node;switch(C.default.Properties[I.property]){case C.default.Properties.frameFillColor:j=j.children.find(function(e){return e instanceof O.ColorFill});break;case C.default.Properties.frameStrokeColor:j=j.children.find(function(e){return e instanceof O.ColorStroke});break;case C.default.Properties.frameStrokeWidth:case C.default.Properties.frameStrokeOpacity:case C.default.Properties.frameStrokeStart:case C.default.Properties.frameStrokeEnd:case C.default.Properties.frameStrokeOffset:j=j.stroke;break;case C.default.Properties.frameFillOpacity:j=j.fill;break;case C.default.Properties.frameFillGradient:j=j.children.find(function(e){return e.constructor===O.GradientFill});break;case C.default.Properties.frameStrokeGradient:j=j.children.find(function(e){return e.constructor===O.GradientStroke});break;case C.default.Properties.frameFillRadial:j=j.children.find(function(e){return e.constructor===O.RadialGradientFill});break;case C.default.Properties.frameStrokeRadial:j=j.children.find(function(e){return e.constructor===O.RadialGradientStroke})}if(j){var A=k.get(j);A||(A=[],k.set(j,A)),A.push(I)}}}l.openArray("keyed"),l.writeUint16length(k.size);var D=!0,R=!1,M=void 0;try{for(var x,F=k[Symbol.iterator]();!(D=(x=F.next()).done);D=!0){var z=x.value,V=o(z,2),B=V[0],H=V[1],W=B===L.default.OrderObject?0:r.get(B);l.openObject("component"),l.writeId(W,"component");var K=H.filter(function(e){return void 0!==C.default.Properties[e.property]});l.writeUint16length(K.length);for(var G=0;G<K.length;G++){var U=K[G],Y=C.default.Properties[U.property],J=new e.block(Y,C.default.ExportPropertyLookup),q=U.keyFrames;J.openArray("frames"),J.writeUint16length(q.length);for(var Q=0;Q<q.length;Q++){var Z=q[Q],$=Z.time-c;J.openObject("frame"),J.writeFloat64($,"time");var ee=void 0;switch(Y){case C.default.Properties.frameBooleanValue:case C.default.Properties.frameStringValue:case C.default.Properties.frameTrigger:case C.default.Properties.frameDrawOrder:case C.default.Properties.frameIsCollisionEnabled:case C.default.Properties.frameActiveChild:ee=!1;break;default:ee=!0}if(ee)switch(J.writeUint8(Z._Interpolator.constructor.ID,"interpolatorType"),Z._Interpolator.constructor){case N.default:J.writeFloat32(Z._Interpolator._X1,"cubicX1"),J.writeFloat32(Z._Interpolator._Y1,"cubicY1"),J.writeFloat32(Z._Interpolator._X2,"cubicX2"),J.writeFloat32(Z._Interpolator._Y2,"cubicY2")}if($>i&&(i=$),Y===C.default.Properties.frameTrigger)   ;else if(Y===C.default.Properties.frameStringValue)J.writeString(Z.value,"value");else if(Y===C.default.Properties.frameBooleanValue||Y===C.default.Properties.frameIsCollisionEnabled)J.writeBool(Z.value,"value");else if(Y===C.default.Properties.frameIntValue)J.writeInt32(Z.value,"value");else if(Y===C.default.Properties.frameDrawOrder){var te=Z.value;J.openArray("drawOrder");var ne=[];for(var re in te){var oe=te[re],ie=r.get(oe.obj);void 0!==ie&&ne.push({nodeIndex:ie,value:oe.v})}J.writeUint16length(ne.length);var ae=!0,se=!1,le=void 0;try{for(var ue,ce=ne[Symbol.iterator]();!(ae=(ue=ce.next()).done);ae=!0){var de=ue.value;J.openObject("order"),J.writeId(de.nodeIndex,"component"),J.writeUint16(de.value,"order"),J.closeObject()}}catch(e){se=!0,le=e}finally{try{!ae&&ce.return&&ce.return()}finally{if(se)throw le}}J.closeArray()}else if(Y===C.default.Properties.frameImageVertices){var fe=B.deformPoints,he=new Float32Array(2*fe.length),pe=!0,ye=!1,ve=void 0;try{for(var me,ge=Z.value[Symbol.iterator]();!(pe=(me=ge.next()).done);pe=!0){var be=me.value,ke=o(be,2),Se=ke[0],Oe=ke[1],we=2*fe.indexOf(Se);we<0||(he[we]=Oe[0],he[we+1]=Oe[1])}}catch(e){ye=!0,ve=e}finally{try{!pe&&ge.return&&ge.return()}finally{if(ye)throw ve}}J.writeFloat32Array(he,"value")}else if(Y===C.default.Properties.framePathVertices){e.pointToPathIndex;var _e=[],Pe=Z.value,Ce=!0,Ee=!1,Te=void 0;try{for(var Ie,je=Pe[Symbol.iterator]();!(Ce=(Ie=je.next()).done);Ce=!0){var Ae=Ie.value,De=o(Ae,2),Re=De[0],Me=De[1];B===Re.parent&&_e.push({point:Re,value:Me})}}catch(e){Ee=!0,Te=e}finally{try{!Ce&&je.return&&je.return()}finally{if(Ee)throw Te}}var xe=[],Fe=!0,Le=!1,Ne=void 0;try{for(var ze,Ve=B.children[Symbol.iterator]();!(Fe=(ze=Ve.next()).done);Fe=!0){var Be=ze.value;Be instanceof y.default&&xe.push(Be)}}catch(e){Le=!0,Ne=e}finally{try{!Fe&&Ve.return&&Ve.return()}finally{if(Le)throw Ne}}var He=!0,We=!1,Ke=void 0;try{for(var Ge,Ue=_e[Symbol.iterator]();!(He=(Ge=Ue.next()).done);He=!0){var Xe=Ge.value,Ye=Xe.point,Je=xe.indexOf(Ye);xe[Je]=Xe}}catch(e){We=!0,Ke=e}finally{try{!He&&Ue.return&&Ue.return()}finally{if(We)throw Ke}}J.openArray("value");var qe=!0,Qe=!1,Ze=void 0;try{for(var $e,et=xe[Symbol.iterator]();!(qe=($e=et.next()).done);qe=!0){var tt=$e.value;if(tt instanceof y.default){var nt=tt.rigTranslation[0],rt=tt.rigTranslation[1];switch(J.writeFloat32(nt,"translationX"),J.writeFloat32(rt,"translationY"),tt.pointType){case P.default.Straight:J.writeFloat32(tt.rigRadius,"radius");break;default:J.writeFloat32(tt.rigIn[0],"inValueX"),J.writeFloat32(tt.rigIn[1],"inValueY"),J.writeFloat32(tt.rigOut[0],"outValueX"),J.writeFloat32(tt.rigOut[1],"outValueY")}}else{var ot=tt.value;tt=tt.point;var it=ot.pos||tt.rigTranslation;switch(J.writeFloat32(it[0],"translationX"),J.writeFloat32(it[1],"translationY"),tt.pointType){case P.default.Straight:J.writeFloat32(void 0===ot.radius?tt.rigRadius:ot.radius,"radius");break;default:var at=ot.in||tt.rigIn,st=ot.out||tt.rigOut;J.writeFloat32(at[0],"inValueX"),J.writeFloat32(at[1],"inValueY"),J.writeFloat32(st[0],"outValueX"),J.writeFloat32(st[1],"outValueY")}}}}catch(e){Qe=!0,Ze=e}finally{try{!qe&&et.return&&et.return()}finally{if(Qe)throw Ze}}J.closeArray()}else if(Y===C.default.Properties.frameFillColor)J.writeFloat32Array(Z.value,"value");else if(Y===C.default.Properties.frameStrokeColor)J.writeFloat32Array(Z.value,"value");else if(Y===C.default.Properties.frameFillGradient||Y===C.default.Properties.frameStrokeGradient||Y===C.default.Properties.frameStrokeRadial||Y===C.default.Properties.frameFillRadial)J.writeUint16(Z.value.length,"length"),J.writeFloat32Array(Z.value,"value");else if(Y===C.default.Properties.frameActiveChild)if(void 0!==Z.value&&Z.value.parent){if(Z.value instanceof a.default){var lt=Z.value.parent.children.indexOf(Z.value);-1===lt&&console.warn("NOT A SOLO CHILD??",Z),J.writeFloat32(lt+1,"value")}}else J.writeFloat32(0,"value");else J.writeFloat32(Z.value,"value");J.closeObject()}J.closeArray(),l.writeBlock(J)}l.closeObject()}}catch(e){R=!0,M=e}finally{try{!D&&F.return&&F.return()}finally{if(R)throw M}}l.closeArray(),l.writeFloat32(e.options.animationStart||0,"animationStart"),l.writeFloat32(e.options.animationEnd||i,"animationEnd"),t.writeBlock(l)}function xe(e,t,n,r){var o=new e.block(X.ActorEvent);q(0,o,n,r),t.writeBlock(o)}function Fe(e,t,n,r){var o=void 0;switch(n.propertyType){case w.default.Type.Integer:o=X.CustomIntProperty;break;case w.default.Type.Float:o=X.CustomFloatProperty;break;case w.default.Type.String:o=X.CustomStringProperty;break;case w.default.Type.Boolean:o=X.CustomBooleanProperty}var i=new e.block(o);switch(q(0,i,n,r),n.propertyType){case w.default.Type.Integer:i.writeInt32(n.rigIntValue,"int");break;case w.default.Type.Float:i.writeFloat32(n.rigFloatValue,"float");break;case w.default.Type.String:i.writeString(n.rigStringValue,"string");break;case w.default.Type.Boolean:i.writeBool(n.rigBooleanValue,"bool")}t.writeBlock(i)}var Le=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t}return r(e,[{key:"addExportAsset",value:function(e,t){var n=null,r=this.assetLookup[e.refId];void 0===r?(this.assetLookup[e.refId]=this.assetData.length,n={asset:e,bitmap:e.bitmap,meshes:[]},this.assetData.push(n)):n=this.assetData[r];var o=t.getExportMeshBuffer();o&&n.meshes.push(o)}},{key:"exportArtboard",value:function(e){var t=[],n=new Map;e.eachChildRecursive(function(e){switch(e.constructor){case u.default:case w.default:case l.default:case _.default:case c.default:case i.default:case k.default:case d.default:case f.default:case I.default:case T.default:case R.default:case j.default:case A.default:case D.default:case S.default:case h.default:case p.default:case s.default:case m.default:case b.default:case g.default:case v.default:case O.ColorFill:case O.ColorStroke:case O.GradientFill:case O.GradientStroke:case O.RadialGradientFill:case O.RadialGradientStroke:n.set(e,t.length),t.push(e)}});var r=new this.block(X.ActorArtboard,!1);r.writeString(e.name,"name"),r.writeFloat32Array(e.translation,"translation"),r.writeFloat32(e.width,"width"),r.writeFloat32(e.height,"height"),r.writeFloat32Array(e.origin,"origin"),r.writeBool(e.clipContents,"clipContents"),r.writeFloat32Array(e.color,"color");var o=new this.block(X.Nodes,!0);o.writeUint16length(t.length);for(var a=0;a<t.length;a++){var y=t[a];switch(y.constructor){case I.default:te(this,o,y,n);break;case T.default:ne(this,o,y,n);break;case R.default:oe(this,o,y,n);break;case j.default:ie(this,o,y,n);break;case A.default:ae(this,o,y,n);break;case D.default:se(this,o,y,n);break;case _.default:le(this,o,y,n);break;case c.default:$(this,o,y,n);break;case i.default:ue(this,o,y,n);break;case k.default:ce(this,o,y,n);break;case u.default:Re(this,o,y,n);break;case d.default:de(this,o,y,n);break;case l.default:xe(this,o,y,n);break;case w.default:Fe(this,o,y,n);break;case f.default:Z(this,o,y,n);break;case S.default:fe(this,o,y,n);break;case h.default:Oe(this,o,y,n);break;case p.default:Se(this,o,y,n);break;case s.default:ge(this,o,y,n);break;case m.default:pe(this,o,y,n);break;case b.default:ve(this,o,y,n);break;case g.default:ye(this,o,y,n);break;case v.default:me(this,o,y,n);break;case O.ColorFill:_e(this,o,y,n);break;case O.ColorStroke:De(this,o,y,n);break;case O.GradientFill:Ee(this,o,y,n);break;case O.GradientStroke:Te(this,o,y,n);break;case O.RadialGradientFill:Ie(this,o,y,n);break;case O.RadialGradientStroke:Ae(this,o,y,n)}}r.writeBlock(o);var P=e.orderedAnimations;if(P){var C=new this.block(X.Animations,!0);C.writeUint16length(P.length);var E=!0,M=!1,x=void 0;try{for(var F,L=P[Symbol.iterator]();!(E=(F=L.next()).done);E=!0){Me(this,C,F.value,n)}}catch(e){M=!0,x=e}finally{try{!E&&L.return&&L.return()}finally{if(M)throw x}}r.writeBlock(C)}return r}},{key:"export",value:function(e,t){var n=this,r=[];this.assetLookup={},this.assetData=r;var o=this.options;this.pointToPathIndex=new Map,e.artboards.eachChildRecursive(function(e){switch(e.constructor){case u.default:if(e.isVisible&&e.asset)if(e.asset instanceof E.default)for(var t=0;t<e.asset.children.length;t++){var r=e.asset.children[t];n.addExportAsset(r,e)}else e.bitmap&&n.addExportAsset(e.asset,e)}});for(var i=e.artboards.children.slice(0).sort(function(e,t){return(t.isMain?1:0)-(e.isMain?1:0)}),a=[],s=0;s<r.length;s++){var l=r[s],c={bytes:l.bitmap.bytes,width:l.bitmap.width,height:l.bitmap.height,channels:l.bitmap.channels},d=1,f=1,h=0,p=0;if(a.push(c),o.cropImages)for(var y=0;y<l.meshes.length;y++)for(var v=l.meshes[y],m=v.length/4,g=0,b=0;b<m;b++){var k=v[g+2],S=v[g+3];g+=4,k<d&&(d=k),k>h&&(h=k),S<f&&(f=S),S>p&&(p=S)}c.minU=1!==d?d:0,c.minV=1!==f?f:0,c.maxU=0!==h?h:1,c.maxV=0!==p?p:1}(new F.default).makeAtlas(a,{multiplyAlpha:o.multiplyAlpha,atlasPadding:o.atlasPadding,atlasPowerOfTwo:o.atlasPowerOfTwo,atlasSquare:o.atlasSquare,maxAtlasWidth:o.maxAtlasWidth,maxAtlasHeight:o.maxAtlasHeight,maxImageWidth:o.maxImageWidth,maxImageHeight:o.maxImageHeight},function(e){if(e){n.atlases=e.atlases;for(var a=0;a<e.bitmaps.length;a++){var s=e.bitmaps[a];r[a].packing=s}var l=new n.stream;l.sign("FLARE"),l.writeUint32(21,"version");var u=new n.block(X.Artboards,!0);u.writeUint16length(i.length);var c=!0,d=!1,f=void 0;try{for(var h,p=i[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var y=h.value,v=n.exportArtboard(y);u.writeBlock(v)}}catch(e){d=!0,f=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw f}}l.writeBlock(u);var m=o.isZipExport,g=e.atlases,b=n,k=[],S=0;if(0===g.length)o.isZipExport=!1,o.wantWriter?t(l):t(V.default.isNode?l.toArrayBuffer():l.toBlob("application/octet-stream"));else for(var O=0;O<g.length;O++){S++,k.push(null);var w=g[O];z.default.toCompressedBuffer(w,"image/png",function(e){return function(t){_(e,t)}}(O),"image/png",1)}}else t(null);function _(e,n){k[e]=n,0===--S&&function(){if(m){var e=new b.block(X.Atlases);e.writeBool(!0,"isOOB"),e.openArray("data"),e.writeUint16length(g.length);var n=l,r=g.length;if(1===r){var i=o.characterName+".png";e.writeString(i)}else if(r>1)for(var a=0;a<r;a++){var s=o.characterName+a+".png";e.writeString(s)}e.closeArray(),n.writeBlock(e);var u=V.default.isNode?l.toArrayBuffer():l.toBlob();x.default.createWriter(V.default.isNode?new x.default.Uint8ArrayWriter:new x.default.BlobWriter,function(e){e.add(o.characterName+(o.extension||".flr"),V.default.isNode?new x.default.Uint8ArrayReader(u):new x.default.BlobReader(u),function(){if(g.length){var n=0;e.add(1===g.length?o.characterName+".png":o.characterName+"0.png",V.default.isNode?new x.default.Uint8ArrayReader(k[0]):new x.default.BlobReader(new Blob([k[0]],{type:"image/png"})),function r(){++n==g.length?e.close(function(e){t(e)}):e.add(o.characterName+n+".png",V.default.isNode?new x.default.Uint8ArrayReader(k[n]):new x.default.BlobReader(new Blob([k[n]],{type:"image/png"})),r)})}else e.close(function(e){t(e)})},function(e,t){})},function(e){})}else{var c=new b.block(X.Atlases);c.writeBool(!1,"isOOB"),c.openArray("data"),c.writeUint16length(g.length);for(var d=0;d<k.length;d++){var f=k[d];c.writeUint32length(f.length),c.writeRaw(f)}c.closeArray(),l.writeBlock(c),o.wantWriter?t(l):t(V.default.isNode?l.toArrayBuffer():l.toBlob("application/octet-stream"))}}()}})}},{key:"block",get:function(){var e=this.options.writerFormat in J?this.options.writerFormat:Y.JSON;return J[e].block}},{key:"stream",get:function(){var e=this.options.writerFormat in J?this.options.writerFormat:Y.JSON;return J[e].writer}}]),e}();t.default=Le},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(18)),a=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var u=(l((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.name="Animations",n.isNameReadOnly=!0,n._UpdateTimeout=null,e.addEventListener("animationListChanged",n.onUpdateRequired),n._Root=e,n._AnimationList=[],n.update(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"sort",value:function(e){var n=this._Root.animations.slice(0);switch(e){case t.SortOrder.Created:break;case t.SortOrder.Alphabetical:n.sort(function(e,t){return e.name.localeCompare(t.name)})}for(var r=0;r<n.length;r++)n[r].order=r}},{key:"update",value:function(){var e=this._Root.orderedAnimations;this._AnimationList=e,this.dispatch("update"),this.dispatch("childrenChanged")}},{key:"onUpdateRequired",value:function(){clearTimeout(this._UpdateTimeout),this._UpdateTimeout=setTimeout(this.update,0)}},{key:"cleanup",value:function(){this._Root.removeEventListener("animationListChanged",this.onUpdateRequired)}},{key:"pauseAll",value:function(){var e=this._Root,t=!0,n=!1,r=void 0;try{for(var o,i=e.animations[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.isPlaying=!1}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"uiHierIconClass",get:function(){return"HierarchyAnimIcon"}},{key:"uiIcon",get:function(){return"icon-animations"}},{key:"firstAnimation",get:function(){var e=this._Root.animations;return e&&e.length?e[0]:null}},{key:"hierarchyChildren",get:function(){return this._AnimationList}}]),t}()).prototype,"update",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"update"),r.prototype),l(r.prototype,"onUpdateRequired",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onUpdateRequired"),r.prototype),r);t.default=u,u.SortOrder={Created:0,Alphabetical:1}},function(e,t,n){var r=n(1168);"string"==typeof r&&(r=[[e.i,r,""]]);var o={insertAt:"top",hmr:!0,transform:void 0};n(14)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(420),a=(r=i)&&r.__esModule?r:{default:r};var s=1,l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"assignID",value:function(){return this.id="folder-"+s++,this.id}},{key:"read",value:function(e,n,r){(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n,r);var o=this.id;if(o||(o=this.assignID()),o){var i=o.split("-");if(i.length>1){var a=Number.parseInt(i[1]);a>s&&(s=a+1)}}}},{key:"resolveChildType",value:function(e,t){var n=e.constructor.registeredAssets[t];return n?n.ctr:null}},{key:"uiIcon",get:function(){return"icon-folder"}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(2)),s=c(n(5)),l=c(n(384)),u=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"boneUpdate",value:function(){this.forceUpdate()}},{key:"setBone",value:function(e){this.bone!==e&&(this.bone&&this.bone.removeEventListener("update",this.boneUpdate),this.bone=e,e&&e.addEventListener("update",this.boneUpdate))}},{key:"componentWillReceiveProps",value:function(e){e.bone!=this.props.bone&&this.setBone(e.bone)}},{key:"componentDidMount",value:function(){this.setBone(this.props.bone)}},{key:"componentWillUnmount",value:function(){this.setBone(null)}},{key:"disconnect",value:function(){this.props.bone.stageItem.isConnected=!1,this.props.skinnable?this.props.skinnable.disconnectBone(this.props.bone):this.props.disconnect&&this.props.disconnect(this.props.bone),this.context.nima.stage.updateHighlights(),this.context.nima.captureJournalEntry()}},{key:"commitEdit",value:function(){var e=new l.default(this.context.nima.stage,this.context.nima.actor,this.props.bone,this.inputText.value);e.start(),e.end(),this.endEdit(!1)}},{key:"endEdit",value:function(e){this.setState({editing:!1}),this.inputText&&this.inputText.removeEventListener("blur",this.commitEdit),clearTimeout(this.editTimeout)}},{key:"cancelEdit",value:function(){this.endEdit(!0)}},{key:"startEdit",value:function(){this.setState({editing:!0,editName:this.props.bone.name});var e=this;clearTimeout(this.editTimeout),this.editTimeout=setTimeout(function(){e.inputText.focus(),e.inputText.setSelectionRange(0,e.inputText.value.length),e.inputText.addEventListener("blur",e.commitEdit)},0)}},{key:"editKeyDown",value:function(e){switch(e.keyCode){case 13:this.inputText.blur();break;case 27:this.cancelEdit(),this.inputText.blur()}}},{key:"editTextChange",value:function(e){this.setState({editName:e.target.value})}},{key:"textMouseDown",value:function(e){var t=Date.now();this.lastMouseDown&&t-this.lastMouseDown<200&&this.startEdit(),this.lastMouseDown=t}},{key:"mouseEnter",value:function(){this.props.bone&&this.props.bone.stageItem&&this.props.bone.stageItem.stage&&(this.context.nima.stage.hoverItem=this.props.bone.stageItem)}},{key:"mouseLeave",value:function(){this.props.bone&&this.props.bone.stageItem&&this.props.bone.stageItem.stage&&this.context.nima.stage.hoverItem===this.props.bone.stageItem&&(this.context.nima.stage.hoverItem=null)}},{key:"setInputText",value:function(e){this.inputText=e}},{key:"render",value:function(){var e=this.props.allowDisconnect;return i.default.createElement("div",{className:"MeshBoneRow",onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave},i.default.createElement("svg",{className:"TimelineIcon TimelineBoneIcon"},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-bone")})),this.state.editing?i.default.createElement("input",{ref:this.setInputText,type:"text",value:this.state.editName,onKeyDown:this.editKeyDown,onChange:this.editTextChange}):i.default.createElement("div",{className:"MeshBone",onMouseDown:this.textMouseDown},this.props.bone.name),e?i.default.createElement("svg",{className:"DeleteRow",onClick:this.disconnect},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-delete")})):null)}}]),t}()).prototype,"boneUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"boneUpdate"),r.prototype),d(r.prototype,"disconnect",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"disconnect"),r.prototype),d(r.prototype,"commitEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commitEdit"),r.prototype),d(r.prototype,"endEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"endEdit"),r.prototype),d(r.prototype,"cancelEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"cancelEdit"),r.prototype),d(r.prototype,"startEdit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"startEdit"),r.prototype),d(r.prototype,"editKeyDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"editKeyDown"),r.prototype),d(r.prototype,"editTextChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"editTextChange"),r.prototype),d(r.prototype,"textMouseDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"textMouseDown"),r.prototype),d(r.prototype,"mouseEnter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseEnter"),r.prototype),d(r.prototype,"mouseLeave",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseLeave"),r.prototype),d(r.prototype,"setInputText",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setInputText"),r.prototype),r);t.default=f,f.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(1)),i=s(n(542)),a=s(n(216));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),r(t,[{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.value,r=e.onValueChanged,s=e.dragScale,l=e.onValueCommit,u=e.isOn,c=e.onToggle,d=e.converter;return o.default.createElement("div",{className:"SelectionPanelCheckProperty"},o.default.createElement(i.default,{value:u,onValueChange:c}),o.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{opacity:u?null:".45"}},this.props.label),o.default.createElement("div",{className:"Spacer"}),o.default.createElement(a.default,{disabled:t||!u,value:n,converter:d,onValueChanged:r,dragScale:s,onValueCommit:l}))}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.floor(10*e)/10}},{key:"toInputValue",value:function(e){return e}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e);if(t<0||Number.isNaN(t))throw"Invalid input";return t}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"defaultValue",get:function(){return 1}},{key:"allowDrag",get:function(){return!0}},{key:"dragScale",get:function(){return 1}},{key:"dragMin",get:function(){return 0}},{key:"dragMax",get:function(){}}]),e}();t.default=o},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=(l(n(28)),l(n(5)),l(n(2))),s=l(n(3));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){function t(e){u(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return d(t,i.default.Component),o(t,[{key:"render",value:function(){var e=this.props.disabled;return i.default.createElement("div",{className:"PathPointBtns"},i.default.createElement(b,{disabled:e,active:0===this.props.selectedIndex,pointIndex:0,onSelectionChanged:this.props.onSelectionChanged},i.default.createElement("svg",{className:"PointIcon"},i.default.createElement("use",{xlinkHref:s.default.make("/images/symbol-defs.svg#icon-point-straight")})),"Straight"),i.default.createElement(b,{disabled:e,active:1===this.props.selectedIndex,pointIndex:1,onSelectionChanged:this.props.onSelectionChanged},i.default.createElement("svg",{className:"PointIcon"},i.default.createElement("use",{xlinkHref:s.default.make("/images/symbol-defs.svg#icon-point-mirrored")})),"Mirrored"),i.default.createElement(b,{disabled:e,active:2===this.props.selectedIndex,pointIndex:2,onSelectionChanged:this.props.onSelectionChanged},i.default.createElement("svg",{className:"PointIcon"},i.default.createElement("use",{xlinkHref:s.default.make("/images/symbol-defs.svg#icon-point-detached")})),"Detached"),i.default.createElement(b,{disabled:e,active:3===this.props.selectedIndex,pointIndex:3,onSelectionChanged:this.props.onSelectionChanged},i.default.createElement("svg",{className:"PointIcon"},i.default.createElement("use",{xlinkHref:s.default.make("/images/symbol-defs.svg#icon-point-assymetric")})),"Asymmetric"))}}]),t}();t.default=f;var h,p,y,v,m,g,b=(r=function(e){function t(){return u(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d(t,i.default.Component),o(t,[{key:"click",value:function(){this.props.onSelectionChanged&&(console.log("button was clicked"),this.props.onSelectionChanged(this.props.pointIndex))}},{key:"render",value:function(){return i.default.createElement("div",{className:this.props.disabled?"PathPointBtnDisabled":this.props.active?"PathPointBtnActive":"PathPointBtn",onClick:this.click},this.props.children)}}]),t}(),h=r.prototype,p="click",y=[a.default],v=Object.getOwnPropertyDescriptor(r.prototype,"click"),m=r.prototype,g={},Object.keys(v).forEach(function(e){g[e]=v[e]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=y.slice().reverse().reduce(function(e,t){return t(h,p,e)||e},g),m&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(m):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(h,p,g),g=null),r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)){var n=new window.FileReader;n.readAsDataURL(t),n.onloadend=function(){var t=n.result;t=t.substr(t.indexOf(",")+1);var r=document.createElement("form");r.setAttribute("action","/nima/flip"),r.setAttribute("method","post");var o=document.createElement("textarea");o.setAttribute("name","body"),o.innerText=t,r.appendChild(o),(o=document.createElement("input")).setAttribute("name","name"),o.setAttribute("value",e),r.appendChild(o),r.submit()}}else{var r=URL.createObjectURL(t),o=document.createElement("a");o.setAttribute("href",r),o.setAttribute("download",e),o.dispatchEvent(new MouseEvent("click")),URL.revokeObjectURL(r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(168),i=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(168),i=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(168));o(n(269)),n(7);function o(e){return e&&e.__esModule?e:{default:e}}var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(168));o(n(269)),n(7);function o(e){return e&&e.__esModule?e:{default:e}}var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(1)),a=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var u=(l((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isFocused:!1,input:null},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"focus",value:function(e){this.setState({isFocused:!0,input:t.formatValue(this.props.value,this.props.rate)});var n=this.inputField;setTimeout(function(){n.setSelectionRange(0,n.value.length)},0)}},{key:"parse",value:function(e,t){var n=e.split(":");return 0==n.length||1==n.length?Math.round(Number.parseFloat(e)):2==n.length?Math.round(Number.parseFloat(n[0]))*t+Math.round(Number.parseFloat(n[1])):60*Math.round(Number.parseFloat(n[0]))*t+Math.round(Number.parseFloat(n[1]))*t+Math.round(Number.parseFloat(n[2]))}},{key:"blur",value:function(e){if(null!==this.state.input){var t=this.parse(e.target.value,this.props.rate);this.props.onValueChanged&&!isNaN(t)&&this.props.onValueChanged(t)}this.setState({isFocused:!1})}},{key:"inputText",value:function(e){this.setState({input:e.target.value})}},{key:"keyDown",value:function(e){switch(e.keyCode){case 13:this.inputField.blur();break;case 27:this.state.input=null,this.inputField.blur()}}},{key:"setInputField",value:function(e){this.inputField=e}},{key:"render",value:function(){var e=(this.state.isFocused?this.state.input:t.formatValue(this.props.value,this.props.rate))||"";return i.default.createElement("input",{className:this.props.className,type:"text",ref:this.setInputField,value:e,onKeyDown:this.keyDown,onChange:this.inputText,onFocus:this.focus,onBlur:this.blur})}}]),t}()).prototype,"focus",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"focus"),r.prototype),l(r.prototype,"blur",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"blur"),r.prototype),l(r.prototype,"inputText",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputText"),r.prototype),l(r.prototype,"keyDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyDown"),r.prototype),l(r.prototype,"setInputField",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setInputField"),r.prototype),r);t.default=u,u.formatValue=function(e,t){if(t){var n=Math.floor(e),r=n/t,o=Math.floor(r/60);e=(0==o?"00":o<10?"0"+o:o)+":"+(0==(r=Math.floor(r-60*o))?"00":r<10?"0"+r:r)+":"+(0==(n-=(r+60*o)*t)?"00":n<10?"0"+n:n)}else e=Math.round(e);return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(2)),s=c(n(5)),l=c(n(528)),u=c(n(441));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isFocused:!1,input:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"inputFocused",value:function(e){e.preventDefault(),e.stopPropagation();var t=e.target;this.setState(function(){return{isFocused:!0,input:l.default.toInputValue(this.props.value)}},function(){t.select()})}},{key:"inputBlurred",value:function(){if(null!==this.state.input){var e,t=this.state.input;try{e=l.default.fromInputValue(t)}catch(t){e=this.props.value}this.props.valueChanged&&!isNaN(e)&&this.props.valueChanged(e)}this.setState({isFocused:!1})}},{key:"inputText",value:function(e){this.setState({input:e.target.value})}},{key:"keyDown",value:function(e){switch(e.keyCode){case 13:this.textInput.blur();break;case 27:this.state.input=null,this.textInput.blur()}}},{key:"mouseOver",value:function(){this.context.tooltip.enter(this)}},{key:"mouseOut",value:function(){this.context.tooltip.leave(this)}},{key:"mouseDown",value:function(e){this.context.tooltip.click(this),this.state.isFocused||(e.preventDefault(),this.lastY=e.clientY,this.moved=!1,this.valueAtClick=this.props.value,this.valueMoveAccum=0,this.moveAccum=0,window.addEventListener("mouseup",this.mouseUp,!0),window.addEventListener("mousemove",this.mouseMove,!0))}},{key:"mouseUp",value:function(e){this.moved?this.setState({isFocused:!1,input:l.default.toInputValue(this.props.value)}):this.inputFocused(e),window.removeEventListener("mousemove",this.mouseMove,!0),window.removeEventListener("mouseup",this.mouseUp,!0)}},{key:"mouseMove",value:function(e){var t=e.clientY-this.lastY;if(this.lastY=e.clientY,this.valueMoveAccum-=t*l.default.dragScale,!this.moved){if(this.moveAccum+=Math.abs(t),!(this.moveAccum>4))return;this.moved=!0}if(this.props.valueChanged){var n=l.default.dragMin,r=l.default.dragMax,o=this.valueAtClick+this.valueMoveAccum;this.valueAtClick>r?o=this.valueMoveAccum>0?this.valueAtClick:o:o<n?o=n:o>r&&(o=r),this.props.valueChanged(o)}}},{key:"setTextInput",value:function(e){this.textInput=e}},{key:"render",value:function(){var e=this.state.isFocused?this.state.input:l.default.toDisplayValue(this.props.value);return i.default.createElement("input",{className:u.default.ZoomInput,type:"text",value:e,ref:this.setTextInput,onKeyDown:this.keyDown,onChange:this.inputText,onBlur:this.inputBlurred,onMouseDown:this.mouseDown,onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut})}}]),t}()).prototype,"inputFocused",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputFocused"),r.prototype),d(r.prototype,"inputBlurred",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputBlurred"),r.prototype),d(r.prototype,"inputText",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputText"),r.prototype),d(r.prototype,"keyDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyDown"),r.prototype),d(r.prototype,"mouseOver",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOver"),r.prototype),d(r.prototype,"mouseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOut"),r.prototype),d(r.prototype,"mouseDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),d(r.prototype,"mouseUp",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseUp"),r.prototype),d(r.prototype,"mouseMove",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseMove"),r.prototype),d(r.prototype,"setTextInput",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTextInput"),r.prototype),r);t.default=f,f.contextTypes={tooltip:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(382)),i=a(n(383));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"shapeName",get:function(){return"Polygon"}},{key:"pathType",get:function(){return i.default}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(382)),i=a(n(336));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"shapeName",get:function(){return"Star"}},{key:"pathType",get:function(){return i.default}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(382)),i=a(n(432));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"shapeName",get:function(){return"Triangle"}},{key:"pathType",get:function(){return i.default}}]),t}();t.default=s},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ChildrenHistoricalPropertyEntry=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=me(n(18)),a=me(n(2)),s=me(n(327)),l=me(n(203)),u=me(n(197)),c=me(n(1271)),d=me(n(351)),f=n(288),h=me(n(225)),p=me(n(335)),y=me(n(429)),v=me(n(383)),m=me(n(336)),g=me(n(432)),b=me(n(275)),k=me(n(419)),S=me(n(517)),O=me(n(518)),w=me(n(173)),_=me(n(237)),P=me(n(228)),C=me(n(198)),E=me(n(303)),T=me(n(375)),I=me(n(515)),j=me(n(529)),A=me(n(532)),D=me(n(433)),R=me(n(533)),M=me(n(530)),x=me(n(531)),F=me(n(1272)),L=me(n(347)),N=me(n(267)),z=me(n(437)),V=me(n(536)),B=me(n(332)),H=me(n(535)),W=me(n(671)),K=me(n(289)),G=me(n(337)),U=me(n(224)),X=me(n(329)),Y=me(n(219)),J=me(n(268)),q=me(n(179)),Q=n(333),Z=me(n(230)),$=n(334),ee=me(n(252)),te=me(n(236)),ne=me(n(301)),re=me(n(525)),oe=me(n(176)),ie=me(n(253)),ae=me(n(1273)),se=me(n(677)),le=me(n(543)),ue=me(n(678)),ce=me(n(544)),de=me(n(545)),fe=me(n(679)),he=me(n(680)),pe=me(n(195)),ye=me(n(254)),ve=me(n(208));function me(e){return e&&e.__esModule?e:{default:e}}function ge(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ke=t.ChildrenHistoricalPropertyEntry=function(){function e(t){be(this,e),this._HistoryList=[],this._RemoveList=[],this._AddList=[],this._NotifyList=[],this._Actor=t}return o(e,[{key:"processChanges",value:function(){var e=new Set,t=new Set,n=!0,r=!1,o=void 0;try{for(var i,a=this._HistoryList[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l=s.from,u=s.to,c=s.item,d=!0,f=!1,h=void 0;try{for(var p,y=l[Symbol.iterator]();!(d=(p=y.next()).done);d=!0){var v=p.value;if(-1===u.indexOf(v)){if(c&&c.onChildRemoved&&c.onChildRemoved(v),!v.hasChildren){e.add(v);continue}v.all(function(t){e.add(t)})}}}catch(e){f=!0,h=e}finally{try{!d&&y.return&&y.return()}finally{if(f)throw h}}}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}var m=!0,g=!1,b=void 0;try{for(var k,S=this._HistoryList[Symbol.iterator]();!(m=(k=S.next()).done);m=!0){var O=k.value,w=(l=O.from,u=O.to,!0),_=!1,P=void 0;try{for(var C,E=u[Symbol.iterator]();!(w=(C=E.next()).done);w=!0){var T=C.value;if(-1===l.indexOf(T)){if(T.parent&&T.parent.onChildAdded&&T.parent.onChildAdded(T),!T.hasChildren){t.add(T);continue}T.all(function(e){t.add(e)})}}}catch(e){_=!0,P=e}finally{try{!w&&E.return&&E.return()}finally{if(_)throw P}}}}catch(e){g=!0,b=e}finally{try{!m&&S.return&&S.return()}finally{if(g)throw b}}var I=!0,j=!1,A=void 0;try{for(var D,R=e[Symbol.iterator]();!(I=(D=R.next()).done);I=!0){D.value.onRemovedFromActor()}}catch(e){j=!0,A=e}finally{try{!I&&R.return&&R.return()}finally{if(j)throw A}}var M=!0,x=!1,F=void 0;try{for(var L,N=t[Symbol.iterator]();!(M=(L=N.next()).done);M=!0){L.value.onAddedToActor()}}catch(e){x=!0,F=e}finally{try{!M&&N.return&&N.return()}finally{if(x)throw F}}}},{key:"add",value:function(e,t,n){this._HistoryList.push({item:e,from:t,to:n})}},{key:"changeChildren",value:function(e,t,n){this._NotifyList.push(e),e.silentlySetChildren(n.slice(0));for(var r=0;r<t.length;r++){var o=t[r];-1===n.indexOf(o)&&this._RemoveList.push(o)}for(var i=0;i<n.length;i++){var a=n[i];-1===t.indexOf(a)&&this._AddList.push({parent:e,child:a})}}},{key:"commitChanges",value:function(e){var t=this._Actor,n=function(t){t.hasChildren?t.all(function(n){n.stageItem&&e.queueRemove(n.stageItem),t.constructor===_.default&&(n.isCollapsedVisibility=!1)}):t.stageItem&&e.queueRemove(t.stageItem),t.setParent(null)},r=!0,o=!1,i=void 0;try{for(var a,s=this._RemoveList[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){n(a.value)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}var l=this._AddList,u=!0,c=!1,d=void 0;try{for(var f,h=l[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value,y=p.child,v=p.parent;y.hasChildren?y.all(function(t){t.stageItem&&t.stageItem.isAutomatic&&e.queueAdd(t.stageItem)}):y.stageItem&&y.stageItem.isAutomatic&&e.queueAdd(y.stageItem),y.setParent(v);var m=y;if(m.hasChildren)for(var g=0;g<m.children.length;g++){var b=m.children[g];b.parent!=m&&b.setParent(m)}}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}for(var k=0;k<this._NotifyList.length;k++){this._NotifyList[k].notifyChildrenChanged()}t.forceRedraw()}},{key:"reset",value:function(){this._RemoveList=[],this._AddList=[],this._NotifyList=[]}},{key:"undo",value:function(e){this.reset();for(var t=0;t<this._HistoryList.length;t++){var n=this._HistoryList[t];this.changeChildren(n.item,n.to,n.from)}this.commitChanges(e)}},{key:"redo",value:function(e){this.reset();for(var t=0;t<this._HistoryList.length;t++){var n=this._HistoryList[t];this.changeChildren(n.item,n.from,n.to)}this.commitChanges(e)}}]),e}(),Se=(ge((r=function(e){function t(){be(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._Artboards=new c.default(e),e._Assets=[],e._AssetFolder=new W.default,e._TempAssetLookup=null,e._AssetsUpdated=!1,e._NodeLookup={},e._WhenNodesLoadedActions=null,e._IsTimeTraveling=!1,e._ForceRedraw=!1,e._LastFullState=new Map,e._IsKeyStateDirty=!1,e._ChildrenChanged=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"onContextReady",value:function(e){this._Context=e;var t=this._ContextQueue;if(t){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){(0,i.value)(e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}}},{key:"getContext",value:function(e){this._Context?e(this._Context):(this._ContextQueue||(this._ContextQueue=[]),this._ContextQueue.push(e))}},{key:"notifyChildrenChanged",value:function(){this._ChildrenChanged=!0}},{key:"notifyAssetChildrenChanged",value:function(){this._AssetsUpdated=!0}},{key:"forceRedraw",value:function(){this._ForceRedraw=!0}},{key:"loadAssets",value:function(e){var t=this;return new Promise(function(n,r){var o=e;if(o){o instanceof Array&&(o={id:"folder-1",type:"folder",children:o});var i=new W.default;t._AssetFolder=i,i.read(t,o,function(){n(this)})}else n()})}},{key:"addArtboard",value:function(e){this._Artboards.add(e)}},{key:"completeRecurseLoad",value:function(){if(this._WhenNodesLoadedActions){var e=!0,t=!1,n=void 0;try{for(var r,o=this._WhenNodesLoadedActions[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){(0,r.value)()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this._WhenNodesLoadedActions=null}this.clearNodeLookup()}},{key:"loadHierarchy",value:function(e){var t=this;return new Promise(function(n,r){t.initNodeLookup();var o=null;if(e.root&&"node"==e.root.type){if(e.root.children){var i=t.addNodeType(d.default,null,{animations:e.animations},!0);i.name="Artboard",t.recurseLoad(e.root.children,i),t._Artboards.add(i,!0),i.makeMain(),i.makeActive(),o=i}}else if(e.artboards){var a=t.addNodeType(c.default,null,e.artboards,!0);a&&e.artboards.children&&t.recurseLoad(e.artboards.children,a),t._Artboards=a}t._Artboards.validate(),t.completeRecurseLoad(),t.advance(0),o&&setTimeout(function(){o.fitToContent()},20),t.getJournalEntry(),n()})}},{key:"load",value:function(e){return Promise.all([this.loadAssets(e.assets),this.loadHierarchy(e)])}},{key:"whenNodesLoaded",value:function(e){this._WhenNodesLoadedActions?this._WhenNodesLoadedActions.push(e):e()}},{key:"assetUpdated",value:function(){this._AssetsUpdated=!0,this._ChildrenChanged=!0}},{key:"assetNeedsRuntimeAsset",value:function(e){this.dispatch("assetNeedsRuntimeAsset",e)}},{key:"cleanup",value:function(){var e=this;this._AssetFolder.all(function(t){e.removeAssetListeners(t)})}},{key:"addAssets",value:function(e,t){for(var n=0;n<e.length;n++)this.addAsset(e[n],!0);t||(this.dispatch("assetListChanged"),this.dispatch("revise"))}},{key:"removeAssetListeners",value:function(e){e.removeEventListener("update",this.assetUpdated)}},{key:"addAssetListener",value:function(e){this.removeAssetListeners(e),e.addEventListener("update",this.assetUpdated)}},{key:"addAsset",value:function(e,t){e.parent||this._AssetFolder.add(e);var n=this;e.all(function(e){n.addAssetListener(e)}),t||(this.dispatch("assetListChanged"),this.dispatch("revise"))}},{key:"removeAsset",value:function(e){e.parent&&e.parent.remove(e),e.isSelected=!1,this.removeAssetListeners(e),this.dispatch("assetListChanged")}},{key:"removeNonNodes",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];switch(n.constructor){case ye.default:this.removeAnimation(n);break;default:this.removeAsset(n)}}}},{key:"removeAssets",value:function(e){for(var t=0;t<e.length;t++){switch(e[t].constructor){case B.default:case V.default:case z.default:case N.default:case W.default:case H.default:this.removeAsset(e[t])}}}},{key:"serialize",value:function(e,t){return{artboards:this._Artboards.serialize(e),assets:this._AssetFolder.serialize().children}}},{key:"isStable",value:function(){var e=this._Artboards.children,t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(!o.value.isStable)return!1}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return!0}},{key:"recurseLoad",value:function(e,n,r){for(var o=0;o<e.length;o++){var i=e[o],a=null;if(i.type&&(a=t.registeredNodes[i.type])){a.ctr!==d.default||n instanceof c.default||(n=this._Artboards);var s=this.addNodeType(a.ctr,n,i);s&&i.children&&this.recurseLoad(i.children,s),r&&s&&r.push(s)}}}},{key:"addTempAssetLookup",value:function(e,t){this._TempAssetLookup&&this._TempAssetLookup.set(e,t)}},{key:"getAsset",value:function(e){var t=null;return this._TempAssetLookup&&(t=this._TempAssetLookup.get(e))?t:(this._AssetFolder.all(function(n){if(n.id===e)return t=n,!1}),t)}},{key:"getAssetWithRefId",value:function(e){var t=null;return this._AssetFolder.all(function(n){if(n.refId===e)return t=n,!1}),t}},{key:"getAssetTypeNamed",value:function(e,t){var n=null;return this._AssetFolder.all(function(r){if(r instanceof e&&r.name===t)return n=r,!1}),n}},{key:"getNodeWithRefId",value:function(e){var t=this._NodeLookup,n=null;return t&&(n=t[e])?n:(this._Artboards.eachChildRecursive(function(t){if(t.refId==e)return n=t,!1}),n)}},{key:"isAssetUsed",value:function(e){if(e.constructor!==N.default)return!0;var t=!1;return this._Artboards.eachChildRecursive(function(n){if(void 0!==n.asset&&n.asset===e)return t=!0,!1}),t}},{key:"updateGraph",value:function(){var e=this._Artboards._Children,t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.updateGraph()&&(this._ForceRedraw=!0)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"advance",value:function(e,t,n,r){var o=this._ForceRedraw;this._ForceRedraw=!1;var i=this._Artboards._Children,a=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;d.advance(e,t&&t.root===d?t:null,n,r)&&(o=!0)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}return this._ChildrenChanged&&(this._ChildrenChanged=!1,this.dispatch("childrenChanged",this)),this._AssetsUpdated&&(this._AssetsUpdated=!1,o=!0),o}},{key:"initNodeLookup",value:function(){this._WhenNodesLoadedActions=[],this._NodeLookup={};var e=this;this.getNode=function(t){return e._NodeLookup[t]}}},{key:"registerNodeLookup",value:function(){this.initNodeLookup();var e=this._NodeLookup;this._Artboards.eachChildRecursive(function(t){t&&t.refId&&(e[t.refId]=t)})}},{key:"clearNodeLookup",value:function(){this._NodeLookup=null,delete this.getNode}},{key:"addNodeType",value:function(e,n,r,o,i){!n||n instanceof X.default||(console.warn("Actor.addNodeType tried to parent to a non-container, will parent to "+(o?"null":"root")+" instead."),n=null);var a=t.registeredNodeTypes.get(e);if(!a)return null;n||o||(n=this._Artboards.active);var s=new a.ctr(this);if(r&&s.read(this,r),n){if(!n.add(s,!1,i)){if(void 0===s.constructor.promote)return null;if(!s.constructor.promote(this,n,r).add(s,!1,i))return null}this._Graph&&s.updateDependencies(this._Graph),s.onAddedToActor()}return this._NodeLookup&&(this._NodeLookup[s.refId]=s),a.stageCtr&&(s.stageItem=new a.stageCtr(s),r&&!0===r.locked&&(s.stageItem.isLocked=!0)),s}},{key:"pasteSVG",value:function(e,n){var r=t.registeredImporterForExtensions.svg;if(r){var o=new Worker(ve.default.getWorkerScript(r.entry)),i=this;o.onmessage=function(e){this.terminate(),i.import(e.data,n)},o.postMessage(e)}}},{key:"importFiles",value:function(e,n,r){for(var o=this,i=0,a=0;a<e.length;a++){var s=e[a],l=s.name,u=l.lastIndexOf(".");if(-1!=u){var c=l.substr(u+1).toLowerCase(),d=t.registeredImporterForExtensions[c];if(d){i++;var f=new Worker(ve.default.getWorkerScript(d.entry));f.onmessage=function(e){this.terminate(),o.import(e.data,n),--i<=0&&r(!0)},f.postMessage(s)}}}0===i&&r(!1)}},{key:"import",value:function(e,n){this.initNodeLookup();var r=[],o=!1,i=this._Artboards.active;if(e.assets){this._TempAssetLookup=new Map;for(var a=0;a<e.assets.length;a++){var s=e.assets[a],l=t.registeredAssets[s.type];if(l&&(!this.getAsset(s.id)||s.generateNewId)){var u=new l.ctr(this);u.read(this,s),this.addAsset(u),o=!0}}}if(e.nodes||e.artboards){var c=[],f=e.artboards&&e.artboards.children||e.nodes,h=e.artboards?this._Artboards:i;if(n&&!e.artboards){var p=n.selectedItems,y=null,v=!0,m=!1,g=void 0;try{for(var b,k=p[Symbol.iterator]();!(v=(b=k.next()).done);v=!0){var S=b.value;if(null!==y&&S.node!==y){y=null;break}y=S.node}}catch(e){m=!0,g=e}finally{try{!v&&k.return&&k.return()}finally{if(m)throw g}}if(y&&(h=y),e.nodes&&h){var O=!0,w=!1,_=void 0;try{for(var P,C=e.nodes[Symbol.iterator]();!(O=(P=C.next()).done);O=!0){var E=P.value;E.id===h.refId&&E.type===h.constructor.registeredActorName&&E.name===h.name&&h.parent&&(h=h.parent)}}catch(e){w=!0,_=e}finally{try{!O&&C.return&&C.return()}finally{if(w)throw _}}}if(e.nodes&&null===h){var T=e.dimensions,I=this.addNodeType(d.default,null,T?{width:T.width,height:T.height,origin:[T.originX,T.originY]}:{},!0);I.name="Artboard",n&&I.stageItem.addToStage(n),this._Artboards.add(I,!0),I.makeMain(),I.makeActive(),h=I}}e:for(;null!==h;){for(var j=0;j<f.length;j++){var A=f[j],D=null;if(A.type&&(D=t.registeredNodes[A.type])&&!U.default.isRelationshipValid(h.constructor,D.ctr)&&!U.default.isRelationshipValid(h.constructor,D.ctr.promoteType)){h=h.parent;continue e}}break}if(!h)return[];this.recurseLoad(f,h),r.push.apply(r,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Object.values(this._NodeLookup).slice())),n&&(h.eachChildRecursive(function(e){var t=e.stageItem;if(!t)return[];!t.stage&&t.isAutomatic&&(t.addToStage(n),e.parent===h&&c.push(t))}),n.selectItems(c))}for(var R in this._TempAssetLookup=null,this._NodeLookup)this._NodeLookup[R].newRefId();e.animations&&this._Artboards.active.importAnimations(e.animations);return this.completeRecurseLoad(),o&&this.dispatch("assetListChanged"),o&&this.dispatch("revise"),r}},{key:"makeAssetWithWorker",value:function(e,n){var r=this,o=new Worker(ve.default.getWorkerScript(n));return new Promise(function(i,a){o.onmessage=function(o){if(o.data.error)a(new Error(n+" failed to make an asset from file "+e.name));else{var s=o.data,l=t.registeredAssets[s.type];if(l){var u=new l.ctr(r);u.read(r,s,function(){i(u)})}else a(new Error(n+" returned an unknown asset type "+l+" for file "+e.name))}},o.postMessage(e)})}},{key:"makeAsset",value:function(e,n){L.default.isPrototypeOf(n)&&(n=t.registeredAssetTypes.get(n));var r=e.lastIndexOf(".");if(-1!=r&&(e=e.substr(0,r)),!n&&-1!=r){var o=e.substr(r+1).toLowerCase();n=t.registeredAssetExtensionToType[o]}if(!n)return null;var i=new n.ctr(this);return i.read(this,{name:e,id:null,type:n.mime}),i}},{key:"makeAssetWithType",value:function(e,t){var n=this.makeAsset(e.name,t);return n?new Promise(function(t,r){n.file=e,n.fromFile(e,function(){t(n)})}):Promise.reject(new Error("Could not find an asset type for file with name "+e.name))}},{key:"stopAnimations",value:function(){var e=this._Artboards.children,t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.stopAnimations()}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"makeImageSequenceAsset",value:function(e){var n=new B.default;n.file=2,n.name=e.name;for(var r=[],o=e.items,i=0;i<o.length;i++){var a=o[i],s=t.registeredAssets[a.type];if(!s){var l=a.name.toLowerCase();s=t.registeredAssetExtensionToType[l]}r.push(this.makeAssetWithType(o[i],s))}return new Promise(function(e,t){Promise.all(r).then(function(r){for(var o=0;o<r.length;o++){var i=r[o];i instanceof N.default&&n.add(i,!0)}n.children.length>0?e(n):t(new Error("Sequence named "+n.name+" created with no frames."))})})}},{key:"makeAssets",value:function(e){for(var n=[],r=[],o=0;o<e.length;o++){var i=e[o];if(1===i.items.length){var a=i.items[0],s=a.name,l=s.lastIndexOf(".");if(-1!=l){var u=s.substr(l+1).toLowerCase(),c=t.registeredAssetExtensionToType[u];c?c.workerScript?r.push(this.makeAssetWithWorker(a,c.workerScript)):r.push(this.makeAssetWithType(a,c)):n.push(a)}}else r.push(this.makeImageSequenceAsset(i))}return new Promise(function(e,t){Promise.all(r).then(function(t){e({assets:t,unprocessed:n})}).catch(function(e){console.warn(e),t(e)})})}},{key:"revise",value:function(){this.dispatch("revise")}},{key:"getJournalEntry",value:function(){var e=new Map,t=[];this._Artboards.all(function(n){var r={item:n,entry:n.serializeHistory()};t.push(r),e.set(n,r)}),this._AssetFolder.all(function(n){var r={item:n,entry:n.serializeHistory()};t.push(r),e.set(n,r)});var n=[],r=null,o=this._LastFullState,i=!0,a=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value,f=d.item,h=d.entry,p=o.get(f);if(p){p=p.entry;var y=h;for(var v in y){var m=!0,g=y[v],b=p[v];if(void 0!==g&&void 0!==b){if(null===g)m=g===b;else switch(g.constructor){case F.default:if(!b||g.id!==b.id){n.push(new s.default(f,v,b,g));continue}break;case Boolean:case Number:case String:g!==b&&(m=!1);break;case Array:case Uint16Array:case Float32Array:if(b&&g.length===b.length){for(var k=0;k<g.length;k++)if(g[k]!==b[k]){m=!1;break}}else m=!1;break;default:g!=b&&(m=!1)}if(!m)if("children"==v){r||(r=new ke(this),n.push(r)),r.add(f,b,g);for(var S=0;S<b.length;S++){var O=b[S];if(-1==g.indexOf(O)){if(e.has(O))continue;var w={item:O,entry:O.serializeHistory()};t.push(w),e.set(O,w)}}}else n.push(new s.default(f,v,b,g))}}}}}catch(e){a=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw l}}return r&&r.processChanges(),n.length&&this.dispatch("revise"),this._LastFullState=e,n}},{key:"dependencyGraph",get:function(){return this._DependencyGraph}},{key:"artboards",get:function(){return this._Artboards}},{key:"activeArtboard",get:function(){return this._Artboards.active}},{key:"isTimeTraveling",get:function(){return this._IsTimeTraveling},set:function(e){this._IsTimeTraveling=e}},{key:"useAnimationValues",set:function(e){var t=this._Artboards.children,n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.eachChildRecursive(function(t){t.useAnimationValues=e}),s.drawOrder.forceUpdate()}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}},{key:"unprocessedAssets",get:function(){var e=[];return this._AssetFolder.eachChildRecursive(function(t){t.id||e.push(t)}),e}},{key:"assets",get:function(){return this._Assets}},{key:"assetFolder",get:function(){return this._AssetFolder}},{key:"hasPlayingAnimations",get:function(){var e=this._Artboards.children,t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(o.value.hasPlayingAnimations)return!0}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return!1}},{key:"isLoadingBitmaps",get:function(){var e=!1;return this._AssetFolder.all(function(t){if((t instanceof N.default||t instanceof V.default)&&!t.bitmap)return e=!0,!1}),e}},{key:"isMissingBitmaps",get:function(){var e=!1;return this._AssetFolder.all(function(t){if((t instanceof N.default||t instanceof V.default)&&t.isMissing)return e=!0,!1}),e}}]),t}()).prototype,"assetUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"assetUpdated"),r.prototype),ge(r.prototype,"assetNeedsRuntimeAsset",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"assetNeedsRuntimeAsset"),r.prototype),ge(r.prototype,"makeAssets",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"makeAssets"),r.prototype),r);t.default=Se,Se.registeredNodes={},Se.registeredNodeTypes=new Map,Se.registeredImporterForExtensions={},Se.registerImporter=function(e,t){for(var n={entry:t},r=0;r<e.length;r++){var o=e[r].toLowerCase();Se.registeredImporterForExtensions[o]=n}},Se.registerNodeType=function(e,t,n){t.registeredActorName=e;var r=Se.registeredNodes[e]={ctr:t,stageCtr:n||null,name:e};Se.registeredNodeTypes.set(t,r)},Se.registeredAssets={},Se.registeredAssetTypes=new Map,Se.registeredAssetExtensionToType={},Se.registerAsset=function(e,t,n,r){var o={ctr:n,ext:t,mime:e,workerScript:r};Se.registeredAssets[e]=o,Se.registeredAssetTypes.set(n,o);for(var i=0;i<t.length;i++){var a=t[i];Se.registeredAssetExtensionToType[a]=o}},Se.getAssetTypeExtensions=function(e){var t=[];for(var n in Se.registeredAssets){var r=Se.registeredAssets[n];r.ctr===e&&(t=t.concat(r.ext))}return t},Se.getAssetTypeMimes=function(e){var t=[];for(var n in Se.registeredAssets){var r=Se.registeredAssets[n];r.ctr===e&&(t=t.concat(r.mime))}return t},Se.getImageExtensions=function(){return Se.getAssetTypeExtensions(N.default)},Se.getImageMimeTypes=function(){return Se.getAssetTypeMimes(N.default)},Se.registerImporter(["zip"],"FlareZipImporter.js"),Se.registerImporter(["flr2d"],"FlareZipImporter.js"),Se.registerImporter(["nma2d"],"FlareZipImporter.js"),Se.registerNodeType("artboards",c.default,J.default),Se.registerNodeType("component",U.default,J.default),Se.registerNodeType("solo",_.default,J.default),Se.registerNodeType("node",w.default,J.default),Se.registerNodeType("image",l.default,q.default),Se.registerNodeType("artboard",d.default,Q.StageArtboard),Se.registerNodeType("shape",u.default,Z.default),Se.registerNodeType("colorFill",f.ColorFill,$.StageColorFill),Se.registerNodeType("gradientFill",f.GradientFill,$.StageLinearGradient),Se.registerNodeType("radialGradientFill",f.RadialGradientFill,$.StageRadialGradient),Se.registerNodeType("colorStroke",f.ColorStroke,$.StageColorStroke),Se.registerNodeType("gradientStroke",f.GradientStroke,$.StageLinearGradient),Se.registerNodeType("radialGradientStroke",f.RadialGradientStroke,$.StageRadialGradient),Se.registerNodeType("path",h.default,ee.default),Se.registerNodeType("rectangle",p.default,ee.default),Se.registerNodeType("ellipse",y.default,ee.default),Se.registerNodeType("polygon",v.default,ee.default),Se.registerNodeType("star",m.default,ee.default),Se.registerNodeType("triangle",g.default,ee.default),Se.registerNodeType("point",b.default,te.default),Se.registerNodeType("meshPoint",k.default,ne.default),Se.registerNodeType("meshDeformPoint",S.default,ne.default),Se.registerNodeType("meshEdge",O.default,re.default),Se.registerNodeType("bone",C.default,oe.default),Se.registerNodeType("jellyBone",E.default,ie.default),Se.registerNodeType("ikConstraint",j.default,le.default),Se.registerNodeType("transformConstraint",A.default,ue.default),Se.registerNodeType("distanceConstraint",D.default,ce.default),Se.registerNodeType("translationConstraint",R.default,de.default),Se.registerNodeType("scaleConstraint",M.default,fe.default),Se.registerNodeType("stageConstraint",x.default,he.default),Se.registerNodeType("jelly",T.default,T.default.StageItem),Se.registerNodeType("skin",I.default,I.default.StageItem),Se.registerNodeType("customProperty",K.default,ae.default),Se.registerNodeType("event",G.default,se.default),Se.registerNodeType("rootBone",Y.default,pe.default),Se.registerAsset("image/svg",["svg"],H.default,"SvgImporter.js"),Se.registerAsset("image/layered",["psd"],z.default,"PsdImporter.js"),Se.registerAsset("image/sequence",[],B.default),Se.registerAsset("image/raw",[],N.default),Se.registerAsset("image/png",["png"],N.default),Se.registerAsset("image/jpg",["jpg","jpeg"],N.default),Se.registerAsset("folder",[],W.default),U.default.setValidParents(d.default,[c.default]),U.default.setValidParents(w.default,[d.default,w.default,_.default,Y.default,C.default,E.default,l.default]),U.default.setValidParents(h.default,[u.default]),U.default.setValidParents(P.default,[u.default]),U.default.setValidParents(b.default,[h.default]),U.default.setValidParents(k.default,[l.default]),U.default.setValidParents(S.default,[l.default]),U.default.setValidParents(O.default,[l.default]),U.default.setValidParents(j.default,[C.default]),U.default.setValidParents(f.ActorPaint,[u.default]),U.default.setValidParents(I.default,[h.default,l.default])},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){var t=o(n(26)),r=o(n(633));function o(e){return e&&e.__esModule?e:{default:e}}(0,t.default)(e,r.default,!0)}).call(this,n(165)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Math.pow(2,Math.round(Math.log(e)/Math.log(2)))}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(168)),a=n(7),s=c(n(2)),l=c(n(642)),u=c(n(647));function c(e){return e&&e.__esModule?e:{default:e}}var d,f,h,p,y,v,m=[1,1,1,.8],g=[1,1,1,.2],b=[1,1,1,1],k=(r=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,null));return e.drawAfterSelections=!0,e.isHandle=!0,e.hitDetectOnMesh=!1,e.isSelectable=!1,e._VertexBuffer=null,e._IndexBuffer=null,e._IsInEditingPosition=!1,e._ResetEditingPosition=!1,e._Feather=50,e._Strength=1,e._Size=100,e._Recalculate=!0,e._InnerRadius=e._Size-e._Feather,e._InnerLine,e._OuterLine,e._ShadowTexture,e._InnerShadowVB,e._InnerShadowIB,e._Mode=t.Mode.Add,e._Influence=null,e._IsWaitingForVerts=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"customHitDetect",value:function(e,t){return!1}},{key:"makeBrush",value:function(e){var t=this._InnerRadius,n=this._Size,r=[],o=[],i=[],a=[];if(t>0){for(var s=Math.round(10*Math.sqrt(t)),u=2*Math.PI/s,c=0,d=2*s,f=0,h=0;h<s;h++){var p=Math.cos(c),y=Math.sin(c),v=p*t,m=y*t;r.push([v,m]);var g=Math.max(0,t-5),b=t+5;o.push(p*g,y*g,.0625,0),o.push(p*b,y*b,1,0),i.push(f,f+1,(f+3)%d),i.push(f,(f+3)%d,(f+2)%d),f+=2,c+=u}r.length?(this._InnerLine=e.makeThickLine(r,!0),this._InnerShadowVB?(this._InnerShadowVB.update(o),this._InnerShadowIB.update(i)):(this._InnerShadowVB=e.makeVertexBuffer(o),this._InnerShadowIB=e.makeIndexBuffer(i))):this._InnerLine=null}else this._InnerLine=null;if(t!==n){for(var k=Math.round(10*Math.sqrt(n)),S=2*Math.PI/k,O=0,w=0;w<k;w++){var _=Math.cos(O)*n,P=Math.sin(O)*n;a.push([_,P]),O+=S}a.length?this._OuterLine=e.makeThickLine(a,!0):this._OuterLine=null}else this._OuterLine=null;if(!this._ShadowTexture){for(var C=new Uint8Array(64),E=0,T=0;T<16;T++)C[E++]=0,C[E++]=0,C[E++]=0,C[E++]=Math.round(255*Math.pow(1-Math.abs(1-T/8),3)*.3);this._ShadowTexture=e.loadBitmapTexture({width:16,height:1,bytes:C,channels:4},l.default.ClampToEdge)}}},{key:"draw",value:function(e,t){this._Recalculate&&(this.makeBrush(e),this._Recalculate=!1);var n=this.renderViewTransform;if(this._IsInEditingPosition){var r=this.stage;if(this._ResetEditingPosition&&r.isMouseOver)this._IsInEditingPosition=!1,this._ResetEditingPosition=!1;else{var o=a.mat2d.clone(r.viewTransform),s=a.mat2d.invert(o,o),l=r.getVisibleStageArea(),u=a.vec2.transformMat2d(a.vec2.create(),[l.left+this._Size*r.scale,l.height-this._Size*r.scale],s);n=a.mat2d.mul(i.default._RenderViewTransform,r.viewTransform,a.mat2d.fromTranslation(a.mat2d.create(),u))}}if(this._InnerLine&&(e.drawTextured(n,this._InnerShadowVB,this._InnerShadowIB,Math.min(1,Math.max(.25,1/this.stage.scale)),b,this._ShadowTexture),e.drawThickLine(n,this._InnerLine,1/this.stage.scale,1,m)),this._OuterLine&&e.drawThickLine(n,this._OuterLine,1/this.stage.scale,1,g),this._Influence){e.enableNormalBlending();var c=this.stage.appContext.editingWeights;if(c)for(var d=a.mat2d.create(),f=this.stage,h=f.viewTransform,p=1/f.scale,y=a.mat2d.fromScaling(a.mat2d.create(),[p,p]),v=this.stageContext,k=c.verts,S=c.showDeformed?null:c.node.worldTransform,O=this._Influence.index,w=this._Influence.weights,_=v.vertexTargetImage,P=a.vec2.create(),C=0;C<O.length;C++){var E=4*O[C],T=k[E],I=k[E+1]-2*p;S?a.vec2.transformMat2d(P,[T,I],S):(P[0]=T,P[1]=I);var j=a.mat2d.fromTranslation(d,P);a.mat2d.mul(j,j,y);var A=a.mat2d.mul(d,h,j);e.drawTextured(A,v.vertexBuffer,v.indexBuffer,Math.min(1,.9*w[C]+.1),b,_,!0)}}}},{key:"updateWeightedVertices",value:function(){if(!this._IsWaitingForVerts)if(this.stage){var e=this.position;if(this.stage.appContext.editingWeights){var t=this;this._IsWaitingForVerts=!0,u.default.call("fbv",[e[0],e[1],this._InnerRadius,this._Size],function(e){t._IsWaitingForVerts=!1,t._Influence=e,t.stage&&t.stage.redraw()})}}else{var n=new Error;console.log("TRYING TO PAINT WHERE WE SHOULDN'T",n.stack)}}},{key:"influence",get:function(){return this._Influence}},{key:"position",get:function(){return a.mat2d.getTranslation(a.vec2.create(),this.renderTransform)},set:function(e){this._IsWaitingForVerts||(this.renderTransform=a.mat2d.fromTranslation(a.mat2d.create(),e),this.updateWeightedVertices())}},{key:"mode",get:function(){return this._Mode},set:function(e){this._Mode!=e&&(this._Mode=e)}},{key:"size",get:function(){return this._Size},set:function(e){this._Size!=e&&(this._Size=Math.max(0,e),this._InnerRadius=Math.max(0,Math.min(this._Size,this._Size-this._Feather)),this._Recalculate=!0,this.stage&&this.stage.redraw())}},{key:"isInEditingPosition",get:function(){return this._IsInEditingPosition},set:function(e){this._IsInEditingPosition!=e&&(e?(this._ResetEditingPosition=!1,this._IsInEditingPosition=e):this._ResetEditingPosition=!0,this.stage&&this.stage.redraw())}},{key:"feather",get:function(){return this._Feather},set:function(e){this._Feather!=e&&(this._Feather=Math.max(0,Math.min(this._Size,e)),this._InnerRadius=Math.max(0,Math.min(this._Size,this._Size-this._Feather)),this._Recalculate=!0,this.stage&&this.stage.redraw())}},{key:"strength",get:function(){return this._Strength},set:function(e){e=Math.min(1,Math.max(0,e)),this._Strength!=e&&(this._Strength=e)}}]),t}(),d=r.prototype,f="updateWeightedVertices",h=[s.default],p=Object.getOwnPropertyDescriptor(r.prototype,"updateWeightedVertices"),y=r.prototype,v={},Object.keys(p).forEach(function(e){v[e]=p[e]}),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=h.slice().reverse().reduce(function(e,t){return t(d,f,e)||e},v),y&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(y):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(d,f,v),v=null),r);t.default=k,k.initializeStageContext=function(e,t){t.vertexTargetImage=e.loadTexture("/static/images/vertex_paint_target.png",l.default.MultiplyAlpha);var n=[-8.5,-8.5,0,1,8.5,-8.5,1,1,8.5,8.5,1,0,-8.5,8.5,0,0],r=[-8.5,-8.5,8.5,-8.5,8.5,8.5,-8.5,8.5],o=[0,1,2,2,3,0];t.vertexBuffer=e.makeVertexBuffer(n),t.cVertexBuffer=e.makeVertexBuffer(r),t.indexBuffer=e.makeIndexBuffer(o),t.points=n,t.index=o},k.Mode={Add:0,Subtract:1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=l(n(266)),i=l(n(265)),a=n(7),s=l(n(17));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Jellies=t;for(var n=this._WorldPositions=new Array(t.length),r=0;r<t.length;r++){var o=t[r];n[r]=a.vec2.clone(o.worldPosition)}}return r(e,[{key:"advance",value:function(e,t){for(var n=this._WorldPositions,r=this._Jellies,o=0;o<r.length;o++){var l=r[o],u=l.node,c=u.jelly,d=n[o];a.vec2.add(d,d,t);var f=l.isIn,h=f?a.vec2.create():a.vec2.set(a.vec2.create(),u.length,0),p=f?c.inDirection:c.outDirection,y=c.unitControlLength;p=a.vec2.scale(a.vec2.create(),p,2*y);var v=a.vec2.add(a.vec2.create(),h,p),m=a.vec2.transformMat2d(a.vec2.create(),h,u.renderTransform),g=a.vec2.transformMat2d(a.vec2.create(),v,u.renderTransform),b=a.mat2d.invert(a.mat2d.create(),u.renderTransform);if(!b)return void s.default.warn("Failed to invert transform space",u.renderTransform);var k=i.default.pointOnSegment(g,m,d[0],d[1]).point,S=a.vec2.transformMat2d(a.vec2.create(),k,b),O=a.vec2.length(a.vec2.subtract(a.vec2.create(),S,h))/y;f?c.easeIn=O:c.easeOut=O}}},{key:"complete",value:function(){}}]),e}();t.default=u,u.make=function(e,t){for(var n=[],r=0;r<t.length;r++){var i=t[r];if(i.node)switch(i.constructor){case o.default:n.push(i)}}if(0!=n.length)return new u(n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(334),i=n(7);var a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Stage=t;var r=[],o=!0,i=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value;u.end&&r.push(u.end),r.push(u)}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}this._Vertices=r}return r(e,[{key:"advance",value:function(e,t,n,r){for(var o=i.vec2.create(),a=0;a<this._Vertices.length;a++){var s=this._Vertices[a];s.worldTranslation=i.vec2.add(o,s.worldTranslation,t)}}},{key:"complete",value:function(){}}]),e}();t.default=a,a.make=function(e,t){for(var n=[],r=0;r<t.length;r++){var i=t[r];i instanceof o.StageGradientPoint&&n.push(i)}if(0!=n.length)return new a(e.stage,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Graph=new Map,this._Root=t,this._Order=null,this._DirtMask=null,this._IsDirty=!1,this._DirtDepth=0,this._IsExceeding=!1}return o(e,[{key:"addDependency",value:function(e,t){var n=this._Graph,r=n.get(t);return r||(r=[],n.set(t,r)),-1===r.indexOf(e)&&(r.push(e),!0)}},{key:"removeDependency",value:function(e,t){var n=this._Graph.get(t);if(!n)return!1;var r=n.indexOf(e);return-1!==r&&(n.splice(r,1),this.sort(),!0)}},{key:"remove",value:function(e){var t=this._Graph;t.delete(e);var n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)for(var l=a.value,u=r(l,2),c=(u[0],u[1]),d=0;d<c.length;d++)c[d]===e&&(c.splice(d,1),d--)}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return this.sort(),!0}},{key:"sort",value:function(){var e=this._Graph,t=new Set,n=new Set,r=[];if(!function o(i){if(t.has(i))return!0;if(n.has(i))return!1;n.add(i);var a=e.get(i);if(a){var s=!0,l=!1,u=void 0;try{for(var c,d=a[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)if(!o(c.value))return!1}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}return t.add(i),r.unshift(i),!0}(this._Root))return console.warn("Dependency cycle detected."),!1;this._Order=r;var o=new Uint8Array(r.length);o.fill(255),this._DirtMask=o;for(var i=0;i<r.length;i++){r[i]._GraphOrder=i}return this._IsDirty=!0,!0}},{key:"addDirtRecursive",value:function(e,t){this.addDirt(e,t,!0)}},{key:"addDirtToDependents",value:function(e,t){var n=this._Graph.get(e);if(n){var r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;this.addDirt(l,t,!0)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}}}},{key:"getDependents",value:function(e){return this._Graph.get(e)}},{key:"getDirt",value:function(e){var t=e._GraphOrder;return this._DirtMask[t]}},{key:"addDirt",value:function(e,t,n){if(this._DirtMask){var r=e._GraphOrder,o=this._DirtMask[r];if((o&t)===t)return!1;var i=this._Graph;if(o|=t,this._IsDirty=!0,this._DirtMask[r]=o,e.onDirty(o),r<this._DirtDepth&&(this._DirtDepth=r),!n)return!0;var a=i.get(e);if(a){var s=!0,l=!1,u=void 0;try{for(var c,d=a[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;this.addDirt(f,t,n)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}return!0}}},{key:"subUpdate",value:function(e){if(!this._IsDirty)return!1;for(var t=this._DirtMask,n=this._Order,r=0;r<=e._GraphOrder;r++){var o=t[r];if(0!==o){var i=n[r];t[r]=0,i.update(this,o)}}}},{key:"update",value:function(){if(!this._IsDirty)return!1;for(var e=this._Order,t=e.length,n=this._DirtMask,r=0;this._IsDirty&&r<100;){this._IsDirty=!1;for(var o=0;o<t;o++){this._DirtDepth=o;var i=n[o];if(0!==i){var a=e[o];if(n[o]=0,a.update(this,i),this._DirtDepth<o)break}}r++}return r>=100?this._IsExceeding||(this._IsExceeding=!0,console.warn("Exceeded max steps.")):this._IsExceeding&&(this._IsExceeding=!1,console.warn("No longer exceeding max steps.")),!0}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(18)),a=l(n(2)),s=l(n(651));function l(e){return e&&e.__esModule?e:{default:e}}var u,c,d,f,h,p,y=(r=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._Drawables=[],e._IsDrawOrderDirty=!1,e._ChildrenChanged=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"onDrawOrderChange",value:function(){this._IsDrawOrderDirty=!0}},{key:"forceUpdate",value:function(){this.onDrawOrderChange()}},{key:"advance",value:function(){var e=!1;return this._ChildrenChanged&&(this.dispatch("childrenChanged"),e=!0,this._ChildrenChanged=!1),this._IsDrawOrderDirty&&((0,s.default)(this._Drawables,function(e,t){return e.drawOrder-t.drawOrder}),this.dispatch("childrenChanged"),e=!0,this._IsDrawOrderDirty=!1),e}},{key:"addDrawable",value:function(e){return-1===this._Drawables.indexOf(e)&&(e.addEventListener("drawOrderChange",this.onDrawOrderChange),e.rigDrawOrder||(e.rigDrawOrder=this.maxDrawOrder+1),this._Drawables.push(e),(0,s.default)(this._Drawables,function(e,t){return e.rigDrawOrder-t.rigDrawOrder}),this._ChildrenChanged=!0,!0)}},{key:"updateDrawOrder",value:function(){(0,s.default)(this._Drawables,function(e,t){return e.rigDrawOrder-t.rigDrawOrder});for(var e=0;e<this._Drawables.length;e++)this._Drawables[e].rigDrawOrder=e+1}},{key:"removeDrawable",value:function(e){var t=this._Drawables.indexOf(e);return-1!==t&&(e.removeEventListener("drawOrderChange",this.onDrawOrderChange),this._Drawables.splice(t,1),this._ChildrenChanged=!0,!0)}},{key:"uiHierIconClass",get:function(){return"HierarchyOrderIcon"}},{key:"uiIcon",get:function(){return"icon-order"}},{key:"drawables",get:function(){return this._Drawables}},{key:"hierarchyChildren",get:function(){return this._Drawables.slice(0).reverse()}},{key:"maxDrawOrder",get:function(){for(var e=0,t=0;t<this._Drawables.length;t++)e=Math.max(e,this._Drawables[t].rigDrawOrder);return e}}]),t}(),u=r.prototype,c="onDrawOrderChange",d=[a.default],f=Object.getOwnPropertyDescriptor(r.prototype,"onDrawOrderChange"),h=r.prototype,p={},Object.keys(f).forEach(function(e){p[e]=f[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=d.slice().reverse().reduce(function(e,t){return t(u,c,e)||e},p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(u,c,p),p=null),r);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(229),i=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(e,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));i._StageItem=r;for(var a=i._Actor.imageNodes.slice(0),s=i._StageItem.node.drawOrder,l=0;l<a.length;l++){var u=a[l];if(u.drawOrder===o){u.drawOrder=s;break}}i._StageItem.node.drawOrder=o,a.sort(function(e,t){return e.drawOrder===t.drawOrder?e.treeIndex-t.treeIndex:e.drawOrder-t.drawOrder});for(var c=0;c<a.length;c++){a[c].drawOrder=c+1}return i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){if(!t||t.constructor!==Object)return t;var n={};for(var r in t){var o=t[r];o?o.constructor===Object?n[r]=e(o):o.constructor===Array?n[r]=o.slice(0):n[r]=o:n[r]=o}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(n(7),i(n(203)),i(n(197)),i(n(198)),i(n(173)),i(n(351)));i(n(219)),i(n(195)),i(n(179)),i(n(17));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Modulation=t,this._CompensateBones=n,this._CompensateImages=r,this._Artboards=o}return r(e,[{key:"advance",value:function(e,t){for(var n=[t[0],-t[1]],r=.001*(n[0]+n[1]),o=0;o<this._Artboards.length;o++){var i=this._Artboards[o];i.width*=1+this._Modulation[0]*r,i.height*=1+this._Modulation[1]*r}}},{key:"complete",value:function(){}}]),e}();t.default=a,a.make=function(e,t){for(var n=[],r=0;r<t.length;r++){var i=t[r];i.node&&i.node.constructor===o.default&&n.push(i.node)}if(0!=n.length)return new a(e.snap?[1,1]:e.modulation,e.stage.settings.compensateBones,e.stage.settings.compensateImages,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7),i=u(n(522)),a=u(n(195)),s=u(n(176)),l=u(n(219));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,n,r,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._CompensateImages=t,this._Stage=n,this._TopJoint=r,this._IKJoints=s,this._TargetJoint=l,this._TransformMatrix=o.mat2d.create(),this._Target=new i.default,this._Target.addToStage(n);for(var u=this._TargetJoint;u.parentJoint;)u=u.parentJoint;a.default.transformChain(u);var c=this._TargetJoint.renderTransform;this._TransformMatrix[4]=c[4],this._TransformMatrix[5]=c[5],this._Target.renderTransform=this._TransformMatrix}return r(e,[{key:"advance",value:function(e,t){for(var n=this._TargetJoint;n.parentJoint;)n=n.parentJoint;a.default.transformChain(n);var r=this._Target.renderTransform;this._TransformMatrix[4]=r[4]+t[0],this._TransformMatrix[5]=r[5]+t[1],this._Target.renderTransform=this._TransformMatrix;for(var i=this._TargetJoint;i.parentJoint;){var s=i.parentJoint,l=o.mat2d.getTranslation(o.vec2.create(),i.renderTransform),u=o.mat2d.getTranslation(o.vec2.create(),s.renderTransform),c=o.vec2.subtract(o.vec2.create(),l,u);i.bone.ikWorldLength=o.vec2.length(c),i.bone.ikAngle=Math.atan2(c[1],c[0]);var d=s.node.worldTransform,f=o.mat2d.invert(o.mat2d.create(),d),h=o.vec2.transformMat2d(o.vec2.create(),u,f),p=o.vec2.transformMat2d(o.vec2.create(),l,f),y=o.vec2.subtract(o.vec2.create(),p,h);i.bone.localIkAngle=Math.atan2(y[1],y[0]),i=s}this._TargetJoint.renderTransform=this._TransformMatrix,i=this._TargetJoint;for(var v=[];i.parentJoint&&(v.push(i),i!=this._TopJoint);){var m=i.bone.ikWorldLength,g=i.parentJoint,b=o.mat2d.getTranslation(o.vec2.create(),i.renderTransform),k=o.mat2d.getTranslation(o.vec2.create(),g.renderTransform),S=o.vec2.subtract(o.vec2.create(),k,b);o.vec2.normalize(S,S),o.vec2.scale(S,S,m);var O=o.vec2.add(o.vec2.create(),b,S);this._TransformMatrix[4]=O[0],this._TransformMatrix[5]=O[1],g.renderTransform=this._TransformMatrix,i=g}for(var w=v.length-1;w>=0;w--){var _=v[w],P=_.bone.ikWorldLength,C=_.bone.stageItem.parentJoint,E=o.mat2d.getTranslation(o.vec2.create(),C.renderTransform);if(_!=this._TargetJoint&&-1==this._IKJoints.indexOf(_)){var T=0,I=0;if(C.bone.stageItem.parentJoint){var j=o.mat2d.getTranslation(o.vec2.create(),C.bone.stageItem.parentJoint.renderTransform),A=o.vec2.subtract(o.vec2.create(),E,j);I=Math.atan2(A[1],A[0])}T=I+_.bone.localIkAngle;var D=o.vec2.add(o.vec2.create(),E,[Math.cos(T)*P,Math.sin(T)*P]);this._TransformMatrix[4]=D[0],this._TransformMatrix[5]=D[1],_.renderTransform=this._TransformMatrix}else{var R=o.mat2d.getTranslation(o.vec2.create(),_.renderTransform),M=o.vec2.subtract(o.vec2.create(),R,E);o.vec2.normalize(M,M),o.vec2.scale(M,M,P);var x=o.vec2.add(o.vec2.create(),E,M);if(_.bone.constrainAngles&&void 0!==_.bone.minAngle){var F=Math.atan2(M[1],M[0]),L=0;if(C.bone.stageItem.parentJoint){var N=o.mat2d.getTranslation(o.vec2.create(),C.bone.stageItem.parentJoint.renderTransform),z=o.vec2.subtract(o.vec2.create(),E,N);L=Math.atan2(z[1],z[0])}var V=F-L;if(V<_.bone.minAngle||V>_.bone.maxAngle){var B=L+Math.min(_.bone.maxAngle,Math.max(V,_.bone.minAngle));x=o.vec2.add(o.vec2.create(),E,[Math.cos(B)*P,Math.sin(B)*P])}}this._TransformMatrix[4]=x[0],this._TransformMatrix[5]=x[1],_.renderTransform=this._TransformMatrix}}for(var H=v.length-1;H>=0;H--)a.default.align(v[H],this._CompensateImages)}},{key:"complete",value:function(){this._Target.removeFromStage()}}]),e}();t.default=c,c.make=function(e,t){for(var n=[],r=null,o=null,i=-1,u=0;u<t.length;u++){var d=t[u];d.constructor===s.default?-1==n.indexOf(d.joint)&&(d.joint.node.treeDepth>i&&(i=d.joint.node.treeDepth,o=d.joint),n.push(d.joint)):d.constructor===a.default&&d.bone&&d.bone.constructor!==l.default&&(r=d)}if(null==r){if(null==o)return;r=o}for(var f=n.slice(0),h=0;h<f.length;h++)for(var p=f[h].parentJoint;p;){if(p&&-1!=f.indexOf(p)){f.splice(h,1),h--;break}p=p.parentJoint}for(var y=0;y<f.length;y++){for(var v=f[y],m=r.parentJoint;m&&m!=v;)m=m.parentJoint;null==m&&(f.splice(y,1),y--)}return 0==f.length&&f.push(r),1!=f.length?null:null!=r.bone?new c(e.stage.settings.compensateImages,e.stage,f[0],n,r):void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(3));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"toggleCheck",value:function(){this.props.onValueChange&&this.props.onValueChange(!this.props.value,this.props.data)}},{key:"select",value:function(){this.props.onSelected&&this.props.onSelected(this.props.data)}},{key:"render",value:function(){return i.default.createElement("div",{className:this.props.isSelected?"CheckboxWrapper CheckboxWrapperSelected":"CheckboxWrapper",onClick:this.select},i.default.createElement("div",{className:"Checkbox",onClick:this.props.isSelectable?this.toggleCheck:null},i.default.createElement("svg",{className:"CheckboxCheck",style:{opacity:this.props.value?1:0}},i.default.createElement("use",{xlinkHref:s.default.make("/images/symbol-defs.svg#icon-check-small")}))),i.default.createElement("div",{className:"CheckboxLabel"},this.props.label),this.props.isCover?i.default.createElement("div",{className:"ShotCoverBadge"},"COVER"):null)}}]),t}()).prototype,"toggleCheck",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleCheck"),r.prototype),u(r.prototype,"select",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"select"),r.prototype),r);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.round(100*e)+"%"}},{key:"toInputValue",value:function(e){return Math.round(1e4*e)/100}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e);if(t<0)throw"Invalid input";return t/100}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"defaultValue",get:function(){return 1}},{key:"allowDrag",get:function(){return!0}},{key:"dragScale",get:function(){return.01}},{key:"dragMin",get:function(){return 0}},{key:"dragMax",get:function(){return 1}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.round(e)}},{key:"toInputValue",value:function(e){return e}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e);if(t<0||t>255)throw"Invalid input";return t}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"defaultValue",get:function(){return 255}},{key:"allowDrag",get:function(){return!0}},{key:"dragScale",get:function(){return.5}},{key:"dragMin",get:function(){return 0}},{key:"dragMax",get:function(){return 255}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.round(360*e)}},{key:"toInputValue",value:function(e){return Math.round(36e3*e)/100}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e);if(t<0||t>360)throw"Invalid input";return t/360}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"defaultValue",get:function(){return 1}},{key:"allowDrag",get:function(){return!0}},{key:"dragScale",get:function(){return 1/360/2}},{key:"dragMin",get:function(){return 0}},{key:"dragMax",get:function(){return 1}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Common:[{keys:["enter"],action:"toggle-edit-mode"},{keys:["p"],action:"pick-parent"},{keys:["`"],action:"switch-mode"},{keys:["h"],action:"hover-show-in-hierarchy"},{keys:["v"],action:"pen-tool"},{keys:[","],action:"previous-key-frame"},{keys:["."],action:"next-key-frame"},{keys:["k"],action:"key-selected"},{keys:["backspace"],action:"delete"},{keys:["delete"],action:"delete"},{keys:["esc"],action:"cancel"},{keys:["t"],action:"translate-tool"},{keys:["shift","t"],action:"key-selected-translation"},{keys:["c"],action:"draw-mesh-tool"},{keys:["c"],action:"select-children-tool"},{keys:["p"],action:"paint-weight-tool"},{keys:["r"],action:"rotate-tool"},{keys:["shift","r"],action:"key-selected-rotation"},{keys:["shift","l"],action:"key-selected-length"},{keys:["s"],action:"scale-tool"},{keys:["shift","s"],action:"key-selected-scale"},{keys:["x"],action:"ik-tool"},{keys:["w"],action:"vertex-weight-tool"},{keys:["b"],action:"bone-tool"},{keys:["a"],action:"artboard-tool"},{keys:["o"],action:"ellipse-tool"},{keys:["u"],action:"rectangle-tool"},{keys:["g"],action:"node-tool"},{keys:["y"],action:"solo-tool"},{keys:["q"],action:"collider-tool"},{keys:["space"],action:"pan"},{keys:["f"],action:"zoom-fit"},{keys:["space"],action:"toggle-play"},{keys:["home"],action:"timeline-start"},{keys:["end"],action:"timeline-end"},{keys:["1"],action:"item1"},{keys:["2"],action:"item2"},{keys:["3"],action:"item3"},{keys:["4"],action:"item4"},{keys:["5"],action:"item5"},{keys:["6"],action:"item6"},{keys:["7"],action:"item7"},{keys:["8"],action:"item8"},{keys:["9"],action:"item9"},{keys:["0"],action:"item10"},{keys:["]"],action:"brush-size-up"},{keys:["["],action:"send-backward"},{keys:["]"],action:"bring-forward"},{keys:["["],action:"brush-size-down"},{keys:["shift","]"],action:"brush-feather-down"},{keys:["shift","["],action:"brush-feather-up"},{keys:["shift","]"],action:"send-to-front"},{keys:["shift","["],action:"send-to-back"},{keys:["alt","]"],action:"brush-strength-up"},{keys:["alt","["],action:"brush-strength-down"},{keys:["left"],action:"nudge-left"},{keys:["right"],action:"nudge-right"},{keys:["up"],action:"nudge-up"},{keys:["down"],action:"nudge-down"},{keys:["shift","left"],action:"bump-left"},{keys:["shift","right"],action:"bump-right"},{keys:["shift","up"],action:"bump-up"},{keys:["shift","down"],action:"bump-down"},{keys:["shift","/"],action:"show-shortcuts-modal"},{keys:["alt","left"],action:"move-selection-prev-frame"},{keys:["alt","right"],action:"move-selection-next-frame"},{keys:["shift","alt","left"],action:"move-selection-prev-10-frames"},{keys:["shift","alt","right"],action:"move-selection-next-10-frames"}],OSX:[{keys:["command","d"],action:"deselect"},{keys:["command","c"],action:"copy"},{keys:["command","v"],action:"paste"},{keys:["command","x"],action:"cut"},{keys:["command","z"],action:"undo"},{keys:["shift","command","z"],action:"redo"},{keys:["command","="],action:"zoom-in"},{keys:["command","-"],action:"zoom-out"},{keys:["command","0"],action:"zoom-100"},{keys:["command","g"],action:"group"},{keys:["command","y"],action:"group-solo"},{keys:["command","a"],action:"select-all"},{keys:["command","left"],action:"prev-frame"},{keys:["command","right"],action:"next-frame"},{keys:["shift","command","left"],action:"prev-10-frames"},{keys:["shift","command","right"],action:"next-10-frames"},{keys:["command","]"],action:"next-item"},{keys:["command","["],action:"prev-item"},{keys:["command","f"],action:"find"},{keys:["command",";"],action:"toggle-rulers"},{keys:["shift","command",";"],action:"reset-rulers"},{keys:["command","s"],action:"force-revision"},{keys:["command","j"],action:"duplicate"}],Windows:[{keys:["ctrl","d"],action:"deselect"},{keys:["ctrl","c"],action:"copy"},{keys:["ctrl","v"],action:"paste"},{keys:["ctrl","x"],action:"cut"},{keys:["ctrl","z"],action:"undo"},{keys:["shift","ctrl","z"],action:"redo"},{keys:["ctrl","="],action:"zoom-in"},{keys:["ctrl","-"],action:"zoom-out"},{keys:["ctrl","0"],action:"zoom-100"},{keys:["ctrl","g"],action:"group"},{keys:["ctrl","y"],action:"group-solo"},{keys:["ctrl","a"],action:"select-all"},{keys:["ctrl","left"],action:"prev-frame"},{keys:["ctrl","right"],action:"next-frame"},{keys:["shift","ctrl","left"],action:"prev-10-frames"},{keys:["shift","ctrl","right"],action:"next-10-frames"},{keys:["ctrl","]"],action:"next-item"},{keys:["ctrl","["],action:"prev-item"},{keys:["ctrl","f"],action:"find"},{keys:["ctrl",";"],action:"toggle-rulers"},{keys:["shift","ctrl",";"],action:"reset-rulers"},{keys:["ctrl","s"],action:"force-revision"},{keys:["ctrl","j"],action:"duplicate"}]};r.OSX=r.OSX.concat(r.Common),r.Windows=r.Windows.concat(r.Common),t.default={Common:r.Common,OSX:r.OSX,Windows:r.Windows}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(172)),s=c(n(5)),l=c(n(2)),u=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={accentSend:!1,sent:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.accentSend=!1}},{key:"reload",value:function(){window.location.reload()}},{key:"sendMessage",value:function(){this.text.value.trim()&&(this.context.nima.errorFeedback(this.text.value.trim()),this.setState({sent:!0}))}},{key:"onInput",value:function(){var e=this.text.value.trim();e=!!e,this.accentSend!=e&&(this.accentSend=e,this.setState({accentSend:e}))}},{key:"setText",value:function(e){this.text=e}},{key:"render",value:function(){return i.default.createElement("div",{className:"FullscreenWarningWrapper"},this.state.sent?i.default.createElement("div",{className:"FullscreenWarning"},i.default.createElement("svg",{className:"CrashIcon"},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-bug")})),i.default.createElement("div",{className:"FullscreenWarningHeader"},"You Found a Bug!"),i.default.createElement("div",{className:"FullscreenCrashTxt"},"Thanks for sending us feedback!"),i.default.createElement("div",{className:"FullscreenWarningBtns"},i.default.createElement(a.default,{label:"Reload",accentBtn:!1,onPress:this.reload}))):i.default.createElement("div",{className:"FullscreenWarning"},i.default.createElement("svg",{className:"CrashIcon"},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-bug")})),i.default.createElement("div",{className:"FullscreenWarningHeader"},"You Found a Bug!"),i.default.createElement("div",{className:"FullscreenCrashTxt"},"Our team has been notified, but it would be really helpful if you could give us some details about what you were doing. Rest assured that our team is looking into it!"),i.default.createElement("textarea",{ref:this.setText,placeholder:"Tell us what went wrong...",onChange:this.onInput}),i.default.createElement("div",{className:"FullscreenWarningBtns"},i.default.createElement(a.default,{label:"Send Message",accentBtn:this.state.accentSend,onPress:this.sendMessage}),i.default.createElement(a.default,{label:"Reload",accentBtn:!1,onPress:this.reload}))))}}]),t}()).prototype,"reload",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"reload"),r.prototype),d(r.prototype,"sendMessage",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"sendMessage"),r.prototype),d(r.prototype,"onInput",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"onInput"),r.prototype),d(r.prototype,"setText",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setText"),r.prototype),r);t.default=f,f.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(172)),s=l(n(2));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"backToFiles",value:function(){window.location="/my/characters"}},{key:"continueAnyway",value:function(){this.props.onContinueAnyway&&this.props.onContinueAnyway()}},{key:"render",value:function(){return i.default.createElement("div",{className:"FullscreenWarningWrapper"},i.default.createElement("div",{className:"FullscreenWarning"},i.default.createElement("div",{className:"FullscreenWarningHeader"},"Nima is not optimized for this browser yet."),i.default.createElement("div",{className:"FullscreenWarningTxt"},"For the best experience, we recommend using ",i.default.createElement("a",{href:"https://www.google.com/chrome"},"Chrome")," or ",i.default.createElement("a",{href:"https://mozilla.org/firefox"},"Firefox"),"."),i.default.createElement("div",{className:"FullscreenWarningBtns"},i.default.createElement(a.default,{label:"Continue Anyway",accentBtn:!1,onPress:this.continueAnyway}),i.default.createElement(a.default,{label:"Back to Your Files",accentBtn:!0,onPress:this.backToFiles}))))}}]),t}()).prototype,"backToFiles",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"backToFiles"),r.prototype),u(r.prototype,"continueAnyway",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"continueAnyway"),r.prototype),r);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(1)),i=a(n(172));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),r(t,[{key:"backToFiles",value:function(){window.location="/my/characters"}},{key:"readMoreInfo",value:function(){window.location=this.props.error.helpLink}},{key:"render",value:function(){var e=this.props.error;return o.default.createElement("div",{className:"FullscreenWarningWrapper"},o.default.createElement("div",{className:"FullscreenWarning"},o.default.createElement("div",{className:"FullscreenWarningHeader"},e.title),o.default.createElement("div",{className:"FullscreenWarningTxt"},e.description),o.default.createElement("div",{className:"FullscreenWarningBtns"},o.default.createElement(i.default,{label:"Help",accentBtn:!1,onPress:this.readMoreInfo}),o.default.createElement(i.default,{label:"Back to Your Files",accentBtn:!0,onPress:this.backToFiles}))))}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=O(n(1)),s=O(n(2)),l=O(n(5)),u=O(n(1163)),c=O(n(1164)),d=O(n(290)),f=O(n(669)),h=O(n(254)),p=O(n(1166)),y=O(n(1170)),v=O(n(1172)),m=O(n(1176)),g=O(n(1178)),b=O(n(19)),k=O(n(537)),S=O(n(3));function O(e){return e&&e.__esModule?e:{default:e}}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function C(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var E=(C((r=function(e){function t(e){w(this,t);var n=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.assetPaneHeightFactor=.33,n.state={assets:null,name:n.props.file.name,hierarchy:null,orderKeyFrameHandler:null,hierarchyPaneHeight:0,assetPaneHeight:0},n._GrabberY=void 0,n}return P(t,a.default.Component),i(t,[{key:"componentWillMount",value:function(){this.isFiltering=!1;var e=this.context.nima;e&&(e.addEventListener("actorLoaded",this.onActorLoaded),e.addEventListener("fileRenamed",this.onFileRenamed),e.stage.addEventListener("selectionChanged",this.onStageSelectionChanged),e.addEventListener("selectionChanged",this.onNonStageItemSelectionsChanged),window.addEventListener("resize",this.onWindowResize),this._Width=this.props.width,this._SelectionPanelWidth=this.props.selectionPanelWidth)}},{key:"componentWillUnmount",value:function(){b.default.cancel(this.doForceUpdate);var e=this.context.nima;e&&(e.removeEventListener("actorLoaded",this.onActorLoaded),e.removeEventListener("fileRenamed",this.onFileRenamed),e.stage.removeEventListener("selectionChanged",this.onStageSelectionChanged),e.removeEventListener("selectionChanged",this.onNonStageItemSelectionsChanged),window.removeEventListener("resize",this.onWindowResize))}},{key:"onWindowResize",value:function(e){this.updateSize()}},{key:"updateSize",value:function(e){if(this.root){var t=this.root.getBoundingClientRect(),n=t.height-this.headerHeight-96,r=n*this.assetPaneHeightFactor;e&&(this._GrabberY=e,r=Math.min(n,Math.max(0,t.height-e-48)),this.assetPaneHeightFactor=r/n);var o=n-r;this.resizeGrabber.setBottom(r+48-3),this.setState({hierarchyPaneHeight:o,assetPaneHeight:r})}}},{key:"resize",value:function(e){this.updateSize(e.clientY)}},{key:"startResize",value:function(){window.addEventListener("mousemove",this.resize,!0),window.addEventListener("mouseup",this.endResize,!0)}},{key:"endResize",value:function(){window.removeEventListener("mousemove",this.resize,!0),window.removeEventListener("mouseup",this.endResize,!0),this.props.onHierarchyPanelsResized&&void 0!==this._GrabberY&&this.props.onHierarchyPanelsResized(this._GrabberY)}},{key:"setFilter",value:function(e){this.filter=e,this.updateFilter()}},{key:"find",value:function(){this.filter.show()}},{key:"componentDidMount",value:function(){var e=this.context.nima.getPreference("editor")||{};this._GrabberY=e.grabberY||void 0,this.updateSize(this._GrabberY)}},{key:"onFileRenamed",value:function(e){this.setState({name:e.name})}},{key:"onChangeActiveArtboard",value:function(e){var t=this.state.animations;t&&(t.pauseAll(),t.cleanup());var n=e?new f.default(e):null;e.actor.animationFolder=n,n&&this.context.nima.editingAnimation&&(this.context.nima.editingAnimation=n.firstAnimation),this.setState({activeArtboard:e,animations:n})}},{key:"onActorLoaded",value:function(e){var t=this._LastActor;t&&t.artboards&&t.artboards.removeEventListener("changeActive",this.onChangeActiveArtboard),e.artboards.addEventListener("changeActive",this.onChangeActiveArtboard);var n=e.artboards.active,r=n?new f.default(n):null;e.animationFolder=r,this.setState(function(t,o){return{hierarchy:e.artboards,activeArtboard:n,assets:e.assetFolder,actor:e,animations:r}}),this._LastActor=e}},{key:"onStageSelectionChanged",value:function(e,t){e.length&&this.context.nima.clearSelections()}},{key:"onNonStageItemSelectionsChanged",value:function(e,t){if(this.context.nima.editingAnimation){for(var n=[],r=0;r<e.length;r++){var o=e[r];o.constructor===h.default&&(-1===n.indexOf(o)&&n.push(o))}if(clearTimeout(this.expandTreeTimeout),this.suppressTreeExpansion||t===this)return;this.secondaryPanel.animationPane.show(n)}else e.length&&this.context.nima.stage.clearSelections(!1,!0)}},{key:"changeName",value:function(e){this.setState({name:e}),this.context.nima.changeFileName(e)}},{key:"bringHoverIntoView",value:function(){var e=this.context.nima.stage.hoverItem;e&&e.node&&this.hierarchy&&this.hierarchy.show(e.node)}},{key:"dragOrder",value:function(e){if(e.preventDefault(),!this.dragImage){var t=this.dragImage=document.createElement("div");t.className="HierarchyDragGhost";for(var n=this.drag.items,r=n.length-1;r>=0;r--){var o=n[r];o.row.setIsDragging(!0);var i=document.createElement("div");i.innerText=o.node.name,t.appendChild(i)}document.body.appendChild(t)}var a=this.dragImage.getBoundingClientRect();this.dragImage.style.left=Math.round(e.clientX-a.width/2)+"px",this.dragImage.style.top=Math.round(e.clientY-a.height/2)+"px"}},{key:"releaseOrder",value:function(e){if(this.dragImage){for(var t=this.drag,n=t.items,r=this.currentDragOrder,o=0;o<n.length;o++){var i=n[o];i.row.setIsDragging(!1);var a=r.indexOf(i.node);i.oldIndex=a+1}if(this.drag.target){r.slice(0);var s=this.drag.target.props.data,l=r.indexOf(s);1!==this.drag.target.state.drop&&(l+=1);for(var u=[],c=0;c<n.length;c++){var d=n[c];u.push(d.node);var f=r.indexOf(d.node);r.splice(f,1),f<l&&l--}Array.prototype.splice.apply(r,[l,0].concat(u));for(var h=0;h<r.length;h++){r[h].hierarchySortOrder=h+1}this.context.nima.captureJournalEntry()}this.dragImage?this.dragImage.parentNode===document.body&&document.body.removeChild(this.dragImage):t.isMultiSelect||(this.suppressTreeExpansion=!0,this.context.nima.stage.selectItem(t.hitItem.stageItem,!1),this.suppressTreeExpansion=!1),this.dragImage=null}this.drag=null,this.topOrderRow.setDragSibling(null),window.removeEventListener("mousemove",this.dragOrder,!0),window.removeEventListener("mouseup",this.releaseOrder,!0)}},{key:"forceSetupWorkspace",value:function(){this.workspaceToggle.forceSetupWorkspace()}},{key:"switchWorkspace",value:function(e){this.secondaryPanel.activeIndex="SetupButton"===e?0:1,this.props.onSwitchedToggle&&this.props.onSwitchedToggle(e),this.updateSize()}},{key:"setAnimationMode",value:function(e){e&&this.setEditingAnimation(e)}},{key:"setEditingAnimation",value:function(e){this.setState({orderKeyFrameHandler:e?{dispatcher:e,event:"keyState",get state(){return this.dispatcher.orderKeyState},setKey:function(){this.dispatcher.setOrderKey()}}:null})}},{key:"setMeshMode",value:function(e){this.root&&(this.meshMode=e,this.translateMesh(e))}},{key:"translateMesh",value:function(e){this.root.style.transform=e?"translate3D(-"+this._Width+"px, 0, 0)":null}},{key:"translatePanelOut",value:function(e){this.root.style.transform=e?"translate3D(-"+(this._Width+this._SelectionPanelWidth)+"px, 0, 0)":null}},{key:"setWidth",value:function(e){this._Width=e,this.root.style.width=e+"px"}},{key:"setSelectionPanelWidth",value:function(e){this._SelectionPanelWidth=e}},{key:"setAssetTip",value:function(e){this.assetTip=e}},{key:"setHeader",value:function(e){this.header=e,e&&(this.headerHeight=e.getBoundingClientRect().height)}},{key:"setRoot",value:function(e){this.root=e}},{key:"filterChange",value:function(e){this.isFiltering=e,this.updateFilter()}},{key:"updateFilter",value:function(){var e=this.hierarchy,t=this.isFiltering,n=this.secondaryPanel,r=this.drawOrder;e&&e.updateFilter(t),r&&r.updateFilter(t),n&&(n.animationPane&&n.animationPane.updateFilter(t),n.assetsPane&&n.assetsPane.updateFilter(t))}},{key:"setHierarchy",value:function(e){this.hierarchy=e}},{key:"setSecondaryPanel",value:function(e){this.secondaryPanel=e}},{key:"setDrawOrder",value:function(e){this.drawOrder=e}},{key:"setWorkspaceToggle",value:function(e){this.workspaceToggle=e}},{key:"setResizeGrabber",value:function(e){this.resizeGrabber=e}},{key:"render",value:function(){var e=this.context.nima,t=!e||!e.hasWriteAccess,n=this.state,r=n.actor,o=n.assets,i=n.animations,s=n.orderKeyFrameHandler,l=n.activeArtboard,f=this.props.file;return a.default.createElement("div",{ref:this.setRoot,id:"HierarchyPanel",style:{width:this._Width+"px",transform:this.meshMode?"translate3D(-"+this._Width+"px, 0, 0)":null}},a.default.createElement("div",{ref:this.setHeader},a.default.createElement("div",{className:"EditorHeader"},a.default.createElement("svg",{className:"MenuIcon",onClick:this.props.onLogoClick,onMouseEnter:this.props.onLogoHover},a.default.createElement("use",{xlinkHref:S.default.make("/images/symbol-defs.svg#icon-menu")})),a.default.createElement(u.default,{name:t?f.name:this.state.name,onNameChanged:this.changeName,readOnly:t}),t?null:a.default.createElement("svg",{className:"InfoIcon",onClick:this.props.onShowPropertiesModal},a.default.createElement("use",{xlinkHref:S.default.make("/images/symbol-defs.svg#icon-info")}))),a.default.createElement(c.default,{ref:this.setWorkspaceToggle,onSwitched:this.switchWorkspace})),a.default.createElement(g.default,null,a.default.createElement(p.default,{icon:"icon-character",title:"Hierarchy",ref:this.setHierarchy,actor:r,data:this.state.hierarchy,height:this.state.hierarchyPaneHeight}),a.default.createElement(y.default,{icon:"icon-order",title:"Draw Order",keyFrameHandler:s,ref:this.setDrawOrder,data:l&&l.drawOrder,height:this.state.hierarchyPaneHeight})),a.default.createElement(k.default,{ref:this.setResizeGrabber,isHorizontal:!0,onMouseDown:this.startResize}),a.default.createElement(T,{contentHeight:this.state.assetPaneHeight,ref:this.setSecondaryPanel,actor:r,assets:o,animations:i,showAssetTip:this.state.showAssetTip}),a.default.createElement(d.default,{ref:this.setFilter,onFilter:this.filterChange}))}},{key:"animationFolder",get:function(){return this.state.animations}}]),t}()).prototype,"onWindowResize",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onWindowResize"),r.prototype),C(r.prototype,"resize",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"resize"),r.prototype),C(r.prototype,"startResize",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"startResize"),r.prototype),C(r.prototype,"endResize",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"endResize"),r.prototype),C(r.prototype,"setFilter",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setFilter"),r.prototype),C(r.prototype,"onFileRenamed",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onFileRenamed"),r.prototype),C(r.prototype,"onChangeActiveArtboard",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onChangeActiveArtboard"),r.prototype),C(r.prototype,"onActorLoaded",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onActorLoaded"),r.prototype),C(r.prototype,"onStageSelectionChanged",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onStageSelectionChanged"),r.prototype),C(r.prototype,"onNonStageItemSelectionsChanged",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onNonStageItemSelectionsChanged"),r.prototype),C(r.prototype,"changeName",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"changeName"),r.prototype),C(r.prototype,"dragOrder",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"dragOrder"),r.prototype),C(r.prototype,"releaseOrder",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"releaseOrder"),r.prototype),C(r.prototype,"forceSetupWorkspace",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"forceSetupWorkspace"),r.prototype),C(r.prototype,"switchWorkspace",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"switchWorkspace"),r.prototype),C(r.prototype,"setAssetTip",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setAssetTip"),r.prototype),C(r.prototype,"setHeader",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setHeader"),r.prototype),C(r.prototype,"setRoot",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setRoot"),r.prototype),C(r.prototype,"filterChange",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"filterChange"),r.prototype),C(r.prototype,"setHierarchy",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setHierarchy"),r.prototype),C(r.prototype,"setSecondaryPanel",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setSecondaryPanel"),r.prototype),C(r.prototype,"setDrawOrder",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setDrawOrder"),r.prototype),C(r.prototype,"setWorkspaceToggle",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setWorkspaceToggle"),r.prototype),C(r.prototype,"setResizeGrabber",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setResizeGrabber"),r.prototype),r);t.default=E,E.contextTypes={nima:l.default.object};var T=(C((o=function(e){function t(e){w(this,t);var n=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return P(t,a.default.Component),i(t,[{key:"onEditingAnimationChanged",value:function(){this.forceUpdate()}},{key:"componentWillMount",value:function(){var e=this.context.nima;e&&e.addEventListener("editingAnimationChanged",this.onEditingAnimationChanged)}},{key:"componentWillUnmount",value:function(){b.default.cancel(this.doForceUpdate);var e=this.context.nima;e&&e.removeEventListener("editingAnimationChanged",this.onEditingAnimationChanged)}},{key:"setTabPanel",value:function(e){this.tabPanel=e}},{key:"setAnimationPane",value:function(e){this.animationPane=e}},{key:"setAssetsPane",value:function(e){this.assetsPane=e}},{key:"render",value:function(){var e=this.context.nima,t=this.props,n=t.actor,r=t.animations,o=t.assets,i=t.contentHeight,s=!!e.editingAnimation;return a.default.createElement(g.default,{ref:this.setTabPanel},a.default.createElement(v.default,{icon:"icon-picture",isHidden:s,ref:this.setAssetsPane,title:"Assets",actor:n,data:o,height:i}),a.default.createElement(m.default,{icon:"icon-animations",isHidden:!s,ref:this.setAnimationPane,title:"Animations",actor:n,data:r,height:i}))}},{key:"activeIndex",get:function(){return this.tabPanel&&this.tabPanel.activeIndex},set:function(e){this.tabPanel&&(this.tabPanel.activeIndex=e)}}]),t}()).prototype,"onEditingAnimationChanged",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"onEditingAnimationChanged"),o.prototype),C(o.prototype,"setTabPanel",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"setTabPanel"),o.prototype),C(o.prototype,"setAnimationPane",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"setAnimationPane"),o.prototype),C(o.prototype,"setAssetsPane",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"setAssetsPane"),o.prototype),o);T.contextTypes={nima:l.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(5)),s=l(n(2));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={name:n.props.name||"",textValue:n.props.name},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.recalculateInputBounds=!0,this.fileName=this.props.name,this.focused=!1}},{key:"setTextInput",value:function(e){this.textInput=e}},{key:"setHiddenDiv",value:function(e){this.hiddenDiv=e}},{key:"nameInputKeyDown",value:function(e){switch(e.keyCode){case 13:this.textInput.blur();break;case 27:this.setState({name:this.fileName}),this.textInput.value=this.fileName,this.textInput.blur()}}},{key:"nameInputChange",value:function(e){if(this.props.readOnly)return!1;this.recalculateInputBounds=!0,this.setState({name:e.target.value}),this.updateInputFieldWidth(e.target.value)}},{key:"nameInputBlurred",value:function(e){this.props.readOnly||(e.target.value!=this.fileName&&this.props.onNameChanged&&(this.props.onNameChanged(e.target.value),this.fileName=e.target.value),this.focused=!1)}},{key:"nameInputFocused",value:function(e){this.focused=!0,this.fileName=this.props.name}},{key:"componentWillReceiveProps",value:function(e){e.name!=this.props.name&&(this.recalculateInputBounds=!0,this.fileName=e.name,this.focused||this.setState({name:this.fileName,textValue:this.fileName}))}},{key:"updateInputFieldWidth",value:function(e){this.setState({textValue:e})}},{key:"componentDidUpdate",value:function(){this.recalculateInputBounds&&(this.calcTextWidth=this.hiddenDiv.getBoundingClientRect().width+3,this.calcTextWidth!=this.state.newWidth&&(this.setState({newWidth:this.calcTextWidth}),this.recalculateInputBounds=!1))}},{key:"render",value:function(){return i.default.createElement("div",{className:"CharacterName"},i.default.createElement("input",{className:"ProjectTitle",ref:this.setTextInput,autoComplete:"off",type:"text",value:this.state.name,onKeyDown:this.nameInputKeyDown,onChange:this.nameInputChange,onBlur:this.nameInputBlurred,onFocus:this.nameInputFocused,style:{width:this.state.newWidth?this.state.newWidth:null,pointerEvents:this.props.readOnly?"none":null}}),i.default.createElement("div",{ref:this.setHiddenDiv,className:"ProjectTitle",style:{visibility:"hidden",whiteSpace:"pre",display:"inline-block",position:"absolute"}},this.state.textValue))}}]),t}()).prototype,"setTextInput",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setTextInput"),r.prototype),u(r.prototype,"setHiddenDiv",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setHiddenDiv"),r.prototype),u(r.prototype,"nameInputKeyDown",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"nameInputKeyDown"),r.prototype),u(r.prototype,"nameInputChange",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"nameInputChange"),r.prototype),u(r.prototype,"nameInputBlurred",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"nameInputBlurred"),r.prototype),u(r.prototype,"nameInputFocused",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"nameInputFocused"),r.prototype),r);t.default=c,c.contextTypes={nima:a.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(1165));function l(e){return e&&e.__esModule?e:{default:e}}var u,c,d,f,h,p,y=(r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={selectedToggle:"SetupButton"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"toggleChanged",value:function(e){this.selectedToggle!=e&&(this.selectedToggle=e,this.setState({selectedToggle:e}),this.props.onSwitched&&this.props.onSwitched(e))}},{key:"forceSetupWorkspace",value:function(){this.toggleChanged("SetupButton")}},{key:"render",value:function(){return i.default.createElement("div",{className:"WorkspaceToggle"},i.default.createElement(s.default,{id:"SetupButton",text:"DESIGN",isSelected:"SetupButton"==this.state.selectedToggle,onSelected:this.toggleChanged}),i.default.createElement(s.default,{id:"AnimateButton",text:"ANIMATE",isSelected:"AnimateButton"==this.state.selectedToggle,onSelected:this.toggleChanged}),i.default.createElement("div",{id:"ToggleHighlight",className:"SetupButton"==this.state.selectedToggle?"ToggleHighlightSetup":"ToggleHighlightAnimate"}))}}]),t}(),u=r.prototype,c="toggleChanged",d=[a.default],f=Object.getOwnPropertyDescriptor(r.prototype,"toggleChanged"),h=r.prototype,p={},Object.keys(f).forEach(function(e){p[e]=f[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=d.slice().reverse().reduce(function(e,t){return t(u,c,e)||e},p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(u,c,p),p=null),r);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(1)),a=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var u=(l((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"mouseOver",value:function(){this.setState({hover:!0})}},{key:"mouseOut",value:function(){this.setState({hover:!1})}},{key:"mouseDown",value:function(){this.props.onSelected&&this.props.onSelected(this.props.id)}},{key:"render",value:function(){return i.default.createElement("div",{onClick:this.mouseDown,onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut,id:this.props.id,className:this.props.isSelected?"workspaceToggleActive":this.state.hover?"workspaceToggleHover":null},this.props.text)}}]),t}()).prototype,"mouseOver",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOver"),r.prototype),l(r.prototype,"mouseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOut"),r.prototype),l(r.prototype,"mouseDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),r);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=T(n(1)),a=T(n(2)),s=T(n(5)),l=T(n(290)),u=T(n(16)),c=T(n(224)),d=T(n(198)),f=T(n(225)),h=T(n(351)),p=T(n(197)),y=T(n(173)),v=T(n(329)),m=T(n(219)),g=T(n(237)),b=T(n(203)),k=T(n(335)),S=T(n(429)),O=T(n(383)),w=T(n(336)),_=T(n(432)),P=T(n(163)),C=T(n(1167)),E=T(n(534));function T(e){return e&&e.__esModule?e:{default:e}}function I(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var j=(I((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){var e=this.context.nima;e&&(this.setActor(this.props.actor),e.stage.addEventListener("selectionChanged",this.onStageSelectionChanged))}},{key:"onStageSelectionChanged",value:function(e,t){e.length&&this.context.nima.clearSelections();if(t!==this){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.node&&-1===e.indexOf(l.node)&&n.push(l.node)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}this.tree&&this.tree.show(n)}}},{key:"componentWillReceiveProps",value:function(e){e.actor!=this.props.actor&&this.setActor(e.actor)}},{key:"componentWillUnmount",value:function(){this.setActor(null)}},{key:"onActorChildrenChanged",value:function(){this.forceUpdate()}},{key:"setActor",value:function(e){if(this.actor!==e){var t=this.actor;t&&t.removeEventListener("childrenChanged",this.onActorChildrenChanged),this.actor=e,e&&e.addEventListener("childrenChanged",this.onActorChildrenChanged)}}},{key:"renderHierarchyItem",value:function(e,t,n){return i.default.createElement(C.default,{isDragging:t,dropTargetState:n,item:e,onSelected:this.onHierarchySelection})}},{key:"spaceHierarchyItem",value:function(e){return e.parent instanceof g.default?2:1}},{key:"updateFilter",value:function(e){this.tree&&this.tree.overrideExpansion(e?function(e){return 0!=(e.filterState&l.default.Expanded)}:null)}},{key:"isHierarchyProperty",value:function(e){return!(e instanceof y.default||e instanceof f.default||e instanceof h.default)}},{key:"getHierarchyItemChildren",value:function(e){if(!e.hierarchyChildren)return null;var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=e.hierarchyChildren[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.hideInHierarchy||s.filterState===l.default.Hidden||t.push(s)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return t}},{key:"setTree",value:function(e){this.tree=e}},{key:"onHierarchySelection",value:function(e,t){var n=this.context.nima.stage;if(t.stageItem)if(t.stageItem.isSelected&&u.default.isMultiSelect(e))n.deSelectItem(t.stageItem,this);else if(e.shiftKey){if(0===n.selectedItems.length)n.selectItem(t.stageItem,!1,!1,this);else{var r=this.tree.getRangeItems(n.selectedItems.map(function(e){return e.node}),t);null!==r&&(r=r.map(function(e){return e.stageItem}),n.clearSelections(!0,!0),n.selectItems(r,!0,!1,this))}}else{u.default.isMultiSelect(e)||n.clearSelections(!0,!0),n.selectItem(t.stageItem,!0,!1,this)}}},{key:"makeDragGhost",value:function(e){var t=this.dragImage=document.createElement("div");return t.className="HierarchyDragGhost",t.innerText=e.name,t}},{key:"allowDrag",value:function(e){switch(e.constructor){case h.default:case p.default:case f.default:case b.default:case m.default:case y.default:case g.default:case k.default:case _.default:case S.default:case O.default:case w.default:return!0;default:return!1}}},{key:"allowDrop",value:function(e,t,n){var r=this.context.nima.stage.currentOperation;if(!t)return r&&r.target(null),e instanceof h.default;if(e instanceof c.default&&!e.isValidParent(t))return r&&r.target(null),!1;if(r&&!(t instanceof v.default&&r.target(t,this.getActualIndex(e,t,n))))return r.target(null),!1;if(e.constructor===m.default&&t.constructor===d.default){for(var o=t.parent;o&&o.constructor!==m.default;)o=o.parent;if(o===e)return!1}return!0}},{key:"getActualIndex",value:function(e,t,n){var r=this.getHierarchyItemChildren(t)[n],o=t.hierarchyChildren.filter(function(t){return t!==e});if(!o)return-1;for(var i=0;i<o.length;i++)if(o[i]===r)return i}},{key:"drop",value:function(e,t,n){this.context.nima.stage.currentOperation||(t||(t=this.actor.artboards),e.parent&&e.parent.remove(e),t.add(e,!1,this.getActualIndex(e,t,n)),e instanceof y.default&&e.compensate(),this.context.nima.captureJournalEntry())}},{key:"show",value:function(e){this.tree.show(e)}},{key:"mouseEnter",value:function(e){var t=this.context.nima.stage.currentOperation;if(t){var n=t.meta;this.tree.handoffDrag(n),t.meta=this.tree}}},{key:"mouseLeave",value:function(e){var t=this.context.nima.stage.currentOperation;t&&t.target(null)}},{key:"itemMouseLeave",value:function(e){var t=this.context.nima.stage.currentOperation;t&&t.target(null)}},{key:"render",value:function(){var e=!1,t=!1;return this.props.data&&(e=this.props.data),e.children&&0===e.children.length&&(t=!0),i.default.createElement("div",{className:E.default.Pane},i.default.createElement(P.default,{isDark:!0,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave,ref:this.setTree,makeDragGhost:this.makeDragGhost,onItemMouseLeave:this.itemMouseLeave,allowDrag:this.allowDrag,drop:this.drop,allowDrop:this.allowDrop,data:this.props.data,showFirstLine:!0,height:this.props.height,iconWidth:15,iconHeight:15,rowHeight:35,getChildren:this.getHierarchyItemChildren,isProperty:this.isHierarchyProperty,renderItem:this.renderHierarchyItem,spaceItem:this.spaceHierarchyItem,expandedItems:this.context.nima.expandedItems}),t?i.default.createElement("div",{className:"Tip"},"Your hierarchy is empty. Drag some assets onto the stage or into this panel."):null)}}]),t}()).prototype,"onStageSelectionChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onStageSelectionChanged"),r.prototype),I(r.prototype,"onActorChildrenChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onActorChildrenChanged"),r.prototype),I(r.prototype,"setActor",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setActor"),r.prototype),I(r.prototype,"renderHierarchyItem",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"renderHierarchyItem"),r.prototype),I(r.prototype,"spaceHierarchyItem",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"spaceHierarchyItem"),r.prototype),I(r.prototype,"isHierarchyProperty",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"isHierarchyProperty"),r.prototype),I(r.prototype,"getHierarchyItemChildren",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"getHierarchyItemChildren"),r.prototype),I(r.prototype,"setTree",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTree"),r.prototype),I(r.prototype,"onHierarchySelection",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onHierarchySelection"),r.prototype),I(r.prototype,"makeDragGhost",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"makeDragGhost"),r.prototype),I(r.prototype,"allowDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"allowDrag"),r.prototype),I(r.prototype,"allowDrop",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"allowDrop"),r.prototype),I(r.prototype,"drop",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"drop"),r.prototype),I(r.prototype,"mouseEnter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseEnter"),r.prototype),I(r.prototype,"mouseLeave",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseLeave"),r.prototype),I(r.prototype,"itemMouseLeave",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"itemMouseLeave"),r.prototype),r);t.default=j,j.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=O(n(1)),a=O(n(5)),s=O(n(203)),l=O(n(197)),u=O(n(225)),c=O(n(228)),d=O(n(2)),f=O(n(29)),h=O(n(670)),p=O(n(237)),y=O(n(173)),v=O(n(254)),m=O(n(19)),g=O(n(290)),b=O(n(163)),k=O(n(435)),S=O(n(3));function O(e){return e&&e.__esModule?e:{default:e}}function w(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var _=(w((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={editing:!1,hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"doForceUpdate",value:function(){this.forceUpdate()}},{key:"debounceForcedUpdate",value:function(){(0,m.default)(this.doForceUpdate)}},{key:"setKeyFrame",value:function(e){e.stopPropagation();var t=this.item;if(t){var n=t.keyFrameHandler;n&&(n.setKey(this.context.nima),this.context.nima.captureJournalEntry())}}},{key:"setItem",value:function(e){var t=this.item;if(t!==e){var n=this.context.nima;if(t){var r=t.keyFrameHandler;r&&(r.dispatcher.removeEventListener(r.event,this.debounceForcedUpdate),n.removeEventListener("editingAnimationChanged",this.debounceForcedUpdate)),t.removeEventListener("displayChange",this.debounceForcedUpdate),t.removeEventListener("visibilityChange",this.debounceForcedUpdate),t.removeEventListener("renderCollapseChange",this.debounceForcedUpdate),t.removeEventListener("update",this.debounceForcedUpdate),t.visibilityItem&&(t.visibilityItem.removeEventListener("hoverChange",this.debounceForcedUpdate),t.visibilityItem.removeEventListener("lockedChange",this.debounceForcedUpdate)),t.stageItem?(t.stageItem.removeEventListener("selectedChange",this.debounceForcedUpdate),(t instanceof l.default||t instanceof u.default||t instanceof c.default)&&t.stageItem.removeEventListener("icon",this.debounceForcedUpdate)):t.removeEventListener("selectedChange",this.debounceForcedUpdate)}if(this.item=e,e){var o=e.keyFrameHandler;o&&(o.dispatcher.addEventListener(o.event,this.debounceForcedUpdate),n.addEventListener("editingAnimationChanged",this.debounceForcedUpdate)),e.addEventListener("displayChange",this.debounceForcedUpdate),e.addEventListener("visibilityChange",this.debounceForcedUpdate),e.addEventListener("renderCollapseChange",this.debounceForcedUpdate),e.addEventListener("update",this.debounceForcedUpdate),e.visibilityItem&&(e.visibilityItem.addEventListener("hoverChange",this.debounceForcedUpdate),e.visibilityItem.addEventListener("lockedChange",this.debounceForcedUpdate)),e.stageItem?(e.stageItem.addEventListener("selectedChange",this.debounceForcedUpdate),(e instanceof l.default||e instanceof u.default||e instanceof c.default)&&e.stageItem.addEventListener("icon",this.debounceForcedUpdate)):e.addEventListener("selectedChange",this.debounceForcedUpdate),this.state.hover&&e.stageItem&&e.stageItem.stage&&(this.context.nima.stage.hoverItem=e.stageItem)}}}},{key:"componentWillReceiveProps",value:function(e){e.item!=this.props.item&&this.setItem(e.item)}},{key:"componentWillMount",value:function(){this.setItem(this.props.item)}},{key:"componentWillUnmount",value:function(){m.default.cancel(this.doForceUpdate),this.setItem(null)}},{key:"mouseEnter",value:function(){this.setState({hover:!0});var e=this.item;e&&e.stageItem&&e.stageItem.stage&&(this.context.nima.stage.hoverItem=e.stageItem)}},{key:"mouseLeave",value:function(){this.setState({hover:!1});var e=this.item;e&&e.stageItem&&this.context.nima.stage.hoverItem===e.stageItem&&(this.context.nima.stage.hoverItem=null)}},{key:"mouseDown",value:function(e){if(e.preventDefault(),e.stopPropagation(),this.item){var t=Date.now();if(this.clickTime){var n=t-this.clickTime;if(delete this.clickTime,n<200&&this.editableName.startEdit())return}this.clickTime=t,this.props.onSelected&&this.props.onSelected(e,this.item)}}},{key:"toggleVisibility",value:function(e){e.stopPropagation();var t=this.item;if(t&&t.visibilityItem){var n=this.context.nima;if(e.altKey)if(n.lastAltVisibility&&n.lastAltVisibility.item===t&&n.lastAltVisibility.meta===e.metaKey)for(var r=n.lastAltVisibility.selection,o=0;o<r.length;o++){var i=r[o];i.isVisible=!i.isVisible}else{var a=[],s=[];t.isVisible||(s.push(t),t.isVisible=!0),e.metaKey||!t.all?a.push(t):t.all(function(e){a.push(e)}),n.actor.artboards.eachChildRecursive(function(e){-1===a.indexOf(e)&&e.isVisible&&(s.push(e),e.isVisible=!1)}),n.lastAltVisibility={selection:s,item:t,meta:e.metaKey}}else{if(e.metaKey||!t.all)t.isVisible=!t.isVisible;else{var l=!t.isVisible;t.all(function(e){e.isVisible=l})}delete n.lastAltVisibility}t.stageItem&&t.stageItem.stage&&t.stageItem.stage.redraw()}}},{key:"toggleLocked",value:function(e){e.stopPropagation();var t=this.item;if(t&&t.visibilityItem){if(e.metaKey||!t.all)t.isLocked=!t.isLocked;else{var n=!t.isLocked;t.all(function(e){e.isLocked=n})}t.stageItem&&t.stageItem.stage&&t.stageItem.stage.redraw()}}},{key:"toggleActive",value:function(e){e.stopPropagation();var t=this.item;t&&t.parent&&(t.parent.activeChild=t,t.stageItem&&t.stageItem.stage&&t.stageItem.stage.redraw())}},{key:"setEditableName",value:function(e){this.editableName=e}},{key:"render",value:function(){var e=this.context.nima.stage,t=this.props,n=t.item,r=t.dropTargetState,o=t.isDragging,a=n.stageItem,d=n.visibilityItem,m=this.state,O=m.editing,w=m.hover,_=n.uiHierIconClass,P=n.uiIcon,C=P?S.default.make("/images/symbol-defs.svg#"+P):null,E=!o&&a?a.isSelected:n.isSelected,T=d&&e&&e.hoverItem===d||!1,I=n instanceof y.default,j=!I||n.isVisible,A=d&&d.isLocked||!1,D=n.filterState,R=!j||0!=(D&(g.default.SemiHidden|g.default.Collapsed)),M=!1,x=this.context.nima.editingAnimation&&n.keyFrameHandler,F=n.parent;F instanceof p.default&&(M=F.activeChild===n),o&&(w=!1);var L=!O&&(w||R)&&!!d&&!(n instanceof v.default),N=w||A,z=!o&&(w||T),V=I,B=this.toggleVisibility,H=this.toggleLocked,W=[f.default.ItemContent];switch(E?W.push(f.default.Selected):z?W.push(f.default.Hovered):R&&W.push(f.default.Hidden),r){case b.default.DropTargetParent:W.push(f.default.DropTargetParent);break;case b.default.DropTarget:W.push(f.default.DropTarget);break;case b.default.DropDisabled:W.push(f.default.DropDisabled)}var K=null;if(n instanceof s.default){var G=n.asset;G&&G.imgSrc&&(K="url('"+G.imgSrc+"')")}else if(n instanceof l.default||n instanceof u.default||n instanceof c.default){var U=n.stageItem.imgIconSrc;U&&(K="url('"+U+"')")}return i.default.createElement("div",{className:f.default.ItemContentWrapper,onClick:this.mouseDown,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave},F instanceof p.default?i.default.createElement("div",{style:{display:"inline-block"},className:f.default.Toggle,onMouseEnter:this.enterToggleActive,onClick:this.toggleActive},i.default.createElement("div",{style:{opacity:M?1:0}})):null,i.default.createElement("div",{className:W.join(" ")},i.default.createElement("div",{className:f.default.TreeIcon+(K?" "+f.default.TreeIconBG:""),style:{backgroundImage:K||null}},K?null:i.default.createElement("svg",{className:_,style:{pointerEvents:"none"}},i.default.createElement("use",{xlinkHref:C}))),i.default.createElement(k.default,{ref:this.setEditableName,item:n}),N&&V?i.default.createElement("svg",{className:f.default.HierarchyLockBtn+(R?" "+f.default.HierarchyLockBtnHidden:""),onClick:H},i.default.createElement("use",{xlinkHref:S.default.make("/images/symbol-defs.svg#"+(A?"icon-lock-layer":"icon-unlock-layer"))})):null,L?i.default.createElement("svg",{className:f.default.HierarchyHideBtn+(R?" "+f.default.HierarchyHideBtnHidden:""),onClick:B},i.default.createElement("use",{xlinkHref:S.default.make(R?"/images/symbol-defs.svg#icon-eye-crossed":"/images/symbol-defs.svg#icon-eye")})):null),x?i.default.createElement("div",{className:0==x.state?h.default.HieararchyKey:1==x.state?h.default.HieararchyKeyChanged:h.default.HieararchyKeyed,onClick:this.setKeyFrame}):null,null,null)}}]),t}()).prototype,"doForceUpdate",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"doForceUpdate"),r.prototype),w(r.prototype,"debounceForcedUpdate",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"debounceForcedUpdate"),r.prototype),w(r.prototype,"setKeyFrame",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"setKeyFrame"),r.prototype),w(r.prototype,"mouseEnter",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseEnter"),r.prototype),w(r.prototype,"mouseLeave",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseLeave"),r.prototype),w(r.prototype,"mouseDown",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),w(r.prototype,"toggleVisibility",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleVisibility"),r.prototype),w(r.prototype,"toggleLocked",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleLocked"),r.prototype),w(r.prototype,"toggleActive",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleActive"),r.prototype),w(r.prototype,"setEditableName",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"setEditableName"),r.prototype),r);t.default=_,_.contextTypes={nima:a.default.object}},function(e,t,n){(t=e.exports=n(13)(!1)).push([e.i,'.source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKey-2dxDU, .source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyChanged-2SBYQ, .source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyed-z3rKP {\n  position: relative;\n  height: 100%;\n  width: 20px; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKey-2dxDU:hover:after {\n  border: 1px solid rgba(255, 255, 255, 0.5); }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKey-2dxDU:after, .source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyChanged-2SBYQ:after, .source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyed-z3rKP:after {\n  content: "";\n  width: 7px;\n  height: 7px;\n  position: absolute;\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  right: 7px;\n  top: 50%;\n  -webkit-transform: rotate(45deg) translate(-50%, -50%);\n      -ms-transform: rotate(45deg) translate(-50%, -50%);\n          transform: rotate(45deg) translate(-50%, -50%);\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  -webkit-transition: background 0.1s ease-in-out, border 0.1s ease-out;\n  transition: background 0.1s ease-in-out, border 0.1s ease-out; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyed-z3rKP:after {\n  background: #57a5e0;\n  border: 1px solid rgba(255, 255, 255, 0); }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyChanged-2SBYQ:after {\n  background: rgba(87, 165, 224, 0);\n  border: 1px solid #ec3e4a; }\n',""]),t.locals={HieararchyKey:"source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKey-2dxDU",HieararchyKeyChanged:"source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyChanged-2SBYQ",HieararchyKeyed:"source-client-source-editors-flare-ui-Components-Hierarchy-HierarchyKey-HieararchyKeyed-z3rKP"}},function(e,t,n){(t=e.exports=n(13)(!1)).push([e.i,".source-client-source-editors-flare-ui-Components-Hierarchy-Pane-Pane-2HJfP {\n  position: relative;\n  overflow: hidden; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-Pane-PaneButtonsWrapper-36Cpf {\n  height: 65px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  padding-left: 15px; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-Pane-PaneButton-10rVI {\n  margin-left: 5px;\n  background: rgba(255, 255, 255, 0.08);\n  height: 25px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  padding: 0 10px;\n  border-radius: 5px;\n  text-transform: uppercase;\n  font-weight: 500;\n  color: #fff;\n  opacity: .5;\n  font-size: 10px;\n  -webkit-transition: background .1s ease-in-out, color .1s ease-in-out;\n  transition: background .1s ease-in-out, color .1s ease-in-out;\n  border: 1px solid rgba(255, 255, 255, 0); }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-Pane-PaneButton-10rVI svg {\n  fill: #fff;\n  -webkit-transition: fill .1s ease-in-out;\n  transition: fill .1s ease-in-out; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-Pane-PaneButton-10rVI:hover {\n  color: #fff;\n  opacity: 1; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-Pane-PaneButton-10rVI:active {\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  opacity: 1; }\n",""]),t.locals={Pane:"source-client-source-editors-flare-ui-Components-Hierarchy-Pane-Pane-2HJfP",PaneButtonsWrapper:"source-client-source-editors-flare-ui-Components-Hierarchy-Pane-PaneButtonsWrapper-36Cpf",PaneButton:"source-client-source-editors-flare-ui-Components-Hierarchy-Pane-PaneButton-10rVI"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=h(n(1)),a=h(n(2)),s=h(n(5)),l=h(n(290)),u=h(n(16)),c=h(n(237)),d=h(n(163)),f=h(n(1171));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var y=(p((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.setData(this.props.data)}},{key:"componentWillReceiveProps",value:function(e){e.data!=this.props.data&&this.setData(e.data)}},{key:"componentWillUnmount",value:function(){this.setData(null)}},{key:"onChildrenChanged",value:function(){this.isFiltering?this.updateFilter(!0):this.forceUpdate()}},{key:"setData",value:function(e){if(this.data!==e){var t=this.data;t&&t.removeEventListener("childrenChanged",this.onChildrenChanged),this.data=e,e&&e.addEventListener("childrenChanged",this.onChildrenChanged)}}},{key:"renderHierarchyItem",value:function(e,t,n){return i.default.createElement(f.default,{isDragging:t,dropTargetState:n,item:e,onSelected:this.onDrawOrderSelection})}},{key:"spaceHierarchyItem",value:function(e){return e.parent instanceof c.default?2:1}},{key:"updateFilter",value:function(e){if(this.isFiltering=e,this.tree){var t=e?this.fullData.filter(function(e){return e.filterState!==l.default.Hidden}):null;this.setState({overrideData:t})}}},{key:"getChildren",value:function(e){return null}},{key:"setTree",value:function(e){this.tree=e}},{key:"onDrawOrderSelection",value:function(e,t,n){var r=this.context.nima.stage;if(n=!0===n,t.stageItem&&t.parent)if(t.stageItem.isSelected&&u.default.isMultiSelect(e))r.deSelectItem(t.stageItem,this);else if(e.shiftKey){if(0===r.selectedItems.length)r.selectItem(t.stageItem,!1,n,this);else{var o=this.tree.getRangeItems(r.selectedItems.map(function(e){return e.node}),t);null!==o&&(o=o.map(function(e){return e.stageItem}),r.clearSelections(!0,!0),r.selectItems(o,!0,n,this))}}else{u.default.isMultiSelect(e)||r.clearSelections(!0,!0),r.selectItem(t.stageItem,!0,n,this)}}},{key:"makeDragGhost",value:function(e,t){e.stageItem.isSelected||this.onDrawOrderSelection(t,e,!0);var n=this.context.nima.stage.selectedItems,r=this.dragImage=document.createElement("div");r.className="HierarchyDragGhost";var o=n.map(function(e){return e.node}).sort(function(e,t){return e.drawOrder-t.drawOrder}).reverse(),i=!0,a=!1,s=void 0;try{for(var l,u=o[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value,d=document.createElement("div");d.innerText=c.name,r.appendChild(d)}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}var f=0,h=this.fullData.map(function(e){return{image:e,order:++f,isDragging:-1!==o.indexOf(e)}});return this.dragData={order:h,dragItems:o},{ghost:r,items:o}}},{key:"allowDrag",value:function(e){return!0}},{key:"allowDrop",value:function(e,t,n){if(t)return!1;var r=this.dragData,o=r.order[n-1],i=r.order[n];return o&&o.isDragging&&(o=null),i&&i.isDragging&&(i=null),o||i}},{key:"drop",value:function(e,t,n){if(this.displayData){for(var r=this.dragData,o=r.order,i=r.dragItems,a=[],s=0;s<=o.length;s++){var l=o[s];if(s===n){var u=!0,c=!1,d=void 0;try{for(var f,h=i[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value;a.push(p)}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}}l&&!l.isDragging&&a.push(l.image)}for(var y=0;y<a.length;y++)a[y].hierarchySortOrder=a.length-y;this.context.nima.captureJournalEntry()}}},{key:"show",value:function(e){this.tree.show(e)}},{key:"render",value:function(){var e=this.displayData;return i.default.createElement(d.default,{isDark:!0,ref:this.setTree,makeDragGhost:this.makeDragGhost,allowDrag:this.allowDrag,drop:this.drop,allowDrop:this.allowDrop,data:e,showFirstLine:!1,hideFirstHorizontalLine:!0,height:this.props.height,iconWidth:15,iconHeight:15,rowHeight:35,getChildren:this.getChildren,renderItem:this.renderHierarchyItem,spaceItem:this.spaceHierarchyItem})}},{key:"displayData",get:function(){return this.state.overrideData||this.fullData}},{key:"fullData",get:function(){return this.props.data&&this.props.data.drawables.slice(0).reverse()}}]),t}()).prototype,"onChildrenChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onChildrenChanged"),r.prototype),p(r.prototype,"setData",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setData"),r.prototype),p(r.prototype,"renderHierarchyItem",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"renderHierarchyItem"),r.prototype),p(r.prototype,"spaceHierarchyItem",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"spaceHierarchyItem"),r.prototype),p(r.prototype,"getChildren",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"getChildren"),r.prototype),p(r.prototype,"setTree",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTree"),r.prototype),p(r.prototype,"onDrawOrderSelection",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onDrawOrderSelection"),r.prototype),p(r.prototype,"makeDragGhost",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"makeDragGhost"),r.prototype),p(r.prototype,"allowDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"allowDrag"),r.prototype),p(r.prototype,"allowDrop",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"allowDrop"),r.prototype),p(r.prototype,"drop",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"drop"),r.prototype),r);t.default=y,y.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=k(n(1)),a=k(n(5)),s=k(n(203)),l=k(n(197)),u=k(n(225)),c=k(n(228)),d=k(n(2)),f=k(n(29)),h=k(n(237)),p=k(n(254)),y=k(n(19)),v=k(n(290)),m=k(n(163)),g=k(n(435)),b=k(n(3));function k(e){return e&&e.__esModule?e:{default:e}}function S(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var O=(S((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={editing:!1,hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"doForceUpdate",value:function(){this.forceUpdate()}},{key:"debounceForcedUpdate",value:function(){(0,y.default)(this.doForceUpdate)}},{key:"setEditableName",value:function(e){this.editableName=e}},{key:"setItem",value:function(e){var t=this.item;t!==e&&(t&&(t.removeEventListener("visibilityChange",this.debounceForcedUpdate),t.removeEventListener("renderCollapseChange",this.debounceForcedUpdate),t.visibilityItem&&(t.visibilityItem.removeEventListener("hoverChange",this.debounceForcedUpdate),t.visibilityItem.removeEventListener("lockedChange",this.debounceForcedUpdate)),t.stageItem?(t.stageItem.removeEventListener("selectedChange",this.debounceForcedUpdate),(t instanceof l.default||t instanceof u.default||t instanceof c.default)&&t.stageItem.removeEventListener("icon",this.debounceForcedUpdate)):t.removeEventListener("selectedChange",this.debounceForcedUpdate)),this.item=e,e&&(e.addEventListener("visibilityChange",this.debounceForcedUpdate),e.addEventListener("renderCollapseChange",this.debounceForcedUpdate),e.visibilityItem&&(e.visibilityItem.addEventListener("hoverChange",this.debounceForcedUpdate),e.visibilityItem.addEventListener("lockedChange",this.debounceForcedUpdate)),e.stageItem?(e.stageItem.addEventListener("selectedChange",this.debounceForcedUpdate),(e instanceof l.default||e instanceof u.default||e instanceof c.default)&&e.stageItem.addEventListener("icon",this.debounceForcedUpdate)):e.addEventListener("selectedChange",this.debounceForcedUpdate)))}},{key:"componentWillReceiveProps",value:function(e){e.item!=this.props.item&&this.setItem(e.item)}},{key:"componentWillMount",value:function(){this.setItem(this.props.item)}},{key:"componentWillUnmount",value:function(){y.default.cancel(this.doForceUpdate),this.setItem(null)}},{key:"mouseEnter",value:function(){this.setState({hover:!0});var e=this.item;e&&e.stageItem&&e.stageItem.stage&&(this.context.nima.stage.hoverItem=e.stageItem)}},{key:"mouseLeave",value:function(){this.setState({hover:!1});var e=this.item;e&&e.stageItem&&this.context.nima.stage.hoverItem===e.stageItem&&(this.context.nima.stage.hoverItem=null)}},{key:"mouseDown",value:function(e){if(e.preventDefault(),e.stopPropagation(),this.item){var t=Date.now();if(this.clickTime){var n=t-this.clickTime;if(delete this.clickTime,n<200&&this.editableName.startEdit())return}this.clickTime=t,this.props.onSelected&&this.props.onSelected(e,this.item)}}},{key:"toggleVisibility",value:function(e){e.stopPropagation();var t=this.item;if(t&&t.visibilityItem){var n=this.context.nima;if(e.altKey)if(n.lastAltVisibility&&n.lastAltVisibility.item===t&&n.lastAltVisibility.meta===e.metaKey)for(var r=n.lastAltVisibility.selection,o=0;o<r.length;o++){var i=r[o];i.isVisible=!i.isVisible}else{var a=[],s=[];t.isVisible||(s.push(t),t.isVisible=!0),e.metaKey||!t.all?a.push(t):t.all(function(e){a.push(e)}),n.actor.artboards.all(function(e){-1===a.indexOf(e)&&e.isVisible&&(s.push(e),e.isVisible=!1)}),n.lastAltVisibility={selection:s,item:t,meta:e.metaKey}}else{if(e.metaKey||!t.all)t.isVisible=!t.isVisible;else{var l=!t.isVisible;t.all(function(e){e.isVisible=l})}delete n.lastAltVisibility}t.stageItem&&t.stageItem.stage&&t.stageItem.stage.redraw()}}},{key:"toggleLocked",value:function(e){e.stopPropagation();var t=this.item;if(t&&t.visibilityItem){if(e.metaKey||!t.all)t.isLocked=!t.isLocked;else{var n=!t.isLocked;t.all(function(e){e.isLocked=n})}t.stageItem&&t.stageItem.stage&&t.stageItem.stage.redraw()}}},{key:"toggleActive",value:function(e){e.stopPropagation();var t=this.item;t&&t.parent&&(t.parent.activeChild=t,t.stageItem&&t.stageItem.stage&&t.stageItem.stage.redraw())}},{key:"render",value:function(){var e=this.context.nima.stage,t=this.props,n=t.item,r=t.dropTargetState,o=t.isDragging,a=n.stageItem,d=n.visibilityItem,y=this.state,k=y.editing,S=y.hover,O=!o&&a?a.isSelected:n.isSelected,w=d&&e&&e.hoverItem===d||!1,_=n.isVisible,P=d&&d.isLocked||!1,C=n.filterState,E=!_||0!=(C&(v.default.SemiHidden|v.default.Collapsed)),T=n.parent;T instanceof h.default&&T.activeChild,o&&(S=!1);var I=!k&&(S||E)&&!!d&&!(n instanceof p.default),j=S||P,A=!o&&(S||w),D=this.toggleVisibility,R=this.toggleLocked,M=[f.default.ItemContent];switch(O?M.push(f.default.Selected):A?M.push(f.default.Hovered):E&&M.push(f.default.Hidden),r){case m.default.DropTargetParent:M.push(f.default.DropTargetParent);break;case m.default.DropTarget:M.push(f.default.DropTarget);break;case m.default.DropDisabled:M.push(f.default.DropDisabled)}var x=null;if(n instanceof s.default){var F=n.asset;F&&F.imgSrc&&(x="url('"+F.imgSrc+"')")}else if(n instanceof l.default||n instanceof u.default||n instanceof c.default){var L=n.stageItem.imgIconSrc;L&&(x="url('"+L+"')")}return i.default.createElement("div",{className:f.default.ItemContentWrapper,onClick:this.mouseDown,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave},i.default.createElement("svg",{className:"HierarchyDragOrderIcon",style:{pointerEvents:"none"}},i.default.createElement("use",{xlinkHref:b.default.make("/images/symbol-defs.svg#icon-drag-order")})),i.default.createElement("div",{className:M.join(" ")},i.default.createElement("div",{className:f.default.TreeIcon+(x?" "+f.default.TreeIconBG:""),style:{backgroundImage:x||null}},x?null:i.default.createElement("svg",{className:"HierarchyImageIcon",style:{pointerEvents:"none"}},i.default.createElement("use",{xlinkHref:b.default.make("/images/symbol-defs.svg#icon-picture")}))),i.default.createElement(g.default,{ref:this.setEditableName,item:n})),j?i.default.createElement("svg",{className:f.default.HierarchyLockBtn+(E?" "+f.default.HierarchyLockBtnHidden:""),onMouseDown:R},i.default.createElement("use",{xlinkHref:b.default.make("/images/symbol-defs.svg#"+(P?"icon-lock-layer":"icon-unlock-layer"))})):null,I?i.default.createElement("svg",{className:f.default.HierarchyHideBtn+(E?" "+f.default.HierarchyHideBtnHidden:""),onMouseDown:D},i.default.createElement("use",{xlinkHref:b.default.make(E?"/images/symbol-defs.svg#icon-eye-crossed":"/images/symbol-defs.svg#icon-eye")})):null,null,null)}}]),t}()).prototype,"doForceUpdate",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"doForceUpdate"),r.prototype),S(r.prototype,"debounceForcedUpdate",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"debounceForcedUpdate"),r.prototype),S(r.prototype,"setEditableName",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"setEditableName"),r.prototype),S(r.prototype,"mouseEnter",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseEnter"),r.prototype),S(r.prototype,"mouseLeave",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseLeave"),r.prototype),S(r.prototype,"mouseDown",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),S(r.prototype,"toggleVisibility",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleVisibility"),r.prototype),S(r.prototype,"toggleLocked",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleLocked"),r.prototype),S(r.prototype,"toggleActive",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleActive"),r.prototype),r);t.default=O,O.contextTypes={nima:a.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=w(n(1)),a=w(n(2)),s=w(n(5)),l=w(n(290)),u=w(n(16)),c=w(n(237)),d=w(n(1173)),f=w(n(1174)),h=w(n(267)),p=w(n(535)),y=w(n(437)),v=w(n(332)),m=w(n(671)),g=n(7),b=w(n(163)),k=w(n(1175)),S=w(n(534)),O=w(n(3));function w(e){return e&&e.__esModule?e:{default:e}}function _(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var P=(_((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.setData(this.props.data)}},{key:"componentWillReceiveProps",value:function(e){e.data!=this.props.data&&this.setData(e.data)}},{key:"componentWillUnmount",value:function(){this.setData(null)}},{key:"onChildrenChanged",value:function(){this.forceUpdate()}},{key:"setData",value:function(e){if(this.data!==e){var t=this.data;t&&t.removeEventListener("childrenChanged",this.onChildrenChanged),this.data=e,e&&e.addEventListener("childrenChanged",this.onChildrenChanged)}}},{key:"renderHierarchyItem",value:function(e,t,n){return i.default.createElement(k.default,{isDragging:t,dropTargetState:n,item:e,onSelected:this.onAssetSelection})}},{key:"spaceHierarchyItem",value:function(e){return e.parent instanceof c.default?2:1}},{key:"updateFilter",value:function(e){this.tree&&(this.tree.overrideExpansion(e?function(e){return 0!=(e.filterState&l.default.Expanded)}:null),this.forceUpdate())}},{key:"getChildren",value:function(e){if(!e.hierarchyChildren)return null;var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=e.hierarchyChildren[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.hideInHierarchy||s.filterState===l.default.Hidden||t.push(s)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return t}},{key:"setTree",value:function(e){this.tree=e}},{key:"onAssetSelection",value:function(e,t){var n=this.context.nima;if(t.isSelected&&u.default.isMultiSelect(e))n.deselectItem(t,!1);else if(e.shiftKey){var r=n.selectedItems;if(0===r.length)n.selectItem(t,!1,this);else{var o=this.tree.getRangeItems(r,t);null!==o&&(n.clearSelections(!0),n.selectItems(o,!0,this))}}else{u.default.isMultiSelect(e)||n.clearSelections(!0),n.selectItem(t,!0,this)}}},{key:"makeDragGhost",value:function(e){var t=this.dragImage=document.createElement("div");t.className="HierarchyDragGhost",t.innerText=e.name;var n=this.context.nima;if(e instanceof y.default){if(e.hierarchyChildren.length){for(var r=new d.default(n.stage,n.actor,this.tree),o=0;o<e.hierarchyChildren.length;o++){var i=e.hierarchyChildren[o];r.addImage(i,g.vec2.set(g.vec2.create(),i.left,-i.top))}r.start(),n.stage.markMouseDown()}}else if(e instanceof h.default||e instanceof v.default){var a=new d.default(n.stage,n.actor,this.tree);a.addImage(e),a.start(),n.stage.markMouseDown()}else if(e instanceof p.default){var s=new f.default(n.stage,n.actor,this.tree);s.addSvg(e),s.start(),n.stage.markMouseDown()}return t}},{key:"destroyDragGhost",value:function(e){}},{key:"allowDrag",value:function(e){return!0}},{key:"allowDrop",value:function(e,t,n){return null===t||t instanceof m.default}},{key:"getActualIndex",value:function(e,t,n){return n}},{key:"drop",value:function(e,t,n){t||(t=this.props.actor.assetFolder),e.parent&&e.parent.remove(e),t.add(e,!1,this.getActualIndex(e,t,n))}},{key:"show",value:function(e){this.tree.show(e)}},{key:"mouseEnter",value:function(e){var t=this.context.nima.stage.currentOperation;if(t){var n=t.meta;this.tree.handoffDrag(n),t.meta=this.tree}}},{key:"setFileDialog",value:function(e){this.fileDialog=e}},{key:"onAssetFilesSelected",value:function(e){var t=e.target.files;t&&t.length&&this.context.nima.addAssetsFromFiles(t)}},{key:"addAsset",value:function(){this.fileDialog.dispatchEvent(new MouseEvent("click"))}},{key:"addFolder",value:function(){var e=this.context.nima.actor,t=e.makeAsset("New Folder",m.default);t.assignID(),e.addAsset(t),this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e=this.getChildren,t=this.props.data;return t&&(t=e(t)),i.default.createElement("div",{className:S.default.Pane},i.default.createElement(b.default,{isDark:!0,ref:this.setTree,onMouseEnter:this.mouseEnter,makeDragGhost:this.makeDragGhost,allowDrag:this.allowDrag,drop:this.drop,allowDrop:this.allowDrop,data:t,showFirstLine:!1,hideFirstHorizontalLine:!0,height:this.props.height-65,iconWidth:40,iconHeight:30,rowHeight:50,getChildren:e,renderItem:this.renderHierarchyItem,spaceItem:this.spaceHierarchyItem}),i.default.createElement("div",{className:S.default.PaneButtonsWrapper},i.default.createElement("div",{className:S.default.PaneButton,onClick:this.addAsset},"Import"),i.default.createElement("div",{className:S.default.PaneButton,onClick:this.addFolder},i.default.createElement("svg",{className:"icon-folder-create"},i.default.createElement("use",{xlinkHref:O.default.make("/images/symbol-defs.svg#icon-folder-create")})))),t&&0===t.length?i.default.createElement("div",{className:"Tip"},"You haven't imported any assets yet. Drag and drop an SVG."):null,i.default.createElement("input",{ref:this.setFileDialog,type:"file",style:{display:"none"},multiple:!0,onChange:this.onAssetFilesSelected}))}}]),t}()).prototype,"onChildrenChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onChildrenChanged"),r.prototype),_(r.prototype,"setData",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setData"),r.prototype),_(r.prototype,"renderHierarchyItem",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"renderHierarchyItem"),r.prototype),_(r.prototype,"spaceHierarchyItem",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"spaceHierarchyItem"),r.prototype),_(r.prototype,"getChildren",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"getChildren"),r.prototype),_(r.prototype,"setTree",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTree"),r.prototype),_(r.prototype,"onAssetSelection",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onAssetSelection"),r.prototype),_(r.prototype,"makeDragGhost",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"makeDragGhost"),r.prototype),_(r.prototype,"destroyDragGhost",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"destroyDragGhost"),r.prototype),_(r.prototype,"allowDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"allowDrag"),r.prototype),_(r.prototype,"allowDrop",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"allowDrop"),r.prototype),_(r.prototype,"drop",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"drop"),r.prototype),_(r.prototype,"mouseEnter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseEnter"),r.prototype),_(r.prototype,"setFileDialog",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setFileDialog"),r.prototype),_(r.prototype,"onAssetFilesSelected",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onAssetFilesSelected"),r.prototype),_(r.prototype,"addAsset",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"addAsset"),r.prototype),_(r.prototype,"addFolder",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"addFolder"),r.prototype),r);t.default=P,P.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=l(n(229)),i=l(n(203)),a=l(n(436)),s=n(7);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o._Meta=r,o._Images=[],o._Target=null,o._IsOverStage=!1,o._Stage.clearSelections(),o._Stage.isSelectionDisabled=!0,o._Artboard=null,o._LastWorldMouse=s.vec2.create(),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"addImage",value:function(e,t){var n=this._Actor;n.initNodeLookup();var r=i.default.makeDefaultData(e),o=n.addNodeType(i.default,null,r);o?(n.recurseLoad(r.children,o),o.width=e.width,o.height=e.height,o.opacity=.5,o.setAsset(e),o.hideInHierarchy=!0,o.name=e.name,n.completeRecurseLoad(),this._Images.push({image:o,translationOffset:t||s.vec2.create()})):console.error("Wasn't able to create image")}},{key:"end",value:function(){for(var e=[],n=0;n<this._Images.length;n++){var r=this._Images[n].image;r.hideInHierarchy=!1,e.push(r.stageItem),r.parent&&(r.parent.notifyChildrenChanged(),r.dispatch("drawOrderChange"))}var o=this._Stage;o.isSelectionDisabled=!1,e.length&&o.selectItems(e,!1),function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this),a.default.remove(this)}},{key:"getTarget",value:function(){return this._Target}},{key:"target",value:function(e,t){this._Target=e;for(var n=0;n<this._Images.length;n++){var r=this._Images[n],o=r.image,i=r.translationOffset;o.parent&&o.parent.remove(o,!0),e?(o.translation=i,e.add(o,!0,t),a.default.set(this,"copy",10)):this._Actor.artboards.active&&this._Actor.artboards.active.add(o,!0)}return null===e&&this.mouseMove(this._LastWorldMouse),this.updateCursor(),!0}},{key:"cancel",value:function(){for(var e=0;e<this._Images.length;e++){var t=this._Images[e].image;t.parent&&t.parent.remove(t),t.stageItem.removeFromStage(),t.setAsset(null)}this._Images.length=0}},{key:"mouseMove",value:function(e){this._Stage;var t=this._Images;s.vec2.copy(this._LastWorldMouse,e);var n=t.length&&t[0];if(n){var r=this._Actor.artboards;this._Artboard=null;var o=!0,i=!1,a=void 0;try{for(var l,u=r.children[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(c.isPointInside(e[0],e[1])){if(c!==n.image.artboard){var d=!0,f=!1,h=void 0;try{for(var p,y=this._Images[Symbol.iterator]();!(d=(p=y.next()).done);d=!0){var v=p.value.image;v.parent.remove(v),c.add(v)}}catch(e){f=!0,h=e}finally{try{!d&&y.return&&y.return()}finally{if(f)throw h}}}c.makeActive(),this._Artboard=c;break}}}catch(e){i=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw a}}for(var m=0;m<this._Images.length;m++){var g=this._Images[m],b=g.image;if(b.stage||b.stageItem.addToStage(this._Stage),!this._Target){var k=b.root&&b.root.originWorld||[1,0,0,1,0,0];b.translation=s.vec2.add(s.vec2.create(),s.vec2.subtract(s.vec2.create(),e,k),g.translationOffset)}}this.updateCursor()}}},{key:"updateCursor",value:function(){var e=!(!this._Artboard&&!this._Target);a.default.set(this,e?"copy":"no-drop",10);var t=!0,n=!1,r=void 0;try{for(var o,i=this._Images[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.image.opacity=e?1:.5}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"mouseUp",value:function(){this._Artboard||this._Target||this.cancel(),this.end()}},{key:"mouseEnterStage",value:function(){this._IsOverStage=!0,this.updateCursor()}},{key:"mouseLeaveStage",value:function(){this._IsOverStage=!1,this.updateCursor()}},{key:"meta",get:function(){return this._Meta},set:function(e){this._Meta=e}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(229)),i=(s(n(203)),s(n(436))),a=n(7);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o._Meta=r,o._Root=null,o._Target=null,o._IsOverStage=!1,o._Stage.clearSelections(),o._Stage.isSelectionDisabled=!0,o._Artboard=null,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"addSvg",value:function(e,t){var n=e.content;if(n){var r=[],o=this._Actor;if(o.registerNodeLookup(),o.recurseLoad([n],null,r),o.completeRecurseLoad(),o.clearNodeLookup(),r.length){var i=r[0];this._Root=i,i.hideInHierarchy=!0,i.name=e.name}}}},{key:"end",value:function(){var e=this._Root;if(e){var n=[];e.hideInHierarchy=!1,n.push(e.stageItem),e.parent&&(e.parent.notifyChildrenChanged(),e.dispatch("drawOrderChange"));var r=this._Stage;r.isSelectionDisabled=!1,n.length&&r.selectItems(n,!1)}(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"end",this).call(this),i.default.remove(this)}},{key:"getTarget",value:function(){return this._Target}},{key:"target",value:function(e,t){var n=this._Root;if(n.parent&&n.parent.remove(n,!0),e){if(!n.isValidParent(e))return!1;n.translation=a.vec2.fromValues(0,0),e.add(n,!0,t),this._Target=e}else this._Actor.artboards.active&&(this._Actor.artboards.active.add(n,!0),this._Target=null);return this.updateCursor(),!0}},{key:"cancel",value:function(){var e=this._Root;e.parent&&e.parent.remove(e),e.all(function(e){e.stageItem&&e.stageItem.removeFromStage()}),this._Root=null,this._Stage.isSelectionDisabled=!1}},{key:"mouseMove",value:function(e){var t=this._Root,n=this._Stage,r=this._Actor.artboards;this._Artboard=null;var o=!0,i=!1,s=void 0;try{for(var l,u=r.children[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(c.isPointInside(e[0],e[1])){c!==t.artboard&&(t.parent.remove(t),c.add(t)),c.makeActive(),this._Artboard=c;break}}}catch(e){i=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw s}}if(t.stageItem.stage||t.all(function(e){e.stageItem.isAutomatic&&e.stageItem.addToStage(n)}),!this._Target){var d=t.root&&t.root.originWorld||[1,0,0,1,0,0];t.translation=a.vec2.subtract(a.vec2.create(),e,d)}this.updateCursor()}},{key:"updateCursor",value:function(){var e=!(!this._Artboard&&!this._Target);i.default.set(this,e?"copy":"no-drop",10);var t=this._Root;t&&(t.opacity=e?1:.5)}},{key:"mouseUp",value:function(){this._Artboard||this._Target||this.cancel(),this.end()}},{key:"meta",get:function(){return this._Meta},set:function(e){this._Meta=e}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=g(n(1)),a=g(n(5)),s=g(n(437)),l=g(n(2)),u=g(n(29)),c=g(n(237)),d=g(n(173)),f=g(n(19)),h=g(n(290)),p=g(n(163)),y=g(n(267)),v=g(n(435)),m=g(n(3));function g(e){return e&&e.__esModule?e:{default:e}}function b(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var k=(b((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={editing:!1,hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"doForceUpdate",value:function(){this.forceUpdate()}},{key:"debounceForcedUpdate",value:function(){(0,f.default)(this.doForceUpdate)}},{key:"setItem",value:function(e){var t=this.item;t!==e&&(t&&(t.removeEventListener("selectedChange",this.debounceForcedUpdate),t.removeEventListener("update",this.debounceForcedUpdate)),this.item=e,e&&(e.addEventListener("selectedChange",this.debounceForcedUpdate),e.addEventListener("update",this.debounceForcedUpdate)))}},{key:"componentWillReceiveProps",value:function(e){e.item!=this.props.item&&this.setItem(e.item)}},{key:"componentWillMount",value:function(){this.setItem(this.props.item)}},{key:"componentWillUnmount",value:function(){f.default.cancel(this.doForceUpdate),this.setItem(null)}},{key:"mouseEnter",value:function(){this.setState({hover:!0});var e=this.item;e&&e.stageItem&&e.stageItem.stage&&(this.context.nima.stage.hoverItem=e.stageItem)}},{key:"mouseLeave",value:function(){this.setState({hover:!1});var e=this.item;e&&e.stageItem&&this.context.nima.stage.hoverItem===e.stageItem&&(this.context.nima.stage.hoverItem=null)}},{key:"mouseDown",value:function(e){if(e.preventDefault(),e.stopPropagation(),this.item){var t=Date.now();if(this.clickTime){var n=t-this.clickTime;if(delete this.clickTime,n<200&&this.editableName.startEdit())return}this.clickTime=t,this.props.onSelected&&this.props.onSelected(e,this.item)}}},{key:"setEditableName",value:function(e){this.editableName=e}},{key:"rightClick",value:function(e){var t=this.props.item;if(t){var n=this.context.nima;if(t instanceof y.default){var r=n.certainSelections(function(e){return e.constructor===y.default});r.length>1&&n.showContextMenu({x:e.clientX,y:e.clientY,items:[{name:"Convert to PSD",select:function(){var e=document.createElement("input");e.addEventListener("change",function(e){var t=e.target.files&&e.target.files.length&&e.target.files[0];t&&n.actor.makeAssets([{items:[t]}]).then(function(e){if(e&&e.assets&&e.assets.length){var t=e.assets[0];if(t.constructor===s.default){var o=[],i=!0,a=!1,l=void 0;try{for(var u,c=t.children[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value,f=!0,h=!1,p=void 0;try{for(var y,v=r[Symbol.iterator]();!(f=(y=v.next()).done);f=!0){var m=y.value;if(d.name===m.name){o.push(m),m.replaceWith(d,n.actor);break}}}catch(e){h=!0,p=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw p}}}}catch(e){a=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw l}}o.length&&(n.actor.removeAssets(o),n.actor.addAsset(t),n.captureJournalEntry())}}}).catch(function(e){n.showImportFileError()})}),e.setAttribute("type","file"),e.click()}}]})}}}},{key:"render",value:function(){var e=this.props,t=e.item,n=e.dropTargetState,r=e.isDragging,o=this.state.hover,a=t.uiIcon,l=a?m.default.make("/images/symbol-defs.svg#"+a):null,f=!r&&t.isSelected,y=!(t instanceof d.default)||t.isVisible,g=t.filterState,b=!y||0!=(g&(h.default.SemiHidden|h.default.Collapsed)),k=!1,S=t.parent;S instanceof c.default&&(k=S.activeChild===t),r&&(o=!1);var O=!r&&o,w=[u.default.ItemContent];switch(f?w.push(u.default.Selected):O?w.push(u.default.Hovered):b&&w.push(u.default.Hidden),n){case p.default.DropTargetParent:w.push(u.default.DropTargetParent);break;case p.default.DropTarget:w.push(u.default.DropTarget);break;case p.default.DropDisabled:w.push(u.default.DropDisabled)}var _=t.imgSrc?"url('"+t.imgSrc+"')":null,P=null;switch(t.constructor){case s.default:P=u.default.PsdDecor}return i.default.createElement("div",{className:u.default.ItemContentWrapper,onClick:this.mouseDown,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave,onContextMenu:this.rightClick},S instanceof c.default?i.default.createElement("div",{style:{display:"inline-block"},className:u.default.Toggle,onMouseEnter:this.enterToggleActive,onClick:this.toggleActive},i.default.createElement("div",{style:{opacity:k?1:0}})):null,i.default.createElement("div",{className:w.join(" ")},i.default.createElement("div",{className:u.default.TreeIcon+(_?" "+u.default.AssetIconBG:""),style:{backgroundImage:_||null}},_?P?i.default.createElement("div",{className:u.default.ThumbDecor},i.default.createElement("svg",{className:P,style:{pointerEvents:"none"}},i.default.createElement("use",{xlinkHref:l}))):null:i.default.createElement("svg",{className:"HierarchyImageIcon",style:{pointerEvents:"none"}},i.default.createElement("use",{xlinkHref:l}))),i.default.createElement(v.default,{ref:this.setEditableName,item:t})),null,null)}}]),t}()).prototype,"doForceUpdate",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"doForceUpdate"),r.prototype),b(r.prototype,"debounceForcedUpdate",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"debounceForcedUpdate"),r.prototype),b(r.prototype,"mouseEnter",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseEnter"),r.prototype),b(r.prototype,"mouseLeave",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseLeave"),r.prototype),b(r.prototype,"mouseDown",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),b(r.prototype,"setEditableName",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"setEditableName"),r.prototype),b(r.prototype,"rightClick",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"rightClick"),r.prototype),r);t.default=k,k.contextTypes={nima:a.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=y(n(1)),a=y(n(2)),s=y(n(5)),l=y(n(290)),u=y(n(16)),c=y(n(163)),d=y(n(1177)),f=y(n(534)),h=y(n(254)),p=y(n(3));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var m=(v((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.setData(this.props.data)}},{key:"componentWillReceiveProps",value:function(e){e.data!=this.props.data&&this.setData(e.data)}},{key:"componentWillUnmount",value:function(){this.setData(null)}},{key:"onChildrenChanged",value:function(){this.forceUpdate()}},{key:"setData",value:function(e){if(this.data!==e){var t=this.data;t&&t.removeEventListener("childrenChanged",this.onChildrenChanged),this.data=e,e&&e.addEventListener("childrenChanged",this.onChildrenChanged)}}},{key:"renderItem",value:function(e,t,n){return i.default.createElement(d.default,{isDragging:t,dropTargetState:n,item:e,onSelected:this.onAnimationSelected})}},{key:"updateFilter",value:function(e){this.tree&&(this.tree.overrideExpansion(e?function(e){return 0!=(e.filterState&l.default.Expanded)}:null),this.forceUpdate())}},{key:"getChildren",value:function(e){if(!e.hierarchyChildren)return null;var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=e.hierarchyChildren[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.hideInHierarchy||s.filterState===l.default.Hidden||t.push(s)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return t}},{key:"setTree",value:function(e){this.tree=e}},{key:"onAnimationSelected",value:function(e,t){var n=this.context.nima;if(2!==e.button||!t.isSelected){var r=this.context.nima.stage;r.selectedItems.length>0&&r.clearSelections(!0),this.context.nima.clearCertainSelections(function(e){return e.constructor!==h.default})}if(t.isSelected&&u.default.isMultiSelect(e))n.deselectItem(t,!1);else if(e.shiftKey){var o=n.selectedItems;if(0===o.length)n.selectItem(t,!1,this);else{var i=this.tree.getRangeItems(o,t);null!==i&&(n.clearSelections(!0),n.selectItems(i,!0,this))}}else{u.default.isMultiSelect(e)||n.clearSelections(!0),n.selectItem(t,!0,this)}}},{key:"makeDragGhost",value:function(e,t){var n=this.context.nima,r=this.props.data;if(r){e.isSelected||this.onAnimationSelected(t,e);var o=r.hierarchyChildren,i=n.selectedItems,a=this.dragImage=document.createElement("div");a.className="HierarchyDragGhost";var s=i.filter(function(e){return e.constructor===h.default}).sort(function(e,t){return e.order-t.order}),l=!0,u=!1,c=void 0;try{for(var d,f=s[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p=d.value,y=document.createElement("div");y.innerText=p.name,a.appendChild(y)}}catch(e){u=!0,c=e}finally{try{!l&&f.return&&f.return()}finally{if(u)throw c}}var v=0,m=o.map(function(e){return{animation:e,order:++v,isDragging:-1!==s.indexOf(e)}});return this.dragData={order:m,dragItems:s},{ghost:a,items:s}}}},{key:"allowDrag",value:function(e){return!0}},{key:"allowDrop",value:function(e,t,n){return!t}},{key:"drop",value:function(e,t,n){for(var r=this.context.nima,o=this.dragData,i=o.order,a=o.dragItems,s=[],l=0;l<=i.length;l++){var u=i[l];if(l===n){var c=!0,d=!1,f=void 0;try{for(var h,p=a[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var y=h.value;s.push(y)}}catch(e){d=!0,f=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw f}}}u&&!u.isDragging&&s.push(u.animation)}for(var v=0;v<s.length;v++)s[v].order=v;r.captureJournalEntry()}},{key:"show",value:function(e){this.tree.show(e)}},{key:"addAnimation",value:function(){var e=this.context.nima,t=e.actor.artboards.active;if(t){var n=t.createAnimation();n.editImmediately=!0,e.editingAnimation=n,e.captureJournalEntry()}else e.stage.displayWarning({title:"No Artboards.",message:"Create an artboard first to add animations."})}},{key:"render",value:function(){var e=this.getChildren,t=this.props.data;return t&&(t=e(t)),i.default.createElement("div",{className:f.default.Pane},i.default.createElement(c.default,{isDark:!0,ref:this.setTree,makeDragGhost:this.makeDragGhost,allowDrag:this.allowDrag,drop:this.drop,allowDrop:this.allowDrop,data:t,showFirstLine:!1,hideFirstHorizontalLine:!0,height:this.props.height-65,iconWidth:15,iconHeight:15,rowHeight:35,getChildren:e,renderItem:this.renderItem}),i.default.createElement("div",{className:f.default.PaneButtonsWrapper},i.default.createElement("div",{className:f.default.PaneButton,onClick:this.addAnimation},i.default.createElement("svg",{className:"icon-plus"},i.default.createElement("use",{xlinkHref:p.default.make("/images/symbol-defs.svg#icon-plus")})))))}}]),t}()).prototype,"onChildrenChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onChildrenChanged"),r.prototype),v(r.prototype,"setData",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setData"),r.prototype),v(r.prototype,"renderItem",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"renderItem"),r.prototype),v(r.prototype,"getChildren",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"getChildren"),r.prototype),v(r.prototype,"setTree",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTree"),r.prototype),v(r.prototype,"onAnimationSelected",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onAnimationSelected"),r.prototype),v(r.prototype,"makeDragGhost",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"makeDragGhost"),r.prototype),v(r.prototype,"allowDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"allowDrag"),r.prototype),v(r.prototype,"allowDrop",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"allowDrop"),r.prototype),v(r.prototype,"drop",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"drop"),r.prototype),v(r.prototype,"addAnimation",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"addAnimation"),r.prototype),r);t.default=m,m.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=y(n(1)),a=y(n(5)),s=y(n(2)),l=y(n(29)),u=y(n(254)),c=y(n(19)),d=(y(n(290)),y(n(163))),f=y(n(435)),h=y(n(669)),p=y(n(3));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var m=(v((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={editing:!1,hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"doForceUpdate",value:function(){this.forceUpdate()}},{key:"debounceForcedUpdate",value:function(){(0,c.default)(this.doForceUpdate)}},{key:"setItem",value:function(e){var t=this.item;t!==e&&(t&&(t.removeEventListener("nameChanged",this.debounceForcedUpdate),t.removeEventListener("selectedChange",this.debounceForcedUpdate),t.removeEventListener("activeChange",this.debounceForcedUpdate),t.removeEventListener("play",this.debounceForcedUpdate)),this.item=e,e&&(e.addEventListener("nameChanged",this.debounceForcedUpdate),e.addEventListener("selectedChange",this.debounceForcedUpdate),e.addEventListener("activeChange",this.debounceForcedUpdate),e.addEventListener("play",this.debounceForcedUpdate)))}},{key:"componentWillReceiveProps",value:function(e){e.item!=this.props.item&&this.setItem(e.item)}},{key:"componentDidUpdate",value:function(){var e=this.props.item;e&&e.editImmediately&&this.editableName&&(e.editImmediately=!1,this.editableName.startEdit())}},{key:"componentWillMount",value:function(){this.setItem(this.props.item)}},{key:"componentWillUnmount",value:function(){c.default.cancel(this.doForceUpdate),this.setItem(null)}},{key:"mouseEnter",value:function(){this.setState({hover:!0});this.item}},{key:"mouseLeave",value:function(){this.setState({hover:!1});this.item}},{key:"mouseDown",value:function(e){if(e.preventDefault(),e.stopPropagation(),this.item){var t=Date.now();if(this.clickTime){var n=t-this.clickTime;if(delete this.clickTime,n<200&&this.editableName.startEdit())return}this.clickTime=t,this.props.onSelected&&this.props.onSelected(e,this.item)}}},{key:"toggleActive",value:function(e){e.stopPropagation();var t=this.item;t&&(this.context.nima.editingAnimation=t)}},{key:"setEditableName",value:function(e){this.editableName=e}},{key:"rightClick",value:function(e){var t=this.props.item;if(t){var n=this,r=this.context.nima,o=r.certainSelections(function(e){return e.constructor===u.default}),i=o.length>1?o:[t],a=r.actor.artboards.active,s=[{name:"Duplicate",select:function(){a.duplicateAnimations(i),r.captureJournalEntry()}},{name:"Delete",select:function(){r.removeAnimations(i),r.captureJournalEntry()}}];i.length<=1&&s.push({name:"Rename",select:function(){n.editableName&&n.editableName.startEdit()}}),s.push({type:"Divider"},{type:"SubMenu",name:"Sort",items:[{name:"Alphabetically",select:function(){r.sortAnimations(h.default.SortOrder.Alphabetical)}},{name:"Date Created",select:function(){r.sortAnimations(h.default.SortOrder.Created)}}]}),r.showContextMenu({x:e.clientX,y:e.clientY,items:s})}}},{key:"togglePlay",value:function(e){var t=this.props.item;e.stopPropagation(),e.preventDefault(),t.isPlaying=!t.isPlaying}},{key:"render",value:function(){var e=this.context.nima,t=this.props,n=t.item,r=t.dropTargetState,o=t.isDragging,a=this.state.hover,s=n.uiHierIconClass,u=n.uiIcon,c=u?p.default.make("/images/symbol-defs.svg#"+u):null,h=!o&&n.isSelected,y=e.editingAnimation===n;o&&(a=!1);var v=!o&&a,m=[l.default.ItemContent];switch(h?m.push(l.default.Selected):v&&m.push(l.default.Hovered),r){case d.default.DropTargetParent:m.push(l.default.DropTargetParent);break;case d.default.DropTarget:m.push(l.default.DropTarget);break;case d.default.DropDisabled:m.push(l.default.DropDisabled)}return i.default.createElement("div",{className:l.default.ItemContentWrapper,onClick:this.mouseDown,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave,onContextMenu:this.rightClick},i.default.createElement("div",{style:{display:"inline-block"},className:l.default.Toggle,onMouseEnter:this.enterToggleActive,onClick:this.toggleActive},i.default.createElement("div",{style:{opacity:y?1:0}})),i.default.createElement("div",{className:m.join(" ")},i.default.createElement("div",{className:l.default.TreeIcon,onClick:this.togglePlay},i.default.createElement("svg",{className:s,style:{pointerEvents:"none"}},i.default.createElement("use",{xlinkHref:c}))),i.default.createElement(f.default,{ref:this.setEditableName,item:n})),null,null)}}]),t}()).prototype,"doForceUpdate",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"doForceUpdate"),r.prototype),v(r.prototype,"debounceForcedUpdate",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"debounceForcedUpdate"),r.prototype),v(r.prototype,"mouseEnter",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseEnter"),r.prototype),v(r.prototype,"mouseLeave",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseLeave"),r.prototype),v(r.prototype,"mouseDown",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),v(r.prototype,"toggleActive",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleActive"),r.prototype),v(r.prototype,"setEditableName",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setEditableName"),r.prototype),v(r.prototype,"rightClick",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"rightClick"),r.prototype),v(r.prototype,"togglePlay",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"togglePlay"),r.prototype),r);t.default=m,m.contextTypes={nima:a.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=f(n(1)),s=f(n(2)),l=f(n(1179)),u=f(n(670)),c=f(n(5)),d=f(n(3));function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var m=(v((r=function(e){function t(e){h(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={activeIndex:0},n}return y(t,a.default.Component),i(t,[{key:"tabClick",value:function(e){this.props.children&&this.props.children.indexOf&&this.setState({activeIndex:this.props.children.indexOf(e)})}},{key:"render",value:function(){var e=this,t=Array.isArray(this.props.children)?this.props.children:[this.props.children],n=Math.min(t.length-1,this.state.activeIndex),r=n>=0?t[n]:null,o=0;return a.default.createElement("div",{className:l.default.TabPanel},a.default.createElement("div",{className:l.default.TabButtonsWrapper},t.filter(function(e){return!e.props.isHidden}).map(function(t){return a.default.createElement(g,{key:o++,active:r===t,child:t,onClick:e.tabClick,label:t.props.title,icon:t.props.icon,keyFrameHandler:t.props.keyFrameHandler})})),r)}},{key:"activeIndex",set:function(e){this.setState({activeIndex:e})},get:function(){return this.state.activeIndex}}]),t}()).prototype,"tabClick",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"tabClick"),r.prototype),r);t.default=m;var g=(v((o=function(e){function t(e){h(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return y(t,a.default.Component),i(t,[{key:"tabClick",value:function(){this.props.onClick(this.props.child)}},{key:"doUpdate",value:function(){this.forceUpdate()}},{key:"setKeyFrameHandler",value:function(e){var t=this.keyFrameHandler;t&&t.dispatcher.removeEventListener(t.event,this.doUpdate),this.keyFrameHandler=e,e&&e.dispatcher.addEventListener(e.event,this.doUpdate)}},{key:"setKeyFrame",value:function(e){var t=this.props.keyFrameHandler;t&&(e.stopPropagation(),t.setKey(this.context.nima),this.context.nima.captureJournalEntry())}},{key:"componentWillReceiveProps",value:function(e){e.keyFrameHandler!=this.props.keyFrameHandler&&this.setKeyFrameHandler(e.keyFrameHandler)}},{key:"render",value:function(){var e=this.props.keyFrameHandler,t=!!e,n=t?e.state:0;return a.default.createElement("div",{className:l.default.TabButton+(this.props.active?" "+l.default.TabButtonActive:""),onClick:this.tabClick},this.props.icon?a.default.createElement("div",{className:l.default.TabIcon},a.default.createElement("svg",{className:this.props.icon},a.default.createElement("use",{xlinkHref:d.default.make("/images/symbol-defs.svg#"+this.props.icon)}))):null,a.default.createElement("span",{title:this.props.label},this.props.label),t?a.default.createElement("div",{className:0==n?u.default.HieararchyKey:1==n?u.default.HieararchyKeyChanged:u.default.HieararchyKeyed,onClick:this.setKeyFrame,style:{marginTop:"1px"}}):null)}}]),t}()).prototype,"tabClick",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"tabClick"),o.prototype),v(o.prototype,"doUpdate",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"doUpdate"),o.prototype),v(o.prototype,"setKeyFrame",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"setKeyFrame"),o.prototype),o);g.contextTypes={nima:c.default.object}},function(e,t,n){var r=n(1180);"string"==typeof r&&(r=[[e.i,r,""]]);var o={insertAt:"top",hmr:!0,transform:void 0};n(14)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(13)(!1)).push([e.i,'.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabPanel-3UC_w {\n  border-top: 1px solid rgba(255, 255, 255, 0.1); }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabPanel-3UC_w:before {\n  content: "";\n  background: -webkit-gradient(linear, left top, left bottom, from(rgba(0, 0, 0, 0)), to(black));\n  background: linear-gradient(rgba(0, 0, 0, 0), black);\n  height: 10px;\n  position: absolute;\n  width: 100%;\n  opacity: .07;\n  margin-top: -10px;\n  pointer-events: none; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButtonsWrapper-2lR8B {\n  padding-left: 10px; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButton-2UJ50 {\n  height: 48px;\n  display: -webkit-inline-box;\n  display: -ms-inline-flexbox;\n  display: inline-flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  font-weight: 400;\n  font-size: 11px;\n  text-transform: uppercase;\n  border-top: 1px solid rgba(0, 0, 0, 0);\n  position: relative;\n  cursor: pointer;\n  margin: -1px 10px 0 10px;\n  color: #fff;\n  -webkit-transition: border-top 0.1s ease-in-out, color 0.1s ease-in-out, opacity 0.1s ease-in-out;\n  transition: border-top 0.1s ease-in-out, color 0.1s ease-in-out, opacity 0.1s ease-in-out; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButton-2UJ50:before,\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButton-2UJ50:after {\n  content: "";\n  position: absolute;\n  height: 100%;\n  width: 10px;\n  left: -10px;\n  top: 0; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButton-2UJ50:after {\n  left: initial;\n  right: -10px; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButton-2UJ50:hover span,\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButton-2UJ50:hover .source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabIcon-y23BF {\n  opacity: .6; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButton-2UJ50 span {\n  opacity: .25; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButton-2UJ50 span:after {\n  content: attr(title);\n  font-weight: 600;\n  display: block;\n  height: 0;\n  visibility: hidden; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButtonActive-1rLIm {\n  border-top: 1px solid #fff;\n  font-weight: 600; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButtonActive-1rLIm span,\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButtonActive-1rLIm .source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabIcon-y23BF {\n  opacity: .6; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabIcon-y23BF {\n  fill: #fff;\n  -webkit-transition: fill .1s ease-in-out;\n  transition: fill .1s ease-in-out;\n  margin-right: 5px;\n  width: 15px;\n  height: 15px;\n  position: relative;\n  opacity: .25;\n  -ms-flex-negative: 0;\n      flex-shrink: 0; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabIcon-y23BF svg {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(calc(-50% + 0.5px), calc(-50% + 0.5px));\n      -ms-transform: translate(calc(-50% + 0.5px), calc(-50% + 0.5px));\n          transform: translate(calc(-50% + 0.5px), calc(-50% + 0.5px)); }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-Pane-FrF6h {\n  position: relative; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-AddButton-2Zlec {\n  width: 100%;\n  height: 26px;\n  background: rgba(228, 228, 228, 0.95);\n  bottom: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  border-radius: 5px; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-PlusIcon-3WZwd {\n  width: 20px;\n  height: 20px;\n  fill: #888; }\n\n.source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-AddButton-2Zlec:hover .source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-PlusIcon-3WZwd {\n  fill: #333; }\n',""]),t.locals={TabPanel:"source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabPanel-3UC_w",TabButtonsWrapper:"source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButtonsWrapper-2lR8B",TabButton:"source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButton-2UJ50",TabIcon:"source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabIcon-y23BF",TabButtonActive:"source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-TabButtonActive-1rLIm",Pane:"source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-Pane-FrF6h",AddButton:"source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-AddButton-2Zlec",PlusIcon:"source-client-source-editors-flare-ui-Components-Hierarchy-TabPanel-PlusIcon-3WZwd"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(2)),s=c(n(438)),l=c(n(3)),u=c(n(5));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"mouseOver",value:function(){this.context.tooltip.enter(this)}},{key:"mouseOut",value:function(){this.context.tooltip.leave(this)}},{key:"click",value:function(e){this.context.tooltip.click(this),this.props.onPress&&this.props.onPress(this.props.context,e)}},{key:"render",value:function(){return i.default.createElement("svg",{className:this.props.disabled?s.default.AlignBtn+" "+s.default.AlignBtnDisabled:s.default.AlignBtn,onClick:this.click,onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut},i.default.createElement("use",{xlinkHref:l.default.make("/images/symbol-defs.svg#"+this.props.icon)}))}}]),t}()).prototype,"mouseOver",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOver"),r.prototype),d(r.prototype,"mouseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOut"),r.prototype),d(r.prototype,"click",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"click"),r.prototype),r);t.default=f,f.contextTypes={tooltip:u.default.object}},function(e,t,n){(t=e.exports=n(13)(!1)).push([e.i,'.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-SelectionPanelContent-8YCh7 {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  overflow-y: auto; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignGroup-1vVHH {\n  border-bottom: 1px solid rgba(255, 255, 255, 0.08);\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  margin-left: 20px;\n  padding: 15px 20px 15px 0; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignBtn-1fWH3 {\n  width: 13px;\n  height: 14px;\n  border: 5px solid rgba(0, 0, 0, 0);\n  opacity: .5;\n  -webkit-transition: opacity .1s ease-in-out;\n  transition: opacity .1s ease-in-out;\n  fill: #fff;\n  -ms-flex-negative: 0;\n      flex-shrink: 0; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignBtn-1fWH3:hover {\n  opacity: 1; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignBtn-1fWH3:first-child {\n  margin-left: -5px; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignBtn-1fWH3:last-child {\n  margin-right: -5px; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignSpacer-D1s5F {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignBtnDisabled-6Oh5D,\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignBtnDisabled-6Oh5D:hover {\n  opacity: .15 !important; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPanel-3Ib2r {\n  height: 304px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n  overflow-y: auto; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPanel-3Ib2r:before {\n  content: "";\n  background: -webkit-gradient(linear, left top, left bottom, from(rgba(0, 0, 0, 0)), to(black));\n  background: linear-gradient(rgba(0, 0, 0, 0), black);\n  height: 10px;\n  position: absolute;\n  width: 100%;\n  opacity: .07;\n  margin-top: -10px;\n  pointer-events: none; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationContent-2iF4D {\n  margin-left: 20px;\n  padding: 20px 20px 20px 0;\n  position: relative; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPanelTitle-3bJ0_ {\n  font-size: 11px;\n  opacity: .6;\n  font-weight: 600;\n  text-transform: uppercase;\n  margin-bottom: 20px; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationGraph-144gt {\n  width: 100%;\n  padding-bottom: 100%;\n  background: rgba(255, 255, 255, 0.04);\n  border-radius: 5px;\n  position: relative;\n  margin-bottom: 16px; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationGraph-144gt canvas {\n  position: fixed;\n  top: 0px;\n  height: 100%;\n  margin-left: -20px;\n  z-index: 10;\n  pointer-events: none; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationGraphLineTop-2T9-5,\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationGraphLineBot-Q3Nmr {\n  position: absolute;\n  height: 1px;\n  background: #fff;\n  opacity: .06;\n  width: 100%;\n  top: 10%; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationGraphLineBot-Q3Nmr {\n  top: initial;\n  bottom: 10%; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPresetRow-34Lgy {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-bottom: 10px; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPresetThumb-15TlY {\n  background: rgba(255, 255, 255, 0.04);\n  border-radius: 5px;\n  width: 30px;\n  height: 30px;\n  margin-right: 10px; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPresetLabel-22wKx {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  opacity: .5; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationNoSelection-_ABMF {\n  opacity: .3;\n  pointer-events: none; }\n\n.source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationGraphNoSelection-2QW6G {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  opacity: .3; }\n',""]),t.locals={SelectionPanelContent:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-SelectionPanelContent-8YCh7",AlignGroup:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignGroup-1vVHH",AlignBtn:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignBtn-1fWH3",AlignSpacer:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignSpacer-D1s5F",AlignBtnDisabled:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-AlignBtnDisabled-6Oh5D",InterpolationPanel:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPanel-3Ib2r",InterpolationContent:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationContent-2iF4D",InterpolationPanelTitle:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPanelTitle-3bJ0_",InterpolationGraph:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationGraph-144gt",InterpolationGraphLineTop:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationGraphLineTop-2T9-5",InterpolationGraphLineBot:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationGraphLineBot-Q3Nmr",InterpolationPresetRow:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPresetRow-34Lgy",InterpolationPresetThumb:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPresetThumb-15TlY",InterpolationPresetLabel:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationPresetLabel-22wKx",InterpolationNoSelection:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationNoSelection-_ABMF",InterpolationGraphNoSelection:"source-client-source-editors-flare-ui-Components-SelectionPanel-SelectionPanelStyles-InterpolationGraphNoSelection-2QW6G"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.round(100*e)/100}},{key:"toInputValue",value:function(e){return e}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e);if(t<0||Number.isNaN(t))throw"Invalid input";return t}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"defaultValue",get:function(){return 1}},{key:"allowDrag",get:function(){return!0}},{key:"dragScale",get:function(){return.01}},{key:"dragMin",get:function(){return 0}},{key:"dragMax",get:function(){return 1}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=p(n(1)),a=p(n(2)),s=p(n(5)),l=p(n(238)),u=p(n(231)),c=p(n(1185)),d=p(n(219)),f=p(n(198)),h=p(n(175));function p(e){return e&&e.__esModule?e:{default:e}}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var v=(y((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hasConstrast:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"hasContrastChange",value:function(e){this.setState({hasContrast:e})}},{key:"setBoneItems",value:function(e){var t=null;if(e)for(var n=0;n<e.length;n++){var r=e[n];if(r.node){var o=r.node;null===t&&(t=[]),-1===t.indexOf(o)&&t.push(o)}}if(!(0,h.default)(this.actorBones,t)){if(this.actorBones)for(var i=0;i<this.actorBones.length;i++){this.actorBones[i].removeEventListener("hasContrastChange",this.hasContrastChange)}if(this.actorBones=t,t){for(var a=!0,s=0;s<this.actorBones.length;s++){var l=this.actorBones[s];l.hasContrast||(a=!1),l.addEventListener("hasContrastChange",this.hasContrastChange)}this.setState({hasContrast:a})}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setBoneItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setBoneItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setBoneItems(null)}},{key:"toggleContrast",value:function(e){this.context.nima.withSelected([d.default,f.default],function(t){t.hasContrast=e}),this.context.nima.captureJournalEntry()}},{key:"sizeChanging",value:function(e){e&&this.context.nima.withSelected([d.default,f.default],function(t){t.size=e})}},{key:"sizeChangeComplete",value:function(){this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e=null;return this.actorBones&&this.actorBones.length&&(e=this.actorBones[0].size),i.default.createElement(u.default,{label:"Bone Options",_key:"_BoneOpts"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitleSwitch"},"Contrast"),i.default.createElement(l.default,{isOn:this.state.hasContrast,onToggle:this.toggleContrast})),i.default.createElement(c.default,{ref:"sizeSlider",label:"Bone Size",value:e,minValue:f.default.MinimumSize,maxValue:f.default.MaximumSize,onValueChanged:this.sizeChanging,onValueChangeComplete:this.sizeChangeComplete}))}}]),t}()).prototype,"hasContrastChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"hasContrastChange"),r.prototype),y(r.prototype,"toggleContrast",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleContrast"),r.prototype),y(r.prototype,"sizeChanging",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"sizeChanging"),r.prototype),y(r.prototype,"sizeChangeComplete",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"sizeChangeComplete"),r.prototype),r);t.default=v,v.contextTypes={nima:s.default.object},v.canMultiEdit=!0,v.panelOrder=3,v.validate=function(e,t){return!e.state.isAnimationOpen}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(1186)),s=l(n(2));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"updateValue",value:function(e,t){var n=this.props.minValue||0;e=n+e*((this.props.maxValue||1)-n),this.setState({value:e}),!t&&this.props.onValueChanged&&this.props.onValueChanged(e)}},{key:"setValue",value:function(e,t){var n=this.props.minValue||0,r=(e-n)/((this.props.maxValue||1)-n);this.refs.slider.setValue(r,t),t&&this.updateValue(r,!0)}},{key:"componentDidMount",value:function(){void 0!==this.props.value&&null!==this.props.value&&this.setValue(this.props.value,!0)}},{key:"componentWillReceiveProps",value:function(e){void 0!==e.value&&e.value!=this.props.value&&this.setValue(e.value,!0)}},{key:"valueChangeComplete",value:function(){this.props.onValueChangeComplete&&this.props.onValueChangeComplete()}},{key:"render",value:function(){var e=Math.round(this.state.value*(this.props.displayScale||1));return i.default.createElement("div",null,i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitleSlider"},this.props.label),i.default.createElement("div",{className:"SelectionPanelSliderValue"},e)),i.default.createElement(a.default,{ref:"slider",onValueChanged:this.updateValue,onValueChangeComplete:this.valueChangeComplete}))}}]),t}()).prototype,"updateValue",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"updateValue"),r.prototype),u(r.prototype,"valueChangeComplete",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"valueChangeComplete"),r.prototype),r);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(1)),a=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var u=(l((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.value=0}},{key:"setValue",value:function(e,t){this.value!=e&&(this.value=e,!t&&this.props.onValueChanged&&this.props.onValueChanged(e),this.setState({value:e}))}},{key:"startDrag",value:function(e){this.lastX=e.clientX,this.width=this.slider.getBoundingClientRect().width,this.grabberX=this.width*this.value,e.preventDefault(),e.stopPropagation(),window.addEventListener("mouseup",this.stopDrag,!0),window.addEventListener("mousemove",this.drag,!0)}},{key:"stopDrag",value:function(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("mouseup",this.stopDrag,!0),window.removeEventListener("mousemove",this.drag,!0),this.props.onValueChangeComplete&&this.props.onValueChangeComplete()}},{key:"drag",value:function(e){e.preventDefault(),e.stopPropagation();var t=e.clientX-this.lastX;this.grabberX+=t,this.grabberX<0?(t+=-this.grabberX,this.grabberX=0):this.grabberX>this.width&&(t-=this.grabberX-this.width,this.grabberX=this.width),this.lastX+=t,this.setValue(this.grabberX/this.width)}},{key:"setSlider",value:function(e){this.slider=e}},{key:"render",value:function(){return i.default.createElement("div",{ref:this.setSlider,className:"Slider"},i.default.createElement("div",{className:"SliderTrack"},i.default.createElement("div",{className:"SliderActiveTrack",style:{width:100*this.state.value+"%"}},i.default.createElement("div",{className:"SliderGrabber",onMouseDown:this.startDrag}))))}}]),t}()).prototype,"startDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"startDrag"),r.prototype),l(r.prototype,"stopDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"stopDrag"),r.prototype),l(r.prototype,"drag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"drag"),r.prototype),l(r.prototype,"setSlider",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setSlider"),r.prototype),r);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=S(n(1)),a=S(n(2)),s=S(n(5)),l=S(n(209)),u=S(n(231)),c=S(n(238)),d=S(n(220)),f=S(n(539)),h=S(n(303)),p=S(n(171)),y=S(n(216)),v=S(n(1188)),m=S(n(1189)),g=S(n(19)),b=S(n(175)),k=S(n(3));function S(e){return e&&e.__esModule?e:{default:e}}function O(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var w=(O((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isJelly:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"eachJelly",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.actorBones[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value.jelly;a&&e(a)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"changeJellySegments",value:function(e){this.eachJelly(function(t){t.segments=e}),this.context.nima.captureJournalEntry()}},{key:"changeEaseIn",value:function(e,t){this.eachJelly(function(t){t.easeIn=e}),t||this.context.nima.captureJournalEntry()}},{key:"changeEaseOut",value:function(e,t){this.eachJelly(function(t){t.easeOut=e}),t||this.context.nima.captureJournalEntry()}},{key:"changeScaleIn",value:function(e,t){this.eachJelly(function(t){t.scaleIn=e}),t||this.context.nima.captureJournalEntry()}},{key:"changeScaleOut",value:function(e,t){this.eachJelly(function(t){t.scaleOut=e}),t||this.context.nima.captureJournalEntry()}},{key:"jellyChange",value:function(){(0,g.default)(this.revalidate)}},{key:"revalidate",value:function(){this.forceUpdate()}},{key:"toggleJelly",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.actorBones[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.isJelly=e}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"setBoneItems",value:function(e){var t=null;if(e)for(var n=0;n<e.length;n++){var r=e[n];if(r.node){var o=r.node;if(o.constructor===h.default&&!(o=o.parent))continue;null===t&&(t=[]),-1===t.indexOf(o)&&t.push(o)}}if(!(0,b.default)(this.actorBones,t)){if(this.actorBones){var i=!0,a=!1,s=void 0;try{for(var l,u=this.actorBones[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){l.value.removeEventListener("jellyChange",this.jellyChange)}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}if(this.actorBones=t,t){var c=!0,d=!1,f=void 0;try{for(var p,y=t[Symbol.iterator]();!(c=(p=y.next()).done);c=!0){p.value.addEventListener("jellyChange",this.jellyChange)}}catch(e){d=!0,f=e}finally{try{!c&&y.return&&y.return()}finally{if(d)throw f}}}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setBoneItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setBoneItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setBoneItems(null),g.default.cancel(this.revalidate)}},{key:"changeDisplayIndex",value:function(e){if(!(e<0)){var t=_[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.actorBones[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.jelly;s&&(s.hideJellies=!t.jelly,s.hideBone=!t.bone)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}var l=null;if(t.jelly){if(!t.bone){l=[];var u=!0,c=!1,d=void 0;try{for(var f,h=this.actorBones[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value.jellyBones;l=l.concat(p)}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}}}else l=this.actorBones.slice(0);if(l){var y=this.context.nima.stage;(0,g.default)(function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=l[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.stageItem&&e.push(a.stageItem)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}y.selectItems(e)})}this.context.nima.captureJournalEntry()}}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"pickedTarget",value:function(e,t){this.pickTargetAlert&&(this.pickTargetAlert.hide(),this.pickTargetAlert=null);var n=this.context.nima,r=n.stage;r.clearRerouteSelection(this.rerouteCB),n.clearCancelCallback(this.cancelCB),r.clearExtraSelectionFilter(),delete this.rerouteCB,delete this.cancelCB,e&&e(t)}},{key:"pickTarget",value:function(e){var n=this.context.nima,r=n.stage;if(!this.pickTargetAlert&&!r.soloItem){var o=this;this.pickTargetAlert=n.alert({title:"Pick Target",message:"Select the item to use as a target.",type:p.default.Types.State,buttons:[{label:"CLEAR",action:function(t,n){o.pickedTarget(e,null),e(null)}},{label:"CANCEL",action:function(t,n){o.pickedTarget(e)}}]}),this.cancelCB=function(t){o.pickedTarget(e)},this.rerouteCB=function(t){o.pickedTarget(e,t)},n.setCancelCallback(this.cancelCB),r.rerouteSelection(this.rerouteCB);var i=l.default.validate(t.Validation,this.actorBones).root;r.setExtraSelectionFilter(function(e){return!e.drawAfterSelections&&e.node&&e.node.root===i})}}},{key:"pickInTarget",value:function(){var e=this,t=this.context.nima;this.pickTarget(function(n){void 0!==n&&(e.eachJelly(function(e){t.detectDependencyCycles(function(){e.inTarget=n.node})}),e.context.nima.captureJournalEntry())})}},{key:"pickOutTarget",value:function(){var e=this,t=this.context.nima;this.pickTarget(function(n){void 0!==n&&(e.eachJelly(function(e){t.detectDependencyCycles(function(){e.outTarget=n.node})}),e.context.nima.captureJournalEntry())})}},{key:"removeInTarget",value:function(){this.eachJelly(function(e){e.inTarget=null}),this.context.nima.captureJournalEntry()}},{key:"removeOutTarget",value:function(){this.eachJelly(function(e){console.log("REMOVING JELLY",e),e.outTarget=null}),this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.actorBones),n=this.props.isAnimating,r=e.isJelly,o=e.segments,a=e.easeIn,s=e.easeOut,h=e.scaleIn,p=e.scaleOut,g=e.displayIndex,b=e.inTarget,S=e.outTarget;return i.default.createElement(u.default,{_key:"_JellyOpts",label:"Jelly Bones",action:n?null:i.default.createElement(c.default,{isOn:r,onToggle:this.toggleJelly})},i.default.createElement("div",{className:"EditMeshOptions",style:{opacity:r?1:.4,pointerEvents:r?"all":"none"}},i.default.createElement("div",null,i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Segments"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(y.default,{value:o,converter:v.default,onValueChanged:this.changeJellySegments,onValueCommit:this.commit,disabled:!1}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Ease In"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(y.default,{value:a,converter:m.default,onValueChanged:this.changeEaseIn,onValueCommit:this.commit,disabled:!1}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Ease Out"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(y.default,{value:s,converter:m.default,onValueChanged:this.changeEaseOut,onValueCommit:this.commit,disabled:!1}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Scale In"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(y.default,{value:h,dragScale:.001,onValueChanged:this.changeScaleIn,onValueCommit:this.commit,disabled:!1}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Scale Out"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(y.default,{value:p,dragScale:.001,onValueChanged:this.changeScaleOut,onValueCommit:this.commit,disabled:!1}))),i.default.createElement("div",{style:{marginBottom:"10px"}},i.default.createElement("div",{onClick:this.pickInTarget,className:"SelectionPanelButton MeshBonesHeader",style:{borderRadius:b?null:"20px"}},i.default.createElement("span",null,"In Target"),i.default.createElement("svg",{className:"AddButton"},i.default.createElement("use",{xlinkHref:k.default.make("/images/symbol-defs.svg#icon-plus")}))),b?i.default.createElement(f.default,{key:b.refId,node:b,onRemove:this.removeInTarget}):null),i.default.createElement("div",{style:{marginBottom:"20px"}},i.default.createElement("div",{onClick:this.pickOutTarget,className:"SelectionPanelButton MeshBonesHeader",style:{borderRadius:S?null:"20px"}},i.default.createElement("span",null,"Out Target"),i.default.createElement("svg",{className:"AddButton"},i.default.createElement("use",{xlinkHref:k.default.make("/images/symbol-defs.svg#icon-plus")}))),S?i.default.createElement(f.default,{key:S.refId,node:S,onRemove:this.removeOutTarget}):null),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Display"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(d.default,{options:_,selectedIndex:g,onSelectionChanged:this.changeDisplayIndex}))))))}}]),t}()).prototype,"changeJellySegments",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeJellySegments"),r.prototype),O(r.prototype,"changeEaseIn",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeEaseIn"),r.prototype),O(r.prototype,"changeEaseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeEaseOut"),r.prototype),O(r.prototype,"changeScaleIn",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeScaleIn"),r.prototype),O(r.prototype,"changeScaleOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeScaleOut"),r.prototype),O(r.prototype,"jellyChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"jellyChange"),r.prototype),O(r.prototype,"revalidate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"revalidate"),r.prototype),O(r.prototype,"toggleJelly",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleJelly"),r.prototype),O(r.prototype,"changeDisplayIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeDisplayIndex"),r.prototype),O(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),O(r.prototype,"pickInTarget",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"pickInTarget"),r.prototype),O(r.prototype,"pickOutTarget",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"pickOutTarget"),r.prototype),O(r.prototype,"removeInTarget",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"removeInTarget"),r.prototype),O(r.prototype,"removeOutTarget",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"removeOutTarget"),r.prototype),r);t.default=w;var _=[{label:"Jellies",jelly:!0,bone:!1},{label:"Bone",jelly:!1,bone:!0},{label:"Both",jelly:!0,bone:!0}];w.validate=function(e,t){return!0},w.Validation={root:{validate:function(e){return e.root||!1}},displayIndex:{validate:function(e){var t=!e.hideJellies,n=!e.hideBone;return _.findIndex(function(e){return e.jelly===t&&e.bone===n})}},isJelly:{validate:function(e){return e.isJelly}},segments:{validate:function(e){return e.jelly&&e.jelly.segments||0}},easeIn:{validate:function(e){return e.jelly&&e.jelly.easeIn||0}},easeOut:{validate:function(e){return e.jelly&&e.jelly.easeOut||0}},scaleIn:{validate:function(e){return e.jelly&&e.jelly.scaleIn||1}},scaleOut:{validate:function(e){return e.jelly&&e.jelly.scaleOut||1}},inTarget:{validate:function(e){return e.jelly&&e.jelly.inTarget||null}},outTarget:{validate:function(e){return e.jelly&&e.jelly.outTarget||null}}},w.canMultiEdit=!0,w.panelOrder=3,w.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.floor(e)}},{key:"toInputValue",value:function(e){return e}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e);if(t<2||t>10)throw"Invalid input";return t}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"defaultValue",get:function(){return 2}},{key:"allowDrag",get:function(){return!0}},{key:"dragScale",get:function(){return 1}},{key:"dragMin",get:function(){return 2}},{key:"dragMax",get:function(){return 10}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.floor(100*e)/100}},{key:"toInputValue",value:function(e){return e}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e);if(t<0||t>2)throw"Invalid input";return t}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"defaultValue",get:function(){return.25}},{key:"allowDrag",get:function(){return!0}},{key:"dragScale",get:function(){return.01}},{key:"dragMin",get:function(){return 0}},{key:"dragMax",get:function(){return 2}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=E(n(1)),a=E(n(2)),s=E(n(5)),l=E(n(209)),u=E(n(220)),c=E(n(216)),d=E(n(267)),f=E(n(332)),h=E(n(179)),p=E(n(658)),y=E(n(659)),v=E(n(1191)),m=E(n(439)),g=E(n(19)),b=E(n(175)),k=E(n(508)),S=E(n(173)),O=E(n(539)),w=E(n(171)),_=E(n(3)),P=E(n(507)),C=E(n(509));function E(e){return e&&e.__esModule?e:{default:e}}function T(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var I=(T((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"itemPropertiesUpdated",value:function(){(0,g.default)(this.revalidate)}},{key:"revalidate",value:function(){this.forceUpdate()}},{key:"setItems",value:function(e){if(!(0,b.default)(this.items,e)){if(this.items)for(var t=0;t<this.items.length;t++){var n=this.items[t];n.node&&(n.node.removeEventListener("clipsChange",this.itemPropertiesUpdated),n.node.removeEventListener("displayChange",this.itemPropertiesUpdated),n.node.removeEventListener("blendModeChange",this.itemPropertiesUpdated),n.node.removeEventListener("opacityChange",this.itemPropertiesUpdated),n.node.removeEventListener("worldTransform",this.itemPropertiesUpdated),n.node.removeEventListener("sequenceChange",this.itemPropertiesUpdated),n.node.removeEventListener("keyState",this.itemPropertiesUpdated))}if(this.items=e,e)for(var r=0;r<e.length;r++){var o=e[r];o.node&&(o.node.addEventListener("clipsChange",this.itemPropertiesUpdated),o.node.addEventListener("displayChange",this.itemPropertiesUpdated),o.node.addEventListener("blendModeChange",this.itemPropertiesUpdated),o.node.addEventListener("opacityChange",this.itemPropertiesUpdated),o.node.addEventListener("worldTransform",this.itemPropertiesUpdated),o.node.addEventListener("sequenceChange",this.itemPropertiesUpdated),o.node.addEventListener("keyState",this.itemPropertiesUpdated))}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setItems(null),g.default.cancel(this.revalidate)}},{key:"changeSequence",value:function(e,t){for(var n=0;n<this.items.length;n++){var r=this.items[n],o=new y.default(this.context.nima.stage,this.context.nima.actor,r,e);o.silent=!0,o.start(),o.end()}t||this.context.nima.captureJournalEntry()}},{key:"changeOpacity",value:function(e,t){for(var n=0;n<this.items.length;n++){var r=this.items[n],o=new p.default(this.context.nima.stage,this.context.nima.actor,r,e);o.silent=!0,o.start(),o.end()}t||this.context.nima.captureJournalEntry()}},{key:"changeDisplayType",value:function(e){if(!(e<0)){var t=j[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&s.node.constructor===S.default&&(s.node.displayType=t.type)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"updateBlendMode",value:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t],r=new v.default(this.context.nima.stage,this.context.nima.actor,n,C.default.all[e]);r.silent=!0,r.start(),r.end()}this.context.nima.captureJournalEntry()}},{key:"keyOpacity",value:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t];this.context.nima.editingAnimation.toggleKey(n.node,"frameOpacity")}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"keySequence",value:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t];this.context.nima.editingAnimation.toggleKey(n.node,"frameSequence")}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"clearClips",value:function(){if(this.items){var e=!0,t=!1,n=void 0;try{for(var r,o=this.items[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.node.clips=[]}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.context.nima.captureJournalEntry()}this.pickTargetAlert&&(this.pickTargetAlert.hide(),this.pickTargetAlert=null);var i=this.context.nima,a=i.stage;a.clearRerouteSelection(this.rerouteCB),i.clearCancelCallback(this.cancelCB),a.clearExtraSelectionFilter(),delete this.rerouteCB,delete this.cancelCB}},{key:"pickedTarget",value:function(e,t){this.pickTargetAlert&&(this.pickTargetAlert.hide(),this.pickTargetAlert=null);var n=this.context.nima,r=n.stage;r.clearRerouteSelection(this.rerouteCB),n.clearCancelCallback(this.cancelCB),r.clearExtraSelectionFilter(),delete this.rerouteCB,delete this.cancelCB,e&&e(t)}},{key:"pickTarget",value:function(e){var t=this.context.nima,n=t.stage;if(!this.pickTargetAlert&&!n.soloItem){var r=this;this.pickTargetAlert=t.alert({title:"Pick Target",message:"Select the item to use as a target.",type:w.default.Types.State,buttons:[{label:"CLEAR",action:function(t,n){r.clearClips(),e(null)}},{label:"CANCEL",action:function(t,n){r.pickedTarget(e)}}]}),this.cancelCB=function(t){r.pickedTarget(e)},this.rerouteCB=function(t){r.pickedTarget(e,t)},t.setCancelCallback(this.cancelCB),n.rerouteSelection(this.rerouteCB),n.setExtraSelectionFilter(function(e){return!e.drawAfterSelections})}}},{key:"addClipping",value:function(){var e=this;this.context.nima;this.pickTarget(function(t){if(void 0!==t){var n=t&&t.node||null;if(n){var r=!0,o=!1,i=void 0;try{for(var a,s=e.items[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value.node;if(!l.clips||-1===l.clips.indexOf(n))if(l.clips){var u=l.clips.slice(0);u.push(n),l.clips=u}else l.clips=[n]}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}e.context.nima.captureJournalEntry()}}})}},{key:"removeClipping",value:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t],r=n.node.clips;if(r){var o=r.indexOf(e);if(-1!==o){var i=r.slice(0);i.splice(o,1),n.node.clips=i}}}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"render",value:function(){var e=this,n=l.default.validate(t.Validation,this.items),r=this.props.isAnimating,o=this.props.disableInput;return i.default.createElement("div",{className:"SelectionPanelGroup"},!1!==n.displayTypeIndex?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Display"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(u.default,{options:j,selectedIndex:n.displayTypeIndex,onSelectionChanged:this.changeDisplayType}))):null,n.hasBlendMode&&!r?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Blend"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(u.default,{options:C.default.all,selectedIndex:n.blendIndex,onSelectionChanged:this.updateBlendMode}))):null,i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Opacity"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(c.default,{value:n.opacity,converter:m.default,keyState:n.keyOpacity,isAnimating:r,onValueChanged:this.changeOpacity,onValueCommit:this.commit,disabled:o,onSetKey:this.keyOpacity})),n.hasSequence?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Frame"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{value:0,keyState:n.keySequence,isAnimating:r,onValueChanged:this.changeSequence,dragScale:1,onValueCommit:this.commit,disabled:!0,onSetKey:this.keySequence}))):null,r?null:i.default.createElement("div",null,i.default.createElement("div",{onClick:this.addClipping,className:"SelectionPanelButton MeshBonesHeader",style:{borderRadius:n.clipping&&n.clipping.length?null:"20px",marginTop:0}},i.default.createElement("span",null,"Clipping"),i.default.createElement("svg",{className:"AddButton"},i.default.createElement("use",{xlinkHref:_.default.make("/images/symbol-defs.svg#icon-plus")}))),n.clipping&&n.clipping.map(function(t){return i.default.createElement(O.default,{key:t.refId,node:t,onRemove:e.removeClipping})})||null))}}]),t}()).prototype,"itemPropertiesUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"itemPropertiesUpdated"),r.prototype),T(r.prototype,"revalidate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"revalidate"),r.prototype),T(r.prototype,"changeSequence",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeSequence"),r.prototype),T(r.prototype,"changeOpacity",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeOpacity"),r.prototype),T(r.prototype,"changeDisplayType",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeDisplayType"),r.prototype),T(r.prototype,"updateBlendMode",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateBlendMode"),r.prototype),T(r.prototype,"keyOpacity",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyOpacity"),r.prototype),T(r.prototype,"keySequence",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keySequence"),r.prototype),T(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),T(r.prototype,"addClipping",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"addClipping"),r.prototype),T(r.prototype,"removeClipping",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"removeClipping"),r.prototype),r);t.default=I,I.validate=function(e,t){var n=l.default.validate(I.Validation,t);return!(!n.hasOpacity&&!n.hasBlendMode)&&n};var j=[{label:"Empty",type:k.default.Empty},{label:"Target",type:k.default.Target}];I.Validation={clipping:{validate:function(e){return e.node&&e.node.clips||null},equals:function(e,t){return(0,b.default)(e,t)}},hasOpacity:{validate:function(e){switch(e.constructor){case d.default:return!1}return!0}},opacity:{validate:function(e){return e.node?e.node.opacity:1},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},keyOpacity:{validate:function(e){return e&&e.node&&e.node.frameOpacityKS}},hasBlendMode:{validate:function(e){return e&&e.node&&e.node instanceof P.default}},blendIndex:{validate:function(e){return e&&e.node&&e.node.blendMode&&e.node.blendMode.id}},hasSequence:{validate:function(e){return e.constructor===h.default&&e.node&&e.node.asset instanceof f.default}},sequence:{validate:function(e){return e&&e.node&&e.node.sequence}},keySequence:{validate:function(e){return e&&e.node&&e.node.frameSequenceKS}},displayTypeIndex:{validate:function(e){var t=e.node;return!(!t||t.constructor!==S.default)&&j.findIndex(function(e){return e.type===t.displayType})}}},I.canMultiEdit=!0,I.panelOrder=2,I.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(229),i=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(e,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._StageItem=r,i._StageItem.node.blendMode=o,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(1)),a=d(n(2)),s=d(n(5)),l=d(n(231)),u=d(n(238)),c=d(n(175));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var h=(f((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hasFilter:!0,showBorder:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"showBorderChange",value:function(e){this.setState({showBorder:e})}},{key:"filteringChange",value:function(e){this.setState({hasFilter:e})}},{key:"setImageAssets",value:function(e){if(!(0,c.default)(this.imageAssets,e)){if(this.imageAssets)for(var t=0;t<this.imageAssets.length;t++){var n=this.imageAssets[t];n.removeEventListener("filteringChange",this.filteringChange),n.removeEventListener("showBorderChange",this.showBorderChange)}if(this.imageAssets=e,e){for(var r=!0,o=!0,i=0;i<this.imageAssets.length;i++){var a=this.imageAssets[i];a.isFilteringEnabled||(r=!1),a.showBorder||(o=!1),a.addEventListener("filteringChange",this.filteringChange),a.addEventListener("showBorderChange",this.showBorderChange)}this.setState({hasFilter:r,showBorder:o})}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setImageAssets(e.stageItems)}},{key:"componentWillMount",value:function(){this.setImageAssets(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setImageAssets(null)}},{key:"toggleFilter",value:function(e){if(this.imageAssets){for(var t=0;t<this.imageAssets.length;t++){this.imageAssets[t].isFilteringEnabled=e}this.context.nima.captureJournalEntry()}}},{key:"toggleShowBorder",value:function(e){if(this.imageAssets){for(var t=0;t<this.imageAssets.length;t++){this.imageAssets[t].showBorder=e}this.context.nima.captureJournalEntry()}}},{key:"render",value:function(){return i.default.createElement("div",null,i.default.createElement(l.default,{_key:"_IAFilteringOpts",label:"Filtering Options"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitleSwitch"},"Linear"),i.default.createElement(u.default,{isOn:this.state.hasFilter,onToggle:this.toggleFilter}))),i.default.createElement(l.default,{_key:"_IAEditorOpts",label:"Editor Options"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitleSwitch"},"Show Border"),i.default.createElement(u.default,{isOn:this.state.showBorder,onToggle:this.toggleShowBorder}))))}}]),t}()).prototype,"showBorderChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"showBorderChange"),r.prototype),f(r.prototype,"filteringChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"filteringChange"),r.prototype),f(r.prototype,"toggleFilter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleFilter"),r.prototype),f(r.prototype,"toggleShowBorder",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleShowBorder"),r.prototype),r);t.default=h,h.canMultiEdit=!0,h.validate=function(e,t){return!e.state.isAnimationOpen},h.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=p(n(1)),a=p(n(2)),s=p(n(5)),l=p(n(231)),u=p(n(540)),c=p(n(337)),d=p(n(331)),f=p(n(175)),h=p(n(3));function p(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function g(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var b=(g((r=function(e){function t(e){y(this,t);var n=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return m(t,i.default.Component),o(t,[{key:"hasContrastChange",value:function(e){this.setState({hasContrast:e})}},{key:"setEventItems",value:function(e){(0,f.default)(this.eventItems,e)||(this.eventNode&&this.eventNode.removeEventListener("childrenChanged",this.onChildrenChanged),this.eventItems=e,e&&e.length?this.eventNode=e[0].node:this.eventNode=null,this.eventNode&&this.eventNode.addEventListener("childrenChanged",this.onChildrenChanged),this.forceUpdate())}},{key:"onChildrenChanged",value:function(){this.forceUpdate()}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setEventItems(e.stageItems)}},{key:"componentDidMount",value:function(){this.setEventItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setEventItems(null)}},{key:"addEvent",value:function(){var e=this.context.nima.actor.addNodeType(c.default,this.eventNode,{});e&&(e.stageItem.addToStage(this.context.nima.stage),this.context.nima.captureJournalEntry())}},{key:"deleteEvent",value:function(e){var t=new d.default(this.context.nima.stage,this.context.nima.actor,[e.stageItem],[]);t.start(),t.end()}},{key:"setKey",value:function(e){this.context.nima.editingAnimation.toggleKey(e,"frameTrigger"),this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"render",value:function(){var e=[],t=this.eventNode;if(t&&t.children){var n=this.props.isAnimating,r=!0,o=!1,a=void 0;try{for(var s,u=t.children[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var d=s.value;d instanceof c.default&&e.push(i.default.createElement(k,{key:d.refId,item:d,isAnimating:n,setKey:this.setKey,onDelete:this.deleteEvent}))}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}return i.default.createElement(l.default,{_key:"_EventOpts",label:"Events",className:"EventsContent",action:this.props.isAnimating?null:i.default.createElement("svg",{className:"AddButton",onClick:this.addEvent},i.default.createElement("use",{xlinkHref:h.default.make("/images/symbol-defs.svg#icon-plus")}))},e.length>0?e:i.default.createElement("div",{className:"SelectionPanelEmptyMsg"},"No events"))}}]),t}()).prototype,"hasContrastChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"hasContrastChange"),r.prototype),g(r.prototype,"onChildrenChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onChildrenChanged"),r.prototype),g(r.prototype,"addEvent",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"addEvent"),r.prototype),g(r.prototype,"deleteEvent",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"deleteEvent"),r.prototype),g(r.prototype,"setKey",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setKey"),r.prototype),r);t.default=b;var k=function(e){function t(){return y(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,u.default),o(t,[{key:"keyState",get:function(){return this.item.frameTriggerKS}}]),t}();b.validate=function(e,t){if(e.state.isAnimationOpen){if(1===t.length)for(var n=t[0].node,r=n.children.length-1;r>=0;r--){if(n.children[r].constructor===c.default)return!0}return!1}return!0},b.contextTypes={nima:s.default.object},b.canMultiEdit=!1,b.panelOrder=4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=m(n(1)),a=m(n(2)),s=m(n(5)),l=m(n(231)),u=m(n(238)),c=m(n(672)),d=m(n(541)),f=m(n(171)),h=m(n(176)),p=m(n(198)),y=m(n(175)),v=m(n(3));function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var b=(g((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={invertDirection:!1,isSingleMode:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"influencedBoneChange",value:function(){this.connectBones(this.constraint)}},{key:"connectBones",value:function(e){if(this.influencedBones)for(var t=0;t<this.influencedBones.length;t++)this.influencedBones[t].isConnected=!1;if(this.influencedBones=[],e)for(var n=0;n<e.influencedBones.length;n++){var r=e.influencedBones[n];r.stageItem.isConnected=!0,this.influencedBones.push(r.stageItem)}this.forceUpdate()}},{key:"connectedBonesChanged",value:function(){this.connectBones(this.constraint),this.forceUpdate()}},{key:"updateInvertDirection",value:function(e){this.setState({invertDirection:e})}},{key:"strengthChange",value:function(){this.forceUpdate()}},{key:"setConstraintItems",value:function(e){if(!(0,y.default)(this.stageItems,e)){if(this.stageItems){if(1===this.stageItems.length){var t=this.stageItems[0].node;t.removeEventListener("influencedBoneChange",this.influencedBoneChange),t.removeEventListener("connectedBonesChanged",this.connectedBonesChanged)}for(var n=0;n<this.stageItems.length;n++){this.stageItems[n].node.removeEventListener("invertDirectionChange",this.updateInvertDirection)}}this.stageItems=e;var r=!0;if(this.constraint=null,this.stageItems){if(1===this.stageItems.length){var o=this.stageItems[0].node;o.addEventListener("influencedBoneChange",this.influencedBoneChange),o.addEventListener("connectedBonesChanged",this.connectedBonesChanged),this.constraint=o,this.connectBones(this.constraint)}else this.influencedBones=[];for(var i=0;i<this.stageItems.length;i++){var a=this.stageItems[i].node;a.invertDirection||(r=!1),a.addEventListener("invertDirectionChange",this.updateInvertDirection)}}else this.connectBones(null);this.setState({isSingleMode:this.stageItems&&1===this.stageItems.length,invertDirection:r})}}},{key:"connectSelectedBones",value:function(){var e=this,t=this.context.nima.stage.selectedItems,n=this.constraint,r=n.parent;t.unshift(r.stageItem);for(var o=[],i=null,a=-1,s=[],l=0;l<t.length;l++){var u=t[l];u.constructor===h.default&&(s.push(u.node),u.joint.node.treeDepth>a&&(a=u.node.treeDepth,i=u.node))}if(i){o.push(i);for(var c=0;c<s.length;c++){var d=s[c];i.isChildOf(d)&&o.push(d)}}n&&function(){for(var t=[],r=0;r<n.influencedBones.length;r++)t.push(n.influencedBones[r]);for(var i=0;i<t.length;i++){var a=t[i];-1===o.indexOf(a)&&(n.removeBoneInfluence(a,!0),a.stageItem.isConnected=!1)}e.influencedBones.length=0;for(var s=e,l=function(n){var r=o[n];e.context.nima.detectDependencyCycles(function(){-1===t.indexOf(r)&&(s.constraint.influenceBone(r,!0),r.stageItem.isConnected=!0),s.influencedBones.push(r.stageItem)})},u=0;u<o.length;u++)l(u)}(),this.cancelConnectBone();var f=n.influencedBones;if(f&&f.length){var p=f[f.length-1];p!==n.parent&&p.add(n)}this.context.nima.captureJournalEntry()}},{key:"cancelConnectBone",value:function(){var e=this.context.nima.stage;if(this.connectAlert&&this.constraint){var t=this.constraint;this.connectAlert.hide(),this.connectAlert=null,e.removeEventListener("selectionChanged",this.stageSelectionChanged),this.context.nima.editor.clearHoldSelectedItem(t.stageItem),e.selectItems([t.stageItem],!1)}e.clearSoloItems(),this.context.nima.clearCancelCallback(this.cancelConnectBone),e.toolType===d.default&&e.tool.close()}},{key:"getValidInfluenceBones",value:function(){if(!this.state.isSingleMode)return[];for(var e=[],t=this.stageItems[0].node.parent.parent;t instanceof p.default;t=t.parent)e.push(t.stageItem);return e}},{key:"connectBone",value:function(){if(this.connectAlert)console.log("ALREADY HAVE A CONNECT STATE");else if(this.constraint){var e=this.constraint,t=this.context.nima;t.editor.holdSelectedItem(this.constraint.stageItem),t.stage.setSoloItems(this.getValidInfluenceBones()),t.setCancelCallback(this.cancelConnectBone),t.stage.selectItems(this.influencedBones.filter(function(t){return t.node!==e.parent}));var n=this;t.stage.addEventListener("selectionChanged",this.stageSelectionChanged),t.stage.toolType=d.default,this.connectAlert=t.alert({title:"Select Bones",message:"Select bones from the same chain to be affected by the IK constraint.",type:f.default.Types.State,buttons:[{label:"CANCEL",action:function(e,t){n.cancelConnectBone()}},{label:"DONE",isDisabled:!0,action:function(e,t){n.connectSelectedBones()}}]}),this.stageSelectionChanged()}}},{key:"toggleInvertDirection",value:function(e){if(this.stageItems){for(var t=0;t<this.stageItems.length;t++){this.stageItems[t].node.invertDirection=e}this.context.nima.captureJournalEntry()}}},{key:"stageSelectionChanged",value:function(){if(this.connectAlert){for(var e=this.context.nima.stage.selectedItems,t=!1,n=0;n<e.length;n++){if(e[n].constructor===h.default){t=!0;break}}this.connectAlert.enableButton(1,t),this.connectAlert.accentButton(1,t)}}},{key:"keyStrength",value:function(e){if(this.stageItems){for(var t=0;t<this.stageItems.length;t++){var n=this.stageItems[t].node;this.context.nima.editingAnimation.toggleKey(n,"frameStrength")}this.context.nima.captureJournalEntry(),this.forceUpdate()}}},{key:"changeStrength",value:function(e,t){if(this.stageItems){for(var n=0;n<this.stageItems.length;n++){this.stageItems[n].node.strength=e}t||this.context.nima.captureJournalEntry(),this.forceUpdate()}}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setConstraintItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setConstraintItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setConstraintItems(null)}},{key:"disconnectBone",value:function(e){this.constraint.removeBoneInfluence(e),this.context.nima.stage.updateHighlights()}},{key:"render",value:function(){var e=[],t=this.influencedBones||[],n=this.state.isSingleMode;if(n&&t)for(var r=this.stageItems[0].node,o=r.parent,a=0;a<t.length;a++){var s=t[a].node;e.push(i.default.createElement(c.default,{allowDisconnect:s!==o,key:s.refId,bone:s,constraint:r,disconnect:this.disconnectBone}))}return i.default.createElement(l.default,{label:"IK Options"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitleSwitch"},"Invert Direction"),i.default.createElement(u.default,{isOn:this.state.invertDirection,onToggle:this.toggleInvertDirection})),n?i.default.createElement("div",null,i.default.createElement("div",{onClick:this.connectBone,className:"MeshBonesHeader",style:{borderRadius:t.length>0?null:"20px"}},i.default.createElement("span",null,"Influenced Bones"),i.default.createElement("svg",{className:"AddButton"},i.default.createElement("use",{xlinkHref:v.default.make("/images/symbol-defs.svg#icon-plus")}))),e):null)}}]),t}()).prototype,"influencedBoneChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"influencedBoneChange"),r.prototype),g(r.prototype,"connectedBonesChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"connectedBonesChanged"),r.prototype),g(r.prototype,"updateInvertDirection",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateInvertDirection"),r.prototype),g(r.prototype,"strengthChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"strengthChange"),r.prototype),g(r.prototype,"cancelConnectBone",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"cancelConnectBone"),r.prototype),g(r.prototype,"connectBone",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"connectBone"),r.prototype),g(r.prototype,"toggleInvertDirection",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleInvertDirection"),r.prototype),g(r.prototype,"stageSelectionChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"stageSelectionChanged"),r.prototype),g(r.prototype,"keyStrength",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyStrength"),r.prototype),g(r.prototype,"changeStrength",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeStrength"),r.prototype),g(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),g(r.prototype,"disconnectBone",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"disconnectBone"),r.prototype),r);t.default=b,b.canMultiEdit=!0,b.panelOrder=3,b.validate=function(e,t){return!e.state.isAnimationOpen},b.Validation={},b.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=h(n(1)),a=h(n(2)),s=h(n(5)),l=h(n(209)),u=h(n(231)),c=h(n(220)),d=h(n(175)),f=h(n(269));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var y=(p((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"updateTransformProperties",value:function(){this.forceUpdate()}},{key:"setConstraintItems",value:function(e){if(!(0,d.default)(this.stageItems,e)){if(this.stageItems)for(var t=0;t<this.stageItems.length;t++){this.stageItems[t].node.removeEventListener("changeTransformConstraint",this.updateTransformProperties)}if(this.stageItems=e,this.constraint=null,this.stageItems)for(var n=0;n<this.stageItems.length;n++){this.stageItems[n].node.addEventListener("changeTransformConstraint",this.updateTransformProperties)}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setConstraintItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setConstraintItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setConstraintItems(null)}},{key:"changeSourceIndex",value:function(e){if(!(e<0)){var t=v[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.sourceSpace=t.space)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"changeDestIndex",value:function(e){if(!(e<0)){var t=v[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.destSpace=t.space)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.stageItems),n=e.sourceSpaceIndex,r=e.destSpaceIndex;return i.default.createElement(u.default,{label:"Transform"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{width:"77px"}},"Source Space"),i.default.createElement("div",{className:"Spacer",style:{marginLeft:"-12px"}}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{options:v,selectedIndex:n,onSelectionChanged:this.changeSourceIndex}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Dest Space"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{options:v,selectedIndex:r,onSelectionChanged:this.changeDestIndex}))))}}]),t}()).prototype,"updateTransformProperties",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateTransformProperties"),r.prototype),p(r.prototype,"changeSourceIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeSourceIndex"),r.prototype),p(r.prototype,"changeDestIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeDestIndex"),r.prototype),r);t.default=y;var v=[{label:"Local",space:f.default.Local},{label:"World",space:f.default.World}];y.canMultiEdit=!0,y.panelOrder=3,y.validate=function(e,t){return!e.state.isAnimationOpen&&l.default.validate(y.Validation,t)},y.Validation={sourceSpaceIndex:{validate:function(e){var t=e.node;return!!t&&v.findIndex(function(e){return e.space===t.sourceSpace})}},destSpaceIndex:{validate:function(e){var t=e.node;return!!t&&v.findIndex(function(e){return e.space===t.destSpace})}}},y.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=y(n(1)),a=y(n(2)),s=y(n(5)),l=y(n(209)),u=y(n(231)),c=y(n(220)),d=y(n(175)),f=n(433),h=y(n(216)),p=y(n(172));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var m=(v((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"updateTransformProperties",value:function(){this.forceUpdate()}},{key:"setConstraintItems",value:function(e){if(!(0,d.default)(this.stageItems,e)){if(this.stageItems)for(var t=0;t<this.stageItems.length;t++){this.stageItems[t].node.removeEventListener("changeDistanceConstraint",this.updateTransformProperties)}if(this.stageItems=e,this.constraint=null,this.stageItems)for(var n=0;n<this.stageItems.length;n++){this.stageItems[n].node.addEventListener("changeDistanceConstraint",this.updateTransformProperties)}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setConstraintItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setConstraintItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setConstraintItems(null)}},{key:"changeModeIndex",value:function(e){if(!(e<0)){var t=g[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.mode=t.mode)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"changeDistance",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.distance=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"setDistance",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.stageItems[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;i.node&&i.node.resetDistance()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.stageItems),n=e.modeIndex,r=e.distance;return i.default.createElement(u.default,{label:"Transform"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Mode"),i.default.createElement("div",{className:"Spacer",style:{marginRight:"-30px"}}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{options:g,selectedIndex:n,onSelectionChanged:this.changeModeIndex}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Distance"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(h.default,{value:r,keyState:0,isAnimating:!1,onValueChanged:this.changeDistance,dragScale:1,onValueCommit:this.commit,disabled:!1,onSetKey:null}))),i.default.createElement(p.default,{label:"Use Current Distance",onPress:this.setDistance}))}}]),t}()).prototype,"updateTransformProperties",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateTransformProperties"),r.prototype),v(r.prototype,"changeModeIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeModeIndex"),r.prototype),v(r.prototype,"changeDistance",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeDistance"),r.prototype),v(r.prototype,"setDistance",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setDistance"),r.prototype),r);t.default=m;var g=[{label:"Closer Than",mode:f.DistanceMode.Closer},{label:"Further Than",mode:f.DistanceMode.Further},{label:"Exactly",mode:f.DistanceMode.Exact}];m.canMultiEdit=!0,m.panelOrder=3,m.validate=function(e,t){return!e.state.isAnimationOpen&&l.default.validate(m.Validation,t)},m.Validation={modeIndex:{validate:function(e){var t=e.node;return!!t&&g.findIndex(function(e){return e.mode===t.mode})}},distance:{validate:function(e){var t=e.node;return!!t&&t.distance}}},m.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=y(n(1)),a=y(n(2)),s=y(n(5)),l=y(n(209)),u=y(n(231)),c=y(n(220)),d=y(n(175)),f=y(n(269)),h=y(n(238)),p=y(n(673));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var m=(v((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"updateTransformProperties",value:function(){this.forceUpdate()}},{key:"setConstraintItems",value:function(e){if(!(0,d.default)(this.stageItems,e)){if(this.stageItems)for(var t=0;t<this.stageItems.length;t++){this.stageItems[t].node.removeEventListener("changeConstraint",this.updateTransformProperties)}if(this.stageItems=e,this.constraint=null,this.stageItems)for(var n=0;n<this.stageItems.length;n++){this.stageItems[n].node.addEventListener("changeConstraint",this.updateTransformProperties)}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setConstraintItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setConstraintItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setConstraintItems(null)}},{key:"changeSourceIndex",value:function(e){if(!(e<0)){var t=g[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.sourceSpace=t.space)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"changeDestIndex",value:function(e){if(!(e<0)){var t=g[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.destSpace=t.space)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"changeMinMaxIndex",value:function(e){if(!(e<0)){var t=g[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.minMaxSpace=t.space)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"toggleCopyX",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.copyX=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"changeScaleX",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.scaleX=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"toggleMinX",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.enableMinX=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"changeMinX",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.minX=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"toggleMaxX",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.enableMaxX=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"changeMaxX",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.maxX=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"toggleCopyY",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.copyY=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"changeScaleY",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.scaleY=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"toggleMinY",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.enableMinY=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"changeMinY",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.minY=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"toggleMaxY",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.enableMaxY=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"changeMaxY",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.maxY=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"toggleOffset",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.offset=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"render",value:function(){this.props.isAnimating;var e=l.default.validate(t.Validation,this.stageItems),n=e.sourceSpaceIndex,r=e.destSpaceIndex,o=e.minMaxSpaceIndex,a=e.enableMinX||e.enableMinY||e.enableMaxX||e.enableMaxY,s=e.copyX||e.copyY;return[i.default.createElement(u.default,{label:"Constrain X",key:"constrainX"},i.default.createElement(p.default,{label:"Copy X",onToggle:this.toggleCopyX,isOn:e.copyX,disabled:!e.copyX,value:e.scaleX,onValueChanged:this.changeScaleX,dragScale:.005,onValueCommit:this.commit}),i.default.createElement(p.default,{label:"Min",onToggle:this.toggleMinX,isOn:e.enableMinX,disabled:!e.enableMinX,value:e.minX,onValueChanged:this.changeMinX,dragScale:.005,onValueCommit:this.commit}),i.default.createElement(p.default,{label:"Max",onToggle:this.toggleMaxX,isOn:e.enableMaxX,disabled:!e.enableMaxX,value:e.maxX,onValueChanged:this.changeMaxX,dragScale:.005,onValueCommit:this.commit})),i.default.createElement(u.default,{label:"Constrain Y",key:"constrainY"},i.default.createElement(p.default,{label:"Copy Y",onToggle:this.toggleCopyY,isOn:e.copyY,disabled:!e.copyY,value:e.scaleY,onValueChanged:this.changeScaleY,dragScale:.005,onValueCommit:this.commit}),i.default.createElement(p.default,{label:"Min",onToggle:this.toggleMinY,isOn:e.enableMinY,disabled:!e.enableMinY,value:e.minY,onValueChanged:this.changeMinY,dragScale:.005,onValueCommit:this.commit}),i.default.createElement(p.default,{label:"Max",onToggle:this.toggleMaxY,isOn:e.enableMaxY,disabled:!e.enableMaxY,value:e.maxY,onValueChanged:this.changeMaxY,dragScale:.005,onValueCommit:this.commit})),i.default.createElement(u.default,{label:"Constraint Space",key:"constrainSpace"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitleSwitch"},"Offset"),i.default.createElement(h.default,{isOn:e.offset,onToggle:this.toggleOffset,disabled:!s})),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Source"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{options:g,selectedIndex:n,onSelectionChanged:this.changeSourceIndex,disabled:!s}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Destination"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{options:g,selectedIndex:r,onSelectionChanged:this.changeDestIndex,disabled:!s}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Min/Max"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{options:g,selectedIndex:o,onSelectionChanged:this.changeMinMaxIndex,disabled:!a}))))]}}]),t}()).prototype,"updateTransformProperties",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateTransformProperties"),r.prototype),v(r.prototype,"changeSourceIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeSourceIndex"),r.prototype),v(r.prototype,"changeDestIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeDestIndex"),r.prototype),v(r.prototype,"changeMinMaxIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMinMaxIndex"),r.prototype),v(r.prototype,"toggleCopyX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleCopyX"),r.prototype),v(r.prototype,"changeScaleX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeScaleX"),r.prototype),v(r.prototype,"toggleMinX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleMinX"),r.prototype),v(r.prototype,"changeMinX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMinX"),r.prototype),v(r.prototype,"toggleMaxX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleMaxX"),r.prototype),v(r.prototype,"changeMaxX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMaxX"),r.prototype),v(r.prototype,"toggleCopyY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleCopyY"),r.prototype),v(r.prototype,"changeScaleY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeScaleY"),r.prototype),v(r.prototype,"toggleMinY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleMinY"),r.prototype),v(r.prototype,"changeMinY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMinY"),r.prototype),v(r.prototype,"toggleMaxY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleMaxY"),r.prototype),v(r.prototype,"changeMaxY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMaxY"),r.prototype),v(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),v(r.prototype,"toggleOffset",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleOffset"),r.prototype),r);t.default=m;var g=[{label:"Local",space:f.default.Local},{label:"World",space:f.default.World}];m.canMultiEdit=!0,m.panelOrder=3,m.validate=function(e,t){return!e.state.isAnimationOpen&&l.default.validate(m.Validation,t)},m.Validation={offset:{validate:function(e){var t=e.node;return!!t&&t.offset}},copyX:{validate:function(e){var t=e.node;return!!t&&t.copyX}},copyY:{validate:function(e){var t=e.node;return!!t&&t.copyY}},scaleX:{validate:function(e){var t=e.node;return!!t&&t.scaleX}},scaleY:{validate:function(e){var t=e.node;return!!t&&t.scaleY}},minX:{validate:function(e){var t=e.node;return!!t&&t.minX}},minY:{validate:function(e){var t=e.node;return!!t&&t.minY}},maxX:{validate:function(e){var t=e.node;return!!t&&t.maxX}},maxY:{validate:function(e){var t=e.node;return!!t&&t.maxY}},enableMinX:{validate:function(e){var t=e.node;return!!t&&t.enableMinX}},enableMinY:{validate:function(e){var t=e.node;return!!t&&t.enableMinY}},enableMaxX:{validate:function(e){var t=e.node;return!!t&&t.enableMaxX}},enableMaxY:{validate:function(e){var t=e.node;return!!t&&t.enableMaxY}},sourceSpaceIndex:{validate:function(e){var t=e.node;return!!t&&g.findIndex(function(e){return e.space===t.sourceSpace})}},destSpaceIndex:{validate:function(e){var t=e.node;return!!t&&g.findIndex(function(e){return e.space===t.destSpace})}},minMaxSpaceIndex:{validate:function(e){var t=e.node;return!!t&&g.findIndex(function(e){return e.space===t.minMaxSpace})}}},m.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=y(n(1)),a=y(n(2)),s=y(n(5)),l=y(n(209)),u=y(n(231)),c=y(n(220)),d=y(n(175)),f=y(n(269)),h=y(n(238)),p=y(n(673));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var m=(v((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"updateTransformProperties",value:function(){this.forceUpdate()}},{key:"setConstraintItems",value:function(e){if(!(0,d.default)(this.stageItems,e)){if(this.stageItems)for(var t=0;t<this.stageItems.length;t++){this.stageItems[t].node.removeEventListener("changeConstraint",this.updateTransformProperties)}if(this.stageItems=e,this.constraint=null,this.stageItems)for(var n=0;n<this.stageItems.length;n++){this.stageItems[n].node.addEventListener("changeConstraint",this.updateTransformProperties)}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setConstraintItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setConstraintItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setConstraintItems(null)}},{key:"changeSourceIndex",value:function(e){if(!(e<0)){var t=g[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.sourceSpace=t.space)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"changeDestIndex",value:function(e){if(!(e<0)){var t=g[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.destSpace=t.space)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"changeMinMaxIndex",value:function(e){if(!(e<0)){var t=g[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.minMaxSpace=t.space)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"toggleCopy",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.copy=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"changeScale",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.scale=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"toggleMin",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.enableMin=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"changeMin",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.min=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"toggleMax",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.enableMax=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"changeMax",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stageItems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.node&&(s.node.max=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"toggleOffset",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stageItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.offset=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"render",value:function(){this.props.isAnimating;var e=l.default.validate(t.Validation,this.stageItems),n=e.sourceSpaceIndex,r=e.destSpaceIndex,o=e.minMaxSpaceIndex,a=e.enableMin||e.enableMax,s=e.copy;return[i.default.createElement(u.default,{label:"Constrain "+(e.constraintName||"Value"),key:"constrainValue"},i.default.createElement(p.default,{label:"Copy",onToggle:this.toggleCopy,isOn:e.copy,disabled:!e.copy,value:e.scale,onValueChanged:this.changeScale,dragScale:.005,onValueCommit:this.commit}),i.default.createElement(p.default,{label:"Min",onToggle:this.toggleMin,isOn:e.enableMin,converter:e.inputConverter,disabled:!e.enableMin,value:e.min,onValueChanged:this.changeMin,dragScale:.005,onValueCommit:this.commit}),i.default.createElement(p.default,{label:"Max",onToggle:this.toggleMax,isOn:e.enableMax,converter:e.inputConverter,disabled:!e.enableMax,value:e.max,onValueChanged:this.changeMax,dragScale:.005,onValueCommit:this.commit})),i.default.createElement(u.default,{label:"Constraint Space",key:"constrainSpace"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitleSwitch"},"Offset"),i.default.createElement(h.default,{isOn:e.offset,onToggle:this.toggleOffset,disabled:!s})),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Source"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{options:g,selectedIndex:n,onSelectionChanged:this.changeSourceIndex,disabled:!s}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Destination"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{options:g,selectedIndex:r,onSelectionChanged:this.changeDestIndex,disabled:!s}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Min/Max"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{options:g,selectedIndex:o,onSelectionChanged:this.changeMinMaxIndex,disabled:!a}))))]}}]),t}()).prototype,"updateTransformProperties",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateTransformProperties"),r.prototype),v(r.prototype,"changeSourceIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeSourceIndex"),r.prototype),v(r.prototype,"changeDestIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeDestIndex"),r.prototype),v(r.prototype,"changeMinMaxIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMinMaxIndex"),r.prototype),v(r.prototype,"toggleCopy",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleCopy"),r.prototype),v(r.prototype,"changeScale",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeScale"),r.prototype),v(r.prototype,"toggleMin",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleMin"),r.prototype),v(r.prototype,"changeMin",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMin"),r.prototype),v(r.prototype,"toggleMax",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleMax"),r.prototype),v(r.prototype,"changeMax",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMax"),r.prototype),v(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),v(r.prototype,"toggleOffset",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleOffset"),r.prototype),r);t.default=m;var g=[{label:"Local",space:f.default.Local},{label:"World",space:f.default.World}];m.canMultiEdit=!0,m.panelOrder=3,m.validate=function(e,t){return!e.state.isAnimationOpen&&l.default.validate(m.Validation,t)},m.Validation={constraintName:{validate:function(e){var t=e.node;return!!t&&t.constructor.constraintName}},inputConverter:{validate:function(e){var t=e.node;return!!t&&t.constructor.converter}},offset:{validate:function(e){var t=e.node;return!!t&&t.offset}},copy:{validate:function(e){var t=e.node;return!!t&&t.copy}},scale:{validate:function(e){var t=e.node;return!!t&&t.scale}},min:{validate:function(e){var t=e.node;return!!t&&t.min}},max:{validate:function(e){var t=e.node;return!!t&&t.max}},enableMin:{validate:function(e){var t=e.node;return!!t&&t.enableMin}},enableMax:{validate:function(e){var t=e.node;return!!t&&t.enableMax}},sourceSpaceIndex:{validate:function(e){var t=e.node;return!!t&&g.findIndex(function(e){return e.space===t.sourceSpace})}},destSpaceIndex:{validate:function(e){var t=e.node;return!!t&&g.findIndex(function(e){return e.space===t.destSpace})}},minMaxSpaceIndex:{validate:function(e){var t=e.node;return!!t&&g.findIndex(function(e){return e.space===t.minMaxSpace})}}},m.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=R(n(1)),a=R(n(2)),s=R(n(5)),l=R(n(209)),u=R(n(220)),c=R(n(216)),d=R(n(172)),f=R(n(195)),h=R(n(268)),p=R(n(230)),y=R(n(252)),v=R(n(179)),m=R(n(176)),g=n(333),b=R(n(267)),k=(n(7),R(n(175))),S=R(n(1200)),O=R(n(653)),w=R(n(655)),_=R(n(656)),P=R(n(657)),C=R(n(19)),E=R(n(197)),T=R(n(225)),I=R(n(203)),j=R(n(351)),A=R(n(228)),D=R(n(674));function R(e){return e&&e.__esModule?e:{default:e}}function M(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var x=(M((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"itemPropertiesUpdated",value:function(){this.context.nima.editingAnimation&&this.context.nima.editingAnimation.isPlaying||(0,C.default)(this.revalidate)}},{key:"revalidate",value:function(){this.forceUpdate()}},{key:"setItems",value:function(e){if(!(0,k.default)(this.items,e)){if(this.items)for(var n=0;n<this.items.length;n++){var r=this.items[n];r.node&&(r.node.removeEventListener("transformPropChange",this.itemPropertiesUpdated),r.node.removeEventListener("worldTransform",this.itemPropertiesUpdated),r.node.removeEventListener("keyState",this.itemPropertiesUpdated))}if(this.items=e,e)for(var o=0;o<e.length;o++){var i=e[o];i.node&&(i.node.addEventListener("transformPropChange",this.itemPropertiesUpdated),i.node.addEventListener("worldTransform",this.itemPropertiesUpdated),i.node.addEventListener("keyState",this.itemPropertiesUpdated))}var a=this.context.nima;a.removeEventListener("toggleEditMode",this.toggleEditMode);var s=l.default.validate(t.Validation,e);(s.hasVertices||s.hasMesh||a.editingShape)&&a.addEventListener("toggleEditMode",this.toggleEditMode)}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setItems(null),C.default.cancel(this.revalidate)}},{key:"toggleFreeze",value:function(e){switch(e){case 0:this.context.nima.stage.settings.compensateBones=!1,this.context.nima.stage.settings.compensateImages=!1,this.forceUpdate();break;case 1:this.context.nima.stage.settings.compensateBones=!0,this.context.nima.stage.settings.compensateImages=!1,this.forceUpdate();break;case 2:this.context.nima.stage.settings.compensateBones=!1,this.context.nima.stage.settings.compensateImages=!0,this.forceUpdate();break;case 3:this.context.nima.stage.settings.compensateBones=!0,this.context.nima.stage.settings.compensateImages=!0,this.forceUpdate()}}},{key:"setTranslateY",value:function(e){this.translateYRef=e}},{key:"setTranslateX",value:function(e){this.translateXRef=e}},{key:"setOriginYRef",value:function(e){this.originYRef=e}},{key:"setOriginXRef",value:function(e){this.originXRef=e}},{key:"translateX",value:function(e,n){for(var r=this.items,o=this.context.nima,i=o.actor,a=o.stage,s=0;s<r.length;s++){var l=r[s],u=void 0;if(l.constructor===f.default){var c=t.Validation.translationY.validate(l);u=new S.default(a,i,l,[e,c])}else u=new O.default(a,i,l,e);u.silent=!0,u.start(),u.end()}n||this.context.nima.captureJournalEntry(),i.updateGraph()}},{key:"translateY",value:function(e,n){for(var r=this.items,o=this.context.nima,i=o.actor,a=o.stage,s=0;s<r.length;s++){var l=r[s],u=void 0;if(l.constructor===f.default){var c=t.Validation.translationX.validate(l);u=new S.default(a,i,l,[c,e])}else u=new w.default(a,i,l,e);u.silent=!0,u.start(),u.end()}n||this.context.nima.captureJournalEntry(),i.updateGraph()}},{key:"rotate",value:function(e,n){for(var r=0;r<this.items.length;r++){var o=this.items[r],i=t.Validation.rotation.validate(o),a=e/180*Math.PI-i,s=new _.default(this.context.nima.stage,this.context.nima.actor,o,a);s.silent=!0,s.start(),s.end()}n||this.context.nima.captureJournalEntry()}},{key:"scaleX",value:function(e,t){for(var n=0;n<this.items.length;n++){var r=this.items[n].node;r.scale=[e,r.scale[1]]}t||this.context.nima.captureJournalEntry()}},{key:"scaleY",value:function(e,t){for(var n=0;n<this.items.length;n++){var r=this.items[n].node;r.scale=[r.scale[0],e]}t||this.context.nima.captureJournalEntry()}},{key:"setWidth",value:function(e,t){for(var n=0;n<this.items.length;n++){var r=this.items[n].node;if(r.constructor===E.default){var o=r.children.find(function(e){return e instanceof A.default});o&&(o.width=e)}else r instanceof A.default?r.width=e:r instanceof j.default&&(r.width=e)}t||this.context.nima.captureJournalEntry()}},{key:"setHeight",value:function(e,t){for(var n=0;n<this.items.length;n++){var r=this.items[n].node;if(r.constructor===E.default){var o=r.children.find(function(e){return e instanceof A.default});o&&(o.height=e)}else r instanceof A.default?r.height=e:r instanceof j.default&&(r.height=e)}t||this.context.nima.captureJournalEntry()}},{key:"setOriginX",value:function(e,t){for(var n=0;n<this.items.length;n++){var r=this.items[n].node;r instanceof j.default&&(r.origin=[e,this.originYRef.props.value])}t||this.context.nima.captureJournalEntry()}},{key:"setOriginY",value:function(e,t){for(var n=0;n<this.items.length;n++){var r=this.items[n].node;r instanceof j.default&&(r.origin=[this.originXRef.props.value,e])}t||this.context.nima.captureJournalEntry()}},{key:"elongate",value:function(e,t){var n=new P.default(this.context.nima.stage,this.context.nima.actor,this.items,e);n.silent=t,n.start(),n.end()}},{key:"keyTranslateX",value:function(e){for(var n=!1,r=0;r<this.items.length;r++){var o=this.items[r];t.Validation.animatesTranslation.validate(o)&&(this.context.nima.editingAnimation.toggleKey(o.node,"framePosX"),n=!0)}n&&(this.context.nima.captureJournalEntry(),this.forceUpdate())}},{key:"keyTranslateY",value:function(e){for(var n=!1,r=0;r<this.items.length;r++){var o=this.items[r];t.Validation.animatesTranslation.validate(o)&&(this.context.nima.editingAnimation.toggleKey(o.node,"framePosY"),n=!0)}n&&(this.context.nima.captureJournalEntry(),this.forceUpdate())}},{key:"keyScaleX",value:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t];this.context.nima.editingAnimation.toggleKey(n.node,"frameScaleX")}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"keyScaleY",value:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t];this.context.nima.editingAnimation.toggleKey(n.node,"frameScaleY")}this.forceUpdate()}},{key:"keyWidth",value:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t].node,r=null;n.constructor===E.default?r=n.children.find(function(e){return e instanceof A.default}):n instanceof A.default&&(r=n),r&&this.context.nima.editingAnimation.toggleKey(r,"frameWidth")}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"keyHeight",value:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t].node,r=null;n.constructor===E.default?r=n.children.find(function(e){return e instanceof A.default}):n instanceof A.default&&(r=n),r&&this.context.nima.editingAnimation.toggleKey(r,"frameHeight")}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"keyRotation",value:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t];this.context.nima.editingAnimation.toggleKey(n.node,"frameRotation")}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"keyLength",value:function(e){for(var t=0;t<this.items.length;t++){var n=this.items[t];this.context.nima.editingAnimation.toggleKey(n.node,"frameLength")}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"keyPathVertices",value:function(){var e=this.context.nima,t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value.node;if(a instanceof T.default)e.editingAnimation.toggleKey(a,"framePathVertices");else if(a instanceof E.default){var s=!0,l=!1,u=void 0;try{for(var c,d=a.paths[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;e.editingAnimation.toggleKey(f,"framePathVertices")}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}e.captureJournalEntry(),this.forceUpdate()}},{key:"keyImageVertices",value:function(){var e=this.context.nima,t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value.node;a instanceof I.default&&e.editingAnimation.toggleKey(a,"frameImageVertices")}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}e.captureJournalEntry(),this.forceUpdate()}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"convertToPath",value:function(){for(var e=[],t=0;t<this.items.length;t++){var n=this.items[t].node,r=[];n.constructor===E.default?r=n.children.filter(function(e){return e instanceof A.default}):n instanceof A.default&&r.push(n);var o=!0,i=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value,c=u.stageItem.isSelected,d=u.convertToPath();c&&e.push(d.stageItem)}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}}e.length&&this.context.nima.stage.selectItems(e),this.context.nima.captureJournalEntry(),this.context.nima.revalidateSelectionPanel(),this.forceUpdate()}},{key:"toggleEditMode",value:function(){if(this.context.nima.editingShape)this.context.nima.editingShape=null;else{var e=l.default.validate(t.Validation,this.items);e.hasVertices?e.hasSize?(this.convertToPath(),this.context.nima.revalidateSelectionPanel()):this.editVertices():e.hasMesh&&this.editVertices()}}},{key:"editVertices",value:function(){this.context.nima.editingShape=this.items[0]}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.items),n=this.props.isAnimating,r=this.props.disableInput;return i.default.createElement("div",{className:"SelectionPanelGroup",_key:"_TransformOpts"},e.hasLength?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Length"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{value:e.length,keyState:e.lengthKeyState,isAnimating:n,onValueChanged:this.elongate,onValueCommit:this.commit,disabled:r,onSetKey:this.keyLength}))):null,e.hasTranslation?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Position"),i.default.createElement(c.default,{ref:this.setTranslateX,label:"X",value:e.translationX,keyState:e.translationKeyStateX,isAnimating:n&&e.animatesTranslation,onValueChanged:this.translateX,onValueCommit:this.commit,disabled:r||n&&!e.animatesTranslation,onSetKey:this.keyTranslateX}),i.default.createElement(c.default,{ref:this.setTranslateY,label:"Y",value:e.translationY,keyState:e.translationKeyStateY,isAnimating:n&&e.animatesTranslation,onValueChanged:this.translateY,onValueCommit:this.commit,disabled:r||n&&!e.animatesTranslation,onSetKey:this.keyTranslateY})):null,e.hasSize?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Size"),i.default.createElement(c.default,{label:"Width",converter:D.default,value:e.width,keyState:e.widthKeyState,isAnimating:n&&!e.hasOrigin,onValueChanged:this.setWidth,dragScale:1,onValueCommit:this.commit,disabled:r||n&&!e.animatesTranslation,onSetKey:this.keyWidth}),i.default.createElement(c.default,{label:"Height",converter:D.default,value:e.height,keyState:e.heightKeyState,isAnimating:n&&!e.hasOrigin,onValueChanged:this.setHeight,dragScale:1,onValueCommit:this.commit,disabled:r||n&&!e.animatesTranslation,onSetKey:this.keyHeight})):null,e.hasOrigin?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Origin"),i.default.createElement(c.default,{ref:this.setOriginXRef,label:"X",value:e.originX,isAnimating:!1,onValueChanged:this.setOriginX,onValueCommit:this.commit,disabled:n}),i.default.createElement(c.default,{ref:this.setOriginYRef,label:"Y",value:e.originY,isAnimating:!1,onValueChanged:this.setOriginY,onValueCommit:this.commit,disabled:n})):null,e.hasScale?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Scale"),i.default.createElement(c.default,{label:"X",value:e.scaleX,keyState:e.scaleKeyStateX,isAnimating:n,onValueChanged:this.scaleX,dragScale:.001,onValueCommit:this.commit,disabled:r,onSetKey:this.keyScaleX}),i.default.createElement(c.default,{label:"Y",value:e.scaleY,keyState:e.scaleKeyStateY,isAnimating:n,onValueChanged:this.scaleY,dragScale:.001,onValueCommit:this.commit,disabled:r,onSetKey:this.keyScaleY})):null,e.hasRotation?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Rotation"),i.default.createElement(c.default,{value:!1!==e.rotation&&180*e.rotation/Math.PI,keyState:e.rotationKeyState,isAnimating:n,unit:" °",onValueChanged:this.rotate,onValueCommit:this.commit,disabled:r,onSetKey:this.keyRotation}),i.default.createElement("div",{className:"Spacer"})):null,n?null:i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Freeze"),i.default.createElement(u.default,{options:[{label:"None"},{label:"Joints"},{label:"Images"},{label:"Both"}],selectedIndex:this.context.nima.stage.settings.compensateBones&&this.context.nima.stage.settings.compensateImages?3:this.context.nima.stage.settings.compensateImages?2:this.context.nima.stage.settings.compensateBones?1:0,onSelectionChanged:this.toggleFreeze}),i.default.createElement("div",{className:"Spacer"})),e.hasVertices?e.hasSize?n?null:i.default.createElement(d.default,{addClass:"NoMargin",label:"Convert to Path",icon:"icon-convert-path",iconClass:"ConvertPathIcon",onPress:this.convertToPath,isAnimating:n,onSetKey:this.keyPathVertices,keyState:e.pathVerticesKeyState}):i.default.createElement(d.default,{addClass:"NoMargin",label:"Edit Vertices",icon:"icon-vector",onPress:this.editVertices,isAnimating:n,onSetKey:this.keyPathVertices,keyState:e.pathVerticesKeyState}):null,e.hasMesh?i.default.createElement(d.default,{addClass:"NoMargin",label:"Edit Mesh",icon:"icon-vector",onPress:this.editVertices,isAnimating:n,onSetKey:this.keyImageVertices,keyState:e.imageVerticesKeyState}):null)}}]),t}()).prototype,"itemPropertiesUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"itemPropertiesUpdated"),r.prototype),M(r.prototype,"revalidate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"revalidate"),r.prototype),M(r.prototype,"toggleFreeze",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleFreeze"),r.prototype),M(r.prototype,"setTranslateY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTranslateY"),r.prototype),M(r.prototype,"setTranslateX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTranslateX"),r.prototype),M(r.prototype,"setOriginYRef",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setOriginYRef"),r.prototype),M(r.prototype,"setOriginXRef",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setOriginXRef"),r.prototype),M(r.prototype,"translateX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"translateX"),r.prototype),M(r.prototype,"translateY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"translateY"),r.prototype),M(r.prototype,"rotate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"rotate"),r.prototype),M(r.prototype,"scaleX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"scaleX"),r.prototype),M(r.prototype,"scaleY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"scaleY"),r.prototype),M(r.prototype,"setWidth",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setWidth"),r.prototype),M(r.prototype,"setHeight",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setHeight"),r.prototype),M(r.prototype,"setOriginX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setOriginX"),r.prototype),M(r.prototype,"setOriginY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setOriginY"),r.prototype),M(r.prototype,"elongate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"elongate"),r.prototype),M(r.prototype,"keyTranslateX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyTranslateX"),r.prototype),M(r.prototype,"keyTranslateY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyTranslateY"),r.prototype),M(r.prototype,"keyScaleX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyScaleX"),r.prototype),M(r.prototype,"keyScaleY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyScaleY"),r.prototype),M(r.prototype,"keyWidth",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyWidth"),r.prototype),M(r.prototype,"keyHeight",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyHeight"),r.prototype),M(r.prototype,"keyRotation",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyRotation"),r.prototype),M(r.prototype,"keyLength",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyLength"),r.prototype),M(r.prototype,"keyPathVertices",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyPathVertices"),r.prototype),M(r.prototype,"keyImageVertices",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyImageVertices"),r.prototype),M(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),M(r.prototype,"convertToPath",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"convertToPath"),r.prototype),M(r.prototype,"toggleEditMode",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleEditMode"),r.prototype),M(r.prototype,"editVertices",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"editVertices"),r.prototype),r);t.default=x,x.validate=function(e,t){var n=l.default.validate(x.Validation,t);return!!(n.hasLength||n.hasTranslation||n.hasRotation||n.hasScale||n.hasVertices||n.hasMesh)&&n},x.Validation={hasLength:{validate:function(e){return e.constructor===m.default}},length:{validate:function(e){return e.node&&e.node.length},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(e)===Math.round(t)}},lengthKeyState:{validate:function(e){return e.node&&e.node.frameLengthKS}},hasTranslation:{validate:function(e){switch(e.constructor){case m.default:case b.default:return!1;case y.default:case v.default:return!e.node.isConnectedToBones}return!0}},hasMesh:{validate:function(e){switch(e.constructor){case v.default:return!0;default:return!1}}},hasVertices:{validate:function(e){switch(e.constructor){case y.default:case p.default:return!0;default:return!1}}},translationX:{validate:function(e){switch(e.constructor){case g.StageArtboard:case y.default:case p.default:case h.default:case v.default:case m.default:return e.node.translation[0];case f.default:return e.parentJoint?e.node.tipWorldTranslation[0]:e.node.translation[0]}return null},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},translationY:{validate:function(e){switch(e.constructor){case g.StageArtboard:case y.default:case p.default:case h.default:case v.default:case m.default:return e.node.translation[1];case f.default:return e.parentJoint?e.node.tipWorldTranslation[1]:e.node.translation[1]}return null},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},animatesTranslation:{validate:function(e){switch(e.constructor){case v.default:return!e.node.isConnectedToBones;case g.StageArtboard:case m.default:return!1;case f.default:return!e.parentJoint;default:return!0}}},translationKeyStateX:{validate:function(e){return e&&e.node&&e.node.framePosXKS}},translationKeyStateY:{validate:function(e){return e&&e.node&&e.node.framePosYKS}},hasRotation:{validate:function(e){switch(e.constructor){case f.default:return!e.parentJoint;case y.default:case v.default:return!e.node.isConnectedToBones;case m.default:case h.default:case y.default:case p.default:return!0}return!1}},rotation:{validate:function(e){switch(e.constructor){case y.default:case p.default:case h.default:case v.default:case m.default:return e.node.rotation;case f.default:if(!e.parentJoint)return e.node.rotation;break;default:return 0}},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},rotationKeyState:{validate:function(e){return e&&e.node?e.node.frameRotationKS:null}},hasScale:{validate:function(e){switch(e.constructor){case f.default:return!e.parentJoint;case y.default:case v.default:return!e.node.isConnectedToBones;case m.default:case h.default:case y.default:case p.default:return!0}return!1}},scaleX:{validate:function(e){switch(e.constructor){case f.default:case h.default:case v.default:case m.default:case y.default:case p.default:return e.node.scale[0];default:return!1}},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},scaleKeyStateX:{validate:function(e){return e&&e.node?e.node.frameScaleXKS:null}},scaleY:{validate:function(e){switch(e.constructor){case f.default:case h.default:case v.default:case m.default:case y.default:case p.default:return e.node.scale[1];default:return!1}},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},scaleKeyStateY:{validate:function(e){return e&&e.node?e.node.frameScaleYKS:null}},hasSize:{validate:function(e){var t=e&&e.node;return!!t&&(t.constructor===E.default?!!t.children.find(function(e){return e instanceof A.default}):t.constructor===j.default||t instanceof A.default)}},width:{validate:function(e){var t=e&&e.node;if(t){if(t.constructor===E.default){var n=t.children.find(function(e){return e instanceof A.default});if(n)return n.width}if(t instanceof A.default)return t.width;if(t instanceof j.default)return t.width}return!1},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},height:{validate:function(e){var t=e&&e.node;if(t){if(t.constructor===E.default){var n=t.children.find(function(e){return e instanceof A.default});if(n)return n.height}if(t instanceof A.default)return t.height;if(t instanceof j.default)return t.height}return!1},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},widthKeyState:{validate:function(e){var t=e&&e.node;if(t){if(t.constructor===E.default){var n=t.children.find(function(e){return e instanceof A.default});if(n)return n.frameWidthKS}if(t instanceof A.default)return t.frameWidthKS}return!1}},heightKeyState:{validate:function(e){var t=e&&e.node;if(t)if(t.constructor===E.default){var n=t.children.find(function(e){return e instanceof A.default});if(n)return n.frameHeightKS}else if(t instanceof A.default)return t.frameHeightKS;return!1}},imageVerticesKeyState:{validate:function(e){var t=e&&e.node;return!!t&&t.frameImageVerticesKS}},pathVerticesKeyState:{validate:function(e){var t=e&&e.node;return!!t&&t.framePathVerticesKS}},hasOrigin:{validate:function(e){switch(e.constructor){case g.StageArtboard:return!0}return!1}},originX:{validate:function(e){switch(e.constructor){case g.StageArtboard:return e.node.origin[0]}return null},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},originY:{validate:function(e){switch(e.constructor){case g.StageArtboard:return e.node.origin[1]}return null},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}}},x.canMultiEdit=!0,x.panelOrder=1,x.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(229)),o=n(7),i=u(n(378)),a=u(n(376)),s=u(n(195)),l=u(n(173));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n,r,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));if(r.constructor!==s.default||r.isRoot){if(r.node.parent instanceof l.default){var d=o.mat2d.fromRotation(o.mat2d.create(),r.node.rotation);d[4]=u[0],d[5]=u[1],o.mat2d.scale(d,d,r.node.scale);var f=o.mat2d.mul(o.mat2d.create(),r.node.parent.worldTransform,d);u=o.mat2d.getTranslation(o.vec2.create(),f)}var h=r.node.worldTranslation,p=o.vec2.subtract(o.vec2.create(),u,h);new a.default(c._Stage.settings.compensateBones,c._Stage.settings.compensateImages,[r.node]).advance(null,p)}else{var y=o.vec2.subtract(o.vec2.create(),u,r.node.tipWorldTranslation);new i.default(c._Stage.settings.compensateBones,c._Stage.settings.compensateImages,[r]).advance(null,y)}return c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=p(n(1)),a=p(n(2)),s=p(n(5)),l=p(n(231)),u=p(n(1202)),c=p(n(289)),d=p(n(331)),f=p(n(175)),h=p(n(3));function p(e){return e&&e.__esModule?e:{default:e}}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var v=(y((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setItems",value:function(e){(0,f.default)(this.items,e)||(this.component&&this.component.removeEventListener("childrenChanged",this.onChildrenChanged),this.items=e,this.component=e&&e[0].node,this.component&&this.component.addEventListener("childrenChanged",this.onChildrenChanged))}},{key:"onChildrenChanged",value:function(e){this.forceUpdate()}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setItems(null)}},{key:"addCustomProperty",value:function(){var e=this.context.nima.actor.addNodeType(c.default,this.component,{});e&&(e.stageItem.addToStage(this.context.nima.stage),this.context.nima.captureJournalEntry())}},{key:"deleteCustomProperty",value:function(e){var t=new d.default(this.context.nima.stage,this.context.nima.actor,[e.stageItem],[]);t.start(),t.end()}},{key:"render",value:function(){var e=this.props.isAnimating,t=[],n=this.component;if(n)for(var r=n.children.length-1;r>=0;r--){var o=n.children[r];o.constructor===c.default&&t.push(i.default.createElement(u.default,{key:o.refId,property:o,onDelete:this.deleteCustomProperty,isAnimating:e}))}return i.default.createElement(l.default,{_key:"_CustomOpts",label:"Custom Properties",action:this.props.isAnimating?null:i.default.createElement("svg",{className:"AddButton",onClick:this.addCustomProperty},i.default.createElement("use",{xlinkHref:h.default.make("/images/symbol-defs.svg#icon-plus")}))},i.default.createElement("div",{className:"EditCustomOptions"},t.length>0?t:i.default.createElement("div",{className:"SelectionPanelEmptyMsg"},"No custom properties")))}}]),t}()).prototype,"onChildrenChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onChildrenChanged"),r.prototype),y(r.prototype,"addCustomProperty",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"addCustomProperty"),r.prototype),y(r.prototype,"deleteCustomProperty",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"deleteCustomProperty"),r.prototype),r);t.default=v,v.validate=function(e,t){if(e.state.isAnimationOpen){if(1===t.length)for(var n=t[0].node,r=n.children.length-1;r>=0;r--){if(n.children[r].constructor===c.default)return!0}return!1}return!0},v.canMultiEdit=!1,v.panelOrder=5,v.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=h(n(1)),a=h(n(2)),s=h(n(5)),l=h(n(216)),u=h(n(220)),c=h(n(289)),d=h(n(384)),f=h(n(3));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var y=(p((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"propertyUpdate",value:function(){this.context.nima.editingAnimation&&this.context.nima.editingAnimation.isPlaying||this.forceUpdate()}},{key:"setProperty",value:function(e){this.property!==e&&(this.property&&(this.property.removeEventListener("update",this.propertyUpdate),this.property.removeEventListener("valueChanged",this.propertyUpdate),this.property.removeEventListener("typeChanged",this.propertyUpdate),this.property.removeEventListener("keyState",this.propertyUpdate)),this.property=e,e&&(e.addEventListener("update",this.propertyUpdate),e.addEventListener("valueChanged",this.propertyUpdate),e.addEventListener("typeChanged",this.propertyUpdate),e.addEventListener("keyState",this.propertyUpdate)))}},{key:"componentWillReceiveProps",value:function(e){e.property!=this.props.property&&this.setProperty(e.property)}},{key:"componentWillMount",value:function(){this.setProperty(this.props.property)}},{key:"componentWillUnmount",value:function(){this.setProperty(null)}},{key:"deleteProperty",value:function(e){this.props.onDelete&&this.props.onDelete(this.props.property)}},{key:"changeName",value:function(e){console.log("DOING CHANGE NAME",e);var t=new d.default(this.context.nima.stage,this.context.nima.actor,this.props.property,e);t.start(),t.end()}},{key:"changePropertyType",value:function(e){this.props.property.propertyType=e,this.context.nima.captureJournalEntry()}},{key:"changeValue",value:function(e,t){switch(this.props.property.propertyType){case c.default.Type.String:this.props.property.stringValue=e;break;case c.default.Type.Integer:this.props.property.intValue=e;break;case c.default.Type.Float:this.props.property.floatValue=e}t||this.context.nima.captureJournalEntry()}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"setKey",value:function(){var e;switch(this.props.property.propertyType){case c.default.Type.String:e="frameStringValue";break;case c.default.Type.Integer:e="frameIntValue";break;case c.default.Type.Float:e="frameFloatValue";break;case c.default.Type.Boolean:e="frameBooleanValue"}this.context.nima.editingAnimation.toggleKey(this.props.property,e),this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"changeBooleanValue",value:function(e){this.props.property.booleanValue=0!==e,this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e,t,n=this.props.isAnimating,r=this.props.property,o=!1,a=2,s=null;switch(this.props.property.propertyType){case c.default.Type.String:e=r.frameStringValueKS,t=r.stringValue,o=!0;break;case c.default.Type.Integer:e=r.frameIntValueKS,t=r.intValue,a=0;break;case c.default.Type.Float:e=r.frameFloatValueKS,t=r.floatValue;break;case c.default.Type.Boolean:e=r.frameBooleanValueKS,t=r.booleanValue?1:0,s=["False","True"]}return i.default.createElement("div",null,i.default.createElement("div",{className:"MeshBonesHeader"},i.default.createElement("span",null,"PROPERTY"),i.default.createElement("svg",{className:"AddButton",style:{opacity:n?0:null,pointerEvents:n?"none":null},onClick:this.deleteProperty},i.default.createElement("use",{xlinkHref:f.default.make("/images/symbol-defs.svg#icon-delete")}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Name"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(l.default,{isText:!0,value:r.name,keyState:0,isAnimating:!1,onValueChanged:this.changeName,dragScale:.001,readOnly:n}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Type"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(u.default,{options:c.default.TypeNames,selectedIndex:r.propertyType,onSelectionChanged:this.changePropertyType,disabled:n}))),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Value"),i.default.createElement("div",{className:"SelectionPanelProperties"},null!=s?i.default.createElement(u.default,{options:s,selectedIndex:t,onSelectionChanged:this.changeBooleanValue,isAnimating:n,keyState:e,onSetKey:this.setKey}):i.default.createElement(l.default,{isText:o,value:t,keyState:e,decimals:a,isAnimating:n,onValueChanged:this.changeValue,dragScale:.001,onValueCommit:this.commit,disabled:!1,onSetKey:this.setKey}))))}}]),t}()).prototype,"propertyUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"propertyUpdate"),r.prototype),p(r.prototype,"deleteProperty",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"deleteProperty"),r.prototype),p(r.prototype,"changeName",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeName"),r.prototype),p(r.prototype,"changePropertyType",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changePropertyType"),r.prototype),p(r.prototype,"changeValue",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeValue"),r.prototype),p(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),p(r.prototype,"setKey",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setKey"),r.prototype),p(r.prototype,"changeBooleanValue",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeBooleanValue"),r.prototype),r);t.default=y,y.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=_(n(1)),a=_(n(2)),s=_(n(5)),l=_(n(231)),u=_(n(289)),c=_(n(331)),d=_(n(198)),f=_(n(173)),h=_(n(328)),p=_(n(529)),y=_(n(532)),v=_(n(433)),m=_(n(533)),g=_(n(530)),b=_(n(531)),k=n(409),S=_(n(175)),O=_(n(540)),w=_(n(3));function _(e){return e&&e.__esModule?e:{default:e}}function P(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var C=(0,k.SortableElement)(function(e){var t=e.item,n=e.deleteConstraint,r=e.isAnimating;return i.default.createElement(O.default,{item:t,onDelete:n,isAnimating:r})}),E=(0,k.SortableContainer)(function(e){var t=e.items,n=e.deleteConstraint,r=e.isAnimating;return i.default.createElement("ul",null,t.map(function(e,t){return i.default.createElement(C,{key:t,index:t,item:e,deleteConstraint:n,isAnimating:r})}))}),T=(P((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setItems",value:function(e){(0,S.default)(this.items,e)||(this.component&&this.component.removeEventListener("childrenChanged",this.onChildrenChanged),this.items=e,this.component=e&&e[0].node,this.component&&this.component.addEventListener("childrenChanged",this.onChildrenChanged))}},{key:"onChildrenChanged",value:function(e){this.forceUpdate()}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setItems(null)}},{key:"makeConstraint",value:function(e){var t=this.context.nima.actor.addNodeType(e,this.component,{});t&&(t.onAdded(),t.stageItem&&t.stageItem.addToStage(this.context.nima.stage),this.context.nima.captureJournalEntry())}},{key:"addConstraint",value:function(e){var t=this,n=this.context.nima,r=[{name:"IK",type:p.default,ownerType:d.default},{name:"Transform",type:y.default,ownerType:f.default},{name:"Distance",type:v.default,ownerType:f.default},{name:"Translation",type:m.default,ownerType:f.default},{name:"Scale",type:g.default,ownerType:f.default},{name:"Rotation",type:b.default,ownerType:f.default}],o=[],i=this.makeConstraint,a=function(e){if(!(t.component instanceof e.ownerType))return"continue";var n={name:e.name,select:function(){i(e.type)}};o.push(n)},s=!0,l=!1,u=void 0;try{for(var c,h=r[Symbol.iterator]();!(s=(c=h.next()).done);s=!0)a(c.value)}catch(e){l=!0,u=e}finally{try{!s&&h.return&&h.return()}finally{if(l)throw u}}o.length&&n.showContextMenu({x:e.clientX,y:e.clientY,items:o})}},{key:"deleteConstraint",value:function(e){var t=new c.default(this.context.nima.stage,this.context.nima.actor,[e.stageItem],[]);t.start(),t.end()}},{key:"onSortEnd",value:function(e){var t=e.oldIndex,n=e.newIndex,r=[],o=[],i=this.component;if(i){var a=!0,s=!1,l=void 0;try{for(var u,c=i.children[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;d instanceof h.default?r.push(d):o.push(d)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}r=(0,k.arrayMove)(r,t,n),i.children=o.concat(r),this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e=this.props.isAnimating,t=[],n=this.component;if(n){var r=!0,o=!1,a=void 0;try{for(var s,u=n.children[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;c instanceof h.default&&t.push(c)}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}return i.default.createElement(l.default,{_key:"_ConstraintOpts",label:"Constraints",className:"EventsContent",action:this.props.isAnimating?null:i.default.createElement("svg",{className:"AddButton",onClick:this.addConstraint},i.default.createElement("use",{xlinkHref:w.default.make("/images/symbol-defs.svg#icon-plus")}))},t.length?i.default.createElement(E,{lockAxis:"y",helperClass:"DragGhost",distance:10,onSortMove:this.onSortMove,onSortEnd:this.onSortEnd,items:t,deleteConstraint:this.deleteConstraint,isAnimating:e}):i.default.createElement("div",{className:"SelectionPanelEmptyMsg"},"No constraints"))}}]),t}()).prototype,"onChildrenChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onChildrenChanged"),r.prototype),P(r.prototype,"makeConstraint",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"makeConstraint"),r.prototype),P(r.prototype,"addConstraint",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"addConstraint"),r.prototype),P(r.prototype,"deleteConstraint",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"deleteConstraint"),r.prototype),P(r.prototype,"onSortEnd",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onSortEnd"),r.prototype),r);t.default=T,T.validate=function(e,t){if(e.state.isAnimationOpen){if(1===t.length)for(var n=t[0].node,r=n.children.length-1;r>=0;r--){if(n.children[r].constructor===u.default)return!0}return!1}return!0},T.canMultiEdit=!1,T.panelOrder=5,T.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=m(n(1)),a=m(n(2)),s=m(n(5)),l=m(n(209)),u=m(n(231)),c=m(n(216)),d=m(n(238)),f=m(n(287)),h=m(n(539)),p=m(n(171)),y=m(n(175)),v=m(n(3));function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var b=(g((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"constraintUpdate",value:function(){this.forceUpdate()}},{key:"setConstraintItems",value:function(e){if(!(0,y.default)(this.stageItems,e)){if(this.stageItems)for(var t=0;t<this.stageItems.length;t++){var n=this.stageItems[t].node;n.removeEventListener("strengthChange",this.constraintUpdate),n.removeEventListener("enabledChange",this.constraintUpdate),n.removeEventListener("targetChange",this.constraintUpdate)}if(this.stageItems=e,this.constraint=null,this.stageItems)for(var r=0;r<this.stageItems.length;r++){var o=this.stageItems[r].node;o.addEventListener("strengthChange",this.constraintUpdate),o.addEventListener("enabledChange",this.constraintUpdate),o.addEventListener("targetChange",this.constraintUpdate)}}}},{key:"keyStrength",value:function(e){if(this.stageItems){for(var t=0;t<this.stageItems.length;t++){var n=this.stageItems[t].node;this.context.nima.editingAnimation.toggleKey(n,"frameStrength")}this.context.nima.captureJournalEntry(),this.forceUpdate()}}},{key:"changeStrength",value:function(e,t){if(this.stageItems){for(var n=0;n<this.stageItems.length;n++){this.stageItems[n].node.strength=e}t||this.context.nima.captureJournalEntry(),this.forceUpdate()}}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setConstraintItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setConstraintItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setConstraintItems(null)}},{key:"toggleEnabled",value:function(){if(this.stageItems){for(var e=!(this.stageItems.length&&this.stageItems[0].node.isEnabled),t=0;t<this.stageItems.length;t++){this.stageItems[t].node.isEnabled=e}this.context.nima.captureJournalEntry()}}},{key:"pickedTarget",value:function(e,t){this.pickTargetAlert&&(this.pickTargetAlert.hide(),this.pickTargetAlert=null);var n=this.context.nima,r=n.stage;r.clearRerouteSelection(this.rerouteCB),n.clearCancelCallback(this.cancelCB),r.clearExtraSelectionFilter(),delete this.rerouteCB,delete this.cancelCB,e&&e(t)}},{key:"pickTarget",value:function(e){var n=this.context.nima,r=n.stage;if(!this.pickTargetAlert&&!r.soloItem){var o=this;this.pickTargetAlert=n.alert({title:"Pick Target",message:"Select the item to use as a target.",type:p.default.Types.State,buttons:[{label:"CLEAR",action:function(t,n){o.pickedTarget(e,null),e(null)}},{label:"CANCEL",action:function(t,n){o.pickedTarget(e)}}]}),this.cancelCB=function(t){o.pickedTarget(e)},this.rerouteCB=function(t){o.pickedTarget(e,t)},n.setCancelCallback(this.cancelCB),r.rerouteSelection(this.rerouteCB);var i=l.default.validate(t.Validation,this.stageItems).root;r.setExtraSelectionFilter(function(e){return!e.drawAfterSelections&&e.node&&e.node.root===i})}}},{key:"pickConstraintTarget",value:function(){var e=this,t=this.context.nima;this.pickTarget(function(n){if(void 0!==n){var r=function(e){var r=e.node;t.detectDependencyCycles(function(){r.target=n.node,r.onTargetOptionChanged()})},o=!0,i=!1,a=void 0;try{for(var s,l=e.stageItems[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){r(s.value)}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}e.context.nima.captureJournalEntry()}})}},{key:"removeConstraintTarget",value:function(){if(this.stageItems){var e=!0,t=!1,n=void 0;try{for(var r,o=this.stageItems[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.node.target=null}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.context.nima.captureJournalEntry()}}},{key:"render",value:function(){var e=this.props.isAnimating,n=l.default.validate(t.Validation,this.stageItems);return i.default.createElement(u.default,{label:"Constraint",action:e?null:i.default.createElement(d.default,{isOn:n.isEnabled,onToggle:this.toggleEnabled})},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Strength"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{value:n.strength,keyState:n.frameStrengthKS,isAnimating:e,onValueChanged:this.changeStrength,dragScale:.005,onValueCommit:this.commit,onSetKey:this.keyStrength}))),e||!1===n.root||!1===n.target?null:i.default.createElement("div",{style:{marginBottom:"10px"}},i.default.createElement("div",{onClick:this.pickConstraintTarget,className:"SelectionPanelButton MeshBonesHeader",style:{borderRadius:n.target?null:"20px"}},i.default.createElement("span",null,n.targetName||"Target"),i.default.createElement("svg",{className:"AddButton"},i.default.createElement("use",{xlinkHref:v.default.make("/images/symbol-defs.svg#icon-plus")}))),n.target?i.default.createElement(h.default,{key:n.target.refId,node:n.target,onRemove:this.removeConstraintTarget}):null))}}]),t}()).prototype,"constraintUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"constraintUpdate"),r.prototype),g(r.prototype,"keyStrength",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyStrength"),r.prototype),g(r.prototype,"changeStrength",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeStrength"),r.prototype),g(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),g(r.prototype,"toggleEnabled",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleEnabled"),r.prototype),g(r.prototype,"pickConstraintTarget",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"pickConstraintTarget"),r.prototype),g(r.prototype,"removeConstraintTarget",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"removeConstraintTarget"),r.prototype),r);t.default=b,b.canMultiEdit=!0,b.panelOrder=3,b.validate=function(e,t){return l.default.validate(b.Validation,t)},b.Validation={root:{validate:function(e){return e.node&&e.node.root||!1}},targetName:{validate:function(e){return e.node&&e.node.constructor.targetName}},strength:{validate:function(e){return e.node&&e.node.strength},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number}},isEnabled:{validate:function(e){return e.node&&e.node.isEnabled}},frameStrengthKS:{validate:function(e){return e.node&&e.node.frameStrengthKS}},target:{validate:function(e){return!!(e.node&&e.node instanceof f.default)&&e.node.target}}},b.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=h(n(1)),a=h(n(2)),s=h(n(5)),l=h(n(209)),u=h(n(231)),c=h(n(220)),d=h(n(237)),f=h(n(175));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var y=(p((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"itemPropertiesUpdated",value:function(){var e=this;clearTimeout(this.t),this.t=setTimeout(function(){e.forceUpdate()},10)}},{key:"setItems",value:function(e){if(!(0,f.default)(this.items,e)){if(this.items)for(var t=0;t<this.items.length;t++){var n=this.items[t];n.node&&(n.node.removeEventListener("activeChildChanged",this.itemPropertiesUpdated),n.node.removeEventListener("keyState",this.itemPropertiesUpdated))}if(this.items=e,e)for(var r=0;r<e.length;r++){var o=e[r];o.node&&(o.node.addEventListener("activeChildChanged",this.itemPropertiesUpdated),o.node.addEventListener("keyState",this.itemPropertiesUpdated))}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setItems(null)}},{key:"changeActiveChild",value:function(e){this.items[0].node.activeChildIndex=e-1,this.context.nima.captureJournalEntry()}},{key:"keyFavoriteChild",value:function(e){var t=this.items[0];this.context.nima.editingAnimation.toggleKey(t.node,"frameActiveChild"),this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.items),n=this.props.isAnimating,r=this.items[0],o=[{label:"None",value:0}],a=r.node.activeChildIndex+1,s=!0,d=!1,f=void 0;try{for(var h,p=r.node.children[Symbol.iterator]();!(s=(h=p.next()).done);s=!0){var y=h.value;o.push({label:y.name,value:y.refId,child:y})}}catch(e){d=!0,f=e}finally{try{!s&&p.return&&p.return()}finally{if(d)throw f}}var v=r.node.frameActiveChildKS;return i.default.createElement(u.default,{_key:"_SoloSelectionOpts",label:"Solo Options"},e.hasSoloChildren?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Active Child"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{options:o,selectedIndex:a,onSelectionChanged:this.changeActiveChild,isAnimating:n,keyState:v,onSetKey:this.keyFavoriteChild}))):null)}}]),t}()).prototype,"itemPropertiesUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"itemPropertiesUpdated"),r.prototype),p(r.prototype,"changeActiveChild",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeActiveChild"),r.prototype),p(r.prototype,"keyFavoriteChild",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyFavoriteChild"),r.prototype),r);t.default=y,y.validate=function(e,t){var n=l.default.validate(y.Validation,t);return!!n.hasSoloChildren&&n},y.Validation={hasSoloChildren:{validate:function(e){return!!(e.node&&e.node instanceof d.default)}}},y.canMultiEdit=!1,y.panelOrder=2,y.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=P(n(1)),a=P(n(2)),s=P(n(5)),l=P(n(209)),u=P(n(172)),c=P(n(216)),d=P(n(175)),f=P(n(19)),h=P(n(218)),p=P(n(236)),y=n(302),v=P(n(252)),m=P(n(230)),g=P(n(176)),b=P(n(1207)),k=P(n(675)),S=P(n(538)),O=P(n(304)),w=P(n(350)),_=n(7);function P(e){return e&&e.__esModule?e:{default:e}}function C(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var E=[h.default.Straight,h.default.Mirror,h.default.Disconnected,h.default.Asymmetric],T=(C((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={selectedBoneIndex:-1},n.connectedBones=new Set,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"selectBoneIndex",value:function(e){var t=this.connectedBones,n=Math.max(0,Math.min(e,t.size-1));this.setState({selectedBoneIndex:n})}},{key:"selectNextBone",value:function(){this.selectBoneIndex(this.state.selectedBoneIndex.selectedBoneIndex+1)}},{key:"selectPreviousBone",value:function(){this.selectBoneIndex(this.state.selectedBoneIndex.selectedBoneIndex-1)}},{key:"setItems",value:function(e){if(!(0,d.default)(this.items,e)){var t=!0,n=!1,r=void 0;try{for(var o,i=this.connectedBones[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.stageItem.fillColor=null}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}var a=[],s=[];if(e){var l=!0,u=!1,c=void 0;try{for(var f,h=e[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var b=f.value;switch(b.constructor){case p.default:case y.StagePathControlIn:case y.StagePathControlOut:s.push(b);break;case v.default:a.push(b.node);break;case m.default:a=a.concat(b.node.paths)}}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}}if(a=new Set(a),this.items){var k=!0,S=!1,O=void 0;try{for(var w,_=this.items[Symbol.iterator]();!(k=(w=_.next()).done);k=!0){var P=w.value.node;P.removeEventListener("typeChange",this.updateProperties),P.removeEventListener("posChange",this.updateProperties),P.removeEventListener("inChange",this.updateProperties),P.removeEventListener("outChange",this.updateProperties),P.removeEventListener("radiusChange",this.updateProperties)}}catch(e){S=!0,O=e}finally{try{!k&&_.return&&_.return()}finally{if(S)throw O}}}if(this.paths){var C=!0,E=!1,T=void 0;try{for(var I,j=this.paths[Symbol.iterator]();!(C=(I=j.next()).done);C=!0){I.value.removeEventListener("weightChange",this.updateProperties)}}catch(e){E=!0,T=e}finally{try{!C&&j.return&&j.return()}finally{if(E)throw T}}}if(this.shapes){var A=!0,D=!1,R=void 0;try{for(var M,x=this.shapes[Symbol.iterator]();!(A=(M=x.next()).done);A=!0){M.value.removeEventListener("pathsAnimated",this.updateProperties)}}catch(e){D=!0,R=e}finally{try{!A&&x.return&&x.return()}finally{if(D)throw R}}}this.items=s,this.paths=Array.from(a);var F=new Set,L=!0,N=!1,z=void 0;try{for(var V,B=a[Symbol.iterator]();!(L=(V=B.next()).done);L=!0){var H=V.value;if(H.connectedBones){var W=!0,K=!1,G=void 0;try{for(var U,X=H.connectedBones[Symbol.iterator]();!(W=(U=X.next()).done);W=!0){var Y=U.value;F.add(Y.node)}}catch(e){K=!0,G=e}finally{try{!W&&X.return&&X.return()}finally{if(K)throw G}}}}}catch(e){N=!0,z=e}finally{try{!L&&B.return&&B.return()}finally{if(N)throw z}}this.connectedBones=F,F.size?(this.selectBoneIndex(0),this.context.nima.setSelectionCallbacks(this.selectBoneIndex,this.selectNextBone,this.selectPreviousBone)):this.context.nima.setSelectionCallbacks();var J=0,q=!0,Q=!1,Z=void 0;try{for(var $,ee=F[Symbol.iterator]();!(q=($=ee.next()).done);q=!0){$.value.stageItem.fillColor=g.default.Colors[J++]}}catch(e){Q=!0,Z=e}finally{try{!q&&ee.return&&ee.return()}finally{if(Q)throw Z}}if(this.items){var te=new Set;this.shapes=te;var ne=!0,re=!1,oe=void 0;try{for(var ie,ae=this.items[Symbol.iterator]();!(ne=(ie=ae.next()).done);ne=!0){var se=ie.value.node;se.addEventListener("typeChange",this.updateProperties),se.addEventListener("posChange",this.updateProperties),se.addEventListener("inChange",this.updateProperties),se.addEventListener("outChange",this.updateProperties),se.addEventListener("radiusChange",this.updateProperties),te.add(se.parent.parent)}}catch(e){re=!0,oe=e}finally{try{!ne&&ae.return&&ae.return()}finally{if(re)throw oe}}var le=!0,ue=!1,ce=void 0;try{for(var de,fe=te[Symbol.iterator]();!(le=(de=fe.next()).done);le=!0){de.value.addEventListener("pathsAnimated",this.updateProperties)}}catch(e){ue=!0,ce=e}finally{try{!le&&fe.return&&fe.return()}finally{if(ue)throw ce}}var he=!0,pe=!1,ye=void 0;try{for(var ve,me=a[Symbol.iterator]();!(he=(ve=me.next()).done);he=!0){ve.value.addEventListener("weightChange",this.updateProperties)}}catch(e){pe=!0,ye=e}finally{try{!he&&me.return&&me.return()}finally{if(pe)throw ye}}}else this.shapes=null}}},{key:"boundForcedUpdate",value:function(){this.forceUpdate()}},{key:"updateProperties",value:function(){(0,f.default)(this.boundForcedUpdate)}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setItems(null)}},{key:"translateX",value:function(e,t){for(var n=new Set,r=0;r<this.items.length;r++){var o=this.items[r],i=_.vec2.subtract(_.vec2.create(),o.getWorldTranslation(_.vec2.fromValues(e,o.pointTranslation[1])),o.getWorldTranslation(o.pointTranslation));w.default.translate([o],i),n.add(o.node.parent)}var a=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.triggerAutoKeyPath()}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}t||this.context.nima.captureJournalEntry()}},{key:"translateY",value:function(e,t){for(var n=new Set,r=0;r<this.items.length;r++){var o=this.items[r],i=_.vec2.subtract(_.vec2.create(),o.getWorldTranslation(_.vec2.fromValues(o.pointTranslation[0],e)),o.getWorldTranslation(o.pointTranslation));w.default.translate([o],i),n.add(o.node.parent)}var a=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.triggerAutoKeyPath()}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}t||this.context.nima.captureJournalEntry()}},{key:"setRadius",value:function(e,t){for(var n=new Set,r=0;r<this.items.length;r++){var o=this.items[r];o.node.radius=e,n.add(o.node.parent)}t||this.context.nima.captureJournalEntry();var i=!0,a=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){l.value.triggerAutoKeyPath()}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"changePointType",value:function(e){for(var t=E[e],n=new Set,r=0;r<this.items.length;r++){var o=this.items[r].node,i=o.parent;o.pointType=t,n.add(i)}var a=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.markDeformDirty()}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"toggleClosePath",value:function(){this.isPathClosed=!this.isPathClosed,this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"doneEditing",value:function(){this.context.nima.editingShape=null}},{key:"changeVertexWeight",value:function(e,t){this.context.nima.stage.findTool(O.default).setWeight(e,t)}},{key:"render",value:function(){var e=this,n=this.context.nima.stage,r=l.default.validate(t.Validation,this.items),o=this.items.length>0,a=this.isPathClosed,s=n.findTool(O.default),d=Array.from(s.weightableBones),f=s.selectedWeights||new Map,h=this.state.selectedBoneIndex;return h=Math.min(d.length-1,h),s.selectBone(d[h]),i.default.createElement("div",{className:"SelectionPanelGroup"},i.default.createElement("div",{className:"SelectionPanelButtonsWrapper"},i.default.createElement(u.default,{label:a?"Open Path":"Close Path",onPress:this.toggleClosePath}),i.default.createElement(u.default,{label:"Done Editing",onPress:this.doneEditing})),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Position"),i.default.createElement(c.default,{ref:this.setTranslateX,label:"X",value:r.translationX,keyState:r.translationKeyStateX,isAnimating:!1,onValueChanged:this.translateX,onValueCommit:this.commit,disabled:!o}),i.default.createElement(c.default,{ref:this.setTranslateY,label:"Y",value:r.translationY,keyState:r.translationKeyStateY,isAnimating:!1,onValueChanged:this.translateY,onValueCommit:this.commit,disabled:!o})),i.default.createElement(k.default,{selectedIndex:r.pointTypeIndex,onSelectionChanged:this.changePointType,disabled:!o}),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Radius"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(c.default,{value:r.radius,converter:b.default,keyState:0,isAnimating:!1,onValueChanged:this.setRadius,onValueCommit:this.commit,disabled:!r.hasRadius||!o,onSetKey:null}))),i.default.createElement("div",{className:"SelectionPanelProperty",style:{display:"initial"}},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Weights"),i.default.createElement("div",{className:"SelectionPanelProperties"},d.map(function(t,n){return i.default.createElement(S.default,{value:f.get(t),idx:n,onSelect:e.selectBoneIndex,key:t.refId,bone:t,color:t.stageItem.cssFillColor,isSelected:h===n,onWeightChanged:e.changeVertexWeight})}))))}},{key:"isPathClosed",get:function(){return this.paths.reduce(function(e,t){return!!t.isClosed&&e},!0)},set:function(e){this.paths.forEach(function(t){return t.isClosed=e})}}]),t}()).prototype,"selectBoneIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectBoneIndex"),r.prototype),C(r.prototype,"selectNextBone",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectNextBone"),r.prototype),C(r.prototype,"selectPreviousBone",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectPreviousBone"),r.prototype),C(r.prototype,"boundForcedUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"boundForcedUpdate"),r.prototype),C(r.prototype,"updateProperties",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateProperties"),r.prototype),C(r.prototype,"translateX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"translateX"),r.prototype),C(r.prototype,"translateY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"translateY"),r.prototype),C(r.prototype,"setRadius",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setRadius"),r.prototype),C(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),C(r.prototype,"changePointType",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changePointType"),r.prototype),C(r.prototype,"toggleClosePath",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleClosePath"),r.prototype),C(r.prototype,"doneEditing",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"doneEditing"),r.prototype),C(r.prototype,"changeVertexWeight",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeVertexWeight"),r.prototype),r);t.default=T,T.validate=function(e,t){return!0},T.Validation={pointTypeIndex:{validate:function(e){return E.indexOf(e.node.pointType)}},translationX:{validate:function(e){return e.pointTranslation[0]},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},translationY:{validate:function(e){return e.pointTranslation[1]},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},hasRadius:{validate:function(e){return e.node.pointType===h.default.Straight}},radius:{validate:function(e){return e.node.radius}}},T.canMultiEdit=!0,T.panelOrder=2,T.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"toDisplayValue",value:function(e){return Math.floor(100*e)/100}},{key:"toInputValue",value:function(e){return e}},{key:"fromDisplayValue",value:function(e){var t=Number.parseFloat(e);if(t<0)throw"Invalid input";return t}},{key:"fromInputValue",value:function(e){return this.fromDisplayValue(e)}},{key:"defaultValue",get:function(){return 0}},{key:"allowDrag",get:function(){return!0}},{key:"dragScale",get:function(){return 1}},{key:"dragMin",get:function(){return 0}},{key:"dragMax",get:function(){return 100}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=S(n(1)),a=S(n(2)),s=S(n(5)),l=S(n(209)),u=S(n(172)),c=S(n(216)),d=S(n(175)),f=S(n(19)),h=(S(n(218)),S(n(301))),p=S(n(179)),y=S(n(176)),v=(S(n(675)),S(n(538))),m=S(n(304)),g=S(n(381)),b=S(n(350)),k=n(7);function S(e){return e&&e.__esModule?e:{default:e}}function O(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var w=(O((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={selectedBoneIndex:-1},n.connectedBones=new Set,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"selectBoneIndex",value:function(e){var t=this.connectedBones,n=Math.max(0,Math.min(e,t.size-1));this.setState({selectedBoneIndex:n})}},{key:"selectNextBone",value:function(){this.selectBoneIndex(this.state.selectedBoneIndex.selectedBoneIndex+1)}},{key:"selectPreviousBone",value:function(){this.selectBoneIndex(this.state.selectedBoneIndex.selectedBoneIndex-1)}},{key:"setItems",value:function(e){if(!(0,d.default)(this.items,e)){var t=!0,n=!1,r=void 0;try{for(var o,i=this.connectedBones[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.stageItem.fillColor=null}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}var a=[],s=[];if(e){var l=!0,u=!1,c=void 0;try{for(var f,v=e[Symbol.iterator]();!(l=(f=v.next()).done);l=!0){var m=f.value;switch(m.constructor){case h.default:s.push(m);break;case p.default:a.push(m.node)}}}catch(e){u=!0,c=e}finally{try{!l&&v.return&&v.return()}finally{if(u)throw c}}}if(a=new Set(a),this.items){var g=!0,b=!1,k=void 0;try{for(var S,O=this.items[Symbol.iterator]();!(g=(S=O.next()).done);g=!0){var w=S.value.node;w.removeEventListener("typeChange",this.updateProperties),w.removeEventListener("posChange",this.updateProperties),w.removeEventListener("inChange",this.updateProperties),w.removeEventListener("outChange",this.updateProperties),w.removeEventListener("radiusChange",this.updateProperties)}}catch(e){b=!0,k=e}finally{try{!g&&O.return&&O.return()}finally{if(b)throw k}}}if(this.images){var _=!0,P=!1,C=void 0;try{for(var E,T=this.images[Symbol.iterator]();!(_=(E=T.next()).done);_=!0){E.value.removeEventListener("weightChange",this.updateProperties)}}catch(e){P=!0,C=e}finally{try{!_&&T.return&&T.return()}finally{if(P)throw C}}}this.items=s,this.images=Array.from(a);var I=new Set,j=!0,A=!1,D=void 0;try{for(var R,M=a[Symbol.iterator]();!(j=(R=M.next()).done);j=!0){var x=R.value;if(x.connectedBones){var F=!0,L=!1,N=void 0;try{for(var z,V=x.connectedBones[Symbol.iterator]();!(F=(z=V.next()).done);F=!0){var B=z.value;I.add(B.node)}}catch(e){L=!0,N=e}finally{try{!F&&V.return&&V.return()}finally{if(L)throw N}}}}}catch(e){A=!0,D=e}finally{try{!j&&M.return&&M.return()}finally{if(A)throw D}}this.connectedBones=I,I.size?(this.selectBoneIndex(0),this.context.nima.setSelectionCallbacks(this.selectBoneIndex,this.selectNextBone,this.selectPreviousBone)):this.context.nima.setSelectionCallbacks();var H=0,W=!0,K=!1,G=void 0;try{for(var U,X=I[Symbol.iterator]();!(W=(U=X.next()).done);W=!0){U.value.stageItem.fillColor=y.default.Colors[H++]}}catch(e){K=!0,G=e}finally{try{!W&&X.return&&X.return()}finally{if(K)throw G}}if(this.items){var Y=new Set;this.shapes=Y;var J=!0,q=!1,Q=void 0;try{for(var Z,$=this.items[Symbol.iterator]();!(J=(Z=$.next()).done);J=!0){var ee=Z.value.node;ee.addEventListener("typeChange",this.updateProperties),ee.addEventListener("posChange",this.updateProperties),ee.addEventListener("inChange",this.updateProperties),ee.addEventListener("outChange",this.updateProperties),ee.addEventListener("radiusChange",this.updateProperties),Y.add(ee.parent.parent)}}catch(e){q=!0,Q=e}finally{try{!J&&$.return&&$.return()}finally{if(q)throw Q}}var te=!0,ne=!1,re=void 0;try{for(var oe,ie=a[Symbol.iterator]();!(te=(oe=ie.next()).done);te=!0){oe.value.addEventListener("weightChange",this.updateProperties)}}catch(e){ne=!0,re=e}finally{try{!te&&ie.return&&ie.return()}finally{if(ne)throw re}}}}}},{key:"boundForcedUpdate",value:function(){this.forceUpdate()}},{key:"updateProperties",value:function(){(0,f.default)(this.boundForcedUpdate)}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setItems(null)}},{key:"translateX",value:function(e,t){for(var n=new Set,r=0;r<this.items.length;r++){var o=this.items[r],i=k.vec2.subtract(k.vec2.create(),k.vec2.fromValues(e,o.pointTranslation[1]),o.pointTranslation);b.default.translate([o],i),n.add(o.node.parent)}var a=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.triggerAutoKeyPath()}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}t||this.context.nima.captureJournalEntry()}},{key:"translateY",value:function(e,t){for(var n=new Set,r=0;r<this.items.length;r++){var o=this.items[r],i=k.vec2.subtract(k.vec2.create(),k.vec2.fromValues(o.pointTranslation[0],e),o.pointTranslation);b.default.translate([o],i),n.add(o.node.parent)}var a=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.triggerAutoKeyPath()}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}t||this.context.nima.captureJournalEntry()}},{key:"setRadius",value:function(e,t){for(var n=new Set,r=0;r<this.items.length;r++){var o=this.items[r];o.node.radius=e,n.add(o.node.parent)}t||this.context.nima.captureJournalEntry();var i=!0,a=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){l.value.triggerAutoKeyPath()}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"changePointType",value:function(e){for(var t=PointTypeOptions[e],n=new Set,r=0;r<this.items.length;r++){var o=this.items[r].node,i=o.parent;o.pointType=t,n.add(i)}var a=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.markDeformDirty()}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"newMesh",value:function(){var e=this.context.nima.stage,t=!0,n=!1,r=void 0;try{for(var o,i=this.images[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.removePoints()}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}e.toolType=g.default}},{key:"doneEditing",value:function(){this.context.nima.editingShape=null}},{key:"changeVertexWeight",value:function(e,t){this.context.nima.stage.findTool(m.default).setWeight(e,t)}},{key:"render",value:function(){var e=this,n=this.context.nima.stage,r=l.default.validate(t.Validation,this.items),o=this.items.length>0,a=n.findTool(m.default),s=Array.from(a.weightableBones),d=a.selectedWeights||new Map,f=this.state.selectedBoneIndex;return f=Math.min(s.length-1,f),a.selectBone(s[f]),i.default.createElement("div",{className:"SelectionPanelGroup"},i.default.createElement("div",{className:"SelectionPanelButtonsWrapper"},i.default.createElement(u.default,{label:"New Mesh",onPress:this.newMesh}),i.default.createElement(u.default,{label:"Done Editing",onPress:this.doneEditing})),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Position"),i.default.createElement(c.default,{ref:this.setTranslateX,label:"X",value:r.translationX,keyState:r.translationKeyStateX,isAnimating:!1,onValueChanged:this.translateX,onValueCommit:this.commit,disabled:!o}),i.default.createElement(c.default,{ref:this.setTranslateY,label:"Y",value:r.translationY,keyState:r.translationKeyStateY,isAnimating:!1,onValueChanged:this.translateY,onValueCommit:this.commit,disabled:!o})),i.default.createElement("div",{className:"SelectionPanelProperty",style:{display:"initial"}},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Weights"),i.default.createElement("div",{className:"SelectionPanelProperties"},s.map(function(t,n){return i.default.createElement(v.default,{value:d.get(t),idx:n,onSelect:e.selectBoneIndex,key:t.refId,bone:t,color:t.stageItem.cssFillColor,isSelected:f===n,onWeightChanged:e.changeVertexWeight})}))))}}]),t}()).prototype,"selectBoneIndex",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectBoneIndex"),r.prototype),O(r.prototype,"selectNextBone",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectNextBone"),r.prototype),O(r.prototype,"selectPreviousBone",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectPreviousBone"),r.prototype),O(r.prototype,"boundForcedUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"boundForcedUpdate"),r.prototype),O(r.prototype,"updateProperties",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateProperties"),r.prototype),O(r.prototype,"translateX",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"translateX"),r.prototype),O(r.prototype,"translateY",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"translateY"),r.prototype),O(r.prototype,"setRadius",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setRadius"),r.prototype),O(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),O(r.prototype,"changePointType",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changePointType"),r.prototype),O(r.prototype,"newMesh",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"newMesh"),r.prototype),O(r.prototype,"doneEditing",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"doneEditing"),r.prototype),O(r.prototype,"changeVertexWeight",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeVertexWeight"),r.prototype),r);t.default=w,w.validate=function(e,t){return!0},w.Validation={translationX:{validate:function(e){return e.pointTranslation[0]},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},translationY:{validate:function(e){return e.pointTranslation[1]},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}}},w.canMultiEdit=!0,w.panelOrder=2,w.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=b(n(1)),a=b(n(2)),s=b(n(5)),l=b(n(175)),u=b(n(19)),c=b(n(3)),d=b(n(176)),f=b(n(253)),h=b(n(541)),p=b(n(171)),y=b(n(374)),v=b(n(228)),m=b(n(672)),g=b(n(304));function b(e){return e&&e.__esModule?e:{default:e}}function k(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var S=(k((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"connectedBoneChange",value:function(){this.forceUpdate()}},{key:"setItems",value:function(e){(0,l.default)(this.items,e)||(this.skinnable&&this.skinnable.removeEventListener("connectedBoneChange",this.connectedBoneChange),this.items=e,this.skinnable=e&&e[0].node||null,this.skinnable&&this.skinnable.addEventListener("connectedBoneChange",this.connectedBoneChange))}},{key:"doForceUpdate",value:function(){this.forceUpdate()}},{key:"onPropertyChanged",value:function(){(0,u.default)(this.doForceUpdate)}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setItems(null)}},{key:"connectSelectedBones",value:function(){for(var e=this.context.nima.stage,t=e.selectedItems,n=[],r=0;r<t.length;r++){var o=t[r];o.node instanceof y.default&&n.push(o.node)}var i=this.skinnable;if(i){var a=[],s=i.connectedBones;if(s)for(var l=0;l<s.length;l++)a.push(s[l].node);for(var u=0;u<a.length;u++){var c=a[u];-1===n.indexOf(c)&&i.disconnectBone(c,!0)}for(var d=0;d<n.length;d++){for(var f=n[d],h=!1,p=0;p<h.length;p++)if(h[p].node===f){h=!0;break}h||i.connectBone(f,!0)}this.setState({areWeightsEnabled:i.connectedBones.length>0}),i.onConnectedBoneChange(),e.findTool(g.default).normalizePath(this.skinnable)}this.cancelConnectBone(),this.context.nima.captureJournalEntry()}},{key:"cancelConnectBone",value:function(){var e=this.context.nima.stage;if(this.connectAlert&&this.skinnable){var t=this.skinnable;this.connectAlert.hide(),this.connectAlert=null,e.removeEventListener("selectionChanged",this.stageSelectionChanged),this.context.nima.editor.clearHoldSelectedItem(t.stageItem),e.selectItems([t.stageItem],!1)}var n=this._ConnectableBones;if(n){var r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l instanceof d.default&&(l.hideHelpers=!1)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}this._ConnectableBones=null}e.clearSoloItems(),this.context.nima.clearCancelCallback(this.cancelConnectBone),e.toolType===h.default&&e.tool.close()}},{key:"stageSelectionChanged",value:function(){if(this.connectAlert){for(var e=this.context.nima.stage.selectedItems,t=!1,n=0;n<e.length;n++){if(e[n].node instanceof y.default){t=!0;break}}this.connectAlert.enableButton(1,t),this.connectAlert.accentButton(1,t)}}},{key:"connectBone",value:function(){if(!this.connectAlert&&this.skinnable){var e=this.skinnable.root,t=this.context.nima.stage.getTypeItems([d.default,f.default]).filter(function(t){return t.node&&t.node.root===e}),n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s instanceof d.default&&(s.hideHelpers=!0)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this._ConnectableBones=t,this.context.nima.editor.holdSelectedItem(this.skinnable.stageItem),this.context.nima.stage.setSoloItems(t,!1,!0),this.context.nima.setCancelCallback(this.cancelConnectBone);for(var l=this.skinnable.connectedBones,u=[],c=0;c<l&&l.length;c++)u.push(l[c].node.stageItem);this.context.nima.stage.selectItems(u),this.context.nima.stage.addEventListener("selectionChanged",this.stageSelectionChanged),this.context.nima.stage.toolType=h.default;var y=this;this.connectAlert=this.context.nima.alert({title:"Select Bones",message:"Select bones that will be used to deform the image.",type:p.default.Types.State,buttons:[{label:"CANCEL",action:function(e,t){y.cancelConnectBone()}},{label:"DONE",isDisabled:!0,action:function(e,t){y.connectSelectedBones()}}]}),this.stageSelectionChanged()}}},{key:"render",value:function(){var e=this.skinnable;if(!e)return i.default.createElement("div",null);var t=e.connectedBones,n=[];if(t)for(var r=0;r<t.length;r++){var o=t[r];n.push(i.default.createElement(m.default,{allowDisconnect:!0,key:o.node.refId,bone:o.node,skinnable:e}))}return i.default.createElement("div",{className:"SelectionPanelGroup",_key:"_ConnectedBoneOpts"},i.default.createElement("div",{onClick:this.connectBone,className:"SelectionPanelButton MeshBonesHeader",style:{borderRadius:t&&t.length>0?null:"20px"}},i.default.createElement("span",null,"Connected Bones"),i.default.createElement("svg",{className:"AddButton"},i.default.createElement("use",{xlinkHref:c.default.make("/images/symbol-defs.svg#icon-plus")}))),n)}}]),t}()).prototype,"connectedBoneChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"connectedBoneChange"),r.prototype),k(r.prototype,"doForceUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"doForceUpdate"),r.prototype),k(r.prototype,"onPropertyChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onPropertyChanged"),r.prototype),k(r.prototype,"cancelConnectBone",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"cancelConnectBone"),r.prototype),k(r.prototype,"stageSelectionChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"stageSelectionChanged"),r.prototype),k(r.prototype,"connectBone",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"connectBone"),r.prototype),r);t.default=S,S.validate=function(e,t){return!t.find(function(e){return e.node instanceof v.default})&&!e.state.isAnimationOpen},S.Validation={},S.canMultiEdit=!1,S.panelOrder=2,S.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=k(n(1)),a=k(n(2)),s=k(n(5)),l=k(n(209)),u=k(n(220)),c=k(n(175)),d=k(n(216)),f=k(n(430)),h=n(288),p=k(n(510)),y=k(n(19)),v=k(n(353)),m=n(334),g=k(n(542)),b=k(n(439));function k(e){return e&&e.__esModule?e:{default:e}}function S(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var O=[p.default.EvenOdd,p.default.NonZero],w=new Map;w.set(v.default.Mode.Solid,h.ColorFill),w.set(v.default.Mode.LinearGradient,h.GradientFill),w.set(v.default.Mode.RadialGradient,h.RadialGradientFill);var _=new Map;_.set("colorFill",v.default.Mode.Solid),_.set("gradientFill",v.default.Mode.LinearGradient),_.set("radialGradientFill",v.default.Mode.RadialGradient);var P=(S((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n.isShowingStageFillControls=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setItems",value:function(e){if(!(0,c.default)(this.items,e)){if(this.items){this.context.nima.editor.clearHoldSelectedItem(this.items);var t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node.removeEventListener("fillChanged",this.onPropertyChanged),a.node.removeEventListener("childrenChanged",this.onPropertyChanged)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.showStageFillControls(!1)}if(this.items=e,this.items){var s=!0,l=!1,u=void 0;try{for(var d,f=this.items[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var h=d.value;h.node.addEventListener("fillChanged",this.onPropertyChanged),h.node.addEventListener("childrenChanged",this.onPropertyChanged)}}catch(e){l=!0,u=e}finally{try{!s&&f.return&&f.return()}finally{if(l)throw u}}}}}},{key:"doForceUpdate",value:function(){this.forceUpdate(),this.showStageFillControls(this.isShowingStageFillControls)}},{key:"onPropertyChanged",value:function(){(0,y.default)(this.doForceUpdate)}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setItems(null)}},{key:"makeFill",value:function(e,t){var n=t.node,r=n.actor.addNodeType(e,n,n.__LastFillData||null);switch(e){case h.ColorFill:n.__LastFillData&&n.__LastFillData.color||(r.color=C);break;case h.GradientFill:case h.RadialGradientFill:n.__LastFillData&&n.__LastFillData.start&&n.__LastFillData.end||r.setToBounds()}return this.showStageFillControls(this.isShowingStageFillControls),r}},{key:"findFill",value:function(e,t){return e.node.children.find(function(e){return e.constructor===t})}},{key:"getFill",value:function(e,t){var n=w.get(t),r=this.findFill(e,n);return r||(this.removeFill(e),this.makeFill(n,e))}},{key:"changeColor",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l=this.getFill(s,e.type);switch(e.type){case v.default.Mode.Solid:l.color=e.value;break;default:l.colorStops=e.value}}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"changeFillRule",value:function(e){var t=O[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l=s.node.fill;l||this.makeFill(h.ColorFill,s),l.fillRule=t}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.forceUpdate(),this.context.nima.captureJournalEntry()}},{key:"showStageFillControls",value:function(e){if(this.isShowingStageFillControls=e,this.items){var t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=a.node,l=!0,u=!1,c=void 0;try{for(var d,f=s.children[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p=d.value;switch(p.constructor){case h.GradientFill:case h.RadialGradientFill:case h.ColorFill:break;default:continue}e?p.stageItem.addToStage(a.stage):p.stageItem.removeFromStage()}}catch(e){u=!0,c=e}finally{try{!l&&f.return&&f.return()}finally{if(u)throw c}}}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}}},{key:"colorPickerCheckClose",value:function(){return!this.context.nima.stage.mouseDownSelected}},{key:"colorPickerOpened",value:function(){this.showStageFillControls(!0),this.context.nima.editor.holdSelectedItem(this.items)}},{key:"colorPickerClosed",value:function(){!!this.context.nima.stage.selectedItems.find(function(e){return e instanceof m.StageGradientPoint})&&this.context.nima.stage.selectItems(this.items),this.context.nima.editor.clearHoldSelectedItem(this.items),this.showStageFillControls(!1),this.context.nima.captureJournalEntry()}},{key:"setFillKey",value:function(){var e=null;switch(l.default.validate(t.Validation,this.items).fillType){case h.ColorFill:e="frameFillColor";break;case h.GradientFill:e="frameFillGradient";break;case h.RadialGradientFill:e="frameFillRadial"}for(var n=0;n<this.items.length;n++){var r=this.items[n];this.context.nima.editingAnimation.toggleKey(r.node,e)}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"keyOpacity",value:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];this.context.nima.editingAnimation.toggleKey(t.node,"frameFillOpacity")}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"changeOpacity",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node.fill;s&&(s.opacity=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.forceUpdate(),t||this.context.nima.captureJournalEntry()}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"removeFill",value:function(e){var t=e.node,n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t.children[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;switch(l.constructor){case h.ColorFill:case h.GradientFill:case h.RadialGradientFill:n.push(l)}}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}var u=n.length>0&&n[0]||null,c=!0,d=!1,f=void 0;try{for(var p,y=n[Symbol.iterator]();!(c=(p=y.next()).done);c=!0){var v=p.value;v.stageItem&&v.stageItem.removeFromStage(),t.remove(v)}}catch(e){d=!0,f=e}finally{try{!c&&y.return&&y.return()}finally{if(d)throw f}}u&&(t.__LastFillData=u.serialize(),delete t.__LastFillData.id)}},{key:"toggleFill",value:function(e){if(e){console.log("Should be enabling it");var t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=a.node.__LastFillData,l=_.get(s&&s.type)||v.default.Mode.Solid;this.getFill(a,l)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}else{var u=!0,c=!1,d=void 0;try{for(var f,h=this.items[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value;this.removeFill(p)}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.items),n=this.props.isAnimating,r={value:e.color};switch(e.fillType){case h.ColorFill:r.type=v.default.Mode.Solid;break;case h.GradientFill:r.type=v.default.Mode.LinearGradient;break;case h.RadialGradientFill:r.type=v.default.Mode.RadialGradient;break;default:r.type=v.default.Mode.Solid}var o=!1!==e.fillType;return i.default.createElement("div",{className:"SelectionPanelGroup",_key:"_FillOpts"},i.default.createElement("div",{className:"SelectionPanelProperty CenterPropertyTitle"},n?null:i.default.createElement(g.default,{value:o,onValueChange:this.toggleFill}),i.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{flex:"1",whiteSpace:"nowrap"}},"Fill"),i.default.createElement("div",{className:"Spacer",style:{flex:"initial",width:"35px"}}),i.default.createElement(f.default,{marker:"SelectionPanelPickerMarker",isEmpty:!o,value:r,onValueChanged:this.changeColor,isAnimating:n,onClosed:this.colorPickerClosed,onOpened:this.colorPickerOpened,checkClose:this.colorPickerCheckClose,keyState:e.keyState,onSetKey:this.setFillKey})),n?null:i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Fill Rule"),i.default.createElement("div",{className:"Spacer",style:{marginRight:"-15px"}}),i.default.createElement(u.default,{options:O,isEmpty:!o,selectedIndex:e.fillRuleIndex,onSelectionChanged:this.changeFillRule})),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Fill Opacity"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(d.default,{value:e.opacity,converter:b.default,keyState:e.opacityKeyState,isAnimating:n,onValueChanged:this.changeOpacity,onValueCommit:this.commit,isEmpty:!o,onSetKey:this.keyOpacity})))}}]),t}()).prototype,"doForceUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"doForceUpdate"),r.prototype),S(r.prototype,"onPropertyChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onPropertyChanged"),r.prototype),S(r.prototype,"changeColor",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeColor"),r.prototype),S(r.prototype,"changeFillRule",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeFillRule"),r.prototype),S(r.prototype,"colorPickerCheckClose",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"colorPickerCheckClose"),r.prototype),S(r.prototype,"colorPickerOpened",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"colorPickerOpened"),r.prototype),S(r.prototype,"colorPickerClosed",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"colorPickerClosed"),r.prototype),S(r.prototype,"setFillKey",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setFillKey"),r.prototype),S(r.prototype,"keyOpacity",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyOpacity"),r.prototype),S(r.prototype,"changeOpacity",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeOpacity"),r.prototype),S(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),S(r.prototype,"toggleFill",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleFill"),r.prototype),r);t.default=P,P.validate=function(e,t){var n=l.default.validate(P.Validation,t);return!e.isAnimating||n.fillType};var C=new Float32Array([1,1,1,1]);P.Validation={keyState:{validate:function(e){var t=e.node,n=t.fill;if(!n)return!1;switch(n.constructor){case h.ColorFill:return t.frameFillColorKS;case h.GradientFill:return t.frameFillGradientKS;case h.RadialGradientFill:return t.frameFillRadialKS}return!1}},fillType:{validate:function(e){var t=e.node.fill;return!!t&&t.constructor}},fillRuleIndex:{validate:function(e){var t=e.node;if(!t)return!1;var n=t.fill;return!!n&&O.indexOf(n.fillRule)}},opacity:{validate:function(e){var t=e.node;if(!t)return!1;var n=t.fill;return!!n&&n.opacity}},opacityKeyState:{validate:function(e){var t=e.node;return!!t&&t.frameFillOpacityKS}},color:{validate:function(e){var t=e.node;if(!t)return!1;var n=t.fill;return n instanceof h.ColorFill?n.color:n?n.colorStops:C},equals:function(e,t){return(0,c.default)(e,t)}}},P.canMultiEdit=!0,P.panelOrder=2,P.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=P(n(1)),a=P(n(2)),s=P(n(5)),l=P(n(209)),u=P(n(175)),c=P(n(216)),d=P(n(430)),f=n(288),h=P(n(19)),p=P(n(353)),y=n(334),v=P(n(542)),m=P(n(1212)),g=P(n(439)),b=P(n(421)),k=P(n(661)),S=(P(n(238)),P(n(511))),O=P(n(512)),w=P(n(220)),_=P(n(635));function P(e){return e&&e.__esModule?e:{default:e}}function C(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var E=new Map;E.set(p.default.Mode.Solid,f.ColorStroke),E.set(p.default.Mode.LinearGradient,f.GradientStroke),E.set(p.default.Mode.RadialGradient,f.RadialGradientStroke);var T=new Map;T.set("colorStroke",p.default.Mode.Solid),T.set("gradientStroke",p.default.Mode.LinearGradient),T.set("radialGradientStroke",p.default.Mode.RadialGradient);var I=(C((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={activeJoin:0},n.isShowingStageStrokeControls=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setItems",value:function(e){if(!(0,u.default)(this.items,e)){if(this.items){this.context.nima.editor.clearHoldSelectedItem(this.items);var t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node.removeEventListener("strokeChanged",this.onPropertyChanged),a.node.removeEventListener("childrenChanged",this.onPropertyChanged)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.showStageStrokeControls(!1)}if(this.items=e,this.items){var s=!0,l=!1,c=void 0;try{for(var d,f=this.items[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var h=d.value;h.node.addEventListener("strokeChanged",this.onPropertyChanged),h.node.addEventListener("childrenChanged",this.onPropertyChanged)}}catch(e){l=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(l)throw c}}}}}},{key:"doForceUpdate",value:function(){this.forceUpdate(),this.showStageStrokeControls(this.isShowingStageStrokeControls)}},{key:"onPropertyChanged",value:function(){(0,h.default)(this.doForceUpdate)}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setItems(null)}},{key:"makeStroke",value:function(e,t){var n=t.node,r=n.actor.addNodeType(e,n,n.__LastStrokeData||null);if(r){switch(e){case f.ColorStroke:n.__LastStrokeData&&n.__LastStrokeData.color||(r.color=j);break;case f.GradientStroke:case f.RadialGradientStroke:n.__LastStrokeData&&n.__LastStrokeData.start&&n.__LastStrokeData.end||r.setToBounds()}return this.showStageStrokeControls(this.isShowingStageStrokeControls),r}}},{key:"findStroke",value:function(e,t){return e.node.children.find(function(e){return e.constructor===t})}},{key:"getStroke",value:function(e,t){var n=E.get(t),r=this.findStroke(e,n);return r||(this.removeStroke(e),this.makeStroke(n,e))}},{key:"changeColor",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=this.getStroke(a,e.type);switch(e.type){case p.default.Mode.Solid:s.color=e.value;break;default:s.colorStops=e.value}}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.forceUpdate()}},{key:"changeWidth",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node.stroke;s&&(s.width=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.forceUpdate(),t||this.context.nima.captureJournalEntry()}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"showStageStrokeControls",value:function(e){if(this.isShowingStageStrokeControls=e,this.items){var t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=a.node,l=!0,u=!1,c=void 0;try{for(var d,h=s.children[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var p=d.value;switch(p.constructor){case f.GradientStroke:case f.RadialGradientStroke:case f.ColorStroke:break;default:continue}e?p.stageItem.addToStage(a.stage):p.stageItem.removeFromStage()}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}}},{key:"colorPickerCheckClose",value:function(){return!this.context.nima.stage.mouseDownSelected}},{key:"colorPickerOpened",value:function(){this.showStageStrokeControls(!0),this.context.nima.editor.holdSelectedItem(this.items)}},{key:"colorPickerClosed",value:function(){!!this.context.nima.stage.selectedItems.find(function(e){return e instanceof y.StageGradientPoint})&&this.context.nima.stage.selectItems(this.items),this.context.nima.editor.clearHoldSelectedItem(this.items),this.showStageStrokeControls(!1),this.context.nima.captureJournalEntry()}},{key:"keyOpacity",value:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];this.context.nima.editingAnimation.toggleKey(t.node,"frameStrokeOpacity")}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"changeOpacity",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node.stroke;s&&(s.opacity=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.forceUpdate(),t||this.context.nima.captureJournalEntry()}},{key:"keyWidth",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.items[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.context.nima.editingAnimation.toggleKey(i.node,"frameStrokeWidth")}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"keyTrimStart",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.items[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.context.nima.editingAnimation.toggleKey(i.node,"frameStrokeStart")}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"keyTrimEnd",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.items[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.context.nima.editingAnimation.toggleKey(i.node,"frameStrokeEnd")}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"keyTrimOffset",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.items[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.context.nima.editingAnimation.toggleKey(i.node,"frameStrokeOffset")}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"setStrokeKey",value:function(){var e=null;switch(l.default.validate(t.Validation,this.items).strokeType){case f.ColorStroke:e="frameStrokeColor";break;case f.GradientStroke:e="frameStrokeGradient";break;case f.RadialGradientStroke:e="frameStrokeRadial"}for(var n=0;n<this.items.length;n++){var r=this.items[n];this.context.nima.editingAnimation.toggleKey(r.node,e)}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"removeStroke",value:function(e){var t=e.node,n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t.children[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;switch(l.constructor){case f.ColorStroke:case f.GradientStroke:case f.RadialGradientStroke:n.push(l)}}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}var u=n.length>0&&n[0]||null,c=!0,d=!1,h=void 0;try{for(var p,y=n[Symbol.iterator]();!(c=(p=y.next()).done);c=!0){var v=p.value;v.stageItem&&v.stageItem.removeFromStage(),t.remove(v)}}catch(e){d=!0,h=e}finally{try{!c&&y.return&&y.return()}finally{if(d)throw h}}u&&(t.__LastStrokeData=u.serialize(),delete t.__LastStrokeData.id)}},{key:"toggleStroke",value:function(e){if(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=a.node.__LastStrokeData,l=T.get(s&&s.type)||p.default.Mode.Solid;this.getStroke(a,l)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}else{var u=!0,c=!1,d=void 0;try{for(var f,h=this.items[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var y=f.value;this.removeStroke(y)}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}}this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"capChanged",value:function(e){var t=A[e]||A[0],n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node.stroke;s&&(s.cap=t)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}},{key:"joinChanged",value:function(e){var t=D[e]||D[0],n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node.stroke;s&&(s.join=t)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}},{key:"changeTrimOption",value:function(e){if(!(e<0)){var t=R[e],n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node.stroke;s&&(s.trim=t)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry()}}},{key:"changeTrimStart",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node.stroke;s&&(s.trimStart=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"changeTrimEnd",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node.stroke;s&&(s.trimEnd=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"changeTrimOffset",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node.stroke;s&&(s.trimOffset=e)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.items),n=this.props.isAnimating,r={value:e.color},o=e.strokeCap,a=e.strokeType,s=e.strokeJoin,u=e.trimOptionIndex,h=e.trimStart,y=e.trimEnd,S=e.trimOffset,O=0!==u;switch(a){case f.ColorStroke:r.type=p.default.Mode.Solid;break;case f.GradientStroke:r.type=p.default.Mode.LinearGradient;break;case f.RadialGradientStroke:r.type=p.default.Mode.RadialGradient;break;default:r.type=p.default.Mode.Solid}var _=A.indexOf(o),P=D.indexOf(s),C=!1!==a;return i.default.createElement("div",{className:"SelectionPanelGroup",_key:"_StrokeOpts"},i.default.createElement("div",{className:"SelectionPanelProperty CenterPropertyTitle"},n?null:i.default.createElement(v.default,{value:C,onValueChange:this.toggleStroke}),i.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{flex:"1",whiteSpace:"nowrap"}},"Stroke"),i.default.createElement("div",{className:"Spacer",style:{flex:"initial",width:"35px"}}),i.default.createElement(d.default,{marker:"SelectionPanelPickerMarker",isEmpty:!C,value:r,onValueChanged:this.changeColor,isAnimating:n,onClosed:this.colorPickerClosed,onOpened:this.colorPickerOpened,checkClose:this.colorPickerCheckClose,keyState:e.keyState,onSetKey:this.setStrokeKey})),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Thickness"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(c.default,{value:e.width,isEmpty:!C,keyState:e.widthKeyState,isAnimating:n,onValueChanged:this.changeWidth,onValueCommit:this.commit,onSetKey:this.keyWidth})),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{whiteSpace:"nowrap"}},"Stroke Opacity"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(c.default,{value:e.opacity,converter:g.default,keyState:e.opacityKeyState,isAnimating:n,onValueChanged:this.changeOpacity,onValueCommit:this.commit,isEmpty:!C,onSetKey:this.keyOpacity})),n?null:i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle CenterPropertyTitle",style:{whiteSpace:"nowrap"}},"Cap"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(m.default,{toggles:[{icon:"icon-cap-butt"},{icon:"icon-cap-round"},{icon:"icon-cap-square"}],activeToggle:_,onToggleChanged:this.capChanged})),n?null:i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle CenterPropertyTitle",style:{whiteSpace:"nowrap"}},"Join"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(m.default,{toggles:[{icon:"icon-join-miter"},{icon:"icon-join-round"},{icon:"icon-join-bevel"}],activeToggle:P,onToggleChanged:this.joinChanged})),n?null:i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Trim Path"),i.default.createElement("div",{className:"Spacer",style:{marginRight:"-15px"}}),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(w.default,{options:R,selectedIndex:u,onSelectionChanged:this.changeTrimOption}))),n&&!O?null:i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{whiteSpace:"nowrap"}},"Start"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(c.default,{value:h,converter:b.default,keyState:e.trimStartState,isAnimating:n,onValueChanged:this.changeTrimStart,onValueCommit:this.commit,disabled:!C||!O,onSetKey:this.keyTrimStart})),n&&!O?null:i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{whiteSpace:"nowrap"}},"End"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(c.default,{value:y,converter:b.default,keyState:e.trimEndState,isAnimating:n,onValueChanged:this.changeTrimEnd,onValueCommit:this.commit,disabled:!C||!O,onSetKey:this.keyTrimEnd})),n&&!O?null:i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{whiteSpace:"nowrap"}},"Offset"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(c.default,{value:S,converter:k.default,keyState:e.trimOffsetState,isAnimating:n,onValueChanged:this.changeTrimOffset,onValueCommit:this.commit,disabled:!C||!O,onSetKey:this.keyTrimOffset})))}}]),t}()).prototype,"doForceUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"doForceUpdate"),r.prototype),C(r.prototype,"onPropertyChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onPropertyChanged"),r.prototype),C(r.prototype,"changeColor",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeColor"),r.prototype),C(r.prototype,"changeWidth",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeWidth"),r.prototype),C(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),C(r.prototype,"colorPickerCheckClose",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"colorPickerCheckClose"),r.prototype),C(r.prototype,"colorPickerOpened",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"colorPickerOpened"),r.prototype),C(r.prototype,"colorPickerClosed",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"colorPickerClosed"),r.prototype),C(r.prototype,"keyOpacity",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyOpacity"),r.prototype),C(r.prototype,"changeOpacity",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeOpacity"),r.prototype),C(r.prototype,"keyWidth",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyWidth"),r.prototype),C(r.prototype,"keyTrimStart",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyTrimStart"),r.prototype),C(r.prototype,"keyTrimEnd",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyTrimEnd"),r.prototype),C(r.prototype,"keyTrimOffset",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyTrimOffset"),r.prototype),C(r.prototype,"setStrokeKey",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setStrokeKey"),r.prototype),C(r.prototype,"toggleStroke",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleStroke"),r.prototype),C(r.prototype,"capChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"capChanged"),r.prototype),C(r.prototype,"joinChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"joinChanged"),r.prototype),C(r.prototype,"changeTrimOption",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeTrimOption"),r.prototype),C(r.prototype,"changeTrimStart",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeTrimStart"),r.prototype),C(r.prototype,"changeTrimEnd",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeTrimEnd"),r.prototype),C(r.prototype,"changeTrimOffset",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeTrimOffset"),r.prototype),r);t.default=I,I.validate=function(e,t){var n=l.default.validate(I.Validation,t);return!e.isAnimating||n.strokeType};var j=new Float32Array([1,1,1,1]),A=[S.default.Butt,S.default.Round,S.default.Square],D=[O.default.Miter,O.default.Round,O.default.Bevel];I.Validation={trimOptionIndex:{validate:function(e){var t=e.node.stroke;return!!t&&R.indexOf(t.trim)}},trimStart:{validate:function(e){var t=e.node.stroke;return!!t&&t.trimStart}},trimEnd:{validate:function(e){var t=e.node.stroke;return!!t&&t.trimEnd}},trimOffset:{validate:function(e){var t=e.node.stroke;return!!t&&t.trimOffset}},keyState:{validate:function(e){var t=e.node,n=t.stroke;if(!n)return!1;switch(n.constructor){case f.ColorStroke:return t.frameStrokeColorKS;case f.GradientStroke:return t.frameStrokeGradientKS;case f.RadialGradientStroke:return t.frameStrokeRadialKS}return!1}},strokeCap:{validate:function(e){var t=e.node.stroke;return!!t&&t.cap}},strokeJoin:{validate:function(e){var t=e.node.stroke;return!!t&&t.join}},strokeType:{validate:function(e){var t=e.node.stroke;return!!t&&t.constructor}},width:{validate:function(e){var t=e.node;if(!t)return!1;var n=t.stroke;return n&&n.width||0}},widthKeyState:{validate:function(e){var t=e.node;return!!t&&t.frameStrokeWidthKS}},trimStartState:{validate:function(e){var t=e.node;return!!t&&t.frameStrokeStartKS}},trimEndState:{validate:function(e){var t=e.node;return!!t&&t.frameStrokeEndKS}},trimOffsetState:{validate:function(e){var t=e.node;return!!t&&t.frameStrokeOffsetKS}},opacity:{validate:function(e){var t=e.node;if(!t)return!1;var n=t.stroke;return!!n&&n.opacity}},opacityKeyState:{validate:function(e){var t=e.node;return!!t&&t.frameStrokeOpacityKS}},color:{validate:function(e){var t=e.node;if(!t)return!1;var n=t.stroke;if(n)switch(n.constructor){case f.ColorStroke:return n.color;case f.GradientStroke:case f.RadialGradientStroke:return n.colorStops}return j},equals:function(e,t){return(0,u.default)(e,t)}}};var R=[_.default.Off,_.default.Sequential,_.default.Synced];I.canMultiEdit=!0,I.panelOrder=2,I.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=u(n(1)),s=u(n(2)),l=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function h(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var p=(h((r=function(e){function t(e){return c(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return f(t,a.default.Component),i(t,[{key:"changeToggle",value:function(e){this.props.onToggleChanged&&this.props.onToggleChanged(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.toggles,r=t.activeToggle;return a.default.createElement("div",{className:"IconToggle"},n.map(function(t,n){return a.default.createElement(y,{key:t.icon,icon:t.icon,select:null,isActive:n===r,index:n,onChange:e.changeToggle})}),-1===r?null:a.default.createElement("div",{className:"IconToggleActive",style:{transform:"translateX("+27*r+"px)"}}))}}]),t}()).prototype,"changeToggle",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"changeToggle"),r.prototype),r);t.default=p;var y=(h((o=function(e){function t(){return c(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,a.default.Component),i(t,[{key:"btnClicked",value:function(){this.props.onChange&&this.props.onChange(this.props.index)}},{key:"render",value:function(){return a.default.createElement("svg",{onClick:this.btnClicked,className:this.props.isActive?"IconToggleBtnActive":"IconToggleBtn"},a.default.createElement("use",{xlinkHref:l.default.make("/images/symbol-defs.svg#"+this.props.icon)}))}}]),t}()).prototype,"btnClicked",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"btnClicked"),o.prototype),o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=y(n(1)),a=y(n(2)),s=y(n(5)),l=y(n(209)),u=y(n(216)),c=y(n(335)),d=y(n(197)),f=y(n(175)),h=y(n(19)),p=y(n(674));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var m=(v((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"itemPropertiesUpdated",value:function(){var e=this.context.nima;e.editingAnimation&&e.editingAnimation.isPlaying||(0,h.default)(this.revalidate)}},{key:"revalidate",value:function(){this.forceUpdate()}},{key:"setRectangles",value:function(e){if(!(0,f.default)(this.rectangles,e)){if(this.rectangles){var t=!0,n=!1,r=void 0;try{for(var o,i=this.rectangles[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.removeEventListener("shapePropChange",this.itemPropertiesUpdated),a.removeEventListener("keyState",this.itemPropertiesUpdated)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}if(this.rectangles=e,this.rectangles){var s=!0,l=!1,u=void 0;try{for(var c,d=this.rectangles[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;h.addEventListener("shapePropChange",this.itemPropertiesUpdated),h.addEventListener("keyState",this.itemPropertiesUpdated)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setRectangles(g(e.stageItems))}},{key:"componentWillMount",value:function(){this.setRectangles(g(this.props.stageItems))}},{key:"componentWillUnmount",value:function(){this.setRectangles(null)}},{key:"changeCornerRadius",value:function(e,t){if(this.rectangles){var n=!0,r=!1,o=void 0;try{for(var i,a=this.rectangles[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.cornerRadius=e}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}}},{key:"keyCornerRadius",value:function(e){var t=this.rectangles;if(t){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;this.context.nima.editingAnimation.toggleKey(s,"frameCornerRadius")}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry(),this.forceUpdate()}}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.rectangles),n=this.props.isAnimating;return i.default.createElement("div",{className:"SelectionPanelGroup"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{whiteSpace:"nowrap"}},"Corner Radius"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(u.default,{converter:p.default,value:e.cornerRadius,dragScale:1,keyState:e.keyCornerRadius,isAnimating:n,onValueChanged:this.changeCornerRadius,onValueCommit:this.commit,disabled:!1,onSetKey:this.keyCornerRadius})))}}]),t}()).prototype,"itemPropertiesUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"itemPropertiesUpdated"),r.prototype),v(r.prototype,"revalidate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"revalidate"),r.prototype),v(r.prototype,"changeCornerRadius",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeCornerRadius"),r.prototype),v(r.prototype,"keyCornerRadius",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyCornerRadius"),r.prototype),v(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),r);function g(e){var t=[];if(e){var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node;s.constructor===c.default?t.push(s):s.constructor===d.default&&(t=t.concat(s.childrenOfType(c.default)))}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}return t}t.default=m,m.validate=function(e,t){return g(t).length>0},m.Validation={keyCornerRadius:{validate:function(e){return e.frameCornerRadiusKS}},cornerRadius:{validate:function(e){return e.cornerRadius}}},m.canMultiEdit=!1,m.panelOrder=1,m.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=p(n(1)),a=p(n(2)),s=p(n(5)),l=p(n(209)),u=p(n(216)),c=p(n(383)),d=p(n(197)),f=p(n(175)),h=p(n(19));function p(e){return e&&e.__esModule?e:{default:e}}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var v=(y((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"itemPropertiesUpdated",value:function(){var e=this.context.nima;e.editingAnimation&&e.editingAnimation.isPlaying||(0,h.default)(this.revalidate)}},{key:"revalidate",value:function(){this.forceUpdate()}},{key:"setPolygons",value:function(e){if(!(0,f.default)(this.polygons,e)){if(this.polygons){var t=!0,n=!1,r=void 0;try{for(var o,i=this.polygons[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.removeEventListener("shapePropChange",this.itemPropertiesUpdated),a.removeEventListener("keyState",this.itemPropertiesUpdated)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}if(this.polygons=e,this.polygons){var s=!0,l=!1,u=void 0;try{for(var c,d=this.polygons[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;h.addEventListener("shapePropChange",this.itemPropertiesUpdated),h.addEventListener("keyState",this.itemPropertiesUpdated)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setPolygons(m(e.stageItems))}},{key:"componentWillMount",value:function(){this.setPolygons(m(this.props.stageItems))}},{key:"componentWillUnmount",value:function(){this.setPolygons(null)}},{key:"changeSides",value:function(e,t){if(this.polygons){var n=!0,r=!1,o=void 0;try{for(var i,a=this.polygons[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.sides=e}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.polygons);return i.default.createElement("div",{className:"SelectionPanelGroup"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Sides"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(u.default,{value:e.sides,dragScale:1,isAnimating:!1,onValueChanged:this.changeSides,onValueCommit:this.commit,disabled:!1})))}}]),t}()).prototype,"itemPropertiesUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"itemPropertiesUpdated"),r.prototype),y(r.prototype,"revalidate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"revalidate"),r.prototype),y(r.prototype,"changeSides",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeSides"),r.prototype),y(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),r);function m(e){var t=[];if(e){var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node;s.constructor===c.default?t.push(s):s.constructor===d.default&&(t=t.concat(s.childrenOfType(c.default)))}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}return t}t.default=v,v.validate=function(e,t){return!e.isAnimating&&m(t).length>0},v.Validation={sides:{validate:function(e){return e.sides}}},v.canMultiEdit=!1,v.panelOrder=1,v.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=y(n(1)),a=y(n(2)),s=y(n(5)),l=y(n(209)),u=y(n(216)),c=y(n(336)),d=y(n(197)),f=y(n(175)),h=y(n(439)),p=y(n(19));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var m=(v((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"itemPropertiesUpdated",value:function(){var e=this.context.nima;e.editingAnimation&&e.editingAnimation.isPlaying||(0,p.default)(this.revalidate)}},{key:"revalidate",value:function(){this.forceUpdate()}},{key:"setStars",value:function(e){if(!(0,f.default)(this.stars,e)){if(this.stars){var t=!0,n=!1,r=void 0;try{for(var o,i=this.stars[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.removeEventListener("shapePropChange",this.itemPropertiesUpdated),a.removeEventListener("keyState",this.itemPropertiesUpdated)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}if(this.stars=e,this.stars){var s=!0,l=!1,u=void 0;try{for(var c,d=this.stars[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;h.addEventListener("shapePropChange",this.itemPropertiesUpdated),h.addEventListener("keyState",this.itemPropertiesUpdated)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}}}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setStars(g(e.stageItems))}},{key:"componentWillMount",value:function(){this.setStars(g(this.props.stageItems))}},{key:"componentWillUnmount",value:function(){this.setStars(null)}},{key:"changePoints",value:function(e,t){if(this.stars){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stars[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.points=e}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}}},{key:"changeInnerRadius",value:function(e,t){if(this.stars){var n=!0,r=!1,o=void 0;try{for(var i,a=this.stars[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.innerRadius=e}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry()}}},{key:"keyInnerRadius",value:function(e){var t=this.stars;if(t){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;this.context.nima.editingAnimation.toggleKey(s,"frameInnerRadius")}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.captureJournalEntry(),this.forceUpdate()}}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.stars),n=this.props.isAnimating;return i.default.createElement("div",{className:"SelectionPanelGroup"},i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{whiteSpace:"nowrap"}},"Inner Radius"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(u.default,{value:e.innerRadius,converter:h.default,keyState:e.keyInnerRadius,isAnimating:n,onValueChanged:this.changeInnerRadius,onValueCommit:this.commit,disabled:!1,onSetKey:this.keyInnerRadius})),n?null:i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Star Points"),i.default.createElement("div",{className:"Spacer"}),i.default.createElement(u.default,{value:e.points,dragScale:1,isAnimating:n,onValueChanged:this.changePoints,onValueCommit:this.commit,disabled:!1})))}}]),t}()).prototype,"itemPropertiesUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"itemPropertiesUpdated"),r.prototype),v(r.prototype,"revalidate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"revalidate"),r.prototype),v(r.prototype,"changePoints",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changePoints"),r.prototype),v(r.prototype,"changeInnerRadius",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeInnerRadius"),r.prototype),v(r.prototype,"keyInnerRadius",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyInnerRadius"),r.prototype),v(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),r);function g(e){var t=[];if(e){var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.node;s.constructor===c.default?t.push(s):s.constructor===d.default&&(t=t.concat(s.childrenOfType(c.default)))}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}return t}t.default=m,m.validate=function(e,t){return g(t).length>0},m.Validation={keyInnerRadius:{validate:function(e){return e.frameInnerRadiusKS}},innerRadius:{validate:function(e){return e.innerRadius}},points:{validate:function(e){return e.points}}},m.canMultiEdit=!1,m.panelOrder=1,m.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=h(n(1)),a=h(n(2)),s=h(n(5)),l=h(n(209)),u=h(n(231)),c=h(n(540)),d=h(n(287)),f=h(n(175));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var y=(p((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={validation:{targetFor:!1}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"deleteTarget",value:function(e){e.target=null,this.context.nima.captureJournalEntry()}},{key:"onDependenciesUpdated",value:function(){this.setState({validation:l.default.validate(t.Validation,this.items)})}},{key:"setStageItems",value:function(e){(0,f.default)(this.items,e)||(this.node&&this.node.actor.removeEventListener("dependenciesUpdate",this.onDependenciesUpdated),this.items=e,e&&e.length?this.node=e[0].node:this.node=null,this.node&&this.node.actor.addEventListener("dependenciesUpdate",this.onDependenciesUpdated),this.setState({validation:l.default.validate(t.Validation,e)}),this.forceUpdate())}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setStageItems(e.stageItems)}},{key:"componentDidMount",value:function(){this.setStageItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.setStageItems(null)}},{key:"render",value:function(){var e=this,t=this.state.validation.targetFor,n=t?t.map(function(t){return i.default.createElement(c.default,{key:t.refId,item:t,isAnimating:!1,onDelete:e.deleteTarget})}):[];return i.default.createElement(u.default,{label:"Target For",className:"EventsContent"},n.length>0?n:i.default.createElement("div",{className:"SelectionPanelEmptyMsg"},"No constraints"))}}]),t}()).prototype,"deleteTarget",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"deleteTarget"),r.prototype),p(r.prototype,"onDependenciesUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onDependenciesUpdated"),r.prototype),r);t.default=y,y.canMultiEdit=!1,y.panelOrder=-1,y.validate=function(e,t){var n=l.default.validate(y.Validation,t);return!!n.targetFor&&n},y.Validation={targetFor:{validate:function(e){var t=e.node;if(!t)return!1;var n=t.root;if(!n)return!1;var r=[],o=n.dependencyGraph.getDependents(t);if(o){var i=!0,a=!1,s=void 0;try{for(var l,u=o[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value.constraints;if(c){var f=!0,h=!1,p=void 0;try{for(var y,v=c[Symbol.iterator]();!(f=(y=v.next()).done);f=!0){var m=y.value;m instanceof d.default&&m.target===t&&r.push(m)}}catch(e){h=!0,p=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw p}}}}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}return!!r.length&&r}}},y.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=P(n(1)),a=P(n(2)),s=P(n(5)),l=P(n(209)),u=P(n(195)),c=P(n(268)),d=P(n(230)),f=P(n(252)),h=P(n(179)),p=P(n(176)),y=P(n(267)),v=n(7),m=P(n(175)),g=P(n(438)),b=P(n(1218)),k=P(n(220)),S=P(n(379)),O=P(n(380)),w=P(n(352)),_=P(n(19));P(n(3));function P(e){return e&&e.__esModule?e:{default:e}}function C(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var E=[O.default,S.default,w.default],T=(C((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"itemPropertiesUpdated",value:function(){this.context.nima.editingAnimation&&this.context.nima.editingAnimation.isPlaying||(0,_.default)(this.revalidate)}},{key:"revalidate",value:function(){this.forceUpdate(),this.curveInput&&this.curveInput.update()}},{key:"setKeyFrames",value:function(e){if(!(0,m.default)(this.keyFrames,e)){if(this.keyFrames){var t=!0,n=!1,r=void 0;try{for(var o,i=this.keyFrames[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.removeEventListener("propChange",this.itemPropertiesUpdated)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}if(this.keyFrames=e,e){var a=!0,s=!1,l=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.addEventListener("propChange",this.itemPropertiesUpdated)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}this.forceUpdate()}}},{key:"changeInterpolation",value:function(e){var t=E[e];if(this.keyFrames){var n=!0,r=!1,o=void 0;try{for(var i,a=this.keyFrames[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.interpolator=t.instance||new t}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.editingAnimation.dispatch("update"),this.context.nima.captureJournalEntry()}}},{key:"setCurveInput",value:function(e){this.curveInput=e}},{key:"scroll",value:function(){this.curveInput&&this.curveInput.renderCanvas()}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.keyFrames),n=null!==e.interpolationIndex;return i.default.createElement("div",{onScroll:this.scroll,className:g.default.InterpolationPanel},i.default.createElement("div",{className:g.default.InterpolationContent},i.default.createElement("div",{className:g.default.InterpolationPanelTitle},"Key Interpolation"),i.default.createElement("div",{className:n?"SelectionPanelProperty":"SelectionPanelProperty "+g.default.InterpolationNoSelection},i.default.createElement("div",{className:"SelectionPanelPropertyTitle"},"Type"),i.default.createElement("div",{className:"SelectionPanelProperties"},i.default.createElement(k.default,{options:E,selectedIndex:e.interpolationIndex,onSelectionChanged:this.changeInterpolation}))),i.default.createElement(b.default,{keyFrames:this.keyFrames,ref:this.setCurveInput})))}}]),t}()).prototype,"itemPropertiesUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"itemPropertiesUpdated"),r.prototype),C(r.prototype,"revalidate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"revalidate"),r.prototype),C(r.prototype,"changeInterpolation",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeInterpolation"),r.prototype),C(r.prototype,"setCurveInput",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setCurveInput"),r.prototype),C(r.prototype,"scroll",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"scroll"),r.prototype),r);t.default=T,T.Validation={interpolationIndex:{validate:function(e){return E.indexOf(e.interpolator.constructor)}},length:{validate:function(e){return e.node&&e.node.length},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(e)===Math.round(t)}},lengthKeyState:{validate:function(e){return e.node&&e.node.frameLengthKS}},hasTranslation:{validate:function(e){switch(e.constructor){case p.default:case y.default:return!1;case h.default:return!e.node.isConnectedToBones}return!0}},translationX:{validate:function(e){switch(e.constructor){case f.default:case d.default:case c.default:case h.default:case p.default:return e.node.translation[0];case u.default:if(e.parentJoint){var t=e.renderTransform;return v.mat2d.getTranslation(v.vec2.create(),t)[0]}return e.node.translation[0]}return null},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},translationY:{validate:function(e){switch(e.constructor){case f.default:case d.default:case c.default:case h.default:case p.default:return e.node.translation[1];case u.default:if(e.parentJoint){var t=e.renderTransform;return v.mat2d.getTranslation(v.vec2.create(),t)[1]}return e.node.translation[1]}return null},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},animatesTranslation:{validate:function(e){switch(e.constructor){case h.default:return!e.node.isConnectedToBones;case p.default:return!1;case u.default:return!e.parentJoint;default:return!0}}},translationKeyStateX:{validate:function(e){return e&&e.node&&e.node.framePosXKS}},translationKeyStateY:{validate:function(e){return e&&e.node&&e.node.framePosYKS}},hasRotation:{validate:function(e){switch(e.constructor){case u.default:return!e.parentJoint;case h.default:return!e.node.isConnectedToBones;case p.default:case c.default:case f.default:case d.default:return!0}return!1}},rotation:{validate:function(e){switch(e.constructor){case f.default:case d.default:case c.default:case h.default:case p.default:return e.node.rotation;case u.default:if(!e.parentJoint)return e.node.rotation;break;default:return 0}},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},rotationKeyState:{validate:function(e){return e&&e.node?e.node.frameRotationKS:null}},hasScale:{validate:function(e){switch(e.constructor){case u.default:return!e.parentJoint;case h.default:return!e.node.isConnectedToBones;case p.default:case c.default:case f.default:case d.default:return!0}return!1}},scaleX:{validate:function(e){switch(e.constructor){case u.default:case c.default:case h.default:case p.default:case f.default:case d.default:return e.node.scale[0];default:return!1}},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},scaleKeyStateX:{validate:function(e){return e&&e.node?e.node.frameScaleXKS:null}},scaleY:{validate:function(e){switch(e.constructor){case u.default:case c.default:case h.default:case p.default:case f.default:case d.default:return e.node.scale[1];default:return!1}},equals:function(e,t){return l.default.isValue(e)&&l.default.isValue(t)&&e.constructor===Number&&t.constructor===Number&&Math.round(100*e)===Math.round(100*t)}},scaleKeyStateY:{validate:function(e){return e&&e.node?e.node.frameScaleYKS:null}}},T.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=f(n(1)),a=(f(n(5)),f(n(2))),s=f(n(438)),l=n(7),u=f(n(379)),c=f(n(380)),d=f(n(352));function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var p=(h((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.interpolator=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setCanvas",value:function(e){this.canvas=e,this.ctx=e?e.getContext("2d"):null,this.renderCanvas()}},{key:"setRoot",value:function(e){this.root=e,this.renderCanvas()}},{key:"componentDidUpdate",value:function(){this.renderCanvas()}},{key:"componentDidMount",value:function(){window.addEventListener("mousemove",this.mouseMove,!0),window.addEventListener("mousedown",this.mouseDown,!0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.dragControlPoint,!0),window.removeEventListener("mouseup",this.stopDragControlPoint,!0),window.removeEventListener("mousemove",this.mouseMove,!0),window.removeEventListener("mousedown",this.mouseDown,!0)}},{key:"update",value:function(e){e||(e=this.props.keyFrames),1===new Set(e.map(function(e){return e.interpolator.constructor})).size?this.interpolator=e[0].interpolator:this.interpolator=null,window.removeEventListener("mousemove",this.dragControlPoint,!0),window.removeEventListener("mouseup",this.stopDragControlPoint,!0),this.renderCanvas()}},{key:"componentWillReceiveProps",value:function(e){e.keyFrames!=this.props.keyFrames&&this.update(e.keyFrames)}},{key:"mouseDown",value:function(e){var t=this.canvas,n=this.interpolator,r=this.root;if(t&&r&&n&&(this.down=[e.clientX,e.clientY],n.constructor===d.default)){if(!this._HoverControlPoint){var o=r.getBoundingClientRect(),i=t.width-40,a=o.height,s=.1*a,u=[n.x1*i,(1-n.y1)*(a-2*s)+s],c=[n.x2*i,(1-n.y2)*(a-2*s)+s],f=l.vec2.fromValues(e.clientX-o.left,e.clientY-o.top);f[0]>0&&f[1]>0&&f[1]<o.height&&((n.y1>=1.1||n.y1<=-.1)&&(n.y2>=1.1||n.y2<=-.1)?this._HoverControlPoint=l.vec2.distance(f,u)<l.vec2.distance(f,c)?1:2:n.y1>=1.1||n.y1<=-.1?this._HoverControlPoint=1:n.y2>=1.1||n.y2<=-.1?this._HoverControlPoint=2:this._HoverControlPoint=l.vec2.distance(f,u)<l.vec2.distance(f,c)?1:2)}this._HoverControlPoint&&(window.addEventListener("mousemove",this.dragControlPoint,!0),window.addEventListener("mouseup",this.stopDragControlPoint,!0),window.removeEventListener("mousemove",this.mouseMove,!0),window.removeEventListener("mousedown",this.mouseDown,!0),e.preventDefault(),e.stopPropagation())}}},{key:"stopDragControlPoint",value:function(e){window.removeEventListener("mousemove",this.dragControlPoint,!0),window.removeEventListener("mouseup",this.stopDragControlPoint,!0),window.addEventListener("mousemove",this.mouseMove,!0),window.addEventListener("mousedown",this.mouseDown,!0);var t=!0,n=!1,r=void 0;try{for(var o,i=this.props.keyFrames[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.commitInterpolatorPropertyChange()}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this._HoverControlPoint=0,this.renderCanvas()}},{key:"dragControlPoint",value:function(e){e.preventDefault();var t=this.canvas,n=this.interpolator,r=this.root,o=this._HoverControlPoint;if(t&&n&&r&&n.constructor===d.default){var i=r.getBoundingClientRect(),a=t.width-40,s=i.height,u=.1*s,c=l.vec2.fromValues(e.clientX-i.left,e.clientY-i.top),f=Math.min(1,Math.max(0,c[0]/a)),h=1-(c[1]-u)/(s-2*u);if(e.shiftKey)switch(o){case 1:Math.abs(f)>Math.abs(h)?h=0:f=0;break;case 2:Math.abs(1-f)>Math.abs(1-h)?h=1:f=1}var p=!0,y=!1,v=void 0;try{for(var m,g=this.props.keyFrames[Symbol.iterator]();!(p=(m=g.next()).done);p=!0){var b=m.value,k=b.interpolator;if(k.constructor===d.default)switch(b.startInterpolatorPropertyChange(),o){case 1:k.setIn(f,h);break;case 2:k.setOut(f,h)}}}catch(e){y=!0,v=e}finally{try{!p&&g.return&&g.return()}finally{if(y)throw v}}this.renderCanvas()}}},{key:"mouseMove",value:function(e){var t=this.canvas,n=this.interpolator,r=this.root;if(t&&n&&r&&n.constructor===d.default){var o=r.getBoundingClientRect(),i=t.width-40,a=o.height,s=.1*a,u=[n.x1*i,(1-n.y1)*(a-2*s)+s],c=[n.x2*i,(1-n.y2)*(a-2*s)+s],f=l.vec2.fromValues(e.clientX-o.left,e.clientY-o.top);this._HoverControlPoint=0,l.vec2.distance(f,u)<5?(this._HoverControlPoint=1,e.preventDefault(),e.stopPropagation()):l.vec2.distance(f,c)<5&&(this._HoverControlPoint=2,e.preventDefault(),e.stopPropagation()),this.renderCanvas()}}},{key:"renderCanvas",value:function(){var e=this.canvas,t=this.ctx,n=this.interpolator,r=this.root;if(e&&r){var o=r.getBoundingClientRect(),i=e.getBoundingClientRect();e.width=o.width+40,e.height=i.height,t.clearRect(0,0,e.width,e.height);var a=o.top-i.top;if(n){t.save(),t.translate(20,a),t.strokeStyle="rgba(87,165,224,1.0)",t.fillStyle="rgba(87,165,224,1.0)";var s=.1*o.height,l=e.width-40,d=o.height;switch(n.constructor){case u.default:t.beginPath(),t.moveTo(0,d-s),t.lineTo(l,s),t.stroke();break;case c.default:t.beginPath(),t.moveTo(0,d-s),t.lineTo(l,d-s),t.lineTo(l,s),t.stroke();break;default:var f=[n.x1*l,(1-n.y1)*(d-2*s)+s],h=[n.x2*l,(1-n.y2)*(d-2*s)+s];t.globalAlpha=.5,t.beginPath(),t.moveTo(0,d-s),t.bezierCurveTo(f[0],f[1],h[0],h[1],l,s),t.stroke(),t.globalAlpha=1,t.fillStyle=1===this._HoverControlPoint?"white":"rgba(87,165,224,1.0)",t.beginPath(),t.moveTo(0,d-s),t.lineTo(f[0],f[1]),t.stroke(),t.beginPath(),t.arc(f[0],f[1],3.5,0,2*Math.PI,!1),t.fill(),t.fillStyle=2===this._HoverControlPoint?"white":"rgba(87,165,224,1.0)",t.beginPath(),t.moveTo(l,s),t.lineTo(h[0],h[1]),t.stroke(),t.beginPath(),t.arc(h[0],h[1],3.5,0,2*Math.PI,!1),t.fill()}t.restore()}}}},{key:"render",value:function(){var e=void 0;return e=!this.props.keyFrames||!(this.props.keyFrames.length>0),i.default.createElement("div",{ref:this.setRoot,className:s.default.InterpolationGraph},i.default.createElement("div",{className:s.default.InterpolationGraphLineTop}),i.default.createElement("div",{className:s.default.InterpolationGraphLineBot}),i.default.createElement("canvas",{ref:this.setCanvas}),e?i.default.createElement("div",{className:s.default.InterpolationGraphNoSelection},"No Key Selected"):null)}}]),t}()).prototype,"setCanvas",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setCanvas"),r.prototype),h(r.prototype,"setRoot",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setRoot"),r.prototype),h(r.prototype,"mouseDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),h(r.prototype,"stopDragControlPoint",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"stopDragControlPoint"),r.prototype),h(r.prototype,"dragControlPoint",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"dragControlPoint"),r.prototype),h(r.prototype,"mouseMove",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseMove"),r.prototype),r);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(647)),a=d(n(176)),s=n(7),l=d(n(208)),u=d(n(348)),c=d(n(2));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var h=(f((r=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Nima=t,this._ActorImage=n,this._SelectionPanel=r,this._IsMeshVisible=!0,this._WeightWorkers=[],this._AllowUndo=!1,this._LastWeightData=null,this._Journal=[],this._JournalIndex=-1,this._LastEntry=-1,this._Stage=n.stageItem.stage,this._IsCalculatingWeights=!1,this._Verts=null,this._PaintWeightData=null;for(var o=0;o<3;o++)this._WeightWorkers.push(new p);this._ShowDeformed=!0}return o(e,[{key:"weightsUpdated",value:function(){var e=this._ActorImage;if(e.weightData=this._PaintWeightData,e.updateWeightData(),this._PaintWeightData=new Float32Array(e.weightData),this._ShowDeformed){for(var t=this._ActorImage.meshData,n=new Float32Array(t.verts),r=this._ActorImage.computeWorldVertices(),o=r.length/2,a=0,s=0,l=0;l<o;l++)n[a]=r[s++],n[a+1]=r[s++],a+=4;i.default.call("sbv",[n,null],function(){}),this._Verts=n}}},{key:"onToolChanged",value:function(e){this._LastTool=e.to}},{key:"activate",value:function(){this._Stage.addEventListener("toolChanged",this.onToolChanged);for(var e=this._ShowDeformed,t=this._ActorImage.connectedBones,n=0;n<t.length;n++){var r=t[n];r.node.stageItem&&(r.node.stageItem.fillColor=a.default.Colors[n%a.default.Colors.length],r.node.stageItem.parent=this._ActorImage.stageItem,r.node.stageItem.overrideTransform=e?null:r.bind,r.node.stageItem.overrideLength=e?null:r.length)}var o=this._ActorImage.meshData;if(this._AllowUndo=!1,-1===this._LastEntry)this.captureJournalEntry();else{var s=this;i.default.call("eq",[this._LastWeightData,this._ActorImage.weightData],function(e){s._AllowUndo=!0,e||(s._Journal.length=0,s._JournalIndex=-1,s._LastEntry=-1,s.captureJournalEntry())})}var l=this._ActorImage;this._PaintWeightData=new Float32Array(this._ActorImage.weightData),l.stageItem.updatePaintWeightData(this._PaintWeightData);var c=new Float32Array(o.verts);if(e)for(var d=l.computeWorldVertices(),f=d.length/2,h=0,p=0,y=0;y<f;y++)c[h]=d[p++],c[h+1]=d[p++],h+=4;l.stageItem.drawDeformed=e,i.default.call("sbv",[c,e?null:l.worldTransform],function(){}),this._Verts=c,this._Nima.setCancelCallback(this.closeWeightEditor),this._LastTool?this._Stage.toolType=this._LastTool:this._Stage.toolType=u.default}},{key:"deactivate",value:function(){this._Stage.removeEventListener("toolChanged",this.onToolChanged);for(var e=this._ActorImage.connectedBones,t=0;t<e.length;t++){var n=e[t];n.node.stageItem&&(n.node.stageItem.fillColor=null,n.node.stageItem.parent=null,n.node.stageItem.overrideTransform=null,n.node.stageItem.overrideLength=null)}this._PaintWeightData=null}},{key:"calculateAutoWeights",value:function(){var e=this;if(!this._IsCalculatingWeights){var t=this._ActorImage.connectedBones;1==t.length||function(){e._IsCalculatingWeights=!0;var n=e._ActorImage.width,r=e._ActorImage.height,o=n/2,i=r/2,a=new Array(t.length),l=t.length,u=y.make(n*r),c=e._ActorImage.bitmap;if(c)for(var d=n*r,f=0;f<d;f++){c.bytes[f*c.channels+3];y.set(u,f)}for(var h=e._ActorImage.worldTransform,p=s.mat2d.invert(s.mat2d.create(),h),v=function(c){var d=t[c],f=d.bind,h=s.vec2.create(),y=s.vec2.set(s.vec2.create(),d.node.length,0);s.vec2.transformMat2d(h,h,f),s.vec2.transformMat2d(y,y,f),s.vec2.transformMat2d(h,h,p),s.vec2.transformMat2d(y,y,p),h[0]+=o,h[1]+=i,y[0]+=o,y[1]+=i;var v,m=e._WeightWorkers[c%e._WeightWorkers.length],g=e;m.makeHeatMap(n,r,u,h,y,(v=c,function(e){if(a[v]=e,0==--l){for(var s=g._ActorImage.meshData.verts,u=s.length/4,c=0,d=0,f=new Float32Array(8*u),h=0;h<u;h++){for(var p=Math.max(0,Math.min(n-1,Math.round(s[c]+o))),y=Math.max(0,Math.min(r-1,Math.round(s[c+1]+i)))*n+p,m=Number.MAX_VALUE,b=0;b<t.length;b++){var k=a[b][y];k<m&&(m=k,f[d+0]=b+1)}f[d+4]=1,c+=4,d+=8}g.smoothWeights(f,10),g._ActorImage.weightData=f,g._PaintWeightData=new Float32Array(f),g._IsCalculatingWeights=!1,g._ActorImage.updateWeightData(),g._Stage.redraw(),g.captureJournalEntry()}}))},m=0;m<t.length;m++)v(m)}()}}},{key:"smoothWeights",value:function(e,t){for(var n=this._ActorImage.meshData.verts.length/4,r=this._ActorImage.meshData.tris,o=r.length/3,i={},a=0,s=0;s<o;s++){var l=r[a++],u=r[a++],c=r[a++],d=i[l];d||(i[l]=d={c:[]}),-1===d.c.indexOf(u)&&d.c.push(u),-1===d.c.indexOf(c)&&d.c.push(c),(d=i[u])||(i[u]=d={c:[]}),-1===d.c.indexOf(l)&&d.c.push(l),-1===d.c.indexOf(c)&&d.c.push(c),(d=i[c])||(i[c]=d={c:[]}),-1===d.c.indexOf(l)&&d.c.push(l),-1===d.c.indexOf(u)&&d.c.push(u)}t||(t=1);for(var f=0;f<t;f++)for(var h in i)for(var p=i[h],y=0;y<p.c.length;y++){var v=p.c[y],m=this.heaviestVertexWeight(e,v);0!=m.w&&this.addVertexWeight(e,h,m.i,.5*m.w)}for(var g=0;g<n;g++)this.normalizeVertexWeight(e,g)}},{key:"getWeight",value:function(e,t){e+=1;for(var n=this._PaintWeightData,r=8*t,o=0;o<4;o++){if(n[r+o]===e)return n[r+o+4]}return 0}},{key:"setWeight",value:function(e,t,n,r){t=Math.min(1,Math.max(0,t)),e+=1;var o=this._ActorImage,i=this._PaintWeightData,a=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){for(var d=8*u.value,f=!1,h=0;h<4;h++){if(i[d+h]===e){f=!0,i[d+h+4]=t;break}}if(!f){for(var p=Number.MAX_VALUE,y=0,v=0;v<4;v++){var m=i[d+v+4];m<p&&(p=m,y=v)}i[d+y+4]=t,i[d+y]=e}var g=1-t;if(0==g)for(var b=0;b<4;b++){i[d+b]!==e&&(i[d+b+4]=0)}else{for(var k=0,S=0;S<4;S++){var O=i[d+S];O!==e?k+=i[d+S+4]:0===O&&(i[d+S+4]=0)}if(k==g){console.log("PERFECT",k,g);continue}if(0===k){for(var w=0;w<4;w++){if(i[d+w]!==e){i[d+w]=1!==e?1:e!==o.connectedBones.length?o.connectedBones.length:0,i[d+w+4]=g;break}}continue}for(var _=g/k,P=0;P<4;P++){i[d+P]!==e&&(i[d+P+4]*=_),i[d+P+4]}}}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}r||(o.stageItem.updatePaintWeightData(this._PaintWeightData),this.weightsUpdated())}},{key:"commitSetWeight",value:function(){this._ActorImage.stageItem.updatePaintWeightData(this._PaintWeightData),this.weightsUpdated()}},{key:"paintInfluence",value:function(e,t,n,r){var o=this._ActorImage;if(!(o.connectedBones.length<=1)){e>1?e=0:e<0&&(e=0);var i=!1;r++;var a=this._PaintWeightData;a||(this._PaintWeightData=a=new Float32Array(o.weightData));for(var s=this._LastWeightData,l=0;l<t.length;l++){for(var u=8*t[l],c=n[l]*e,d=!1,f=0,h=!1,p=0;p<4;p++){if(a[u+p]===r){h=!0;var y=a[u+p+4];f=y+c;var v=e;s[u+p]===r&&(v=Math.min(1,s[u+p+4]+e)),f>v&&(f=v),y!==f&&(d=!0,a[u+p+4]=f);break}}if(!h){for(var m=Number.MAX_VALUE,g=0,b=0;b<4;b++){var k=a[u+b+4];k<m&&(m=k,g=b)}d=!0,a[u+g+4]=c,f=c,a[u+g]=r}if(d){i=!0;var S=1-f,O=0;if(0==S)for(var w=0;w<4;w++){a[u+w]!==r&&(a[u+w+4]=0)}else{for(var _=0;_<4;_++){var P=a[u+_];P!==r?O+=a[u+_+4]:0===P&&(a[u+_+4]=0)}if(O==S)continue;for(var C=S/O,E=0;E<4;E++){a[u+E]!==r&&(a[u+E+4]*=C)}}}}i&&o.stageItem.updatePaintWeightData(this._PaintWeightData)}}},{key:"subtractInfluence",value:function(e,t,n,r){var o=this._ActorImage;if(!(o.connectedBones.length<=1)){e>1?e=0:e<0&&(e=0);var i=!1;r++;var a=this._PaintWeightData;a||(this._PaintWeightData=a=new Float32Array(o.weightData));for(var s=this._LastWeightData,l=0;l<t.length;l++){for(var u=8*t[l],c=n[l]*e,d=!1,f=0,h=0;h<4;h++){if(a[u+h]===r){!0;var p=a[u+h+4];f=p-c;var y=0;s[u+h]===r&&(y=Math.min(1,Math.max(0,s[u+h+4]-e))),f<y&&(f=y),p!==f&&(d=!0,a[u+h+4]=f);break}}if(d){i=!0;var v=1-f,m=0;if(0==v)for(var g=0;g<4;g++){a[u+g]!==r&&(a[u+g+4]=0)}else{for(var b=0;b<4;b++){var k=a[u+b];k!==r?m+=a[u+b+4]:0===k&&(a[u+b+4]=0)}if(0===m){for(var S=this._ActorImage.meshData.verts,O=S.length/4,w=0,_=4*t[l],P=S[_],C=S[_+1],E=-1,T=Number.MAX_VALUE,I=0;I<O;I++){var j=8*I;if(0!==a[j+4]&&a[j]!==r||0!==a[j+5]&&a[j+1]!==r||0!==a[j+6]&&a[j+2]!==r||0!==a[j+7]&&a[j+3]!==r){var A=S[w]-P,D=S[w+1]-C,R=A*A+D*D;R<T&&(E=I,T=R),w+=4}else w+=4}var M=1;if(-1!==E)for(var x=8*E,F=0,L=0;L<4;L++){var N=a[x+L+4],z=a[x+L];z!==r&&(N>F&&(F=N,M=z))}for(var V=0;V<4;V++){if(a[u+V]!==r){a[u+V]=M,a[u+V+4]=v;break}}}else{if(m==v)continue;for(var B=v/m,H=0;H<4;H++){a[u+H]!==r&&(a[u+H+4]*=B)}}}}}i&&o.stageItem.updatePaintWeightData(this._PaintWeightData)}}},{key:"addVertexWeight",value:function(e,t,n,r){for(var o=8*t,i=0;i<4;i++){if(e[o+i]===n)return e[o+i+4]+=.1*r,!0}for(var a=0;a<4;a++){if(e[o+a]<=r)return e[o+a+4]=r,e[o+a]=n,!0}return!1}},{key:"heaviestVertexWeight",value:function(e,t){for(var n=8*t,r=0,o=0,i=0;i<4;i++){var a=e[n+i+4];a>r&&(r=a,o=e[n+i])}return{w:r,i:o}}},{key:"normalizeVertexWeight",value:function(e,t){for(var n=8*t,r=0,o=0;o<4;o++)0!=e[n+o]?r+=e[n+o+4]:e[n+o+4]=0;if(1==r)return!1;var i=1/r;return e[n+4]*=i,e[n+5]*=i,e[n+6]*=i,e[n+7]*=i,!0}},{key:"blurMap",value:function(e,t,n){for(var r=[.003765,.015019,.023792,.015019,.003765,.015019,.059912,.094907,.059912,.015019,.023792,.094907,.150342,.094907,.023792,.015019,.059912,.094907,.059912,.015019,.003765,.015019,.023792,.015019,.003765],o=[],i=0;i<r.length;i++){var a=i%5,s=Math.floor(i/5);o.push([a+-2,s+-2,r[i]])}for(var l=void 0,u=n,c=e*t,d=0;d<20;d++){for(var f=new Float32Array(c),h=0;h<e;h++)for(var p=0;p<t;p++){for(var y=0,v=0;v<o.length;v++){var m=o[v],g=h+m[0],b=p+m[1],k=m[2];g>=0&&g<e&&b>=0&&b<t&&(y+=u[b*e+g]*k)}f[p*e+h]=y}l=f,u=f}return l}},{key:"makeHeatMapImage",value:function(e,t,n,r){var o=document.createElement("canvas");o.width=e,o.height=t;for(var i=o.getContext("2d"),a=i.getImageData(0,0,o.width,o.height),s=a.data,l=e*t,u=0,c=0;c<l;c++){var d=n[c];d>u&&(u=d)}for(var f=0;f<t;f++)for(var h=0;h<e;h++){var p=4*((t-f-1)*e+h),y=n[f*e+h],v=Math.round(y/u*255);s[p]=v,s[p+1]=v,s[p+2]=v,s[p+3]=255}i.putImageData(a,0,0);var m=o.toDataURL();return document.createElement("img").src=m,o}},{key:"clearHistory",value:function(){}},{key:"captureJournalEntry",value:function(e){-1!==this._LastEntry&&this._LastEntry===this._ActorImage.weightDataUndoDelta||(e||(this._JournalIndex!=this._Journal.length-1&&this._Journal.splice(this._JournalIndex+1,this._Journal.length-(this._JournalIndex+1)),this._Journal.push(this._LastWeightData=new Float32Array(this._ActorImage.weightData)),this._JournalIndex=this._Journal.length-1),this._LastEntry=this._ActorImage.weightDataUndoDelta)}},{key:"undo",value:function(){if(!(this._JournalIndex<1)){var e=this._Journal[this._JournalIndex-1];if(e){var t=this._ActorImage;t.weightData=new Float32Array(e),this._PaintWeightData=new Float32Array(e),t.stageItem.updatePaintWeightData(this._PaintWeightData),this._LastWeightData=new Float32Array(e),this._Stage.redraw(),this.weightsUpdated()}this._JournalIndex--,this.captureJournalEntry(!0)}}},{key:"redo",value:function(){if(!(this._JournalIndex+1>this._Journal.length-1)){this._JournalIndex++;var e=this._Journal[this._JournalIndex];if(e){var t=this._ActorImage;t.weightData=new Float32Array(e),this._PaintWeightData=new Float32Array(e),t.stageItem.updatePaintWeightData(this._PaintWeightData),this._LastWeightData=new Float32Array(e),this._Stage.redraw(),this.weightsUpdated()}this.captureJournalEntry(!0)}}},{key:"closeWeightEditor",value:function(){this._Stage.tool&&this._Stage.tool.cancel()?this._Nima.setCancelCallback(this.closeWeightEditor):this._SelectionPanel.editWeightsOff()}},{key:"paintWeightData",get:function(){return this._PaintWeightData}},{key:"verts",get:function(){return this._Verts}},{key:"showDeformed",set:function(e){this._ShowDeformed!==e&&(this._ShowDeformed=e);for(var t=this._ActorImage,n=t.connectedBones,r=0;r<n.length;r++){var o=n[r];o.node.stageItem&&(o.node.stageItem.overrideTransform=e?null:o.bind,o.node.stageItem.overrideLength=e?null:o.length)}var a=t.meshData,s=new Float32Array(a.verts);if(e)for(var l=t.computeWorldVertices(),u=l.length/2,c=0,d=0,f=0;f<u;f++)s[c]=l[d++],s[c+1]=l[d++],c+=4;t.stageItem.drawDeformed=e,i.default.call("sbv",[s,e?null:t.worldTransform],function(){}),this._Verts=s},get:function(){return this._ShowDeformed}},{key:"node",get:function(){return this._ActorImage}},{key:"stageItem",get:function(){return this._ActorImage.stageItem}}]),e}()).prototype,"onToolChanged",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"onToolChanged"),r.prototype),f(r.prototype,"closeWeightEditor",[c.default],Object.getOwnPropertyDescriptor(r.prototype,"closeWeightEditor"),r.prototype),r);function p(){var e=new Worker(l.default.getWorkerScript("AutoWeightWorker.js")),t=0,n={};e.onmessage=function(e){var t=n[e.data.id];t&&(t(e.data.response),delete n[e.data.id])},this.makeHeatMap=function(r,o,i,a,s,l){!function(r,o,i){n[++t]=i,o.push(t),e.postMessage({call:r,arguments:o})}("makeHeatMap",[r,o,i,a,s],l)}}t.default=h;var y={make:function(e){return new Uint8Array(Math.ceil(e/8))},set:function(e,t){var n=t%8;e[Math.floor(t/8)]|=1<<n},clear:function(e,t){var n=t%8;e[Math.floor(t/8)]&=~(1<<n)},get:function(e,t){var n=t%8;return 0!=(e[Math.floor(t/8)]&1<<n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=_(n(1)),a=_(n(2)),s=_(n(5)),l=_(n(209)),u=_(n(172)),c=_(n(175)),d=_(n(430)),f=(n(288),_(n(19))),h=_(n(353)),p=_(n(238)),y=_(n(676)),v=_(n(179)),m=_(n(230)),g=_(n(268)),b=_(n(195)),k=_(n(176)),S=n(333),O=_(n(253)),w=_(n(266));_(n(203));function _(e){return e&&e.__esModule?e:{default:e}}function P(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var C=(P((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setItems",value:function(e){if(!(0,c.default)(this.items,e)){if(this.items){var t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node.removeEventListener("colorChanged",this.onPropertyChanged),a.node.removeEventListener("clipContentsChanged",this.onPropertyChanged)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}if(this.items=e,this.items){var s=!0,l=!1,u=void 0;try{for(var d,f=this.items[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var h=d.value;h.node.addEventListener("colorChanged",this.onPropertyChanged),h.node.addEventListener("clipContentsChanged",this.onPropertyChanged)}}catch(e){l=!0,u=e}finally{try{!s&&f.return&&f.return()}finally{if(l)throw u}}}}}},{key:"doForceUpdate",value:function(){this.forceUpdate()}},{key:"onPropertyChanged",value:function(){(0,f.default)(this.doForceUpdate)}},{key:"componentWillReceiveProps",value:function(e){e.stageItems!=this.props.stageItems&&this.setItems(e.stageItems)}},{key:"componentWillMount",value:function(){this.context.nima.actor.artboards.addEventListener("changeMain",this.onPropertyChanged),this.setItems(this.props.stageItems)}},{key:"componentWillUnmount",value:function(){this.context.nima.actor.artboards.removeEventListener("changeMain",this.onPropertyChanged),this.setItems(null)}},{key:"changeColor",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.items[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.node.color=e.value}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}t||this.context.nima.captureJournalEntry(),this.forceUpdate()}},{key:"colorPickerCheckClose",value:function(){return!this.context.nima.stage.mouseDownSelected}},{key:"colorPickerOpened",value:function(){this.context.nima.editor.holdSelectedItem(this.items)}},{key:"colorPickerClosed",value:function(){this.context.nima.editor.clearHoldSelectedItem(this.items),this.context.nima.captureJournalEntry()}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"toggleClipContents",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.items[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.node&&(a.node.clipContents=e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}this.context.nima.captureJournalEntry()}},{key:"toggleIsMain",value:function(e){if(this.items&&0!==this.items.length){var t=this.items[0].node;if(e)t.makeMain();else{var n=t.actor.artboards.children.find(function(e){return e!==t});n&&n.makeMain()}this.context.nima.captureJournalEntry()}}},{key:"downloadPNG",value:function(){var e=this.items,t=this.context;if(!e||1===e.length){var n=t.nima.stage,r=this.items[0].node,o=n.getLayerOptions(S.StageArtboard),i=o.disableDraw,a=n.getLayerOptions(k.default).disableDraw,s=n.getLayerOptions(v.default).disableDraw,l=n.isSelectionDisabled;return n.addRenderCapture({setup:function(){return o.disableDraw=!0,[g.default,b.default,k.default,O.default,w.default].forEach(function(e){n.getLayerOptions(e).disableDraw=!0}),[v.default,m.default].forEach(function(e){n.getLayerOptions(e).disableDraw=!1}),n.isSelectionDisabled=!0,{cb:function(){},renderWidth:r.width,renderHeight:r.height,renderView:n.getZoomFitViewTransform(r.width,r.height,r.stageItem)}},cleanup:function(e){[g.default,b.default,k.default,O.default,w.default].forEach(function(e){n.getLayerOptions(e).disableDraw=a}),[v.default,m.default].forEach(function(e){n.getLayerOptions(e).disableDraw=s}),n.isSelectionDisabled=l,o.disableDraw=i},complete:function(e,n,o,i){var a=document.createElement("canvas");a.width=n,a.height=o;var s=a.getContext("2d"),l=new Uint8ClampedArray(e),u=new ImageData(l,n,o);s.putImageData(u,0,0),a.toBlob(function(e){(0,y.default)(t.nima.file.name+("Artboard"!==r.name?"-"+r.name:""),e)},"image/png")}}),t}}},{key:"fitContents",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.items[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;i.node&&i.node.fitToContent()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.context.nima.captureJournalEntry()}},{key:"render",value:function(){var e=l.default.validate(t.Validation,this.items),n=this.props.isAnimating,r=!1===e.color?null:{value:e.color,type:h.default.Mode.Solid};return i.default.createElement("div",{className:"SelectionPanelGroup",_key:"_ArtboardOpts"},this.items&&1===this.items.length?i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitleSwitch"},"Main Artboard"),i.default.createElement(p.default,{isOn:e.isMain,onToggle:this.toggleIsMain})):null,i.default.createElement("div",{className:"SelectionPanelProperty CenterPropertyTitle"},i.default.createElement("div",{className:"SelectionPanelPropertyTitle",style:{flex:"1"}},"Background"),i.default.createElement("div",{className:"Spacer",style:{flex:"initial",width:"35px"}}),i.default.createElement(d.default,{allowChangeType:!1,marker:"SelectionPanelPickerMarker",value:r,isEmpty:null===r,onValueChanged:this.changeColor,disabled:n,onClosed:this.colorPickerClosed,onOpened:this.colorPickerOpened,checkClose:this.colorPickerCheckClose})),i.default.createElement("div",{className:"SelectionPanelProperty"},i.default.createElement("div",{className:"SelectionPanelPropertyTitleSwitch"},"Clip Contents"),i.default.createElement(p.default,{isOn:e.clipContents,onToggle:this.toggleClipContents})),i.default.createElement(u.default,{addClass:"NoMargin",label:"Fit Contents",onPress:this.fitContents}),this.items&&1===this.items.length?i.default.createElement(u.default,{label:"Download PNG",onPress:this.downloadPNG}):null)}}]),t}()).prototype,"doForceUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"doForceUpdate"),r.prototype),P(r.prototype,"onPropertyChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onPropertyChanged"),r.prototype),P(r.prototype,"changeColor",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeColor"),r.prototype),P(r.prototype,"colorPickerCheckClose",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"colorPickerCheckClose"),r.prototype),P(r.prototype,"colorPickerOpened",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"colorPickerOpened"),r.prototype),P(r.prototype,"colorPickerClosed",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"colorPickerClosed"),r.prototype),P(r.prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),P(r.prototype,"toggleClipContents",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleClipContents"),r.prototype),P(r.prototype,"toggleIsMain",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleIsMain"),r.prototype),P(r.prototype,"downloadPNG",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"downloadPNG"),r.prototype),P(r.prototype,"fitContents",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"fitContents"),r.prototype),r);t.default=C,C.validate=function(e,t){return!e.state.isAnimationOpen},C.Validation={color:{validate:function(e){var t=e.node;return!!t&&t.color},equals:function(e,t){return(0,c.default)(e,t)}},clipContents:{validate:function(e){var t=e.node;return!!t&&t.clipContents}},isMain:{validate:function(e){var t=e.node;return!!t&&t.isMain}}},C.canMultiEdit=!0,C.panelOrder=2,C.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),a=u(n(5)),s=u(n(2)),l=n(7);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var d=(c((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.rootClassName=this.props.isVertical?"LeftGuideRuler":"TopGuideRuler",this.guides=[],this.permanentGuides=[]}},{key:"componentDidMount",value:function(){var e=this.canvas;e&&(this.canvas=e,this.ctx=e.getContext("2d"),this.drawTicks()),this.context.nima.addEventListener("stageRectChanged",this.drawTicks)}},{key:"componentWillUnmount",value:function(){this.context.nima.removeEventListener("stageRectChanged",this.drawTicks)}},{key:"setCanvas",value:function(e){this.canvas=e}},{key:"serialize",value:function(){if(this.permanentGuides&&this.permanentGuides.length){for(var e=[],t=0;t<this.permanentGuides.length;t++){var n=this.permanentGuides[t];void 0!==n.world&&e.push(n.world)}if(e.length)return e}}},{key:"reset",value:function(){this.permanentGuides.length=0,this.context.nima.stage.redraw()}},{key:"deserialize",value:function(e){if(e&&e.length){for(var t=0;t<e.length;t++){var n=e[t];this.permanentGuides.push({world:n})}this.context.nima.stage.redraw()}}},{key:"formatThousands",value:function(e,t){for(var n=e.toFixed(t),r=0|n,o=e<0?1:0,i=(""+Math.abs(n-r).toFixed(t)).substr(2,t),a=""+r,s=a.length,l="";(s-=3)>o;)l=","+a.substr(s,3)+l;return a.substr(0,s+3)+l+(i?"."+i:"")}},{key:"mouseMove",value:function(e){var t=this.context.nima.stage;if(!t.isPanning&&!this.dragGuide){this.hoverGuide||(this.hoverGuide={}),this.hitGuide=null,this.hoverGuide.screenOffset=this.props.isVertical?e.clientY:e.clientX;for(var n=t.screenScale,r=0;r<this.permanentGuides.length;r++){var o=this.permanentGuides[r];if(Math.abs(o.screenOffset-this.hoverGuide.screenOffset*n)<5*n){this.hitGuide=o,this.hoverGuide=null;break}}this.context.nima.stage.redraw()}}},{key:"mouseLeave",value:function(e){this.hoverGuide=null,this.context.nima.stage.redraw()}},{key:"mouseDrag",value:function(e){e.stopPropagation(),e.preventDefault(),this.dragGuide.screenOffset=this.props.isVertical?e.clientY:e.clientX,delete this.dragGuide.world,this.context.nima.stage.redraw()}},{key:"endDrag",value:function(e){window.removeEventListener("mousemove",this.mouseDrag,!0),window.removeEventListener("mouseup",this.endDrag,!0);(this.props.isVertical?this.dragGuide.localOffset>this.canvas.height:this.dragGuide.localOffset<0)&&this.permanentGuides.splice(this.permanentGuides.indexOf(this.dragGuide),1),this.dragGuide=null,this.context.nima.stage.redraw(),this.context.nima.actor.revise()}},{key:"mouseDown",value:function(e){if(this.hitGuide)return this.dragGuide=this.hitGuide,this.hitGuide=null,window.addEventListener("mousemove",this.mouseDrag,!0),void window.addEventListener("mouseup",this.endDrag,!0);this.hoverGuide&&void 0!==this.hoverGuide.world&&(this.permanentGuides.push(this.hoverGuide),this.hoverGuide=null,this.context.nima.actor.revise())}},{key:"drawTicks",value:function(){if(this.canvas){var e=this.canvas,t=this.ctx,n=this.context.nima,r=n.stage,o=this.props.isVertical,i=this.context.nima.getStageRect(),a=r.screenScale;1!=a&&(i={width:i.width*a,height:i.height*a,bottom:i.bottom*a,top:i.top*a,left:i.left*a});var s=20*a,u=30*a;if(i){i.top||(i.top=(i.bottom-i.height)*a);var c=o?u:i.width+2*s-u,d=o?i.height+2*s-u:u,f=i.width+2*s-u;i.height;e.width==c&&e.height==d||(e.width=c,e.height=d);for(var h=i.left-s+u,p=i.bottom+s,y=16*a,v=64*a,m=y*r.scale;m<16*a;)m*=2,y*=2,v*=2;var g=Math.ceil(o?i.height/m:i.width/m)+2,b=l.vec2.clone(r.translation);if(n.actor&&n.actor.artboards&&n.actor.artboards.active){var k=n.actor.artboards.active.originWorld;b[0]+=k[0]*r.scale,b[1]+=k[1]*r.scale}var S=0,O=0;if(o){var w=(b[1]-p)/r.scale;O=w-w%y,S=-w%y*r.scale-m,S-=m,O-=y}else{var _=(h-b[0])/r.scale;O=_-_%y,S=-_%y*r.scale-m,S-=m,O-=y}var P=10*a;t.save(),t.clearRect(0,0,e.width,e.height),t.fillStyle="rgba(255,255,255,0.1)",t.font=10*a+"px Roboto",o?(t.fillRect(0,0,u,1),t.rotate(-Math.PI/2),t.translate(-d,0)):t.fillRect(0,0,1,u);for(var C=[],E=0;E<g;E++){S+=m;var T=Math.round(O);o&&(T=-T);var I=Math.floor(S);T%v==0?(t.fillRect(I,0,1,u),C.push(T,I)):t.fillRect(I,u-P,1,P),O+=y}t.fillStyle="rgba(255,255,255,0.6)";for(var j=C.length,A=0;A<j;A+=2){var D=C[A],R=C[A+1];t.fillText(this.formatThousands(D),Math.floor(R)+5*a,13*a)}if(t.fillStyle="rgba(87,165,224,1.0)",this.guides.length=0,this.hoverGuide){var M=0;if(o){var x=(this.hoverGuide.screenOffset*a-b[1])/r.scale,F=x*r.scale+b[1],L=i.bottom+s-F;this.hoverGuide.world=x,M=L,this.guides.push({x:h,y:F-1,w:f,h:1,o:.5})}else{var N=(this.hoverGuide.screenOffset*a-b[0])/r.scale,z=N*r.scale+b[0]-h;M=z,this.hoverGuide.world=N,this.guides.push({x:z+h,y:i.top,w:1,h:window.innerHeight*a-u,o:.5})}t.fillRect(M,0,1,u)}for(var V=0;V<this.permanentGuides.length;V++){var B=this.permanentGuides[V],H=0;if(o){var W=B.world;void 0===W&&(W=(B.screenOffset*a-b[1])/r.scale,B.world=W);var K=W*r.scale+b[1],G=i.bottom+s-K;B.screenOffset=K,H=B.localOffset=G,this.guides.push({x:h,y:K-1,w:f,h:1,o:1})}else{var U=B.world;void 0===U&&(U=(B.screenOffset*a-b[0])/r.scale,B.world=U);var X=U*r.scale+b[0],Y=X-h;B.screenOffset=X,B.localOffset=Y,H=Y,this.guides.push({x:X,y:i.top,w:1,h:window.innerHeight*a-u,o:1})}t.fillRect(H,0,1,u)}t.restore()}}}},{key:"render",value:function(){return i.default.createElement("div",{style:{display:this.props.isVisible?null:"none"},className:this.rootClassName},i.default.createElement("div",{className:this.rootClassName+"Ticks"},i.default.createElement("canvas",{onMouseDown:this.mouseDown,onMouseMove:this.mouseMove,onMouseLeave:this.mouseLeave,ref:this.setCanvas,className:"GuideRulerTicks"})))}}]),t}()).prototype,"setCanvas",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setCanvas"),r.prototype),c(r.prototype,"mouseMove",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseMove"),r.prototype),c(r.prototype,"mouseLeave",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseLeave"),r.prototype),c(r.prototype,"mouseDrag",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDrag"),r.prototype),c(r.prototype,"endDrag",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"endDrag"),r.prototype),c(r.prototype,"mouseDown",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),c(r.prototype,"drawTicks",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"drawTicks"),r.prototype),r);t.default=d,d.contextTypes={nima:a.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=S(n(1)),a=S(n(2)),s=S(n(1223)),l=S(n(537)),u=S(n(1225)),c=S(n(681)),d=S(n(1226)),f=S(n(1227)),h=S(n(1228)),p=S(n(1229)),y=S(n(1232)),v=S(n(1234)),m=S(n(5)),g=S(n(174)),b=S(n(1235)),k=S(n(3));function S(e){return e&&e.__esModule?e:{default:e}}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var _=(w((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={activeAnimationHover:!1,animationFilter:null,dropdownOpacity:0,duration:10,fps:60,GraphActive:!1,height:260,input:"",isAnimationsOpen:!1,isOpen:!1,isPlaying:!1,keyedNodes:[],LoopActive:!1,scrollOffset:0,SelectionActive:!1,timelineLeft:null,timelineWidth:null,WorkAreaActive:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.scrollOffset=0,this.timelineCanvas=new p.default(this,this.context.nima),this.timelineCanvas.isActive=!1}},{key:"setTimelineHeader",value:function(e){this.timelineHeader=e}},{key:"setAnimationPanel",value:function(e){this.animationPanel=e}},{key:"resize",value:function(){if(this.virtualList&&this.scrollbar.setContentHeight(this.virtualList.sizeAndPositionManager.getTotalSize()),this.timelineHeader){var e=this.timelineHeader.getBoundingClientRect();this.state.timelineWidth==e.width&&this.state.timelineLeft==e.left&&this.timelineCanvas.top==e.bottom||(this.timelineCanvas.width=e.width,this.timelineCanvas.left=e.left,this.timelineCanvas.top=e.bottom,this.setState({timelineWidth:e.width,timelineLeft:e.left}))}}},{key:"updateResize",value:function(){this.state.isOpen&&this.resize(),this.resizeEndTime>Date.now()&&window.requestAnimationFrame(this.updateResize)}},{key:"resizeFor",value:function(e){this.resizeEndTime=Date.now()+1e3*e,window.requestAnimationFrame(this.updateResize)}},{key:"componentDidUpdate",value:function(){this.state.isOpen&&this.resize()}},{key:"componentDidMount",value:function(){this.timelineCanvas.isActive=this.state.isOpen,this.setHeight(this.state.height),window.addEventListener("resize",this.windowResize)}},{key:"componentWillUnmount",value:function(){this.context.nima.stage&&this.context.nima.stage.removeEventListener("selectionChanged",this.stageSelectionChanged),window.removeEventListener("resize",this.windowResize)}},{key:"windowResize",value:function(){this.resize()}},{key:"startResize",value:function(){this.props.onClickResizeGrabber&&this.props.onClickResizeGrabber(),window.addEventListener("mouseup",this.endResize,!0)}},{key:"endResize",value:function(){this.resize(),window.removeEventListener("mouseup",this.endResize,!0)}},{key:"animationNodesUpdated",value:function(e){this.setState({keyedNodes:e})}},{key:"nameChanged",value:function(e){this.forceUpdate()}},{key:"stageSelectionChanged",value:function(e,t){if(this.state.SelectionActive)this.animation&&this.animation.updateEditableKeyedNodes(),this.forceUpdate();else if(this.animation){var n=this.animation.editableKeyedNodes;if(!t||t.constructor!==s.default)for(var r=n.length+1,o=0,i=0;i<r;i++){if(i>0){var a=n[i-1].node;if(a.stageItem&&a.stageItem.isSelected){this.scrollTo(o);break}}o+=this.getRowHeight(i)}var l=[],u=!0,c=!1,d=void 0;try{for(var f,h=n[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value;p&&p.node&&p.node.stageItem&&p.node.stageItem.isSelected&&(l=l.concat(p.baseKeyFrameGroup.propsList))}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}l.length&&this.animation.selectItem(l)}this.timelineCanvas.forceDraw()}},{key:"recomputeSizes",value:function(){this.virtualList&&(this.virtualList.recomputeSizes(1),this.forceUpdate())}},{key:"updateDuration",value:function(){this.setState({duration:this.animation.duration})}},{key:"updateFps",value:function(){this.setState({fps:this.animation.fps})}},{key:"onKeyedPropertyChanged",value:function(){this.timelineCanvas&&this.timelineCanvas.forceDraw()}},{key:"onKeyFrameSelected",value:function(){var e=this.animation.selectedKeyFrames,t=new Set,n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.group.node;t.add(s)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.context.nima.stage.clearSelections(!0,!1,!0),this.context.nima.stage.selectItems(Array.from(t).map(function(e){return e.stageItem}).filter(function(e){return null!=e}),!1,!0,this)}},{key:"setAnimation",value:function(e){this.context.nima.stage.removeEventListener("selectionChanged",this.stageSelectionChanged),this.animation&&(this.animation.removeEventListener("nameChanged",this.nameChanged),this.animation.removeEventListener("nodesUpdate",this.animationNodesUpdated),this.animation.removeEventListener("play",this.playStateChange),this.animation.removeEventListener("isEditingCurvesChange",this.isEditingCurvesChange),this.animation.removeEventListener("isWorkAreaActiveChange",this.isWorkAreaActiveChange),this.animation.removeEventListener("loopChange",this.loopChange),this.animation.removeEventListener("showSelectionOnlyChange",this.showSelectionOnlyChange),this.animation.removeEventListener("expand",this.recomputeSizes),this.animation.removeEventListener("updateEditableRows",this.recomputeSizes),this.animation.removeEventListener("fpsChange",this.updateFps),this.animation.removeEventListener("durationChange",this.updateDuration),this.animation.removeEventListener("keyedPropertyChange",this.onKeyedPropertyChanged),this.animation.removeEventListener("frameSelect",this.onKeyFrameSelected),this.animation.timelineCanvas=null),this.animation=e,e&&(this.context.nima.stage.addEventListener("selectionChanged",this.stageSelectionChanged),e.addEventListener("nameChanged",this.nameChanged),e.addEventListener("nodesUpdate",this.animationNodesUpdated),e.addEventListener("play",this.playStateChange),e.addEventListener("isEditingCurvesChange",this.isEditingCurvesChange),e.addEventListener("isWorkAreaActiveChange",this.isWorkAreaActiveChange),e.addEventListener("loopChange",this.loopChange),e.addEventListener("showSelectionOnlyChange",this.showSelectionOnlyChange),e.addEventListener("expand",this.recomputeSizes),e.addEventListener("updateEditableRows",this.recomputeSizes),e.addEventListener("fpsChange",this.updateFps),e.addEventListener("durationChange",this.updateDuration),e.addEventListener("keyedPropertyChange",this.onKeyedPropertyChanged),e.addEventListener("frameSelect",this.onKeyFrameSelected),e.timelineCanvas=this.timelineCanvas),this.timelineCanvas.animation=e,e?this.setState({isPlaying:e.isPlaying,GraphActive:e.isEditingCurves,SelectionActive:e.showSelectionOnly,LoopActive:e.loop,WorkAreaActive:e.isWorkAreaActive,workAreaStart:e.workAreaStart,workAreaEnd:e.workAreaEnd,displayStart:e.displayStart,displayEnd:e.displayEnd,duration:e.duration,fps:e.fps,keyedNodes:e.keyedNodes}):this.forceUpdate()}},{key:"setActor",value:function(e){this.actor&&this.actor.removeEventListener("animationListChanged",this.animationListChanged),e&&e.addEventListener("animationListChanged",this.animationListChanged),this.actor=e}},{key:"setHeight",value:function(e){this.height!=e&&(this.height=e,this.timelineCanvas.setHeight(e-87),this.setState({height:e}))}},{key:"setIsOpen",value:function(e){if(this.isOpen!=e){this.isOpen=e,this.setState({isOpen:e}),this.timelineCanvas.isActive=e;var t=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t.resize()},410)}}},{key:"componentWillReceiveProps",value:function(e){e.actor!=this.actor&&this.setActor(e.actor)}},{key:"inputFPS",value:function(e){this.animation.fps=e,this.setState({fps:e})}},{key:"inputDurationFrames",value:function(e){this.animation.duration=e/this.state.fps,this.setState({duration:this.animation.duration})}},{key:"maxScroll",value:function(){return this.virtualList?this.virtualList.sizeAndPositionManager.getTotalSize()-this.virtualList.props.height:0}},{key:"setCanvas",value:function(e){this.timelineCanvas.setCanvas(e)}},{key:"setCanvasBg",value:function(e){this.timelineCanvas.setBackground(e)}},{key:"setPlayheadContainer",value:function(e){this.timelineCanvas.setPlayheadContainer(e)}},{key:"rewind",value:function(e){this.animation.position=0}},{key:"togglePlay",value:function(e){this.animation.isPlaying=!this.animation.isPlaying}},{key:"playStateChange",value:function(e){this.setState({isPlaying:e})}},{key:"toggleWorkArea",value:function(){this.animation.isWorkAreaActive=!this.animation.isWorkAreaActive}},{key:"toggleLoop",value:function(){this.animation.loop=!this.animation.loop}},{key:"toggleSelection",value:function(){this.animation.showSelectionOnly=!this.animation.showSelectionOnly}},{key:"toggleCurves",value:function(){this.animation.isEditingCurves=!this.animation.isEditingCurves}},{key:"isEditingCurvesChange",value:function(e){this.setState({GraphActive:e})}},{key:"isWorkAreaActiveChange",value:function(e){this.setState({WorkAreaActive:e})}},{key:"showSelectionOnlyChange",value:function(e){this.setState({SelectionActive:e})}},{key:"loopChange",value:function(e){this.setState({LoopActive:e})}},{key:"setLeft",value:function(e){this.animationPanel.style.left=e+"px"}},{key:"setRight",value:function(e){this.animationPanel.style.right=e+"px"}},{key:"setExport",value:function(e){if(e)this.animationPanel.style.transition="left 0.4s cubic-bezier(0.8, 0, 0, 1), right 0.4s cubic-bezier(0.8, 0, 0, 1), height 0.4s cubic-bezier(0.8, 0, 0, 1)",this.animationPanel.style.right="0px",this.animationPanel.style.left="0px",clearTimeout(this.animLeftTimeout);else{this.animationPanel.style.right=this.props.settingsOpen?"260px":null,this.animationPanel.style.left=this.props.filePanelWidth+"px";var t=this;this.animLeftTimeout=setTimeout(function(){t.animationPanel.style.transition=null},400)}}},{key:"mouseWheel",value:function(e){e.altKey?this.timelineCanvas.zoomTime(-e.deltaY):this.timelineCanvas.panTime(-e.deltaY)}},{key:"animationListChanged",value:function(){if(this.animation&&this.actor){var e=this.actor.animations;-1===e.indexOf(this.animation)&&(e.length?this.context.nima.editingAnimation=e[0]:this.animation=null)}}},{key:"getRowHeight",value:function(e){if(0===e)return 35;var t=this.animation.editableKeyedNodes[e-1];return t.isExpanded?35*t.rowCount:35}},{key:"onScroll",value:function(e,t){this.scrollOffset!==e&&(this.scrollOffset=e,this.setState({scrollOffset:e}),this.timelineCanvas.scroll(e))}},{key:"scrollTo",value:function(e){e=Math.max(0,Math.min(this.maxScroll(),e)),this.scrollOffset!==e&&(this.scrollOffset=e,this.setState({scrollOffset:e}),this.timelineCanvas.scroll(e))}},{key:"setVirtualList",value:function(e){this.virtualList=e}},{key:"setScrollbar",value:function(e){this.scrollbar=e}},{key:"dragScrollBar",value:function(e){this.setState({scrollOffset:e})}},{key:"render",value:function(){var e=this.animation,t=this.state.fps,n=Math.round(this.state.duration*t);if(!e)return i.default.createElement("div",{className:"AnimationPanel",ref:this.setAnimationPanel,style:{height:this.state.isOpen?this.state.height+"px":"0px",transition:this.props.animationIsResizing?"height 0s":null}});var r=e.editableKeyedNodes,o=this.actor,a=this.state.height+"px";return i.default.createElement("div",{className:"AnimationPanel",ref:this.setAnimationPanel,style:{height:this.state.isOpen?a:"0px",transition:this.props.animationIsResizing?"none":null}},i.default.createElement("div",{className:"AnimationPanelShadowLeft"}),i.default.createElement("div",{className:"AnimationPanelShadowRight"}),i.default.createElement(l.default,{isHorizontal:!0,onMouseDown:this.startResize}),i.default.createElement("div",{className:"ApHeader"},i.default.createElement("div",{className:"ApTransportControls"},this.state.isPlaying?i.default.createElement("svg",{className:"PauseButton",onMouseDown:this.togglePlay},i.default.createElement("use",{xlinkHref:k.default.make("/images/symbol-defs.svg#icon-pause")})):i.default.createElement("svg",{className:"PlayButton",onMouseDown:this.togglePlay},i.default.createElement("use",{xlinkHref:k.default.make("/images/symbol-defs.svg#icon-play")})),i.default.createElement("svg",{className:"RewButton",onMouseDown:this.rewind},i.default.createElement("use",{xlinkHref:k.default.make("/images/symbol-defs.svg#icon-rewind")}))),i.default.createElement("div",{className:"ApTransportHeader"},i.default.createElement(u.default,{animation:e}),i.default.createElement("div",{className:"FpsInput"},i.default.createElement("div",{className:"FpsLabel"},"FPS"),i.default.createElement(c.default,{className:"TimelineFpsInput",value:t,onValueChanged:this.inputFPS})),i.default.createElement(c.default,{className:"TimelineTotalInput",value:n,rate:t,onValueChanged:this.inputDurationFrames}))),i.default.createElement("div",{className:"ApTimelineHeaderWrapper"},i.default.createElement("div",{className:"ApTimelineHeaderButtons",style:{marginTop:this.state.isAnimationsOpen?a:"0px"}},i.default.createElement(f.default,null),i.default.createElement(d.default,{type:"Selection",onSelected:this.toggleSelection,isActive:this.state.SelectionActive,tip:{label:"Show Selected"}}),i.default.createElement(d.default,{type:"Loop",onSelected:this.toggleLoop,isActive:this.state.LoopActive,tip:{label:"Loop"}}),i.default.createElement(d.default,{type:"WorkArea",onSelected:this.toggleWorkArea,isActive:this.state.WorkAreaActive,tip:{label:"Work Area"}})),i.default.createElement("div",{ref:this.setTimelineHeader,className:"ApTimelineHeader",onWheel:this.mouseWheel},i.default.createElement(h.default,{animation:e}),i.default.createElement(y.default,{ref:"Ticks",animation:e,width:this.state.timelineWidth,left:this.state.timelineLeft,workAreaActive:this.state.WorkAreaActive}))),i.default.createElement("div",{className:"ApTimelineWrapper",style:{overflow:this.state.isAnimationsOpen?"hidden":null}},i.default.createElement("div",{className:"ApTimelineSources",style:{marginTop:this.state.isAnimationsOpen?a:"0px",opacity:this.state.isAnimationsOpen?0:1}},i.default.createElement(g.default,{ref:this.setVirtualList,width:"100%",scrollOffset:this.state.scrollOffset,height:this.state.height-40-47,itemCount:r.length+1,itemSize:this.getRowHeight,onScroll:this.onScroll,renderItem:function(t){var n,a=t.style,l=t.index;if(0===l)return i.default.createElement("div",{key:l,className:"ApAnimationName"},i.default.createElement("span",null,e.name));var u=r[l-1];return i.default.createElement(s.default,(O(n={key:l,style:a,idx:l},"key",u.node.refId),O(n,"keyFrameGroup",u),O(n,"artboard",o.artboards.active),n))}})),i.default.createElement("div",{className:"ApTimelineScrollWrapper"},i.default.createElement("div",{className:"ApTimelineCanvasMarker"},i.default.createElement("div",{ref:this.setCanvasBg,style:{background:this.state.WorkAreaActive?"rgba(0,0,0,0.24)":null}}),i.default.createElement("canvas",{ref:this.setCanvas})),i.default.createElement("div",{ref:this.setPlayheadContainer},i.default.createElement(v.default,{animation:e,timelineWidth:this.state.timelineWidth})),i.default.createElement(b.default,{ref:this.setScrollbar,height:this.state.height-40-47,scrollOffset:this.state.scrollOffset,onScroll:this.dragScrollBar}))))}}]),t}()).prototype,"setTimelineHeader",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTimelineHeader"),r.prototype),w(r.prototype,"setAnimationPanel",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setAnimationPanel"),r.prototype),w(r.prototype,"updateResize",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateResize"),r.prototype),w(r.prototype,"windowResize",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"windowResize"),r.prototype),w(r.prototype,"startResize",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"startResize"),r.prototype),w(r.prototype,"endResize",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"endResize"),r.prototype),w(r.prototype,"animationNodesUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"animationNodesUpdated"),r.prototype),w(r.prototype,"nameChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"nameChanged"),r.prototype),w(r.prototype,"stageSelectionChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"stageSelectionChanged"),r.prototype),w(r.prototype,"recomputeSizes",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"recomputeSizes"),r.prototype),w(r.prototype,"updateDuration",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateDuration"),r.prototype),w(r.prototype,"updateFps",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateFps"),r.prototype),w(r.prototype,"onKeyedPropertyChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyedPropertyChanged"),r.prototype),w(r.prototype,"onKeyFrameSelected",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyFrameSelected"),r.prototype),w(r.prototype,"inputFPS",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputFPS"),r.prototype),w(r.prototype,"inputDurationFrames",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputDurationFrames"),r.prototype),w(r.prototype,"setCanvas",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setCanvas"),r.prototype),w(r.prototype,"setCanvasBg",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setCanvasBg"),r.prototype),w(r.prototype,"setPlayheadContainer",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setPlayheadContainer"),r.prototype),w(r.prototype,"rewind",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"rewind"),r.prototype),w(r.prototype,"togglePlay",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"togglePlay"),r.prototype),w(r.prototype,"playStateChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"playStateChange"),r.prototype),w(r.prototype,"toggleWorkArea",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleWorkArea"),r.prototype),w(r.prototype,"toggleLoop",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleLoop"),r.prototype),w(r.prototype,"toggleSelection",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleSelection"),r.prototype),w(r.prototype,"toggleCurves",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleCurves"),r.prototype),w(r.prototype,"isEditingCurvesChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"isEditingCurvesChange"),r.prototype),w(r.prototype,"isWorkAreaActiveChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"isWorkAreaActiveChange"),r.prototype),w(r.prototype,"showSelectionOnlyChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"showSelectionOnlyChange"),r.prototype),w(r.prototype,"loopChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"loopChange"),r.prototype),w(r.prototype,"mouseWheel",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseWheel"),r.prototype),w(r.prototype,"animationListChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"animationListChanged"),r.prototype),w(r.prototype,"getRowHeight",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"getRowHeight"),r.prototype),w(r.prototype,"onScroll",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onScroll"),r.prototype),w(r.prototype,"setVirtualList",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setVirtualList"),r.prototype),w(r.prototype,"setScrollbar",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setScrollbar"),r.prototype),w(r.prototype,"dragScrollBar",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"dragScrollBar"),r.prototype),r);t.default=_,_.DoubleClickTime=200,_.contextTypes={nima:m.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=S(n(1)),a=S(n(2)),s=S(n(16)),l=S(n(5)),u=S(n(198)),c=S(n(173)),d=S(n(237)),f=S(n(225)),h=S(n(197)),p=S(n(203)),y=S(n(219)),v=S(n(337)),m=S(n(1224)),g=S(n(328)),b=S(n(3)),k=S(n(19));function S(e){return e&&e.__esModule?e:{default:e}}function O(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function w(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var _=(w((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={keyFrameGroup:null,propertyGroups:[],numRows:1,expanded:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.animationProperties=[]}},{key:"commit",value:function(){this.context.nima.captureJournalEntry()}},{key:"expand",value:function(e){e&&this.frameUpdated(),this.setState({expanded:e})}},{key:"toggleExpand",value:function(e){e.stopPropagation(),this.state.keyFrameGroup.isExpanded=!this.state.keyFrameGroup.isExpanded}},{key:"selectedChange",value:function(e){this.setState({isSelected:e})}},{key:"doForceUpdate",value:function(){this.forceUpdate()}},{key:"debounceForcedUpdate",value:function(){(0,k.default)(this.doForceUpdate)}},{key:"stageSelectionCleared",value:function(){this.props.keyFrameGroup.animation.selectItem(null)}},{key:"setKeyFrameGroup",value:function(e){var t=this.state.keyFrameGroup;t&&t.removeEventListener&&(t.removeEventListener("expand",this.expand),t.removeEventListener("hover",this.hoverChange),t.node.stageItem&&(t.node.stageItem.removeEventListener("selectedChange",this.selectedChange),t.node.stageItem.removeEventListener("icon",this.debounceForcedUpdate))),e&&(this.keyFrameGroup=e,e.addEventListener&&(e.addEventListener("expand",this.expand),e.addEventListener("hover",this.hoverChange),e.node.stageItem&&(e.node.stageItem.addEventListener("selectedChange",this.selectedChange),e.node.stageItem.addEventListener("icon",this.debounceForcedUpdate)),this.expand(e.isExpanded),e.node.stageItem&&this.selectedChange(e.node.stageItem.isSelected))),this.setState({keyFrameGroup:e})}},{key:"setArtboard",value:function(e){var t=this.artboard;t!==e&&(t&&t.removeEventListener("frameUpdated",this.frameUpdated),e&&e.addEventListener("frameUpdated",this.frameUpdated))}},{key:"componentWillReceiveProps",value:function(e){e.keyFrameGroup!=this.state.keyFrameGroup&&this.setKeyFrameGroup(e.keyFrameGroup),e.artboard!=this.state.artboard&&this.setArtboard(e.artboard)}},{key:"componentDidMount",value:function(){this.context.nima.stage.addEventListener("selectionCleared",this.stageSelectionCleared),this.props.keyFrameGroup&&this.setKeyFrameGroup(this.props.keyFrameGroup),this.props.artboard&&this.setArtboard(this.props.artboard)}},{key:"componentWillUnmount",value:function(){this.context.nima.stage.removeEventListener("selectionCleared",this.stageSelectionCleared),this.setKeyFrameGroup(null),this.setArtboard(null),k.default.cancel(this.doForceUpdate)}},{key:"addTimelineProperty",value:function(e){-1==this.animationProperties.indexOf(e)&&this.animationProperties.push(e)}},{key:"removeTimelineProperty",value:function(e){var t=this.animationProperties.indexOf(e);-1!=t&&this.animationProperties.splice(t,1)}},{key:"frameUpdated",value:function(){var e=this.state.keyFrameGroup;if(e&&e.isExpanded)for(var t=0;t<this.animationProperties.length;t++)this.animationProperties[t].updateProperty()}},{key:"hoverChange",value:function(){this.setState({hasHover:this.props.keyFrameGroup.hasHover})}},{key:"hover",value:function(){this.props.keyFrameGroup&&(this.props.keyFrameGroup.hasHover=!0)}},{key:"leave",value:function(){this.props.keyFrameGroup&&(this.props.keyFrameGroup.hasHover=!1)}},{key:"select",value:function(e){var t=this.props.keyFrameGroup;if(t&&t.node.stageItem){this.context.nima.stage.selectItem(t.node.stageItem,s.default.isMultiSelect(e),!1,this);var n=this.state.keyFrameGroup;if(n&&n.propertyGroups){var r=n.propertyGroups,o=[],i=!0,a=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value.props,f=!0,h=!1,p=void 0;try{for(var y,v=d[Symbol.iterator]();!(f=(y=v.next()).done);f=!0){var m=y.value.frameList;o.push.apply(o,O(m.keyFrames))}}catch(e){h=!0,p=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw p}}}}catch(e){a=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw l}}n.animation.dispatch("selectKeyFrames",o,s.default.isMultiSelect(e))}}}},{key:"selectProperty",value:function(e,t){e.stopPropagation();var n=this.props.keyFrameGroup;if(n&&n.node.stageItem){var r=t.frameList,o=s.default.isMultiSelect(e);this.context.nima.stage.selectItem(n.node.stageItem,o,!1,this),r.animation.dispatch("selectKeyFrames",r.keyFrames,o)}}},{key:"setRoot",value:function(e){this.root=e}},{key:"render",value:function(){var e,t,n="Unnamed",r=this.state.keyFrameGroup,o=!0,a=[],s=null;if(r){var l=r.node;switch(l.blockExpand&&(o=!1),l.constructor){case u.default:e="TimelineBoneIcon",t=b.default.make("/images/symbol-defs.svg#icon-bone");break;case c.default:e="TimelineNodeIcon",t=b.default.make("/images/symbol-defs.svg#icon-node");break;case p.default:e="TimelineImageIcon",t=b.default.make("/images/symbol-defs.svg#icon-picture");break;case y.default:e="TimelineRootIcon",t=b.default.make("/images/symbol-defs.svg#icon-root");break;case v.default:e="TimelineEventIcon",t=b.default.make("/images/symbol-defs.svg#icon-event");break;case d.default:e="TimelineSoloIcon",t=b.default.make("/images/symbol-defs.svg#icon-solo");break;case f.default:case h.default:e="TimelineImageIcon",t=b.default.make("/images/symbol-defs.svg#"+l.uiIcon);var k=l.stageItem.imgIconSrc;k&&(s="url('"+k+"')")}!e&&r.node instanceof g.default&&(e="HierarchyEventIcon",t=b.default.make("/images/symbol-defs.svg#icon-constraint")),n=r.node.name,a=r.propertyGroups}var S=[],O=o&&this.state.expanded;if(a&&O)for(var w=0;w<a.length;w++){var _=a[w],P="Unnamed",C=[];if(_){P=_.label;for(var E=0;E<_.props.length;E++){var T=_.props[E],I=i.default.createElement(m.default,{onSelected:this.selectProperty,onValueCommit:this.commit,ref:T.ref,key:T.key,title:0==E?P:null,node:T.node||r.node,property:T,row:this});C.push(I)}}S.push(i.default.createElement("div",{key:w,className:"AnimationProperty"},C))}var j=this.state,A=j.hasHover,D=j.isSelected,R=!1,M=!1;A&&D?(R=!0,M=!0):A?R=!0:D&&(M=!0);var x=[M?"TimelineRowContentSelected":"TimelineRowContent",R?"TimelineRowContentHover":null].filter(function(e){return null!==e}).join(" ");return i.default.createElement("div",{ref:this.setRoot,className:"TimelineRow",style:this.props.style,onMouseDown:this.select},i.default.createElement("div",{className:x,onMouseEnter:this.hover,onMouseLeave:this.leave},o?i.default.createElement("div",{className:"TimelineExpandBtn",onMouseDown:this.toggleExpand},i.default.createElement("svg",{className:"ExpandArrow",style:{transform:"rotate("+(O?0:-90)+"deg)"}},i.default.createElement("use",{xlinkHref:b.default.make("/images/symbol-defs.svg#icon-arrow")}))):null,i.default.createElement("svg",{style:{backgroundImage:s||null},className:"TimelineIcon "+e+(s?" TimelineIconBG":"")},s?null:i.default.createElement("use",{xlinkHref:t})),i.default.createElement("div",{className:"TimelineItemTxt"},n)),i.default.createElement("div",null,S))}}]),t}()).prototype,"commit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"commit"),r.prototype),w(r.prototype,"expand",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"expand"),r.prototype),w(r.prototype,"toggleExpand",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleExpand"),r.prototype),w(r.prototype,"selectedChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectedChange"),r.prototype),w(r.prototype,"doForceUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"doForceUpdate"),r.prototype),w(r.prototype,"debounceForcedUpdate",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"debounceForcedUpdate"),r.prototype),w(r.prototype,"stageSelectionCleared",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"stageSelectionCleared"),r.prototype),w(r.prototype,"frameUpdated",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"frameUpdated"),r.prototype),w(r.prototype,"hoverChange",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"hoverChange"),r.prototype),w(r.prototype,"hover",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"hover"),r.prototype),w(r.prototype,"leave",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"leave"),r.prototype),w(r.prototype,"select",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"select"),r.prototype),w(r.prototype,"selectProperty",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectProperty"),r.prototype),w(r.prototype,"setRoot",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setRoot"),r.prototype),r);t.default=_,_.contextTypes={nima:l.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(5)),s=c(n(2)),l=c(n(220)),u=(c(n(16)),c(n(431)));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={propertyValue:0,hasHover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"changeEnumeration",value:function(e){var t=this.props.property;t.onValueChanged&&t.onValueChanged(e,!1,t)}},{key:"setFrameList",value:function(e){this.frameList&&(this.frameList.removeEventListener("hover",this.hoverChange),this.frameList.removeEventListener("selected",this.selectedChange)),e&&(e.addEventListener("hover",this.hoverChange),e.addEventListener("selected",this.selectedChange),this.setState({isSelected:e.isSelected,hasHover:e.hasHover})),this.frameList=e}},{key:"hoverChange",value:function(){this.setState({hasHover:this.frameList.hasHover})}},{key:"select",value:function(e){this.props.onSelected&&this.props.onSelected(e,this.props.property)}},{key:"selectedChange",value:function(e){this.setState({isSelected:e})}},{key:"hover",value:function(){this.frameList&&(this.frameList.hasHover=!0)}},{key:"leave",value:function(){this.frameList&&(this.frameList.hasHover=!1)}},{key:"updateProperty",value:function(){if(!this.props.property.onValueChanged)return!1;var e=this.props.property,t=this.props.node[e.key];return this.propertyValue!=t&&(this.propertyValue=t,this.setState({propertyValue:t}),!0)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.property,n=e.node;e.row.addTimelineProperty(this),t.event&&(n.addEventListener(t.event,this.updateProperty),this.updateProperty()),t.keyStateEvent?n.addEventListener(t.keyStateEvent,this.onKeyStateChanged):n.addEventListener("keyState",this.onKeyStateChanged),this.setFrameList(this.props.property.frameList)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.property,n=e.node;e.row.removeTimelineProperty(this),t.event&&n.removeEventListener(t.event,this.updateProperty),t.keyStateEvent?n.removeEventListener(t.keyStateEvent,this.onKeyStateChanged):n.removeEventListener("keyState",this.onKeyStateChanged),this.setFrameList(null)}},{key:"componentWillReceiveProps",value:function(e){e.property&&e.property.frameList!=this.frameList&&this.setFrameList(e.property.frameList)}},{key:"previousKey",value:function(e){e.stopPropagation(),this.props.property.frameList.setPositionToPreviousKey()}},{key:"nextKey",value:function(e){e.stopPropagation(),this.props.property.frameList.setPositionToNextKey()}},{key:"setKey",value:function(e){var t=this.context.nima;e.stopPropagation(),this.props.property.frameList.setKey(),this.forceUpdate(),t.captureJournalEntry()}},{key:"onKeyStateChanged",value:function(e){this.forceUpdate()}},{key:"onValueChanged",value:function(e,t){var n=this.props.property,r=n.onValueChanged;r&&r(e,t,n)}},{key:"render",value:function(){var e=this.props,t=e.property,n=e.node,r=e.dragScale,o=e.onValueCommit,a=this.state,s=a.isFocused,c=a.input,d=a.propertyValue,f=a.hasHover,h=a.isSelected,p=t.converter,y=t.isText,v=t.decimals;if(s)c;else if(t.isText)d;else{var m=t.decimals;null==m&&(m=2);var g=Math.pow(10,m);Math.round(d*g),g,t.isAngle&&" °"}var b=n[t.key+"KS"],k=void 0,S={},O=t.frameList,w=O.animation.isEditingCurves&&O.isSelected?O.cssColor:null;switch(b){case 0:k="KeyNavAdd";break;case 1:k="KeyNavChanged";break;case 2:k="KeyNavKeyed",S={background:w}}var _=!1,P=!1;f&&h?(_=!0,P=!0):f?_=!0:h&&(P=!0);var C=!t.onValueChanged,E=t.enumeration,T=-1;return E&&(T=t.enumerationIndex(t)),i.default.createElement("div",{className:_&&P?"AnimationPropertyInputFieldSelected AnimationPropertyInputFieldHover":_?"AnimationPropertyInputField AnimationPropertyInputFieldHover":P?"AnimationPropertyInputFieldSelected":"AnimationPropertyInputField",onMouseDown:this.select,onMouseEnter:this.hover,onMouseLeave:this.leave},i.default.createElement("div",{className:"AnimationPropertyTitle",style:{flex:C?1:null}},this.props.title||""),C?null:i.default.createElement("div",{className:"AnimationPropertyInputLabel"},this.props.property.label),C?null:E?i.default.createElement(l.default,{options:E,selectedIndex:T,onSelectionChanged:this.changeEnumeration,isAnimating:!1}):i.default.createElement("span",{className:"InputSpan"},i.default.createElement(u.default,{value:d,isText:y,converter:p,dragScale:r,decimalPlaces:v,onValueCommit:o,onValueChanged:this.onValueChanged})),i.default.createElement("div",{className:"KeyNavLeft",onMouseDown:this.previousKey},i.default.createElement("div",null)),i.default.createElement("div",{className:k,onMouseDown:this.setKey},i.default.createElement("div",{style:S})),i.default.createElement("div",{className:"KeyNavRight",onMouseDown:this.nextKey},i.default.createElement("div",null)))}}]),t}()).prototype,"changeEnumeration",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"changeEnumeration"),r.prototype),d(r.prototype,"hoverChange",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"hoverChange"),r.prototype),d(r.prototype,"select",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"select"),r.prototype),d(r.prototype,"selectedChange",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"selectedChange"),r.prototype),d(r.prototype,"hover",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"hover"),r.prototype),d(r.prototype,"leave",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"leave"),r.prototype),d(r.prototype,"updateProperty",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"updateProperty"),r.prototype),d(r.prototype,"previousKey",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"previousKey"),r.prototype),d(r.prototype,"nextKey",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"nextKey"),r.prototype),d(r.prototype,"setKey",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setKey"),r.prototype),d(r.prototype,"onKeyStateChanged",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyStateChanged"),r.prototype),d(r.prototype,"onValueChanged",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onValueChanged"),r.prototype),r);t.default=f,f.contextTypes={nima:a.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(681));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fps:60,currentPosition:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"animationPositionChanged",value:function(){this.animation.isPlaying||this.setState({fps:this.animation.fps,currentPosition:this.animation.position})}},{key:"componentDidMount",value:function(){this.setAnimation(this.props.animation)}},{key:"componentWillUnmount",value:function(){this.setAnimation(null)}},{key:"setAnimation",value:function(e){this.animation&&(this.animation.removeEventListener("position",this.animationPositionChanged),this.animation.removeEventListener("fpsChange",this.animationPositionChanged),this.animation.removeEventListener("play",this.animationPositionChanged)),this.animation=e,e&&(e.addEventListener("position",this.animationPositionChanged),e.addEventListener("fpsChange",this.animationPositionChanged),e.addEventListener("play",this.animationPositionChanged),this.setState({fps:e.fps,currentPosition:e.position}))}},{key:"componentWillReceiveProps",value:function(e){e.animation&&e.animation!=this.animation&&this.setAnimation(e.animation)}},{key:"inputPositionFrames",value:function(e){this.animation.position=e/this.state.fps,this.setState({currentPosition:this.animation.position})}},{key:"render",value:function(){var e=this.state.fps,t=Math.floor(this.state.currentPosition*e);return i.default.createElement(s.default,{className:"TimelineCurrentInput",value:t,rate:e,onValueChanged:this.inputPositionFrames})}}]),t}()).prototype,"animationPositionChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"animationPositionChanged"),r.prototype),u(r.prototype,"inputPositionFrames",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputPositionFrames"),r.prototype),r);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),a=u(n(2)),s=u(n(5)),l=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var d=(c((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"mouseOver",value:function(){this.context.tooltip.enter(this)}},{key:"mouseOut",value:function(){this.context.tooltip.leave(this)}},{key:"mouseDown",value:function(){this.context.tooltip.click(this),this.props.onSelected&&this.props.onSelected(this.props.type)}},{key:"render",value:function(){var e;switch(this.props.type){case"Selection":e=l.default.make("/images/symbol-defs.svg#icon-timeline-selected");break;case"Loop":e=l.default.make("/images/symbol-defs.svg#icon-loop");break;case"WorkArea":e=l.default.make("/images/symbol-defs.svg#icon-work-area");break;case"Graph":e=l.default.make("/images/symbol-defs.svg#icon-graph")}return i.default.createElement("div",{className:this.props.type+"TimelineButton"+(this.props.isActive?"Active":""),onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut,onMouseDown:this.mouseDown},i.default.createElement("svg",null,i.default.createElement("use",{xlinkHref:e})))}}]),t}()).prototype,"mouseOver",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOver"),r.prototype),c(r.prototype,"mouseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOut"),r.prototype),c(r.prototype,"mouseDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),r);t.default=d,d.contextTypes={tooltip:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),a=u(n(2)),s=u(n(5)),l=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}var c,d,f,h,p,y,v=(r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isAutoKeyEnabled:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.state.isAutoKeyEnabled=this.context.nima.autoKey}},{key:"toggle",value:function(){this.context.nima.autoKey=!this.context.nima.autoKey,this.setState({isAutoKeyEnabled:this.context.nima.autoKey})}},{key:"componentDidMount",value:function(){this.setState({isAutoKeyEnabled:this.context.nima.autoKey})}},{key:"render",value:function(){return i.default.createElement("div",{className:this.state.isAutoKeyEnabled?"AutoKeyTimelineButtonActive":"AutoKeyTimelineButton",onMouseDown:this.toggle},i.default.createElement("svg",{className:"AutoKeyIcon"},i.default.createElement("use",{xlinkHref:l.default.make("/images/symbol-defs.svg#icon-timer")})),i.default.createElement("span",null,"AUTOKEY"))}}]),t}(),c=r.prototype,d="toggle",f=[a.default],h=Object.getOwnPropertyDescriptor(r.prototype,"toggle"),p=r.prototype,y={},Object.keys(h).forEach(function(e){y[e]=h[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=f.slice().reverse().reduce(function(e,t){return t(c,d,e)||e},y),p&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(p):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(c,d,y),y=null),r);t.default=v,v.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(1)),a=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var u=(l((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setTrack",value:function(e){this.track=e}},{key:"clickScrollStart",value:function(e){e.stopPropagation(),e.preventDefault(),this.dragLast=e.clientX,this.trackWidth=this.track.getBoundingClientRect().width,window.addEventListener("mouseup",this.endScrollDrag,!0),window.addEventListener("mousemove",this.scrollStartDrag,!0)}},{key:"componentWillReceiveProps",value:function(e){e.animation!=this.animation&&this.setAnimation(e.animation)}},{key:"componentWillUnmount",value:function(){this.setAnimation(null),window.removeEventListener("mouseup",this.endScrollDrag,!0),window.removeEventListener("mousemove",this.scrollDrag,!0),window.removeEventListener("mousemove",this.scrollStartDrag,!0),window.removeEventListener("mousemove",this.scrollEndDrag,!0)}},{key:"updateScroll",value:function(){this.forceUpdate()}},{key:"setAnimation",value:function(e){this.animation&&this.animation.removeEventListener("scrollChange",this.updateScroll),e&&(this.animation=e,this.animation.addEventListener("scrollChange",this.updateScroll))}},{key:"scrollStartDrag",value:function(e){var t=this.props.animation;e.stopPropagation(),e.preventDefault();var n=e.clientX-this.dragLast,r=(t.displayEnd,t.displayStart,n/this.trackWidth*t.duration),o=2/this.props.animation.fps,i=t.displayStart+r;i>t.displayEnd-o&&(i=t.displayEnd-o),i<0&&(i=0);var a=(i-t.displayStart)/t.duration*this.trackWidth;this.dragLast+=a,t.displayStart=Math.max(0,Math.min(t.duration-2/t.fps,i))}},{key:"clickScrollEnd",value:function(e){e.stopPropagation(),e.preventDefault(),this.dragLast=e.clientX,this.trackWidth=this.track.getBoundingClientRect().width,window.addEventListener("mouseup",this.endScrollDrag,!0),window.addEventListener("mousemove",this.scrollEndDrag,!0)}},{key:"scrollEndDrag",value:function(e){var t=this.props.animation,n=e.clientX-this.dragLast,r=(t.displayEnd,t.displayStart,n/this.trackWidth*t.duration),o=t.displayEnd+r,i=2/this.props.animation.fps;o<t.displayStart+i&&(o=t.displayStart+i),o>t.duration&&(o=t.duration);var a=(o-t.displayEnd)/t.duration*this.trackWidth;this.dragLast+=a,t.displayEnd=Math.max(0,Math.min(t.duration,o))}},{key:"clickScrollMiddle",value:function(e){e.stopPropagation(),e.preventDefault(),this.dragLast=e.clientX,this.trackWidth=this.track.getBoundingClientRect().width,window.addEventListener("mouseup",this.endScrollDrag,!0),window.addEventListener("mousemove",this.scrollDrag,!0)}},{key:"scrollDrag",value:function(e){var t=this.props.animation;e.stopPropagation(),e.preventDefault();var n=e.clientX-this.dragLast,r=t.displayEnd-t.displayStart,o=n/this.trackWidth*t.duration,i=t.displayStart+o,a=t.displayEnd+o;i<0&&(i=0,a=r),a>t.duration&&(i=(a=t.duration)-r);var s=(i-t.displayStart)/t.duration*this.trackWidth;this.dragLast+=s,t.displayEnd=Math.max(0,Math.min(t.duration,a)),t.displayStart=Math.max(0,Math.min(t.duration-2/t.fps,i))}},{key:"endScrollDrag",value:function(e){window.removeEventListener("mouseup",this.endScrollDrag,!0),window.removeEventListener("mousemove",this.scrollDrag,!0),window.removeEventListener("mousemove",this.scrollStartDrag,!0),window.removeEventListener("mousemove",this.scrollEndDrag,!0)}},{key:"render",value:function(){var e=this.props.animation,t=(e.displayEnd-e.displayStart)/e.duration,n=e.displayStart/e.duration;return i.default.createElement("div",{className:"ApTimelineHorizontalScrollTrack",ref:this.setTrack},i.default.createElement("div",{className:"TimelineScrollGrabber",style:{width:100*t+"%",marginLeft:100*n+"%"}},i.default.createElement("div",{className:"TimelineScrollLeftHandle",onMouseDown:this.clickScrollStart}),i.default.createElement("div",{className:"TimelineScrollMiddle",onMouseDown:this.clickScrollMiddle}),i.default.createElement("div",{className:"TimelineScrollRightHandle",onMouseDown:this.clickScrollEnd})))}}]),t}()).prototype,"setTrack",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTrack"),r.prototype),l(r.prototype,"clickScrollStart",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"clickScrollStart"),r.prototype),l(r.prototype,"updateScroll",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateScroll"),r.prototype),l(r.prototype,"scrollStartDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"scrollStartDrag"),r.prototype),l(r.prototype,"clickScrollEnd",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"clickScrollEnd"),r.prototype),l(r.prototype,"scrollEndDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"scrollEndDrag"),r.prototype),l(r.prototype,"clickScrollMiddle",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"clickScrollMiddle"),r.prototype),l(r.prototype,"scrollDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"scrollDrag"),r.prototype),l(r.prototype,"endScrollDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"endScrollDrag"),r.prototype),r);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=b;var r=y(n(16)),o=y(n(221)),i=n(7),a=(y(n(664)),y(n(652))),s=y(n(289)),l=y(n(1230)),u=y(n(254)),c=y(n(440)),d=y(n(197)),f=y(n(379)),h=y(n(380)),p=y(n(352));function y(e){return e&&e.__esModule?e:{default:e}}var v=parseInt(c.default.timelineMarginLeft),m=parseFloat(c.default.timelineMarginRight);function g(e,t,n,r,o,i){var a=0,s=e[t];void 0===s&&(s=i);var l=s;e[t+"Anim"]=this,this.advance=function(i){var u=!1;(a+=i)>=r&&(a=r,u=!0);var c=o(a/r);return s=l*(1-c)+n*c,e&&(e[t]=s),u&&delete e[t+"Anim"],u},Object.defineProperties(this,{value:{get:function(){return s}},to:{get:function(){return n}}})}function b(e,t){var n=this,c=void 0,y=void 0,k=void 0,S=void 0,O=void 0,w=!1,_=performance.now(),P=[],C=!1,E=void 0,T=void 0,I=1/15*1e3,j=0,A=0,D=0,R=0,M=!1,x=0,F=20,L=35,N=L/2,z=.4,V=new o.default(.8,0,0,1),B=new o.default(.42,0,.58,1),H=7,W=3.5,K=6,G=45*Math.PI/180,U=H/2,X=3,Y=U+1,J="rgba(87,165,224,1.0)",q="rgba(255,255,255,1.0)",Q="rgba(87,165,224,0.3)",Z="rgba(255,255,255,1.0)",$="rgba(87,165,224,0.3)",ee="rgba(87,165,224,1.0)",te=void 0,ne=!1,re=[0,0],oe=[],ie=[],ae=i.vec2.create(),se=i.vec2.create(),le=!1,ue=[],ce=null,de=void 0,fe=void 0,he=!1,pe=null,ye=null;function ve(e){ce&&(ce.hasHover=!1,ce=null)}function me(){for(var e=0;e<oe.length;e++){oe[e].interpolator=p.default.makeEasyEase()}T.editor.captureJournalEntry(),ct()}function ge(){for(var e=0;e<oe.length;e++){oe[e].interpolator=p.default.makeEaseIn()}T.editor.captureJournalEntry(),ct()}function be(){for(var e=0;e<oe.length;e++){oe[e].interpolator=p.default.makeEaseOut()}T.editor.captureJournalEntry(),ct()}function ke(){for(var e=0;e<oe.length;e++)oe[e].interpolator=h.default.instance;T.editor.captureJournalEntry(),ct()}function Se(){for(var e=0;e<oe.length;e++)oe[e].interpolator=f.default.instance;T.editor.captureJournalEntry(),ct()}var Oe=Date.now();function we(){for(var e=-Number.MAX_VALUE,t=Number.MAX_VALUE,n=0;n<oe.length;n++){var r=oe[n];r.time<t&&(t=r.time),r.time>=e&&(e=r.time)}return{min:t,max:e,range:e-t}}function _e(e){18==e.keyCode&&((Ct=we()).min===Ct.max&&(Ct=null),ct())}function Pe(e){18==e.keyCode&&(Ct=null,ct())}var Ce=!1,Ee=!1,Te=0;function Ie(e){e&&(e.stopPropagation(),e.preventDefault());if(Ee=!1,window.removeEventListener("mouseup",Ie,!0),!Ce){var n=Je(e.clientX,e.clientY);if(n){var o=n.isSelected;if(n.constructor===Array){o=!0;for(var i=0;i<n.length;i++)if(!n[i].isSelected){o=!1;break}n.length>0&&n[0].time}else n.time;o||tt(n,r.default.isMultiSelect(e)),2===e.button&&(Xe(!1),je&&(je.cancel(),je=null),window.removeEventListener("mousemove",rt,!0),window.removeEventListener("mousemove",Ze,!0),n.hasValueGraph&&t.showContextMenu({x:e.clientX,y:e.clientY,items:[{icon:"key-hold",name:"Hold",select:ke,isActive:n.interpolator===h.default.instance},{icon:"key-linear",name:"Linear",select:Se,isActive:n.interpolator===f.default.instance},{type:"Divider"},{icon:"key-mirrored",name:"Easy Ease",select:me},{icon:"key-ease-in",name:"Easy Ease In",select:ge},{icon:"key-ease-out",name:"Easy Ease Out",select:be}]}))}}}var je=null;function Ae(e){Te=0;var n=Date.now(),o=n-Oe;Oe=n;var a=o<222,s=-1;if(Ce=!1,Ee=!1,!e.target||"ScrollbarGrabber"!==e.target.className){if(window.addEventListener("mouseup",Ie,!0),e.clientX>A&&e.clientX<A+j)if(e.preventDefault(),e.stopPropagation(),Xe(!0),t.stage.isPanning)t.stage.isGrabbing=!0,t.stage.suppressPanning=!0,window.addEventListener("mousemove",rt,!0),window.addEventListener("mouseup",ot,!0),re[0]=e.clientX,re[1]=e.clientY;else{if(pe=null,T.isEditingCurves){for(var u=e.clientX-A,c=e.clientY-D,d=i.vec2.set(i.vec2.create(),u,c),f=0;f<oe.length;f++){var h=oe[f];if(h.cin)if(i.vec2.distance(h.cin.pos,d)<=K){pe=h.cin,ye=h,s=h.inTime;break}if(h.cout)if(i.vec2.distance(h.cout.pos,d)<=K){pe=h.cout,ye=h,s=h.outTime;break}if(h.prv&&!h.prv.isSelected&&h.prv.cout)if(i.vec2.distance(h.prv.cout.pos,d)<=K){pe=h.prv.cout,ye=h.prv,s=h.prv.outTime;break}if(h.nxt&&!h.nxt.isSelected&&h.nxt.cin)if(i.vec2.distance(h.nxt.cin.pos,d)<=K){pe=h.nxt.cin,ye=h.nxt,s=h.nxt.inTime;break}}if(pe)return re[0]=e.clientX,re[1]=e.clientY,(je=new l.default(e,i.vec2.set(i.vec2.create(),1==pe.factor?ye.inTime:ye.outTime,1==pe.factor?ye.inGraphValue:ye.outGraphValue))).onDrag=Fe,void(je.onRelease=xe)}var p=Je(e.clientX,e.clientY);if(p&&0===e.button){var y=p.isSelected;if(p.constructor===Array){y=!0;for(var m=0;m<p.length;m++)if(!p[m].isSelected){y=!1;break}p.length>0&&(s=p[0].time)}else s=p.time;y||tt(p,r.default.isMultiSelect(e));var g=we();if(e.altKey&&g.range>0&&(s==g.min?(g.at=0,Ke=g):s==g.max&&(g.at=1,Ke=g),Ke))for(var b=0;b<oe.length;b++){var k=oe[b],S=k.time;k.__sf=(S-Ke.min)/Ke.range}re[0]=e.clientX,re[1]=e.clientY;for(var O=[],w=0;w<oe.length;w++){var _=oe[w];O.push([_.time,_.graphValue])}(je=new l.default(e,O)).allowLock=T.isEditingCurves,je.onDrag=Ke?Ge:Ue,je.onRelease=Ye}else 2===e.button?Ee=!0:(r.default.isMultiSelect(e)?ue=oe.slice(0):ue.length=0,ae=qe(e.clientX,e.clientY),le=!1,window.addEventListener("mousemove",Ze,!0),window.addEventListener("mouseup",nt,!0))}if(a)if(-1!==s)T.position=s;else{var P=(T.displayEnd-T.displayStart)/R,C=e.clientX-A-v;T.position=T.displayStart+P*C}}}function De(e){for(var t={},n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=0;o<oe.length;o++){var i=oe[o],a=t[i._Group.node.refId];a||(a=t[i._Group.node.refId]={});var s=a[i._List.property];s||(s=a[i._List.property]=[]),i.time<n&&(n=i.time),i.time>r&&(r=i.time),s.push(i._List.serializeFrame(i))}e.nodes=t,e.minTime=n,e.maxTime=r}var Re=null;function Me(){if(oe.length){for(var e=0;e<oe.length;e++){oe[e].remove()}for(var n=0;n<ie.length;n++)ie[n].reSort();tt(null)}else{for(var r=t.selectedItems,o=0,i=null,a=[],s=0;s<r.length;s++){var l=r[s];l.constructor===u.default&&(a.push(l),l===T&&!0,1==++o&&(i=l.name))}o&&(Re&&Re.hide(),Re=t.alert({title:"Confirm",message:1===o?'Are you sure you want to delete the "'+i+'" animation?':"Are you sure you want to delete "+o+" animations?",buttons:[{label:"Delete",action:function(){t.removeAnimations(a)}},{label:"Cancel",action:function(){}}]}))}}function xe(e){je=null,Xe(!1),T.editor.captureJournalEntry(),ct()}function Fe(e){var t=(T.displayEnd-T.displayStart)/R,n=e.getUnlockedRelativeScaled(t)[0],r=pe.sibling,o=1==pe.factor?r:ye,i=1==pe.factor?ye:r;n>i.time&&(n=i.time),n<o.time&&(n=o.time);var a=i.time-o.time,s=(n-o.time)/a,l=fe-de,u=x-2*F,c=e.axisLock?ye.graphValue:e.getUnlockedRelativeScaled(-l/u)[1];1==pe.factor?(ye.inFactor=1-s,ye.inGraphValue=c,ye.constrainToIn(t,l/u)):(ye.outGraphValue=c,ye.outFactor=s,ye.constrainToOut(t,l/u)),ct()}var Le=[],Ne=null,ze=75,Ve=15,Be=0,He=0;function We(){if(Ne=null,Be||He){var t=!1;if(T.isEditingCurves){var n=(fe-de)/(x-2*F)*-He;de+=n,fe+=n}else e.scrollTo(st+He),t=0!==He;var r=T.displayEnd-T.displayStart,o=Be*(r/R);T.displayStart+o<0?o+=-(T.displayStart+o):T.displayEnd+o>T.duration&&(o-=T.displayEnd+o-T.duration),T.displayStart+=o,T.displayEnd+=o,Ne=setTimeout(We,ze),le&&!t&&Qe()}}var Ke=null;function Ge(e){var t=(T.displayEnd-T.displayStart)/R,n=e.absolute[0]-A-v,r=T.displayStart+t*n,o=0===Ke.at?r:Ke.min,i=(1===Ke.at?r:Ke.max)-o;if(T.isEditingCurves)for(var a=fe-de,s=x-2*F,l=0;l<oe.length;l++){var u=oe[l],c=e.getRelativeScaled(-a/s,l)[1];u.setFullFrameTime(o+u.__sf*i,u.prv&&!u.prv.isSelected,u.nxt&&!u.nxt.isSelected),u.graphValue=c}else for(var d=0;d<oe.length;d++){var f=oe[d];f.setFullFrameTime(o+f.__sf*i,f.prv&&!f.prv.isSelected,f.nxt&&!f.nxt.isSelected)}if(Le.length){for(var h=0;h<Le.length;h++){var p=Le[h];delete p._Hidden,p._List.keyFrames.push(p)}Le.length=0}for(var y=0;y<ie.length;y++)ie[y].reSort();for(var m=0;m<oe.length;m++){var g=oe[m];if(!g._Hidden){var b=g._Time;if(g.prv&&g.prv._Time===b){var k=g._List.keyFrames.indexOf(g.prv);-1!=k&&g._List.keyFrames.splice(k,1),Le.push(g.prv),g.prv._Hidden=!0,g.prv=g.prv.prv,g.prv&&(g.prv.nxt=g)}if(g.nxt&&g.nxt._Time===b){var S=g._List.keyFrames.indexOf(g.nxt);-1!=S&&g._List.keyFrames.splice(S,1),Le.push(g.nxt),g.nxt._Hidden=!0,g.nxt=g.nxt.nxt,g.nxt&&(g.nxt.prv=g)}}}ct()}function Ue(e){var t=(T.displayEnd-T.displayStart)/R,n=e.clampAllScale(t,0,T.duration,0);if(T.isEditingCurves)for(var r=fe-de,o=x-2*F,i=0;i<oe.length;i++){var a=e.getRelativeScaled(n,i)[0],s=e.getRelativeScaled(-r/o,i)[1];a=Math.trunc(a*T.fps)/T.fps;var l=oe[i];l.setFullFrameTime(a,l.prv&&!l.prv.isSelected,l.nxt&&!l.nxt.isSelected),l.graphValue=s}else for(var u=0;u<oe.length;u++){var c=oe[u],d=e.getRelativeScaled(n,u)[0];d=Math.trunc(d*T.fps)/T.fps,c.setFullFrameTime(d,c.prv&&!c.prv.isSelected,c.nxt&&!c.nxt.isSelected)}if(Le.length){for(var f=0;f<Le.length;f++){var h=Le[f];delete h._Hidden,h._List.keyFrames.push(h)}Le.length=0}for(var p=0;p<ie.length;p++)ie[p].reSort();for(var y=0;y<oe.length;y++){var v=oe[y],m=v._Time;if(v.prv&&v.prv._Time===m){var g=v._List.keyFrames.indexOf(v.prv);-1!=g&&v._List.keyFrames.splice(g,1),Le.push(v.prv),v.prv._Hidden=!0,v.prv=v.prv.prv,v.prv&&(v.prv.nxt=v)}if(v.nxt&&v.nxt._Time===m){var b=v._List.keyFrames.indexOf(v.nxt);-1!=b&&v._List.keyFrames.splice(b,1),Le.push(v.nxt),v.nxt._Hidden=!0,v.nxt=v.nxt.nxt,v.nxt&&(v.nxt.prv=v)}}ct()}function Xe(e){he=e}function Ye(){if(Ke=null,Le.length){for(var e=0;e<Le.length;e++){var t=Le[e];t._Animation.onKeyFrameDeleted(t)}Le.length=0}Xe(!1),T.editor.captureJournalEntry(),ct()}function Je(e,t){var n=(T.displayEnd-T.displayStart)/R;e=e-A-v;var r=T.displayStart+n*e;if(T.isEditingCurves){for(var o=t-D,i=T.selectedItems,s=0;s<i.length;s++){var l=i[s].getClosestKey(r,Y*n);if(l&&Math.abs(l.py-o)<Y)return l}return null}var u=function(e){var t=St(e);if(bt.length>t)return bt[t];return null}(t-D);u||-1===St(t-D)&&(u=Pt);if(u){if(u==Pt||u.constructor===a.default)for(var c=u==Pt?Pt.keys:u.allKeys,d=e+v,f=0;f<c.length;f++){var h=c[f];if(d>=h.px-Y&&d<=h.px+Y&&h.list.length)return h.list}else{var p=u.getClosestKey(T.displayStart+n*e,Y*n);if(p)return p}return null}}function qe(e,t){var n=(T.displayEnd-T.displayStart)/R,r=T.displayStart+n*(e-A-v),o=t-D+st;T.isEditingCurves&&(o=fe-(t-D-F)/(x-2*F)*(fe-de));return i.vec2.set(i.vec2.create(),r,o)}function Qe(){var e=qe(se[0],se[1]),t=ae[0]<e[0],n=ae[1]<e[1],r=t?ae[0]:e[0],o=n?ae[1]:e[1],i=t?e[0]:ae[0],l=n?e[1]:ae[1],u=(T.displayEnd,T.displayStart,r),c=i,f=[];if(T.isEditingCurves)for(var h=T.selectedItems,p=0;p<h.length;p++)for(var y=h[p],v=y.getKeysInRangeIdx(u,c),m=y.keyFrames,g=v.start;g<v.end;g++){var b=m[g];b.graphValue>=o&&b.graphValue<=l&&f.push(b)}else{var k=Math.floor(o/L)-1,S=Math.floor(l/L)-1;o%L>N&&k++,l%L<N&&S--,function(e,t,n){t<=-1&&n>=-1&&e(-1,Pt);for(var r=T.editableKeyedNodes,o=0,i=0;i<r.length;i++){var a=r[i];if((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,a),void 0!==n&&o>n)return;o++;for(var l=a.keyFrameGroups,u=0;u<l.length;u++){var c=l[u],f=c.props;a.isExpanded&&(f.framePosX&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.framePosX),o++),f.framePosY&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.framePosY),o++),f.frameWidth&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameWidth),o++),f.frameHeight&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameHeight),o++),f.frameRotation&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameRotation),o++),f.frameScaleX&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameScaleX),o++),f.frameScaleY&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameScaleY),o++),f.frameCornerRadius&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameCornerRadius),o++),f.frameInnerRadius&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameInnerRadius),o++),f.frameOpacity&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameOpacity),o++),f.frameSequence&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameSequence),o++),f.frameStrength&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameStrength),o++),f.frameLength&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameLength),o++),f.frameIsCollisionEnabled&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameIsCollisionEnabled),o++),f.frameIntValue&&c.node.propertyType===s.default.Type.Integer&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameIntValue),o++),f.frameFloatValue&&c.node.propertyType===s.default.Type.Float&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameFloatValue),o++),f.frameStringValue&&c.node.propertyType===s.default.Type.String&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameStringValue),o++),f.frameBooleanValue&&c.node.propertyType===s.default.Type.Boolean&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameBooleanValue),o++),f.frameActiveChild&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameActiveChild),o++),f.frameDrawOrder&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameDrawOrder),o++),f.frameTrigger&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameTrigger),o++),f.framePathVertices&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.framePathVertices),o++),f.frameImageVertices&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameImageVertices),o++),a.node.paintFill===d.default.PaintType.Color&&f.frameFillColor&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameFillColor),o++),a.node.paintFill===d.default.PaintType.LinearGradient&&f.frameFillGradient&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameFillGradient),o++),a.node.paintFill===d.default.PaintType.RadialGradient&&f.frameFillRadial&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameFillRadial),o++),a.node.paintFill!==d.default.PaintType.None&&f.frameFillOpacity&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameFillOpacity),o++),a.node.paintStroke===d.default.PaintType.Color&&f.frameStrokeColor&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameStrokeColor),o++),a.node.paintStroke===d.default.PaintType.LinearGradient&&f.frameStrokeGradient&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameStrokeGradient),o++),a.node.paintStroke===d.default.PaintType.RadialGradient&&f.frameStrokeRadial&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameStrokeRadial),o++),a.node.paintStroke!==d.default.PaintType.None&&f.frameStrokeWidth&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameStrokeWidth),o++),a.node.paintStroke!==d.default.PaintType.None&&f.frameStrokeOpacity&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameStrokeOpacity),o++),a.node.paintStroke!==d.default.PaintType.None&&f.frameStrokeStart&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameStrokeStart),o++),a.node.paintStroke!==d.default.PaintType.None&&f.frameStrokeEnd&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameStrokeEnd),o++),a.node.paintStroke!==d.default.PaintType.None&&f.frameStrokeOffset&&((void 0===t||o>=t)&&(void 0===n||o<=n)&&e(o,f.frameStrokeOffset),o++))}}}(function(e,t){if(t===Pt||t.constructor===a.default)for(var n=t===Pt?Pt.keys:t.allKeys,r=0;r<n.length;r++){var o=n[r];if(o.list.length){var i=o.list[0]._Time;if(i>=u&&i<=c)for(var s=0;s<o.list.length;s++)f.push(o.list[s])}}else{var l=t.getKeysInRange(u,c);l.length&&f.push.apply(f,l)}},k,S)}ue.length&&f.push.apply(f,ue),tt(f,!1,!0)}function Ze(e){e.preventDefault(),se=[e.clientX,e.clientY],le=!0,Qe();var t=e.clientY-D;He=t<0?-Ve:t>x?Ve:0;var n=e.clientX-A;(Be=n<0?-Ve:n>j?Ve:0)||He?Ne||(Ne=setTimeout(We,ze)):Ne&&(clearTimeout(Ne),Ne=null),ct()}function $e(){!function(){for(var e=0;e<oe.length;e++){var t=oe[e];t._List.isSelected||(t.isSelected=!1,oe.splice(e,1),e--)}}()}function et(e,t){tt(e,t,!0)}function tt(e,t,n){if(!t){T.isEditingCurves||n||T.selectItem(null);for(var r=0;r<oe.length;r++)oe[r].isSelected=!1;oe.length=0,ie.length=0}if(e)if(e.constructor===Array)for(var o=0;o<e.length;o++){var i=e[o];i.isSelected||(n||T.selectItem(i._List,!0),oe.push(i),-1==ie.indexOf(i.row)&&ie.push(i.row),i.isSelected=!0)}else e.isSelected||(n||T.selectItem(e._List,!0),oe.push(e),-1==ie.indexOf(e.row)&&ie.push(e.row),e.isSelected=!0);T._SelectedKeyFrames=oe,n||T.dispatch("frameSelect"),ct()}function nt(e){if(Xe(!1),window.removeEventListener("mousemove",Ze,!0),window.removeEventListener("mouseup",nt,!0),He=0,Be=0,Ne&&(clearTimeout(Ne),Ne=null),le)le=!1,!T.isEditingCurves&&oe.length&&function(){T.selectItem(null,!1,!0);for(var e=0;e<oe.length;e++){var t=oe[e];T.selectItem(t._List,!0,!0)}}(),T.dispatch("frameSelect");else{var t=Je(e.clientX,e.clientY);t?tt(t,r.default.isMultiSelect(e)):tt(null)}ct()}function rt(n){n.stopPropagation(),n.preventDefault(),t.stage.updateCustomCursorPosition(n);var r=n.clientX-re[0],o=n.clientY-re[1];re[0]=n.clientX,re[1]=n.clientY,e.scrollTo(st-o);var i=T.displayEnd-T.displayStart,a=i/R*-r,s=T.displayStart+a,l=T.displayEnd+a;s<0&&(s=0,l=i),l>T.duration&&(s=(l=T.duration)-i),T.setRange(s,l)}function ot(){Xe(!1),t.stage.isGrabbing=!1,t.stage.suppressPanning=!1,window.removeEventListener("mousemove",rt,!0),window.removeEventListener("mouseup",ot,!0),ct()}this.panTime=function(e){var t=e,n=T.displayEnd-T.displayStart,r=n/R*-t,o=T.displayStart+r,i=T.displayEnd+r;o<0&&(o=0,i=n),i>T.duration&&(o=(i=T.duration)-n),T.setRange(o,i)},this.zoomTime=function(e){var t=e,n=(T.displayEnd-T.displayStart)/R*-t,r=T.displayStart-n,o=T.displayEnd+n;r<0&&(r=0),o>T.duration&&(o=T.duration),T.setRange(r,o,!0)};var it=i.vec2.create();function at(e){e.preventDefault();var n=i.vec2.set(i.vec2.create(),e.clientX,e.clientY);if(Te+=i.vec2.distance(n,it),it=n,Te>4&&(Ce=!0),e.clientX>A&&e.clientX<A+j){te||(te=!0);var r=St(e.clientY-D),o=bt[r];o&&(o.hasHover=!0),ce&&ce!=o&&(ce.hasHover=!1),ce=o}else te&&(te=!1);Ee&&Ce&&(Ee=!1,t.stage.isGrabbing=!0,t.stage.suppressPanning=!0,window.addEventListener("mousemove",rt,!0),window.addEventListener("mouseup",ot,!0),re[0]=e.clientX,re[1]=e.clientY)}var st=0;function lt(t){var n=t.deltaY;1===t.deltaMode&&(n*=35),e.scrollTo(st+n)}function ut(){clearTimeout(E),document.hasFocus()?window.requestAnimationFrame(mt):E=setTimeout(mt,I)}function ct(){C=!0}function dt(){Ct=null,ct()}function ft(){ct()}function ht(e){ct()}this.scroll=function(e){st=e,le&&(Qe(),ne=!0),ct()};var pt=0;function yt(){if(y){var e=pt;return!(!M&&x==e)&&(M=!1,y.width=j,y.height=x=e,S&&(S.style.width=y.width+"px",S.style.height=y.height+"px"),O&&(O.style.width=y.width+"px",O.style.height=y.height+"px"),!0)}}function vt(e,t,n,r,o){var i=e[t+"Anim"];if(i){var a=P.indexOf(i);-1!=a&&P.splice(a,1)}!function(e,t,n,r,o){P.push(new g(e,t,n,r,o))}(e,t,n,r,o)}function mt(){var e=performance.now();if(w){var t=(e-_)/1e3;_=e;for(var n=0!=P.length,r=0;r<P.length;r++){P[r].advance(t)&&(P.splice(r,1),r--)}var o=C||n;C=!1,yt()&&(o=!0),o&&(T&&T.isEditingCurves?function(){if(!y||!T)return;Ct&&(Ct=we());bt=[],kt=0;Date.now();k.clearRect(0,0,y.width,y.height),k.strokeStyle=q,k.fillStyle=J;var e=(T.displayEnd-T.displayStart)/R,t=1/e,n=v-T.displayStart/e;_t(e);var r=T.selectedItems,o=[],a=!he||null==de||null==fe;a&&(de=null,fe=null);if(je&&je.axisLock){k.save();var s=x-F,l=fe-de,u=x-2*F;k.strokeStyle="rgba(255,185,0,1.0)";var c=je.origins;if(c&&c.length&&oe.length===c.length)for(var d=0;d<c.length;d++){var f=c[d],p=oe[d],m=n+f[0]*t,g=s-(f[1]-de)/l*u,b=n+p.time*t,S=s-(p.graphValue-de)/l*u;k.moveTo(m,g),k.lineTo(b,S),k.stroke()}k.restore()}for(var O=0;O<r.length;O++){for(var w=r[O],_=w.keyFrames,P=w.getKeysInRangeIdx(T.displayStart,T.displayEnd),C=Math.max(0,P.start-1),E=Math.min(_.length-1,P.end+1),I=C;I<=E;I++){var j=_[I];if(a){var A=j.graphValueBounds;null===de?(de=A[0],fe=A[1]):(A[0]<de&&(de=A[0]),A[1]>fe&&(fe=A[1]))}if(a&&j.isSelected){j.inGraphValue<de&&(de=j.inGraphValue),j.inGraphValue>fe&&(fe=j.inGraphValue),j.outGraphValue<de&&(de=j.outGraphValue),j.outGraphValue>fe&&(fe=j.outGraphValue);var D=j.prv;D&&!D.isSelected&&(D.inGraphValue<de&&(de=D.inGraphValue),D.inGraphValue>fe&&(fe=D.inGraphValue),D.outGraphValue<de&&(de=D.outGraphValue),D.outGraphValue>fe&&(fe=D.outGraphValue));var M=j.nxt;M&&!M.isSelected&&(M.inGraphValue<de&&(de=M.inGraphValue),M.inGraphValue>fe&&(fe=M.inGraphValue),M.outGraphValue<de&&(de=M.outGraphValue),M.outGraphValue>fe&&(fe=M.outGraphValue))}}if(a){var L=w.getInterpolatedValue(T.displayStart);L=w.getGraphValue(L),null===de?(de=L,fe=L):(L<de&&(de=L),L>fe&&(fe=L)),L=w.getInterpolatedValue(T.displayEnd),L=w.getGraphValue(L),null===de?(de=L,fe=L):(L<de&&(de=L),L>fe&&(fe=L))}o.push({item:w,start:Math.max(0,C-1),end:Math.min(_.length-1,E+1)})}de==fe&&(de-=10,fe+=10);for(var N=x-F,z=fe-de,V=x-2*F,B=[],H=0;H<o.length;H++){var W=o[H],K=W.item,G=K.keyFrames,U=W.start,X=W.end,Y=K.cssColor;k.fillStyle=Y;for(var Q=null,$=U;$<=X;$++){var ee=G[$],te=ee.graphValue,ne=(ee.time,n+ee.time*t),re=N-(te-de)/z*V;if(ee.px=ne,ee.py=re,ee.hasHandles)if(Q?(ee.cin||(ee.cin={pos:i.vec2.create()}),ee.cin.sibling=Q,ee.cin.factor=1,ee.cin.pos[0]=n+ee.inTime*t,ee.cin.pos[1]=N-(ee.inGraphValue-de)/z*V):delete ee.cin,$+1<G.length&&ee.interpolator!==h.default.instance){ee.cout||(ee.cout={pos:i.vec2.create()});var ie=G[$+1];ee.cout.sibling=ie,ee.cout.factor=-1,ee.cout.pos[0]=n+ee.outTime*t,ee.cout.pos[1]=N-(ee.outGraphValue-de)/z*V}else delete ee.cout;else delete ee.cin,delete ee.cout;if(Q){if(k.save(),k.strokeStyle=Q.isSelected&&ee.isSelected?Z:Y,k.beginPath(),Q.interpolator===h.default.instance)k.moveTo(Q.px,Q.py),k.lineTo(ne,Q.py),k.lineTo(ne,re);else{k.moveTo(Q.px,Q.py);var ae=Q.px,se=Q.py;Q.cout&&(ae=Q.cout.pos[0],se=Q.cout.pos[1]);var le=ne,ue=re;ee.cin&&(le=ee.cin.pos[0],ue=ee.cin.pos[1]),k.bezierCurveTo(ae,se,le,ue,ne,re)}k.stroke(),k.restore(),Q.isSelected?B.push(Q):Tt(Q,Q.px,Q.py)}Q=ee}Q&&(Q.isSelected?B.push(Q):Tt(Q,Q.px,Q.py))}for(var ce=0;ce<B.length;ce++){var pe=B[ce];k.fillStyle=pe._List.cssColor,k.save(),k.strokeStyle=pe._List.cssColor,pe.hasHandles&&(pe.cin&&(k.beginPath(),k.moveTo(pe.px,pe.py),k.lineTo(pe.cin.pos[0],pe.cin.pos[1]),k.stroke(),Et(pe.cin)),pe.cout&&(k.beginPath(),k.moveTo(pe.px,pe.py),k.lineTo(pe.cout.pos[0],pe.cout.pos[1]),k.stroke(),Et(pe.cout))),pe.prv&&!pe.prv.isSel&&pe.prv.cout&&(k.beginPath(),k.moveTo(pe.prv.px,pe.prv.py),k.lineTo(pe.prv.cout.pos[0],pe.prv.cout.pos[1]),k.stroke(),Et(pe.prv.cout)),pe.nxt&&!pe.nxt.isSel&&pe.nxt.cout&&(k.beginPath(),k.moveTo(pe.nxt.px,pe.nxt.py),k.lineTo(pe.nxt.cin.pos[0],pe.nxt.cin.pos[1]),k.stroke(),Et(pe.nxt.cin)),k.restore(),Tt(pe,pe.px,pe.py)}var ye=(fe-de)/(x-2*F),ve=50*ye,me=1;ve<.01?(ve=.01,me=100):ve<.025?(ve=.025,me=1e3):ve<.05?(ve=.05,me=100):ve<.1?(ve=.1,me=10):ve<.25?(ve=.25,me=100):ve<.5?(ve=.5,me=10):ve=ve<1?1:ve<3?2:5*Math.round(ve/5);var ge=ve/ye,be=Math.ceil(x/ge+1),ke=de/ve,Se=Math.floor(ke)*ve,Oe=(Se-de)/ye;k.save(),k.strokeStyle="rgba(70,70,70,0.8)",k.fillStyle="rgba(145,145,145,1.0)",k.font="11px 'Roboto', sans-serif";for(var _e=x-F-Oe,Pe=0;Pe<be;Pe++){k.beginPath(),k.moveTo(0,_e),k.lineTo(10,_e),k.stroke();var Ce=1==me?Se:Math.round(Se*me)/me;k.fillText(Ce.toString(),15,_e),Se+=ve,_e-=ge}k.restore(),Ot(e)}():function(){if(!y||!T)return;Ct&&(Ct=we());bt=[],kt=0,k.clearRect(0,0,y.width,y.height);var e=st,t=(T.displayEnd-T.displayStart)/R,n=1/t,r=v-T.displayStart/t;_t(t);var o=T.editableKeyedNodes,i=-e+L;Pt.lut={},Pt.keys.length=0;for(var a=0;a<o.length;a++){var l=i<=x,u=o[a];u.allKeysLut={},u.allKeys=[];var c=void 0!==u.renderExpansionAnim,f=L;if(u.isExpanded){for(var h=0,p=0;p<u.keyFrameGroups.length;p++){var m=u.keyFrameGroups[p];h+=m.propsList.length;var g=m.props;g.frameIntValue&&m.node.propertyType!==s.default.Type.Integer&&h--,g.frameFloatValue&&m.node.propertyType!==s.default.Type.Float&&h--,g.frameStringValue&&m.node.propertyType!==s.default.Type.String&&h--,g.frameBooleanValue&&m.node.propertyType!==s.default.Type.Boolean&&h--,u.node.paintFill!==d.default.PaintType.Color&&g.frameFillColor&&h--,u.node.paintFill!==d.default.PaintType.LinearGradient&&g.frameFillGradient&&h--,u.node.paintFill!==d.default.PaintType.RadialGradient&&g.frameFillRadial&&h--,u.node.paintFill===d.default.PaintType.None&&g.frameFillOpacity&&h--,u.node.paintStroke!==d.default.PaintType.Color&&g.frameStrokeColor&&h--,u.node.paintStroke!==d.default.PaintType.LinearGradient&&g.frameStrokeGradient&&h--,u.node.paintStroke!==d.default.PaintType.RadialGradient&&g.frameStrokeRadial&&h--,u.node.paintStroke===d.default.PaintType.None&&g.frameStrokeWidth&&h--,u.node.paintStroke===d.default.PaintType.None&&g.frameStrokeOpacity&&h--,u.node.paintStroke===d.default.PaintType.None&&g.frameStrokeStart&&h--,u.node.paintStroke===d.default.PaintType.None&&g.frameStrokeEnd&&h--,u.node.paintStroke===d.default.PaintType.None&&g.frameStrokeOffset&&h--}f+=L*h}var S=u.renderExpansion;u.renderExpansion==f||c&&u.renderExpansionAnim.to==f||(void 0===u.renderExpansion&&(u.renderExpansion=L),vt(u,"renderExpansion",f,z,V),c=!0),i+S<0&&(l=!1);var O=u.node.stageItem,w=O&&O.isSelected;l&&(u.hasHover||w)&&(u.hasHover&&w?k.fillStyle=b.RowHoverAndSelectedBackground:u.hasHover?k.fillStyle=b.RowHoverBackground:w&&(k.fillStyle=b.RowSelectedBackground),k.fillRect(0,i,j,L)),0==bt.length&&(kt=i),l&&bt.push(u);var _=i+L,P=l&&(c||u.isExpanded);l&&(k.save(),k.beginPath(),k.rect(0,i,j,S),k.clip());for(var C=0;C<u.keyFrameGroups.length;C++){var E=u.keyFrameGroups[C],I=E.props;I.framePosX&&(_=gt(u,I.framePosX,r,_,n,P)),I.framePosY&&(_=gt(u,I.framePosY,r,_,n,P)),I.frameWidth&&(_=gt(u,I.frameWidth,r,_,n,P)),I.frameHeight&&(_=gt(u,I.frameHeight,r,_,n,P)),I.frameRotation&&(_=gt(u,I.frameRotation,r,_,n,P)),I.frameScaleX&&(_=gt(u,I.frameScaleX,r,_,n,P)),I.frameScaleY&&(_=gt(u,I.frameScaleY,r,_,n,P)),I.frameCornerRadius&&(_=gt(u,I.frameCornerRadius,r,_,n,P)),I.frameInnerRadius&&(_=gt(u,I.frameInnerRadius,r,_,n,P)),I.frameOpacity&&(_=gt(u,I.frameOpacity,r,_,n,P)),I.frameSequence&&(_=gt(u,I.frameSequence,r,_,n,P)),I.frameStrength&&(_=gt(u,I.frameStrength,r,_,n,P)),I.frameLength&&(_=gt(u,I.frameLength,r,_,n,P)),I.frameIsCollisionEnabled&&(_=gt(u,I.frameIsCollisionEnabled,r,_,n,P)),I.frameIntValue&&E.node.propertyType===s.default.Type.Integer&&(_=gt(u,I.frameIntValue,r,_,n,P)),I.frameFloatValue&&E.node.propertyType===s.default.Type.Float&&(_=gt(u,I.frameFloatValue,r,_,n,P)),I.frameStringValue&&E.node.propertyType===s.default.Type.String&&(_=gt(u,I.frameStringValue,r,_,n,P)),I.frameBooleanValue&&E.node.propertyType===s.default.Type.Boolean&&(_=gt(u,I.frameBooleanValue,r,_,n,P)),I.frameActiveChild&&(_=gt(u,I.frameActiveChild,r,_,n,P)),I.frameDrawOrder&&(_=gt(u,I.frameDrawOrder,r,_,n,P)),I.frameTrigger&&(_=gt(u,I.frameTrigger,r,_,n,P)),I.framePathVertices&&(_=gt(u,I.framePathVertices,r,_,n,P)),I.frameImageVertices&&(_=gt(u,I.frameImageVertices,r,_,n,P)),u.node.paintFill===d.default.PaintType.Color&&I.frameFillColor&&(_=gt(u,I.frameFillColor,r,_,n,P)),u.node.paintFill===d.default.PaintType.LinearGradient&&I.frameFillGradient&&(_=gt(u,I.frameFillGradient,r,_,n,P)),u.node.paintFill===d.default.PaintType.RadialGradient&&I.frameFillRadial&&(_=gt(u,I.frameFillRadial,r,_,n,P)),u.node.paintFill!==d.default.PaintType.None&&I.frameFillOpacity&&(_=gt(u,I.frameFillOpacity,r,_,n,P)),u.node.paintStroke===d.default.PaintType.Color&&I.frameStrokeColor&&(_=gt(u,I.frameStrokeColor,r,_,n,P)),u.node.paintStroke===d.default.PaintType.LinearGradient&&I.frameStrokeGradient&&(_=gt(u,I.frameStrokeGradient,r,_,n,P)),u.node.paintStroke===d.default.PaintType.RadialGradient&&I.frameStrokeRadial&&(_=gt(u,I.frameStrokeRadial,r,_,n,P)),u.node.paintStroke!==d.default.PaintType.None&&I.frameStrokeWidth&&(_=gt(u,I.frameStrokeWidth,r,_,n,P)),u.node.paintStroke!==d.default.PaintType.None&&I.frameStrokeOpacity&&(_=gt(u,I.frameStrokeOpacity,r,_,n,P)),u.node.paintStroke!==d.default.PaintType.None&&I.frameStrokeStart&&(_=gt(u,I.frameStrokeStart,r,_,n,P)),u.node.paintStroke!==d.default.PaintType.None&&I.frameStrokeEnd&&(_=gt(u,I.frameStrokeEnd,r,_,n,P)),u.node.paintStroke!==d.default.PaintType.None&&I.frameStrokeOffset&&(_=gt(u,I.frameStrokeOffset,r,_,n,P))}if(l){k.strokeStyle=q,k.fillStyle="rgba(255,255,255,0.5)";for(var A=i+N,D=0;D<u.allKeys.length;D++){var M=u.allKeys[D],F=M.isSelected;k.save(),F&&(k.fillStyle=J),k.translate(M.px,A),k.rotate(G);var B=F&&Ct&&(Ct.min===M.list[0]._Time||Ct.max===M.list[0]._Time);B&&(k.fillStyle="rgba(255,185,0,1.0)",k.translate(-X,X),k.fillRect(-U,-U,H,H),k.translate(2*X,2*-X),k.fillRect(-U,-U,H,H),k.translate(-X,X)),k.fillRect(-U,-U,H,H),F&&(k.strokeRect(-U,-U,H,H),B&&(k.strokeStyle="rgba(0,0,0,1.0)",k.strokeRect(-U-1,-U-1,H+2,H+2))),k.restore()}k.restore(),k.fillStyle="rgba(70,70,70,0.8)",k.fillRect(0,i+S,j,1)}i+=S}i=-e,k.save(),k.strokeStyle=q,k.fillStyle="rgba(255,255,255,0.85)";for(var W=i+N,K=0;K<Pt.keys.length;K++){var Y=Pt.keys[K],Q=Y.isSelected;k.save(),Q&&(k.fillStyle=J),k.translate(Y.px,W),k.rotate(G);var Z=Q&&Ct&&(Ct.min===Y.list[0]._Time||Ct.max===Y.list[0]._Time);Z&&(k.fillStyle="rgba(255,185,0,1.0)",k.translate(-X,X),k.fillRect(-U,-U,H,H),k.translate(2*X,2*-X),k.fillRect(-U,-U,H,H),k.translate(-X,X)),k.fillRect(-U,-U,H,H),Q&&(k.strokeRect(-U,-U,H,H),Z&&(k.strokeStyle="rgba(0,0,0,1.0)",k.strokeRect(-U-1,-U-1,H+2,H+2))),k.restore()}k.restore(),k.fillStyle="rgba(70,70,70,0.8)",k.fillRect(0,i+L,j,1),Ot(t)}(),ne&&(Qe(),ne=!1)),ut()}}function gt(e,t,n,r,o,i){t._Y=r-c,i&&(bt.push(t),(t.hasHover||t.isSelected)&&(t.hasHover&&t.isSelected?k.fillStyle=b.RowHoverAndSelectedBackground:t.hasHover?k.fillStyle=b.RowHoverBackground:t.isSelected&&(k.fillStyle=b.RowSelectedBackground),k.fillRect(0,r,j,L)));var a=t.keyFrames,s=r+N;i&&(k.fillStyle=J,k.strokeStyle=q);for(var l=null,u=!1,d=0;d<a.length;d++){var f=a[d],p=f.prv&&f.prv.isSelected,y=Math.round(n+f.time*o)+.5,v=!1;if(y>-U){var m=f.isSelected,g=y<j+U;if(g){var S=Pt.lut[y];if(S||(S={px:y,list:[],isSelected:m},Pt.lut[y]=S,Pt.keys.push(S)),m||(S.isSelected=!1),S.list.push(f),(S=e.allKeysLut[y])||(S={px:y,list:[],isSelected:m},e.allKeysLut[y]=S,e.allKeys.push(S)),m||(S.isSelected=!1),S.list.push(f),i){k.save(),k.translate(y,s),f._Interpolator.constructor!==h.default&&k.rotate(G);var O=m&&Ct&&(Ct.min===f._Time||Ct.max===f._Time);O&&(k.fillStyle="rgba(255,185,0,1.0)",k.translate(-X,X),k.fillRect(-U,-U,H,H),k.translate(2*X,2*-X),k.fillRect(-U,-U,H,H),k.translate(-X,X),v=!0),k.fillRect(-U,-U,H,H),m&&(k.strokeRect(-U,-U,H,H),O&&(k.strokeStyle="rgba(0,0,0,1.0)",k.strokeRect(-U-1,-U-1,H+2,H+2))),k.restore()}}if(i&&null!==l&&(g||l<j+U)){var w=u?5:0,_=v?5:0;k.fillStyle=p&&m?Z:Q,k.fillRect(l+U+w,s-.5,y-l-H-w-_,1),k.fillStyle=J}u=v}l=y}return r+L}this.setHeight=function(e){pt=e},Object.defineProperties(this,{isMouseOver:{get:function(){return te}},isPanning:{get:function(){return t.stage.isPanning},set:function(e){t.stage.isPanning=e}},isActive:{get:function(){return w},set:function(e){w!=e&&(w=e)&&ut()}},animation:{get:function(){return T},set:function(e){if(T!=e){T&&(T.removeEventListener("update",ft),T.removeEventListener("moveSelectedKeyFrames",dt),T.removeEventListener("expand",ht),T.removeEventListener("delete",Me),T.removeEventListener("copy",De),T.removeEventListener("itemSelected",$e),T.removeEventListener("selectKeyFrames",et)),T=e;for(var t=0;t<oe.length;t++)oe[t].isSelected=!1;oe.length=0,ie.length=0,T&&(T.addEventListener("update",ft),T.addEventListener("moveSelectedKeyFrames",dt),T.addEventListener("expand",ht),T.addEventListener("delete",Me),T.addEventListener("copy",De),T.addEventListener("itemSelected",$e),T.addEventListener("selectKeyFrames",et)),ct()}}},left:{get:function(){return A},set:function(e){A=e}},top:{get:function(){return D},set:function(e){D=e}},width:{get:function(){return j},set:function(e){j!=e&&(R=(j=e)-v-m,M=!0)}},selectedKeyFrames:{get:function(){return oe}}});var bt=[],kt=0;function St(e){return Math.floor((e-kt)/L)}function Ot(e){if(le){var t=qe(se[0],se[1]),n=ae[0]<t[0],r=ae[1]<t[1],o=(n?ae[0]:t[0])/e,i=r?ae[1]:t[1],a=(n?t[0]:ae[0])/e,s=r?t[1]:ae[1],l=Math.round(a-o),u=Math.round(o+v-T.displayStart/e)+.5,c=void 0,d=void 0;if(T.isEditingCurves){var f=fe-de,h=x-2*F;i=x-F-(i-de)/f*h,s=x-F-(s-de)/f*h,d=Math.round(s-i),c=i}else d=Math.round(s-i),c=Math.round(i-st)+.5;k.fillStyle=$,k.strokeStyle=ee,k.lineWidth=1,k.fillRect(u,c,l,d),k.strokeRect(u,c,l,d)}}var wt=!1;function _t(e){if(wt!=T.isWorkAreaActive&&(vt(n,"workAreaAlpha",T.isWorkAreaActive?1:0,.1,B),wt=T.isWorkAreaActive),0!=n.workAreaAlpha){var t=n.workAreaAlpha,r=Math.round(v+(T.workAreaStart-T.displayStart)/e),o=Math.round(v+(T.workAreaEnd-T.displayStart)/e)-2;k.save(),k.fillStyle="rgba(0,0,0,"+t+")",k.fillRect(r,0,2,x),k.fillRect(o,0,2,x),k.fillStyle="rgba(255,255,255,"+.04*t+")",k.fillRect(r+2,0,o-r-2,x),k.restore()}}n.workAreaAlpha=0;var Pt={lut:{},keys:[]},Ct=null;function Et(e){k.beginPath(),k.arc(e.pos[0],e.pos[1],W,0,2*Math.PI,!1),k.fill()}function Tt(e,t,n){k.save(),k.translate(t,n),e._Interpolator.constructor!==h.default&&k.rotate(G);var r=Ct&&e.isSelected&&(Ct.min===e._Time||Ct.max===e._Time);r&&(k.fillStyle="rgba(255,185,0,1.0)",k.translate(-X,X),k.fillRect(-U,-U,H,H),k.translate(2*X,2*-X),k.fillRect(-U,-U,H,H),k.translate(-X,X)),Ct&&e.isSelected&&(Ct.min===e._Time||Ct.max===e._Time)&&(k.fillStyle="rgba(255,185,0,1.0)"),k.fillRect(-U,-U,H,H),e.isSelected&&(k.strokeRect(-U,-U,H,H),r&&(k.strokeStyle="rgba(0,0,0,1.0)",k.strokeRect(-U-1,-U-1,H+2,H+2))),k.restore()}this.forceDraw=ct,this.setCanvas=function(e){c&&(c.removeEventListener("wheel",lt),c.removeEventListener("mousedown",Ae),c.removeEventListener("mousemove",at),c.removeEventListener("mouseleave",ve),document.removeEventListener("keydown",_e),document.removeEventListener("keyup",Pe),window.removeEventListener("focus",ut)),j=x=0,(y=e)?(k=y.getContext("2d"),(c=y.parentNode.parentNode.parentNode).addEventListener("wheel",lt),c.addEventListener("mousedown",Ae),c.addEventListener("mousemove",at),c.addEventListener("mouseleave",ve),document.addEventListener("keydown",_e),document.addEventListener("keyup",Pe),window.addEventListener("focus",ut),yt()&&ct()):(c&&(c.removeEventListener("mousedown",Ae),c.removeEventListener("mousemove",at),c.removeEventListener("wheel",lt),c.removeEventListener("mouseleave",ve)),c=null,window.removeEventListener("focus",ut)),ut()},this.setBackground=function(e){S=e,M=!0,y&&yt()&&ct()},this.setPlayheadContainer=function(e){O=e,M=!0,y&&yt()&&ct()}}b.RowHoverBackground="rgba(150,150,150,0.1)",b.RowSelectedBackground="rgba(150,150,150,0.07)",b.RowHoverAndSelectedBackground="rgba(150,150,150,0.1)"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(7),s=n(2),l=(o=s)&&o.__esModule?o:{default:o};function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),window.addEventListener("mouseup",this.onMouseUp,!0),window.addEventListener("mousemove",this.onMouseMove,!0),window.addEventListener("keydown",this.onKeyDown,!0),window.addEventListener("keyup",this.onKeyUp,!0),this._StartPoint=a.vec2.set(a.vec2.create(),t.clientX,t.clientY),this._Absolute=a.vec2.clone(this._StartPoint),this._Relative=a.vec2.create(),this._Origin=a.vec2.create(),this._LockedRelative=a.vec2.create(),this._LockedAbsolute=a.vec2.create(),n)if(n.constructor===Array){this._Origins=[];for(var r=0;r<n.length;r++){var o=n[r];this._Origins.push(a.vec2.set(a.vec2.create(),o[0],o[1]))}}else this._Origin[0]=n[0],this._Origin[1]=n[1];this._AllowLock=!0,this.axisLock=t.shiftKey}return i(e,[{key:"onMouseUp",value:function(e){window.removeEventListener("mouseup",this.onMouseUp,!0),window.removeEventListener("mousemove",this.onMouseMove,!0),window.removeEventListener("keydown",this.onKeyDown,!0),window.removeEventListener("keyup",this.onKeyUp,!0),this.onRelease&&this.onRelease(e,this)}},{key:"cancel",value:function(){window.removeEventListener("mouseup",this.onMouseUp,!0),window.removeEventListener("mousemove",this.onMouseMove,!0),window.removeEventListener("keydown",this.onKeyDown,!0),window.removeEventListener("keyup",this.onKeyUp,!0)}},{key:"onKeyDown",value:function(e){16==e.keyCode&&(this.axisLock=!0)}},{key:"onKeyUp",value:function(e){16==e.keyCode&&(this.axisLock=!1)}},{key:"onMouseMove",value:function(e){e.preventDefault(),e.stopPropagation(),this._Absolute=a.vec2.set(a.vec2.create(),e.clientX,e.clientY),this.updateDrag()}},{key:"updateDrag",value:function(){a.vec2.subtract(this._Relative,this._Absolute,this._StartPoint),this._AxisLock&&(Math.abs(this._Relative[0])>Math.abs(this._Relative[1])?a.vec2.set(this._LockedRelative,this._Relative[0],0):a.vec2.set(this._LockedRelative,0,this._Relative[1]),a.vec2.add(this._LockedAbsolute,this._StartPoint,this._LockedRelative)),this.onDrag&&this.onDrag(this)}},{key:"clampAllScale",value:function(e,t,n,r){var o=this._AxisLock?this._LockedRelative[r]:this._Relative[r],i=o*e,a=!0,s=!1,l=void 0;try{for(var u,c=this._Origins[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value[r],f=d+i,h=Math.min(n,Math.max(t,f));if(h!==f){var p=(h-d)/o;p<e&&(e=p)}}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}return e}},{key:"getRelativeScaled",value:function(e,t){return void 0!==t?a.vec2.add(a.vec2.create(),this._Origins[t],a.vec2.scale(a.vec2.create(),this._AxisLock?this._LockedRelative:this._Relative,e)):a.vec2.add(a.vec2.create(),this._Origin,a.vec2.scale(a.vec2.create(),this._AxisLock?this._LockedRelative:this._Relative,e))}},{key:"getUnlockedRelativeScaled",value:function(e,t){return void 0!==t?a.vec2.add(a.vec2.create(),this._Origins[t],a.vec2.scale(a.vec2.create(),this._Relative,e)):a.vec2.add(a.vec2.create(),this._Origin,a.vec2.scale(a.vec2.create(),this._Relative,e))}},{key:"relative",get:function(){return a.vec2.add(a.vec2.create(),this._Origin,this._AxisLock?this._LockedRelative:this._Relative)}},{key:"absolute",get:function(){return this._AxisLock?this._LockedAbsolute:this._Absolute}},{key:"axisLock",set:function(e){this._AllowLock||(e=!1),this._AxisLock!=e&&(this._AxisLock=e,this.updateDrag())},get:function(){return this._AxisLock}},{key:"allowLock",get:function(){return this._AllowLock},set:function(e){this._AllowLock=e,e||(this.axisLock=!1)}},{key:"origin",get:function(){return this._Origin}},{key:"origins",get:function(){return this._Origins}}]),e}()).prototype,"onMouseUp",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseUp"),r.prototype),u(r.prototype,"onKeyDown",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyDown"),r.prototype),u(r.prototype,"onKeyUp",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyUp"),r.prototype),u(r.prototype,"onMouseMove",[l.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseMove"),r.prototype),r);t.default=c},function(e,t,n){(t=e.exports=n(13)(!1)).push([e.i,"\n",""]),t.locals={timelineMarginLeft:"10px",timelineMarginRight:"15px"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(1233)),a=d(n(1)),s=d(n(2)),l=d(n(5)),u=d(n(436)),c=d(n(440));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var h=parseInt(c.default.timelineMarginLeft),p=parseFloat(c.default.timelineMarginRight),y=(f((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={start:0,end:0,waStart:0,waEnd:0,rate:60},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),o(t,[{key:"getMouseTime",value:function(e){var t=(this.state.end-this.state.start)/(this.props.width-h-p);return(e.clientX-this.props.left-h)*t+this.state.start}},{key:"componentWillUnmount",value:function(){this.setAnimation(null)}},{key:"setAnimation",value:function(e){this.animation&&this.animation.removeEventListener("scrollChange",this.updateAnimation),this.animation=e,e&&e.addEventListener("scrollChange",this.updateAnimation),this.updateAnimation()}},{key:"updateAnimation",value:function(){if(this.animation){var e=this.animation;this.setState({start:e.displayStart,end:e.displayEnd,waStart:e.workAreaStart,waEnd:e.workAreaEnd,rate:e.fps})}}},{key:"updatePlayhead",value:function(e){if(this.animation){var t=this.getMouseTime(e),n=Math.min(this.animation.duration,Math.max(0,t));this.animation.position=Math.round(n*this.animation.fps)/this.animation.fps}}},{key:"dragWaStart",value:function(e){this.context.nima.isDragging=!0,e.preventDefault(),this.animation&&(this.animation.workAreaStart=this.getMouseTime(e))}},{key:"dragWaEnd",value:function(e){this.context.nima.isDragging=!0,e.preventDefault(),this.animation&&(this.animation.workAreaEnd=this.getMouseTime(e))}},{key:"endWaDrag",value:function(e){this.context.nima.isDragging=!1,window.removeEventListener("mousemove",this.dragWaStart,!0),window.removeEventListener("mousemove",this.dragWaEnd,!0),window.removeEventListener("mouseup",this.endWaDrag,!0)}},{key:"componentDidMount",value:function(){this.setAnimation(this.props.animation)}},{key:"componentWillReceiveProps",value:function(e){e.animation&&e.animation!=this.animation&&this.setAnimation(e.animation)}},{key:"mouseDown",value:function(e){if(this.props.width&&this.props.workAreaActive){var t=(this.state.end-this.state.start)/(this.props.width-h-p),n=(this.state.waStart-this.state.start)/t+h,r=(this.state.waEnd-this.state.start)/t+h,o=e.clientX-this.props.left;Math.abs(o-n)<5?(window.addEventListener("mousemove",this.dragWaStart,!0),window.addEventListener("mouseup",this.endWaDrag,!0)):Math.abs(o-r)<5&&(window.addEventListener("mousemove",this.dragWaEnd,!0),window.addEventListener("mouseup",this.endWaDrag,!0))}window.addEventListener("mousemove",this.drag,!0),window.addEventListener("mouseup",this.endDrag,!0),this.updatePlayhead(e)}},{key:"drag",value:function(e){this.context.nima.isDragging=!0,e.preventDefault(),e.stopPropagation(),this.context.nima.editingAnimation.isPlaying=!1,this.updatePlayhead(e)}},{key:"endDrag",value:function(e){this.context.nima.isDragging=!1,window.removeEventListener("mousemove",this.drag,!0),window.removeEventListener("mouseup",this.endDrag,!0)}},{key:"shouldComponentUpdate",value:function(e,t){return e.workAreaActive!=this.props.workAreaActive||e.width!=this.props.width||t.start!=this.state.start||t.end!=this.state.end||t.waStart!=this.state.waStart||t.waEnd!=this.state.waEnd||t.rate!=this.state.rate||e.animation!=this.props.animation}},{key:"mouseLeave",value:function(e){u.default.remove(this)}},{key:"mouseMove",value:function(e){if(e.preventDefault(),this.props.width&&this.props.workAreaActive){var t=(this.state.end-this.state.start)/(this.props.width-20),n=(this.state.waStart-this.state.start)/t+h,r=(this.state.waEnd-this.state.start)/t+h,o=e.clientX-this.props.left;Math.abs(o-n)<5||Math.abs(o-r)<5?u.default.set(this,"ew-resize"):u.default.remove(this)}else u.default.remove(this)}},{key:"mouseWheel",value:function(e){console.log(e.wheelDeltaY)}},{key:"render",value:function(){var e=[],t=0,n=0;if(this.props.width){var r=(this.state.end-this.state.start)/(this.props.width-h-p),o=100*r,s=o,l=r,u="s",c=this.state.start,d=60;s<1&&(s=o*this.state.rate,l=r*this.state.rate,c*=this.state.rate,u="f",d=this.state.rate),s<1?s=1:s<3?s=2:(s=5*Math.round(s/5),s=d/Math.round(d/s));for(var f=s/l,y=Math.ceil(this.props.width/f+1),v=c/s,m=Math.floor(v)*s,g=-v%1*f,b=0;b<y;b++){var k=Math.floor(m%d);0==k&&(k=Math.floor(m/d),k=((k%=60)<10?"0"+k:k)+":00"),e.push(a.default.createElement("div",{className:"ApTimelineHeaderTickUnit",key:"t"+b,style:{width:f+"px"}},a.default.createElement("div",{className:"ApTimelineHeaderTick"}),a.default.createElement("div",{className:"ApTimelineHeaderUnit"},k,u))),m+=s}t=(this.state.waStart-this.state.start)/r+h,n=(this.state.waEnd-this.state.start)/r+h}return a.default.createElement("div",{onWheel:this.mouseWheel,className:"ApTimelineHeaderTicks",onMouseDown:this.mouseDown,style:{paddingLeft:h+"px",background:this.props.workAreaActive?"rgba(0,0,0,0.25)":null},onMouseMove:this.mouseMove,onMouseLeave:this.mouseLeave},a.default.createElement("div",{className:"WorkArea",style:{opacity:this.props.workAreaActive?1:0,left:t+"px",width:n-t+"px"}},a.default.createElement("div",{className:"WorkAreaLeftHandle"}),a.default.createElement("div",{className:"WorkAreaRightHandle"})),a.default.createElement(i.default,{animation:this.animation,width:this.props.width}),a.default.createElement("div",{style:{marginLeft:g+"px",pointerEvents:"none"}},e),a.default.createElement("div",{className:"HeaderTicksBottomBorder"}))}}]),t}()).prototype,"updateAnimation",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"updateAnimation"),r.prototype),f(r.prototype,"updatePlayhead",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"updatePlayhead"),r.prototype),f(r.prototype,"dragWaStart",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"dragWaStart"),r.prototype),f(r.prototype,"dragWaEnd",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"dragWaEnd"),r.prototype),f(r.prototype,"endWaDrag",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"endWaDrag"),r.prototype),f(r.prototype,"mouseDown",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),f(r.prototype,"drag",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"drag"),r.prototype),f(r.prototype,"endDrag",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"endDrag"),r.prototype),f(r.prototype,"mouseLeave",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseLeave"),r.prototype),f(r.prototype,"mouseMove",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseMove"),r.prototype),f(r.prototype,"mouseWheel",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseWheel"),r.prototype),r);t.default=y,y.contextTypes={nima:l.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(440));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=parseInt(s.default.timelineMarginLeft),d=parseFloat(s.default.timelineMarginRight),f=(u((r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"updatePosition",value:function(){if(this.animation){var e=(this.animation.displayEnd-this.animation.displayStart)/(this.props.width-c-d),t=(this.animation.position-this.animation.displayStart)/e+c;this.playbarHead.style.transform="scaleX(0.65) translate3D("+t/.65+"px, 0px, 0px)"}}},{key:"setPlaybarHead",value:function(e){this.playbarHead=e}},{key:"componentDidUpdate",value:function(){this.updatePosition()}},{key:"componentDidMount",value:function(){this.setAnimation(this.props.animation)}},{key:"componentWillUnmount",value:function(){this.setAnimation(null)}},{key:"setAnimation",value:function(e){this.animation&&(this.animation.removeEventListener("position",this.updatePosition),this.animation.removeEventListener("scrollChange",this.updatePosition)),this.animation=e,e&&(e.addEventListener("position",this.updatePosition),e.addEventListener("scrollChange",this.updatePosition))}},{key:"shouldComponentUpdate",value:function(e,t){return e.animation!=this.props.animation||this.props.width!=e.width}},{key:"componentWillReceiveProps",value:function(e){e.animation&&e.animation!=this.animation&&this.setAnimation(e.animation)}},{key:"render",value:function(){return i.default.createElement("div",{className:"PlaybarHead",ref:this.setPlaybarHead},i.default.createElement("div",null))}}]),t}()).prototype,"updatePosition",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updatePosition"),r.prototype),u(r.prototype,"setPlaybarHead",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setPlaybarHead"),r.prototype),r);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(440));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=parseInt(s.default.timelineMarginLeft),d=parseFloat(s.default.timelineMarginRight),f=(u((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={position:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"updatePosition",value:function(){if(this.playbar){var e=(this.animation.displayEnd-this.animation.displayStart)/(this.props.timelineWidth-c-d),t=this.animation.displayStart-c*e,n=this.animation.displayEnd+d*e;if(this.animation.position<t||this.animation.position>n)this.playbar.style.opacity=0;else{var r=c+(this.animation.position-this.animation.displayStart)/e;this.playbar.style.transform="translate3D("+r+"px, 0px, 0px)",this.playbar.style.opacity=1}}}},{key:"setPlaybar",value:function(e){this.playbar=e}},{key:"componentDidUpdate",value:function(){this.updatePosition()}},{key:"componentDidMount",value:function(){this.setAnimation(this.props.animation)}},{key:"setAnimation",value:function(e){this.animation&&(this.animation.removeEventListener("position",this.updatePosition),this.animation.removeEventListener("scrollChange",this.updatePosition)),this.animation=e,e&&(e.addEventListener("position",this.updatePosition),e.addEventListener("scrollChange",this.updatePosition)),this.updatePosition()}},{key:"shouldComponentUpdate",value:function(e,t){return e.animation!=this.props.animation||this.props.timelineWidth!=e.timelineWidth}},{key:"componentWillReceiveProps",value:function(e){e.animation&&e.animation!=this.animation&&this.setAnimation(e.animation)}},{key:"render",value:function(){return i.default.createElement("div",{className:"Playbar",ref:this.setPlaybar})}}]),t}()).prototype,"updatePosition",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updatePosition"),r.prototype),u(r.prototype,"setPlaybar",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setPlaybar"),r.prototype),r);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(1)),a=s(n(2));s(n(5));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var u=(l((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.contentHeight=0,n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"setContentHeight",value:function(e){this.contentHeight!==e&&(this.contentHeight=e,this.setState({contentHeight:e}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.drag,!0),window.removeEventListener("mouseup",this.stopDrag,!0)}},{key:"grab",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.grabber;if(t){var n=t.getBoundingClientRect();this.grabOffset=e.clientY-n.top,window.addEventListener("mousemove",this.drag,!0),window.addEventListener("mouseup",this.stopDrag,!0)}}},{key:"drag",value:function(e){var t=this.grabber,n=this.bar;if(t){var r=t.getBoundingClientRect(),o=n.getBoundingClientRect(),i=this.state.contentHeight;i||(i=this.props.contentHeight);var a=this.props.height,s=r.height,l=i-a,u=o.top-e.clientY+this.grabOffset,c=Math.max(0,Math.min(1,-u/(a-s)));this.props.onScroll&&this.props.onScroll(c*l)}}},{key:"stopDrag",value:function(e){window.removeEventListener("mousemove",this.drag,!0),window.removeEventListener("mouseup",this.stopDrag,!0)}},{key:"setBar",value:function(e){this.bar=e}},{key:"setGrabber",value:function(e){this.grabber=e}},{key:"render",value:function(){var e=this.props,t=e.height,n=e.contentHeight,r=e.scrollOffset,o=this.state.contentHeight;o||(o=n);var a=t/o*t,s=r/(o-t)*(t-a),l=a<t;return i.default.createElement("div",{ref:this.setBar,className:"Scrollbar",style:{height:t+"px"}},l?i.default.createElement("div",{ref:this.setGrabber,className:"ScrollbarGrabber",onMouseDown:this.grab,style:{height:a+"px",top:s+"px"}},i.default.createElement("div",null)):null)}}]),t}()).prototype,"grab",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"grab"),r.prototype),l(r.prototype,"drag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"drag"),r.prototype),l(r.prototype,"stopDrag",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"stopDrag"),r.prototype),l(r.prototype,"setBar",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setBar"),r.prototype),l(r.prototype,"setGrabber",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setGrabber"),r.prototype),r);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=M(n(1)),a=M(n(2)),s=M(n(5)),l=M(n(1237)),u=M(n(1238)),c=M(n(1239)),d=M(n(682)),f=M(n(504)),h=M(n(1242)),p=M(n(179)),y=M(n(195)),v=M(n(176)),m=M(n(253)),g=M(n(266)),b=M(n(348)),k=M(n(304)),S=M(n(424)),O=M(n(349)),w=M(n(422)),_=M(n(423)),P=M(n(428)),C=M(n(425)),E=M(n(427)),T=M(n(426)),I=M(n(385)),j=M(n(1243)),A=M(n(1244)),D=M(n(1245)),R=M(n(3));function M(e){return e&&e.__esModule?e:{default:e}}function x(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var F=[I.default,j.default,A.default,D.default],L=[y.default,v.default,m.default,g.default],N=(x((r=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){var e=this.context.nima;e.addEventListener("fileLoaded",this.onFileLoaded);var t=e.stage,n=this.boneLayerOptions=[],r=!0,o=!1,a=void 0;try{for(var s,l=L[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value;n.push(t.getLayerOptions(u))}}catch(e){o=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw a}}var c=t.getLayerOptions(p.default);this.imageLayerOptions=c;var d=t.settings;this.setState({isReadOnly:!e.hasWriteAccess,selectedTool:t.toolType,selectedFilter:t.selectedFilter,zoom:t.zoom,imageSelectionState:1,imageVisibilityState:1,boneSelectionState:1,boneVisibilityState:1,gridAxisState:1,gridSubdivideState:1,selectionPopup:{icon:R.default.make("/images/symbol-defs.svg#icon-cursor"),showLegend:!0,options:[{icon:R.default.make("/images/symbol-defs.svg#icon-picture"),className:"ImageToggle",activeState:function(){return c.disableSelection?0:1},toggle:function(){c.disableSelection=!c.disableSelection}},{icon:R.default.make("/images/symbol-defs.svg#icon-bone"),className:"BoneToggle",activeState:function(){return n[0].disableSelection?0:1},toggle:function(){var e=!n[0].disableSelection,t=!0,r=!1,o=void 0;try{for(var i,a=n[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.disableSelection=e}}catch(e){r=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw o}}}}]},visibilityPopup:{icon:R.default.make("/images/symbol-defs.svg#icon-eye"),showLegend:!0,options:[{icon:R.default.make("/images/symbol-defs.svg#icon-picture"),className:"ImageToggle",activeState:function(){return c.disableDraw?0:c.mode==p.default.RenderModes.Regular?1:2},toggle:function(){var e=c.disableDraw?0:c.mode==p.default.RenderModes.Regular?1:2;switch(e=(e+1)%3){case 0:c.disableDraw=!0,c.mode=p.default.RenderModes.Regular;break;case 1:c.disableDraw=!1,c.mode=p.default.RenderModes.Regular;break;case 2:c.disableDraw=!1,c.mode=p.default.RenderModes.Dim}},tip:{label:"Show Images"}},{icon:R.default.make("/images/symbol-defs.svg#icon-bone"),className:"BoneToggle",activeState:function(){return n[0].disableDraw?0:1},toggle:function(){var e=!n[0].disableDraw,t=!0,r=!1,o=void 0;try{for(var i,a=n[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){i.value.disableDraw=e}}catch(e){r=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw o}}},tip:{label:"Show Bones"}}]},axisPopup:{icon:R.default.make("/images/symbol-defs.svg#icon-axis"),showLegend:!1,isRadio:!0,closeOnSelect:!0,get extraIcon(){switch(t.transformSpace){case 0:return i.default.createElement("div",{className:"AxisSpace"},"L");case 1:return i.default.createElement("div",{className:"AxisSpace"},"P");case 2:return i.default.createElement("div",{className:"AxisSpace"},"W")}return null},options:[{icon:null,useTxtLabel:!0,txtLabel:"Local",get className(){return 0===t.transformSpace?"TextToggleActive":"TextToggle"},activeState:function(){return 0===t.transformSpace?1:0},toggle:function(){t.transformSpace=0}},{icon:null,useTxtLabel:!0,txtLabel:"Parent",get className(){return 1===t.transformSpace?"TextToggleActive":"TextToggle"},activeState:function(){return 1===t.transformSpace?1:0},toggle:function(){t.transformSpace=1}},{icon:null,useTxtLabel:!0,txtLabel:"World",get className(){return 2===t.transformSpace?"TextToggleActive":"TextToggle"},activeState:function(){return 2===t.transformSpace?1:0},toggle:function(){t.transformSpace=2}}]},gridPopup:{icon:function(){return d.showGridAxis||d.showGridSubdivisions?d.showGridAxis?d.showGridSubdivisions?R.default.make("/images/symbol-defs.svg#icon-grid-sub-axis"):R.default.make("/images/symbol-defs.svg#icon-grid-axis"):R.default.make("/images/symbol-defs.svg#icon-grid-sub"):R.default.make("/images/symbol-defs.svg#icon-grid-none")},showLegend:!1,options:[{icon:R.default.make("/images/symbol-defs.svg#icon-grid-axis"),className:"GridAxisToggle",activeState:function(){return d.showGridAxis?1:0},toggle:function(){d.showGridAxis=!d.showGridAxis},tip:{label:"Show Grid Axis"}},{icon:R.default.make("/images/symbol-defs.svg#icon-grid-sub"),className:"GridSubToggle",activeState:function(){return d.showGridSubdivisions?1:0},toggle:function(){d.showGridSubdivisions=!d.showGridSubdivisions},tip:{label:"Show Grid"}},{icon:R.default.make("/images/symbol-defs.svg#icon-rulers"),className:"GridSubToggle",activeState:function(){return e.getPreference("showGuides")?1:0},toggle:function(){e.setProjectPreference("showGuides",!e.getPreference("showGuides"))},tip:{label:"Rulers",actions:[{label:"Show/Hide",action:f.default.Actions.ToggleRulers},{label:"Reset",action:f.default.Actions.ResetRulers}]}}]}})}},{key:"onFileLoaded",value:function(){this.setState({isReadOnly:!this.context.nima.hasWriteAccess})}},{key:"componentDidMount",value:function(){this.updateToggles(),this.context.nima.stage.addEventListener("toolChanged",this.onToolChanged),this.context.nima.stage.addEventListener("selectionFilterChanged",this.onFilterChanged),this.context.nima.stage.addEventListener("zoomChanged",this.onZoomChanged),this.context.nima.stage.addEventListener("updateLayerOptions",this.onLayerOptionsChanged)}},{key:"setAnimationMode",value:function(e){var t=!!e;this.createGroup&&(this.createGroup.flyout.style.display=t?"none":"")}},{key:"setCreateGroup",value:function(e){this.createGroup=e}},{key:"onLayerOptionsChanged",value:function(){this.updateToggles()}},{key:"updateToggles",value:function(){var e={};this.imageLayerOptions.disableDraw?e.imageVisibilityState=0:this.imageLayerOptions.mode==p.default.RenderModes.Regular?e.imageVisibilityState=1:this.imageLayerOptions.mode==p.default.RenderModes.Dim&&(e.imageVisibilityState=2),this.imageLayerOptions.disableSelection?e.imageSelectionState=0:e.imageSelectionState=1;var t=this.boneLayerOptions[0];e.boneSelectionState=t.disableSelection?0:1,e.boneVisibilityState=t.disableDraw?0:1;var n=this.context.nima.stage;n.settings.showGridAxis?e.gridAxisState=1:e.gridAxisState=0,n.settings.showGridSubdivisions?e.gridSubdivideState=1:e.gridSubdivideState=0,this.setState(e),this.context.nima.stage.redraw()}},{key:"onToolChanged",value:function(e){this.setState({selectedTool:this.context.nima.stage.toolType})}},{key:"onFilterChanged",value:function(e){this.setState({selectedFilter:e})}},{key:"onZoomChanged",value:function(e){this.setState({zoom:e})}},{key:"toolSelected",value:function(e){this.context.nima.stage.toolType=e}},{key:"filterSelected",value:function(e){this.context.nima.stage.selectionFilter=new e}},{key:"componentWillUnmount",value:function(){var e=this.context.nima;e.removeEventListener("fileLoaded",this.onFileLoaded),e.stage.removeEventListener("toolChanged",this.toolChanged),e.stage.removeEventListener("zoomChanged",this.onZoomChanged),e.stage.removeEventListener("selectionFilterChanged",this.onFilterChanged),e.stage.removeEventListener("updateLayerOptions",this.onLayerOptionsChanged)}},{key:"zoomInputChanged",value:function(e){this.context.nima.stage.zoom=e}},{key:"selectionOptionsChanged",value:function(e,t){e%=2,t%=2,this.imageLayerOptions.disableSelection=0==e;var n=!0,r=!1,o=void 0;try{for(var i,a=this.boneLayerOptions[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.disableSelection=0==t}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.updateToggles()}},{key:"visibilityOptionsChanged",value:function(e,t){switch(t%=2,e%=3){case 0:this.imageLayerOptions.disableDraw=!0,this.imageLayerOptions.mode=p.default.RenderModes.Regular;break;case 1:this.imageLayerOptions.disableDraw=!1,this.imageLayerOptions.mode=p.default.RenderModes.Regular;break;case 2:this.imageLayerOptions.disableDraw=!1,this.imageLayerOptions.mode=p.default.RenderModes.Dim}var n=!0,r=!1,o=void 0;try{for(var i,a=this.boneLayerOptions[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.disableDraw=0===t}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}this.updateToggles()}},{key:"gridOptionsChanged",value:function(e,t){e%=2,t%=2;var n=this.context.nima.stage;n.settings.showGridAxis=1==e,n.settings.showGridSubdivisions=1==t,this.updateToggles()}},{key:"setMeshMode",value:function(e){if(this.setState({meshMode:e}),clearTimeout(this.myTimeout),e)this.setState({meshVisibility:!0});else{var t=this;this.myTimeout=setTimeout(function(){t.setState({meshVisibility:!1})},400)}}},{key:"setWeightsMode",value:function(e){if(this.setState({weightsMode:e}),clearTimeout(this.myTimeout),e)this.setState({weightVisibility:!0}),this.meshVisibilityRef&&this.meshVisibilityRef.setToggleValue(this.context.nima.editingWeights.isMeshVisible);else{var t=this;this.myTimeout=setTimeout(function(){t.setState({weightVisibility:!1})},400)}}},{key:"toggleMeshVisibility",value:function(e){var t=this.context.nima.editingWeights;t&&(t.isMeshVisible=e)}},{key:"translatePanelOut",value:function(e,t){if(e){var n=this;this.translateTimeout=setTimeout(function(){n.toolbar.style.display="none"},400)}else this.toolbar.style.display=null,clearTimeout(this.translateTimeout);var r=this.toolbar.getBoundingClientRect();this.toolbar.style.transform=e?"translate3D("+(r.width+(t?200:0))+"px, 0, 0)":"translate3D(0px, 0, 0)"}},{key:"setToolbar",value:function(e){this.toolbar=e}},{key:"setMeshVisibilityRef",value:function(e){this.meshVisibilityRef=e}},{key:"incSelectionFilter",value:function(e){var t=this.context.nima.stage.selectionFilter&&F.indexOf(this.context.nima.stage.selectionFilter.constructor)||0;-1===t?t=0:(t=(t+e)%F.length)<0&&(t+=F.length);var n=F[t];this.context.nima.stage.selectionFilter=new n}},{key:"render",value:function(){return i.default.createElement("div",{id:"Toolbar",ref:this.setToolbar,style:{right:this.props.settingsOpen?"200px":"0px"}},i.default.createElement("div",{className:"WeightsToolbar",style:{opacity:this.state.weightsMode?"1":"0",visibility:this.state.weightVisibility?"visible":"hidden"}},i.default.createElement("div",{className:"ToolGroup"},i.default.createElement(u.default,{type:b.default,cssID:"PaintWeightTool",icon:R.default.make("/images/symbol-defs.svg#icon-brush"),onSelected:this.toolSelected,isSelected:this.state.selectedTool==b.default,tip:{label:"Paint Weights",action:null}}),i.default.createElement(u.default,{type:k.default,cssID:"VertexWeightTool",icon:R.default.make("/images/symbol-defs.svg#icon-select-vertices"),onSelected:this.toolSelected,isSelected:this.state.selectedTool==k.default,tip:{label:"Set Vertex Weight",action:null}})),i.default.createElement("div",{className:"ToolGroup"},i.default.createElement(h.default,{name:"MeshVisibility",ref:this.setMeshVisibilityRef,onToggle:this.toggleMeshVisibility})),i.default.createElement(c.default,{cssID:"VisibilityOptions",data:this.state.visibilityPopup,onChange:this.visibilityOptionsChanged,tip:{label:"Visibility Options"}}),i.default.createElement("div",{className:"ToolGroup"},i.default.createElement(d.default,{value:this.state.zoom,valueChanged:this.zoomInputChanged,tip:{label:"Zoom",actions:[{label:"In",action:f.default.Actions.ZoomIn},{label:"Out",action:f.default.Actions.ZoomOut},{label:"Actual Size",action:f.default.Actions.Zoom100},{label:"Fit",action:f.default.Actions.ZoomFit}]}}))),i.default.createElement("div",{className:"MeshToolbar",style:{opacity:this.state.meshMode?"1":"0",visibility:this.state.meshVisibility?"visible":"hidden"}},i.default.createElement("div",{className:"ToolGroup"},i.default.createElement(u.default,{type:P.default,cssID:"DrawMeshTool",icon:R.default.make("/images/symbol-defs.svg#icon-pen"),onSelected:this.toolSelected,isSelected:this.state.selectedTool==P.default,tip:{label:"Pen Tool",action:null}})),i.default.createElement("div",{className:"ToolGroup"},i.default.createElement(d.default,{value:this.state.zoom,valueChanged:this.zoomInputChanged,tip:{label:"Zoom",actions:[{label:"In",action:f.default.Actions.ZoomIn},{label:"Out",action:f.default.Actions.ZoomOut},{label:"Actual Size",action:f.default.Actions.Zoom100},{label:"Fit",action:f.default.Actions.ZoomFit}]}}))),i.default.createElement("div",{className:"DefaultToolbar",style:{transform:this.state.meshMode||this.state.weightsMode?"translate3D(100%, 0, 0)":null}},i.default.createElement("div",{className:"ToolGroup"},i.default.createElement(u.default,{type:O.default,cssID:"TranslateTool",icon:R.default.make("/images/symbol-defs.svg#icon-move"),onSelected:this.toolSelected,isSelected:this.state.selectedTool==O.default,tip:{label:"Translate",action:f.default.Actions.TranslateTool}}),i.default.createElement(u.default,{type:w.default,cssID:"RotateTool",icon:R.default.make("/images/symbol-defs.svg#icon-rotate"),onSelected:this.toolSelected,isSelected:this.state.selectedTool==w.default,tip:{label:"Rotate",action:f.default.Actions.RotateTool}}),i.default.createElement(u.default,{type:_.default,cssID:"ScaleTool",icon:R.default.make("/images/symbol-defs.svg#icon-scale"),onSelected:this.toolSelected,isSelected:this.state.selectedTool==_.default,tip:{label:"Scale",action:f.default.Actions.ScaleTool}}),i.default.createElement(u.default,{type:S.default,cssID:"IKTool",icon:R.default.make("/images/symbol-defs.svg#icon-arrow-divert"),onSelected:this.toolSelected,isSelected:this.state.selectedTool==S.default,tip:{label:"IK Pose",action:f.default.Actions.IKTool}})),i.default.createElement(l.default,{isStageTool:!0,ref:this.setCreateGroup,addClass:"CreateTools",iconHref:R.default.make("/images/symbol-defs.svg#icon-plus"),selectedType:this.context.nima.stage.toolType,tip:{label:"Create Tools"}},i.default.createElement(u.default,{type:C.default,cssID:"CreateBoneTool",icon:R.default.make("/images/symbol-defs.svg#icon-bone-add"),onSelected:this.toolSelected,isSelected:this.state.selectedTool==C.default,tip:{label:"Create Bone",action:f.default.Actions.BoneTool}}),i.default.createElement(u.default,{type:T.default,cssID:"CreateNodeTool",icon:R.default.make("/images/symbol-defs.svg#icon-node-add"),onSelected:this.toolSelected,isSelected:this.state.selectedTool==T.default,tip:{label:"Create Node",action:f.default.Actions.NodeTool}}),i.default.createElement(u.default,{type:E.default,icon:R.default.make("/images/symbol-defs.svg#icon-solo-add"),onSelected:this.toolSelected,isSelected:this.state.selectedTool==E.default,tip:{label:"Create Solo Node",action:f.default.Actions.SoloTool}})),i.default.createElement(l.default,{addClass:"SelectionFilters",showActive:!0,iconHref:R.default.make("/images/symbol-defs.svg#icon-select-all"),selectedType:this.state.selectedFilter&&this.state.selectedFilter.constructor,tip:{label:"Selection Modes",actions:[{label:"Next",action:f.default.Actions.NextSelectionFilter},{label:"Prev",action:f.default.Actions.PreviousSelectionFilter}]}},i.default.createElement(u.default,{type:I.default,cssID:"SelectionFilter",icon:R.default.make("/images/symbol-defs.svg#icon-select-all"),onSelected:this.filterSelected,isSelected:this.state.selectedFilter&&this.state.selectedFilter.constructor==I.default,tip:{label:"Select Anything",action:f.default.Actions.AllSelectionFilter}}),i.default.createElement(u.default,{type:j.default,cssID:"BoneSelectionFilter",icon:R.default.make("/images/symbol-defs.svg#icon-select-bones"),onSelected:this.filterSelected,isSelected:this.state.selectedFilter&&this.state.selectedFilter.constructor==j.default,tip:{label:"Select Bones",action:f.default.Actions.BoneSelectionFilter}}),i.default.createElement(u.default,{type:A.default,cssID:"ImageSelectionFilter",icon:R.default.make("/images/symbol-defs.svg#icon-select-images"),onSelected:this.filterSelected,isSelected:this.state.selectedFilter&&this.state.selectedFilter.constructor==A.default,tip:{label:"Select Images",action:f.default.Actions.ImageSelectionFilter}}),i.default.createElement(u.default,{type:D.default,cssID:"VertexSelectionFilter",icon:R.default.make("/images/symbol-defs.svg#icon-select-vertices"),onSelected:this.filterSelected,isSelected:this.state.selectedFilter&&this.state.selectedFilter.constructor==D.default,tip:{label:"Select Vertices",action:f.default.Actions.VertexSelectionFilter}})),i.default.createElement(c.default,{cssID:"VisibilityOptions",data:this.state.visibilityPopup,onChange:this.visibilityOptionsChanged,tip:{label:"Visibility Options"}}),i.default.createElement(c.default,{cssID:"AxisOptions",data:this.state.axisPopup,onChange:this.visibilityOptionsChanged,tip:{label:"Axis Options"}}),i.default.createElement(c.default,{cssID:"GridOptions",data:this.state.gridPopup,tip:{label:"Grid Options"},onChange:this.gridOptionsChanged}),i.default.createElement("div",{className:"ToolGroup"},i.default.createElement(d.default,{value:this.state.zoom,valueChanged:this.zoomInputChanged,tip:{label:"Zoom",actions:[{label:"In",action:f.default.Actions.ZoomIn},{label:"Out",action:f.default.Actions.ZoomOut},{label:"Actual Size",action:f.default.Actions.Zoom100},{label:"Fit",action:f.default.Actions.ZoomFit}]}})),i.default.createElement("div",{className:"ToolGroup"},this.state.isReadOnly?null:i.default.createElement(u.default,{cssID:"ExportButton",icon:R.default.make("/images/symbol-defs.svg#icon-export"),onSelected:this.props.onGotoExport,tip:{label:"Export"}}),i.default.createElement(u.default,{cssID:"SettingsButton",isActive:this.props.settingsOpen,onSelected:this.props.onSettingsToggled,icon:R.default.make(this.props.settingsOpen?"/images/symbol-defs.svg#icon-cog-selected":"/images/symbol-defs.svg#icon-cog"),tip:{label:"Settings"}}))))}}]),t}()).prototype,"onFileLoaded",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onFileLoaded"),r.prototype),x(r.prototype,"setCreateGroup",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setCreateGroup"),r.prototype),x(r.prototype,"onLayerOptionsChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onLayerOptionsChanged"),r.prototype),x(r.prototype,"updateToggles",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateToggles"),r.prototype),x(r.prototype,"onToolChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onToolChanged"),r.prototype),x(r.prototype,"onFilterChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onFilterChanged"),r.prototype),x(r.prototype,"onZoomChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onZoomChanged"),r.prototype),x(r.prototype,"toolSelected",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toolSelected"),r.prototype),x(r.prototype,"filterSelected",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"filterSelected"),r.prototype),x(r.prototype,"zoomInputChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"zoomInputChanged"),r.prototype),x(r.prototype,"selectionOptionsChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"selectionOptionsChanged"),r.prototype),x(r.prototype,"visibilityOptionsChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"visibilityOptionsChanged"),r.prototype),x(r.prototype,"gridOptionsChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"gridOptionsChanged"),r.prototype),x(r.prototype,"toggleMeshVisibility",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleMeshVisibility"),r.prototype),x(r.prototype,"setToolbar",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setToolbar"),r.prototype),x(r.prototype,"setMeshVisibilityRef",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setMeshVisibilityRef"),r.prototype),r);t.default=N,N.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(5));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hover:!1,isOpen:!1,popupOpacity:0,isActive:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"mouseOver",value:function(){this.state.isOpen||this.context.tooltip.enter(this),this.setState({hover:!0})}},{key:"mouseOut",value:function(){this.context.tooltip.leave(this),this.setState({hover:!1})}},{key:"mouseDown",value:function(e){this.context.tooltip.click(this),this.open()}},{key:"open",value:function(){window.addEventListener("mousedown",this.close,!0),clearTimeout(this.timeout),this.setState({popupOpacity:1,isOpen:!0})}},{key:"close",value:function(){var e;window.removeEventListener("mousedown",this.close,!0),this.setState({isOpen:!1}),this.timeout=setTimeout((e=this,function(){e.setState({popupOpacity:0})}),125)}},{key:"componentWillReceiveProps",value:function(e){e.selectedType!=this.props.selectedType&&this.checkActive(e.selectedType)}},{key:"checkActive",value:function(e){var t=this.props.children;if(t){this.childToolActive=!1,this.activeIcon=null;for(var n=0;n<t.length;n++){var r=t[n];if(r&&r.props.type==e){this.childToolActive=!0,this.activeIcon=r.props.icon;break}}this.childToolActive?this.setState({isActive:!0}):this.setState({isActive:!1})}}},{key:"componentDidUpdate",value:function(){this.togglesSizeCalc&&(this.togglesWidth=this.togglesSizeCalc.getBoundingClientRect().width)}},{key:"setTogglesSizeCalc",value:function(e){this.togglesSizeCalc=e}},{key:"setFlyout",value:function(e){this.flyout=e}},{key:"render",value:function(){var e=this.props.isStageTool&&this.state.isActive;return i.default.createElement("div",{ref:this.setFlyout,className:this.props.addClass?"Flyout "+this.props.addClass:"Flyout",onMouseDown:this.mouseDown,onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut,id:this.props.type},i.default.createElement("div",{className:this.state.isOpen?"ToolSelectedPopup ToolSelectedPopupOpen":"ToolSelectedPopup",style:{opacity:this.state.popupOpacity,width:this.state.isOpen?this.togglesWidth+60+"px":null,left:this.state.isOpen?-this.togglesWidth+"px":null}},i.default.createElement("div",{className:"ToggleWrapper",style:{width:this.state.isOpen?this.togglesWidth+"px":""}},i.default.createElement("div",{ref:this.setTogglesSizeCalc,className:"TogglesSizeCalc"},this.props.children))),i.default.createElement("div",{className:this.state.isOpen?"ToolPopupArrow ToolPopupArrowOpen":"ToolPopupArrow"}),i.default.createElement("div",{className:"FlyoutIcon"},i.default.createElement("svg",{className:"ToolIcon",style:{fill:e&&!this.state.isOpen?"#fff":this.state.hover||this.state.isOpen?"#333":null}},i.default.createElement("use",{xlinkHref:this.props.showActive?this.activeIcon||this.props.iconHref:this.state.isActive&&!this.state.isOpen?this.activeIcon:this.props.iconHref})),i.default.createElement("div",{className:"ToolSelected",style:{opacity:e&&!this.state.isOpen?1:0}})))}}]),t}()).prototype,"mouseOver",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOver"),r.prototype),u(r.prototype,"mouseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOut"),r.prototype),u(r.prototype,"mouseDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),u(r.prototype,"open",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"open"),r.prototype),u(r.prototype,"close",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"close"),r.prototype),u(r.prototype,"setTogglesSizeCalc",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTogglesSizeCalc"),r.prototype),u(r.prototype,"setFlyout",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setFlyout"),r.prototype),r);t.default=c,c.contextTypes={nima:s.default.object,tooltip:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(5));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"mouseOver",value:function(){this.context.tooltip.enter(this),this.setState({hover:!0})}},{key:"mouseOut",value:function(){this.context.tooltip.leave(this),this.setState({hover:!1})}},{key:"click",value:function(e){e.stopPropagation(),this.context.tooltip.click(this),this.props.onSelected&&this.props.onSelected(this.props.type,e)}},{key:"render",value:function(){var e;this.props.icon&&(e=this.props.icon);var t=void 0!==this.props.isSelected;return i.default.createElement("div",{className:"ToolButton",onClick:this.click,onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut,id:this.props.cssID},t?i.default.createElement("div",{className:"ToolSelected",style:{opacity:this.props.isSelected?1:0}}):null,i.default.createElement("svg",{className:this.props.isSelected?"ToolIcon ToolIconActive":"ToolIcon",style:{fill:this.props.isActive?"#000":null}},i.default.createElement("use",{xlinkHref:e})))}}]),t}()).prototype,"mouseOver",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOver"),r.prototype),u(r.prototype,"mouseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOut"),r.prototype),u(r.prototype,"click",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"click"),r.prototype),r);t.default=c,c.contextTypes={tooltip:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(2)),s=c(n(5)),l=c(n(1240)),u=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hover:!1,isOpen:!1,popupOpacity:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"mouseOver",value:function(){this.state.isOpen||this.context.tooltip.enter(this),this.setState({hover:!0})}},{key:"mouseOut",value:function(){this.context.tooltip.leave(this),this.setState({hover:!1})}},{key:"mouseDown",value:function(e){this.context.tooltip.click(this),this.open()}},{key:"open",value:function(){window.addEventListener("mousedown",this.close,!0),clearTimeout(this.timeout),this.setState({popupOpacity:1,isOpen:!0})}},{key:"close",value:function(){var e;window.removeEventListener("mousedown",this.close,!0),this.setState({isOpen:!1}),this.timeout=setTimeout((e=this,function(){e.setState({popupOpacity:0})}),125)}},{key:"setTogglesSizeCalc",value:function(e){this.togglesSizeCalc=e}},{key:"componentDidUpdate",value:function(){this.togglesWidth=this.togglesSizeCalc.getBoundingClientRect().width}},{key:"render",value:function(){var e,t=["OptionHighlightNone","OptionHighlightAll","OptionHighlightSome"],n=["OptionStatusOff","OptionStatus","OptionStatusHalf"],r=this.props.data,o=[],a=this,s=[0,0,0],c=!1;if(r){e=r.icon&&r.icon.constructor===Function?r.icon():r.icon,c=r.showLegend;for(var d=0;d<r.options.length;d++){var f=r.options[d],h=function(e){return function(t){if(a.props.data.radio)for(var n=0;n<r.options.length;n++){var o=r.options[n];o!==e&&o.activeState()&&o.toggle()}e.toggle(),a.forceUpdate(),a.context.nima.stage.redraw(),r.closeOnSelect&&a.close()}}(f),p=function(e){return function(t){e.isMouseOver=!0,a.forceUpdate()}}(f),y=function(e){return function(t){e.isMouseOver=!1,a.forceUpdate()}}(f),v=f.activeState();d<3&&(s[d]=v),o.push(i.default.createElement(l.default,{key:d,className:f.className,onClick:h,onMouseEnter:p,onMouseLeave:y,tip:f.tip},f.useTxtLabel?i.default.createElement("div",{className:"ToolIcon"},f.txtLabel):i.default.createElement("svg",{className:"ToolIcon"+(f.isMouseOver?" ToolIconHover":"")},i.default.createElement("use",{xlinkHref:f.icon})),f.useTxtLabel?null:i.default.createElement("div",{className:"OptionHighlight "+t[v]})))}45*r.options.length,45*r.options.length}return i.default.createElement("div",{className:"ToolButton",onMouseDown:this.mouseDown,onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut,id:this.props.cssID},i.default.createElement("div",{className:this.state.isOpen?"ToolSelectedPopup ToolSelectedPopupOpen":"ToolSelectedPopup",style:{opacity:this.state.popupOpacity,width:this.state.isOpen?this.togglesWidth+60+"px":null,left:this.state.isOpen?-this.togglesWidth+"px":null}},i.default.createElement("div",{className:"ToggleWrapper",style:{width:this.state.isOpen?this.togglesWidth+"px":""}},i.default.createElement("div",{ref:this.setTogglesSizeCalc,className:"TogglesSizeCalc"},o))),i.default.createElement("svg",{className:this.state.isOpen?"ToolPopupArrow ToolPopupArrowOpen":"ToolPopupArrow"},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-popup-arrow")})),c?i.default.createElement("div",{className:"OptionStatuses"},i.default.createElement("div",{className:n[s[0]]}),i.default.createElement("div",{className:n[s[1]]}),o.length>2?i.default.createElement("div",{className:n[s[2]]}):null):null,r.extraIcon||null,i.default.createElement("svg",{className:"ToolIcon"+(this.state.hover||this.state.isOpen?" ToolIconFlyActive":"")},i.default.createElement("use",{xlinkHref:e})))}}]),t}()).prototype,"mouseOver",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOver"),r.prototype),d(r.prototype,"mouseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOut"),r.prototype),d(r.prototype,"mouseDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),d(r.prototype,"open",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"open"),r.prototype),d(r.prototype,"close",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"close"),r.prototype),d(r.prototype,"setTogglesSizeCalc",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTogglesSizeCalc"),r.prototype),r);t.default=f,f.contextTypes={nima:s.default.object,tooltip:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(5));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"click",value:function(e){this.context.tooltip.click(this),this.props.onClick&&this.props.onClick(e)}},{key:"mouseEnter",value:function(e){this.context.tooltip.enter(this),this.props.onMouseEnter&&this.props.onMouseEnter(e)}},{key:"mouseLeave",value:function(e){this.context.tooltip.leave(this),this.props.onMouseLeave&&this.props.onMouseLeave(e)}},{key:"render",value:function(){return i.default.createElement("div",{className:this.props.className,onClick:this.click,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave},this.props.children)}}]),t}()).prototype,"click",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"click"),r.prototype),u(r.prototype,"mouseEnter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseEnter"),r.prototype),u(r.prototype,"mouseLeave",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseLeave"),r.prototype),r);t.default=c,c.contextTypes={tooltip:s.default.object}},function(e,t,n){(t=e.exports=n(13)(!1)).push([e.i,".source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-Toolbar-3nb9a {\n  font-weight: 400;\n  height: 60px;\n  background: rgba(29, 29, 29, 0.9);\n  position: absolute;\n  top: 0;\n  left: 300px;\n  right: 200px;\n  -webkit-backdrop-filter: blur(20px);\n          backdrop-filter: blur(20px);\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  pointer-events: auto;\n  padding: 0 10px;\n  -webkit-transition: margin-right 0.4s cubic-bezier(0.8, 0, 0, 1);\n  transition: margin-right 0.4s cubic-bezier(0.8, 0, 0, 1);\n  z-index: 2001; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarDivider-2LcUF {\n  position: absolute;\n  height: 1px;\n  bottom: 0px;\n  left: 20px;\n  right: 20px;\n  background: #fff;\n  opacity: .1; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButton-Q6LcJ {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  height: 50px;\n  padding: 0 10px;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  position: relative; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButton-Q6LcJ svg {\n  opacity: .4;\n  -webkit-transition: opacity 0.1s ease-in-out, fill 0.1s ease-in-out;\n  transition: opacity 0.1s ease-in-out, fill 0.1s ease-in-out; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButton-Q6LcJ:hover .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButtonIcon-dUimn {\n  opacity: 1; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButtonSelected-3CKIJ .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuIcon-3tht2,\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButtonSelected-3CKIJ .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuLabel-39rCn,\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButtonSelected-3CKIJ .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuShortcut-3atX1 {\n  opacity: 1;\n  font-weight: 600;\n  letter-spacing: -0.1px; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButtonIcon-dUimn {\n  width: 20px;\n  height: 20px;\n  fill: #fff; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButtonDisabled-1AhfQ {\n  opacity: .25;\n  pointer-events: none; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarDropdownArrow-2li1x {\n  width: 5px;\n  height: 5px;\n  fill: #fff;\n  opacity: 0.6;\n  margin-left: 5px;\n  -webkit-transition: opacity 0.1s ease-in-out;\n  transition: opacity 0.1s ease-in-out; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenu-2uYy3,\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRight-2CxtA,\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarSubMenu-2biFb {\n  background: rgba(51, 51, 51, 0.95);\n  -webkit-backdrop-filter: blur(20px);\n          backdrop-filter: blur(20px);\n  width: 200px;\n  position: absolute;\n  left: 10px;\n  top: 50px;\n  border-radius: 5px;\n  padding: 10px 0;\n  -webkit-box-shadow: 0 50px 100px rgba(0, 0, 0, 0.5);\n          box-shadow: 0 50px 100px rgba(0, 0, 0, 0.5);\n  color: #fff;\n  z-index: 2001;\n  -webkit-transition: opacity 0.1s ease-out;\n  transition: opacity 0.1s ease-out; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRight-2CxtA {\n  left: initial;\n  right: 10px; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarSubMenu-2biFb {\n  left: 100%;\n  top: 0; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRow-2POs_ {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  height: 40px;\n  padding: 0 20px;\n  -webkit-transition: background 0.1s ease-in-out;\n  transition: background 0.1s ease-in-out;\n  position: relative;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuIcon-3tht2,\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuIconBone-1WBhq {\n  width: 20px;\n  height: 20px;\n  fill: #fff;\n  margin-right: 8px;\n  opacity: .4;\n  -webkit-transition: opacity 0.1s ease-in-out;\n  transition: opacity 0.1s ease-in-out; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuIconBone-1WBhq {\n  width: 15px;\n  height: 15px;\n  margin: 3px 11px 2px 2px; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuLabel-39rCn {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  opacity: .5;\n  -webkit-transition: opacity 0.1s ease-in-out;\n  transition: opacity 0.1s ease-in-out;\n  color: #fff; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuShortcut-3atX1 {\n  opacity: .5;\n  -webkit-transition: opacity 0.1s ease-in-out;\n  transition: opacity 0.1s ease-in-out;\n  color: #fff; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRow-2POs_:hover {\n  background: rgba(255, 255, 255, 0.03); }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRow-2POs_:hover > .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuIcon-3tht2,\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRow-2POs_:hover > .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuLabel-39rCn,\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRow-2POs_:hover > .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuShortcut-3atX1,\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRow-2POs_:hover > .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuExpand-1ZER4 {\n  opacity: 1; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuDivider-2_MBB {\n  height: 1px;\n  background: #fff;\n  opacity: .08;\n  margin: 10px 0; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuExpand-1ZER4 {\n  width: 6px;\n  height: 9px;\n  fill: #fff;\n  opacity: 0.5;\n  margin-left: 5px;\n  -webkit-transition: opacity 0.1s ease-in-out;\n  transition: opacity 0.1s ease-in-out; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarSpacer-ATjFZ {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ZoomInput-121u6 {\n  text-align: center;\n  width: 60px;\n  height: 40px;\n  padding: 0;\n  border: 0;\n  outline: 0;\n  background: none;\n  font-size: 13px;\n  color: #fff;\n  opacity: .4;\n  -webkit-transition: opacity 0.1s ease-in-out;\n  transition: opacity 0.1s ease-in-out; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ZoomInput-121u6:hover {\n  opacity: 1; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ZoomInput-121u6:focus, .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ZoomInput-121u6:active {\n  opacity: 1; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ActiveTransformTool-1IjIA {\n  fill: #FF5678;\n  opacity: 1 !important; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ActiveCreateTool-xOzP8 {\n  fill: #33A7FF;\n  opacity: 1 !important; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-VertexToolbarWrapper-JZ7DO {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-VertexToolbarWrapper-JZ7DO .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRow-2POs_ {\n  padding: 0 10px; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-VertexToolbarWrapper-JZ7DO .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRow-2POs_:hover {\n  background: none; }\n\n.source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-VertexToolbarWrapper-JZ7DO .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRow-2POs_ .source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuIcon-3tht2 {\n  margin-right: 5px; }\n",""]),t.locals={Toolbar:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-Toolbar-3nb9a",ToolbarDivider:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarDivider-2LcUF",ToolButton:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButton-Q6LcJ",ToolButtonIcon:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButtonIcon-dUimn",ToolButtonSelected:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButtonSelected-3CKIJ",ToolbarMenuIcon:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuIcon-3tht2",ToolbarMenuLabel:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuLabel-39rCn",ToolbarMenuShortcut:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuShortcut-3atX1",ToolButtonDisabled:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolButtonDisabled-1AhfQ",ToolbarDropdownArrow:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarDropdownArrow-2li1x",ToolbarMenu:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenu-2uYy3",ToolbarMenuRight:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRight-2CxtA",ToolbarSubMenu:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarSubMenu-2biFb",ToolbarMenuRow:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuRow-2POs_",ToolbarMenuIconBone:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuIconBone-1WBhq",ToolbarMenuExpand:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuExpand-1ZER4",ToolbarMenuDivider:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarMenuDivider-2_MBB",ToolbarSpacer:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ToolbarSpacer-ATjFZ",ZoomInput:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ZoomInput-121u6",ActiveTransformTool:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ActiveTransformTool-1IjIA",ActiveCreateTool:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-ActiveCreateTool-xOzP8",VertexToolbarWrapper:"source-client-source-editors-flare-ui-Components-Toolbar-Toolbar-VertexToolbarWrapper-JZ7DO"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(3));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hover:!1,toggleOn:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"mouseOver",value:function(){this.setState({hover:!0})}},{key:"mouseOut",value:function(){this.setState({hover:!1})}},{key:"mouseDown",value:function(){this.props.onToggle&&this.props.onToggle(!this.state.toggleOn),this.setState({toggleOn:!this.state.toggleOn})}},{key:"setToggleValue",value:function(e){this.setState({toggleOn:e})}},{key:"render",value:function(){var e;switch(this.props.name){case"MeshVisibility":e=s.default.make("/images/symbol-defs.svg#icon-mesh")}return i.default.createElement("div",{className:"VisibilityToggle",onMouseDown:this.mouseDown,onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut,id:this.props.name},i.default.createElement("svg",{className:this.state.toggleOn?"ToggleIcon ToggleIconActive":"ToggleIcon"},i.default.createElement("use",{xlinkHref:e})),i.default.createElement("div",{className:"ToggleHighlight"+(this.state.toggleOn?" ToggleVisible":" ToggleHidden")}))}}]),t}()).prototype,"mouseOver",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOver"),r.prototype),u(r.prototype,"mouseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOut"),r.prototype),u(r.prototype,"mouseDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),r.prototype),r);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=u(n(385)),i=u(n(176)),a=u(n(195)),s=u(n(253)),l=u(n(266));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"canSelectType",value:function(e){switch(e){case i.default:case a.default:case s.default:case l.default:return!0}return!1}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(385)),i=a(n(179));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"canSelectType",value:function(e){return e===i.default}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(385)),i=a(n(330));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"canSelectType",value:function(e){return e===i.default}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=z(n(1)),a=z(n(2)),s=z(n(5)),l=z(n(1247)),u=z(n(682)),c=z(n(504)),d=z(n(1248)),f=z(n(441)),h=z(n(377)),p=z(n(349)),y=z(n(422)),v=z(n(423)),m=z(n(424)),g=z(n(304)),b=z(n(425)),k=z(n(523)),S=z(n(427)),O=z(n(426)),w=z(n(524)),_=z(n(428)),P=z(n(381)),C=z(n(526)),E=z(n(527)),T=z(n(683)),I=z(n(684)),j=z(n(685)),A=z(n(179)),D=z(n(230)),R=z(n(268)),M=z(n(195)),x=z(n(176)),F=z(n(253)),L=z(n(266)),N=z(n(3));function z(e){return e&&e.__esModule?e:{default:e}}function V(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var B=(V((r=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){var e=this.context.nima,t=e.stage;e.addEventListener("fileLoaded",this.onFileLoaded),e.addEventListener("editShape",this.onEditShapeChanged),this.setState({canCopy:e.hasCopyAccess,selectedTool:t.toolType,tool:t.tool,zoom:t.zoom,isEditingShape:e.isEditingShape&&!(e.editingShape instanceof A.default),isEditingImage:e.isEditingShape&&e.editingShape instanceof A.default,hasVertexWeights:e.hasVertexWeights,showGuides:this.context.nima.getPreference("showGuides"),hideShapes:!1,hideBones:!1})}},{key:"onEditShapeChanged",value:function(e){var t=this.context.nima;this.setState({hasVertexWeights:t.hasVertexWeights,isEditingShape:e&&!(t.editingShape instanceof A.default),isEditingImage:e&&t.editingShape instanceof A.default})}},{key:"onFileLoaded",value:function(){this.setState({canCopy:this.context.nima.hasCopyAccess})}},{key:"componentDidMount",value:function(){var e=this.context.nima.stage;e.addEventListener("toolChanged",this.onToolChanged),e.addEventListener("zoomChanged",this.onZoomChanged),e.addEventListener("transformSpaceChanged",this.updateProperty)}},{key:"setAnimationMode",value:function(e){this.setState({animateMode:e})}},{key:"setCreateGroup",value:function(e){this.createGroup=e}},{key:"onZoomChanged",value:function(e){this.setState({zoom:e})}},{key:"onToolChanged",value:function(e){var t=this.context.nima.stage;this.setState({selectedTool:t.toolType,tool:t.tool})}},{key:"toolSelected",value:function(e){var t=this.context.nima.stage;if(e instanceof Array){var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(t.selectTool(s))break}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}else t.selectTool(e)}},{key:"updateProperty",value:function(){this.forceUpdate()}},{key:"componentWillUnmount",value:function(){var e=this.context.nima,t=e.stage;e.removeEventListener("fileLoaded",this.onFileLoaded),t.removeEventListener("toolChanged",this.toolChanged),t.removeEventListener("zoomChanged",this.onZoomChanged),t.removeEventListener("transformSpaceChanged",this.updateProperty),e.removeEventListener("editShape",this.onEditShapeChanged)}},{key:"zoomInputChanged",value:function(e){this.context.nima.stage.zoom=e}},{key:"setToolbar",value:function(e){this.toolbar=e}},{key:"toggleRulers",value:function(){this.context.nima.setProjectPreference("showGuides",!this.context.nima.getPreference("showGuides")),this.setState({showGuides:this.context.nima.getPreference("showGuides")})}},{key:"toggleShapes",value:function(){var e=null,t=this.context.nima.stage;[A.default,D.default].forEach(function(n){var r=t.getLayerOptions(n);null===e&&(e=!r.disableDraw),r.disableDraw=e}),this.setState({hideShapes:e}),t.redraw()}},{key:"toggleBones",value:function(){var e=null,t=this.context.nima.stage;[R.default,M.default,x.default,F.default,L.default].forEach(function(n){var r=t.getLayerOptions(n);null===e&&(e=!r.disableDraw),r.disableDraw=e}),this.setState({hideBones:e}),t.redraw()}},{key:"setLeft",value:function(e){this.toolbar.style.left=e+"px"}},{key:"setRight",value:function(e){this.toolbar.style.right=e+"px"}},{key:"setMarginRight",value:function(e){this.toolbar.style.marginRight=e+"px"}},{key:"setLocalAxis",value:function(e){e.stopPropagation(),this.context.nima.stage.transformSpace=h.default.Local}},{key:"setParentAxis",value:function(e){e.stopPropagation(),this.context.nima.stage.transformSpace=h.default.Parent}},{key:"setWorldAxis",value:function(e){e.stopPropagation(),this.context.nima.stage.transformSpace=h.default.World}},{key:"renderAxisOptions",value:function(){var e=void 0;switch(this.context.nima.stage.transformSpace){case h.default.Parent:e=N.default.make("/images/symbol-defs.svg#icon-axis-parent");break;case h.default.Local:e=N.default.make("/images/symbol-defs.svg#icon-axis-local");break;case h.default.World:e=N.default.make("/images/symbol-defs.svg#icon-axis-world")}return i.default.createElement(d.default,{isSubMenu:!0,icon:e,label:"Show Axis"},i.default.createElement("div",{className:f.default.ToolbarMenuRow,onClick:this.setLocalAxis},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-axis-local")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Local")),i.default.createElement("div",{className:f.default.ToolbarMenuRow,onClick:this.setParentAxis},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-axis-parent")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Parent")),i.default.createElement("div",{className:f.default.ToolbarMenuRow,onClick:this.setWorldAxis},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-axis-world")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"World")))}},{key:"render",value:function(){var e,t,n,r,o=this.context.editor.bindingString,a=this.state,s=a.isEditingShape,h=a.isEditingImage,A=a.hasVertexWeights,D=a.selectedTool,R=a.tool,M=s||h;switch(D){case p.default:e=M?N.default.make("/images/symbol-defs.svg#icon-vertex-translate-active"):N.default.make("/images/symbol-defs.svg#icon-move");break;case y.default:e=N.default.make("/images/symbol-defs.svg#icon-rotate");break;case v.default:e=N.default.make("/images/symbol-defs.svg#icon-scale-flare");break;case m.default:e=N.default.make("/images/symbol-defs.svg#icon-arrow-divert");break;case g.default:e=N.default.make("/images/symbol-defs.svg#icon-weights-tool-active");break;case b.default:n=N.default.make("/images/symbol-defs.svg#icon-bone-add");break;case O.default:n=N.default.make("/images/symbol-defs.svg#icon-node-add");break;case k.default:n=N.default.make("/images/symbol-defs.svg#icon-artboard-tool");break;case S.default:n=N.default.make("/images/symbol-defs.svg#icon-solo-add");break;case P.default:case w.default:n=N.default.make("/images/symbol-defs.svg#icon-pen-flare");break;case C.default:n=N.default.make("/images/symbol-defs.svg#icon-rectangle-tool");break;case E.default:n=N.default.make("/images/symbol-defs.svg#icon-ellipse-tool");break;case T.default:n=N.default.make("/images/symbol-defs.svg#icon-polygon-tool");break;case I.default:n=N.default.make("/images/symbol-defs.svg#icon-star-tool");break;case j.default:n=N.default.make("/images/symbol-defs.svg#icon-triangle-tool")}switch(D){case p.default:case y.default:case v.default:case m.default:case g.default:n=N.default.make("/images/symbol-defs.svg#icon-plus-circle"),t=f.default.ActiveTransformTool;break;case k.default:case b.default:case O.default:case S.default:case w.default:case P.default:case C.default:case E.default:case T.default:case I.default:case j.default:e=M?N.default.make("/images/symbol-defs.svg#icon-vertex-translate"):N.default.make("/images/symbol-defs.svg#icon-move"),r=f.default.ActiveCreateTool}return i.default.createElement("div",{className:f.default.Toolbar,ref:this.setToolbar},M?null:i.default.createElement(d.default,{icon:e,iconClass:t,tip:{label:"Transform Tools"}},i.default.createElement(l.default,{type:p.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==p.default},i.default.createElement("svg",{className:D==p.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveTransformTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-move")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Translate"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},o(c.default.Actions.TranslateTool))),i.default.createElement(l.default,{type:y.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==y.default},i.default.createElement("svg",{className:D==y.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveTransformTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-rotate")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Rotate"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},o(c.default.Actions.RotateTool))),i.default.createElement(l.default,{type:v.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==v.default},i.default.createElement("svg",{className:D==v.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveTransformTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-scale-flare")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Scale"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},o(c.default.Actions.ScaleTool))),i.default.createElement(l.default,{type:m.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==m.default},i.default.createElement("svg",{className:D==m.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveTransformTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-arrow-divert")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"IK Pose"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},o(c.default.Actions.IKTool))),i.default.createElement(l.default,{type:null,isDisabled:!0,classReplace:f.default.ToolbarMenuRow,onSelected:null,isSelected:null},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-move-pivot")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Move Pivot"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut})),i.default.createElement("div",{className:f.default.ToolbarMenuDivider}),this.renderAxisOptions()),M?i.default.createElement("div",{className:f.default.VertexToolbarWrapper},i.default.createElement(l.default,{type:p.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==p.default,tip:{label:h?"Deform your mesh by moving vertices":"Translate vertices",action:c.default.Actions.TranslateTool}},i.default.createElement("svg",{className:D==p.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveTransformTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:D==p.default?N.default.make("/images/symbol-defs.svg#icon-vertex-translate-active"):N.default.make("/images/symbol-defs.svg#icon-vertex-translate")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},h?"Deform":"Move")),i.default.createElement(l.default,{type:[P.default,w.default],classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:R instanceof _.default,tip:{label:h?"Edit the countour of this mesh":"Edit the vertices of your paths",action:c.default.Actions.PenTool}},i.default.createElement("svg",{className:R instanceof _.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveCreateTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-pen-flare")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},h?"Edit Mesh":"Pen")),A?i.default.createElement(l.default,{type:g.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==g.default,tip:{label:"Edit weights of connected bones",action:c.default.Actions.VertexWeightTool}},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:D==g.default?N.default.make("/images/symbol-defs.svg#icon-weights-tool-active"):N.default.make("/images/symbol-defs.svg#icon-weights-tool")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Edit Weights")):null):null,this.state.animateMode||M?null:i.default.createElement(d.default,{icon:n,iconClass:r,tip:{label:"Create Tools"}},i.default.createElement(d.default,{isDisabled:M,isSubMenu:!0,icon:N.default.make("/images/symbol-defs.svg#icon-shapes"),label:"Shape"},i.default.createElement(l.default,{type:C.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==C.default},i.default.createElement("svg",{className:D==C.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveCreateTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-rectangle-tool")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Rectangle"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},o(c.default.Actions.RectangleTool))),i.default.createElement(l.default,{type:E.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==E.default},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-ellipse-tool")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Ellipse"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},o(c.default.Actions.EllipseTool))),i.default.createElement(l.default,{type:T.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==T.default},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-polygon-tool")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Polygon")),i.default.createElement(l.default,{type:I.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==I.default},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-star-tool")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Star")),i.default.createElement(l.default,{type:j.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==j.default},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-triangle-tool")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Triangle"))),i.default.createElement(l.default,{type:[P.default,w.default],classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:R instanceof _.default},i.default.createElement("svg",{className:R instanceof _.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveCreateTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-pen-flare")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Pen"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},o(c.default.Actions.PenTool))),i.default.createElement("div",{className:f.default.ToolbarMenuDivider}),i.default.createElement(l.default,{type:k.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==k.default},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-artboard-tool")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Artboard"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},"A")),i.default.createElement(l.default,{isDisabled:M,type:b.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==b.default},i.default.createElement("svg",{className:D==b.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveCreateTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-bone-add")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Bone"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},o(c.default.Actions.BoneTool))),i.default.createElement(l.default,{isDisabled:M,type:O.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==O.default},i.default.createElement("svg",{className:D==O.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveCreateTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-node-add")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Node"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},o(c.default.Actions.NodeTool))),i.default.createElement(l.default,{isDisabled:M,type:S.default,classReplace:f.default.ToolbarMenuRow,onSelected:this.toolSelected,isSelected:D==S.default},i.default.createElement("svg",{className:D==S.default?f.default.ToolbarMenuIcon+" "+f.default.ActiveCreateTool:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-solo-add")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Solo"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},o(c.default.Actions.SoloTool)))),i.default.createElement("div",{className:f.default.ToolbarSpacer}),i.default.createElement(u.default,{value:this.state.zoom,valueChanged:this.zoomInputChanged,tip:{label:"Zoom",actions:[{label:"In",action:c.default.Actions.ZoomIn},{label:"Out",action:c.default.Actions.ZoomOut},{label:"Actual Size",action:c.default.Actions.Zoom100},{label:"Fit",action:c.default.Actions.ZoomFit}]}}),i.default.createElement(d.default,{icon:N.default.make("/images/symbol-defs.svg#icon-eye"),alignRight:!0},i.default.createElement(l.default,{classReplace:f.default.ToolbarMenuRow,onSelected:this.toggleShapes},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-shapes")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},this.state.hideShapes?"Show Shapes":"Hide Shapes")),i.default.createElement(l.default,{classReplace:f.default.ToolbarMenuRow,onSelected:this.toggleBones},i.default.createElement("svg",{className:f.default.ToolbarMenuIconBone},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-bone")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},this.state.hideBones?"Show Bones":"Hide Bones")),i.default.createElement(l.default,{classReplace:f.default.ToolbarMenuRow,onSelected:this.toggleRulers},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-rulers")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},this.state.showGuides?"Hide Rulers":"Show Rulers"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},"⌘;")),i.default.createElement("div",{className:f.default.ToolbarMenuRow},i.default.createElement("svg",{className:f.default.ToolbarMenuIcon},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-rulers")})),i.default.createElement("div",{className:f.default.ToolbarMenuLabel},"Reset Rulers"),i.default.createElement("div",{className:f.default.ToolbarMenuShortcut},"⌘⇧;"))),i.default.createElement(l.default,{onSelected:this.props.onSettingsToggled,tip:{label:"Settings"}},i.default.createElement("svg",{className:f.default.ToolButtonIcon,style:{opacity:this.props.settingsOpen?"1":null}},i.default.createElement("use",{xlinkHref:N.default.make(this.props.settingsOpen?"/images/symbol-defs.svg#icon-cog-selected":"/images/symbol-defs.svg#icon-cog")}))),i.default.createElement(l.default,{isDisabled:!this.state.canCopy,onSelected:this.props.onGotoExport,tip:{label:"Export"}},i.default.createElement("svg",{className:f.default.ToolButtonIcon,style:{opacity:this.props.isActive?"1":null}},i.default.createElement("use",{xlinkHref:N.default.make("/images/symbol-defs.svg#icon-export")}))),i.default.createElement("div",{className:f.default.ToolbarDivider}))}}]),t}()).prototype,"onEditShapeChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onEditShapeChanged"),r.prototype),V(r.prototype,"onFileLoaded",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onFileLoaded"),r.prototype),V(r.prototype,"setCreateGroup",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setCreateGroup"),r.prototype),V(r.prototype,"onZoomChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onZoomChanged"),r.prototype),V(r.prototype,"onToolChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onToolChanged"),r.prototype),V(r.prototype,"toolSelected",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toolSelected"),r.prototype),V(r.prototype,"updateProperty",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"updateProperty"),r.prototype),V(r.prototype,"zoomInputChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"zoomInputChanged"),r.prototype),V(r.prototype,"setToolbar",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setToolbar"),r.prototype),V(r.prototype,"toggleRulers",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleRulers"),r.prototype),V(r.prototype,"toggleShapes",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleShapes"),r.prototype),V(r.prototype,"toggleBones",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleBones"),r.prototype),V(r.prototype,"setLocalAxis",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setLocalAxis"),r.prototype),V(r.prototype,"setParentAxis",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setParentAxis"),r.prototype),V(r.prototype,"setWorldAxis",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setWorldAxis"),r.prototype),r);t.default=B,B.contextTypes={nima:s.default.object,editor:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),a=u(n(2)),s=u(n(5)),l=u(n(441));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var d=(c((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hover:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"mouseOver",value:function(){this.context.tooltip.enter(this),this.setState({hover:!0})}},{key:"mouseOut",value:function(){this.context.tooltip.leave(this),this.setState({hover:!1})}},{key:"click",value:function(e){e.stopPropagation(),this.context.tooltip.click(this),this.props.onSelected&&this.props.onSelected(this.props.type,e)}},{key:"render",value:function(){var e;return e=this.props.classReplace?this.props.classReplace:l.default.ToolButton,this.props.isSelected&&(e=e+" "+l.default.ToolButtonSelected),this.props.isDisabled&&(e=e+" "+l.default.ToolButtonDisabled),i.default.createElement("div",{className:e,onClick:this.click,onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut,id:this.props.cssID},this.props.children)}}]),t}()).prototype,"mouseOver",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOver"),r.prototype),c(r.prototype,"mouseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOut"),r.prototype),c(r.prototype,"click",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"click"),r.prototype),r);t.default=d,d.contextTypes={tooltip:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(1)),a=d(n(2)),s=d(n(441)),l=d(n(3)),u=d(n(5)),c=d(n(19));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var h=(f((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isOpen:!1,visibility:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"mouseOver",value:function(){(0,c.default)(this.toolTipEnter)}},{key:"toolTipEnter",value:function(){this.context.tooltip.enter(this)}},{key:"mouseOverChildren",value:function(e){c.default.cancel(this.toolTipEnter)}},{key:"mouseOut",value:function(){this.context.tooltip.leave(this)}},{key:"open",value:function(){this.context.tooltip.click(this),window.addEventListener("click",this.close,!0),this.setState({isOpen:!0,visibility:!0}),clearTimeout(this.timeout)}},{key:"close",value:function(){var e;this.context.tooltip.click(this),window.removeEventListener("click",this.close,!0),this.setState({isOpen:!1}),this.timeout=setTimeout((e=this,function(){e.setState({visibility:!1})}),100)}},{key:"render",value:function(){var e;return e=this.props.isSubMenu?s.default.ToolbarMenuRow:s.default.ToolButton,this.props.isDisabled&&(e=e+" "+s.default.ToolButtonDisabled),i.default.createElement("div",{className:e,onClick:this.props.isSubMenu?null:this.state.isOpen?this.close:this.open,onMouseEnter:this.props.isSubMenu?this.open:this.mouseOver,onMouseLeave:this.props.isSubMenu?this.close:this.mouseOut},i.default.createElement("svg",{className:this.props.isSubMenu?s.default.ToolbarMenuIcon:this.props.iconClass?this.props.iconClass+" "+s.default.ToolButtonIcon:s.default.ToolButtonIcon,style:{opacity:this.state.isOpen?"1":null}},i.default.createElement("use",{xlinkHref:this.props.icon})),this.props.isSubMenu?i.default.createElement("div",{className:s.default.ToolbarMenuLabel},this.props.label):null,this.props.isSubMenu?i.default.createElement("svg",{className:s.default.ToolbarMenuExpand},i.default.createElement("use",{xlinkHref:l.default.make("/images/symbol-defs.svg#icon-menu-expand")})):i.default.createElement("svg",{className:s.default.ToolbarDropdownArrow},i.default.createElement("use",{xlinkHref:l.default.make("/images/symbol-defs.svg#icon-arrow")})),i.default.createElement("div",{onMouseOver:this.mouseOverChildren,className:this.props.isSubMenu?s.default.ToolbarSubMenu:this.props.alignRight?s.default.ToolbarMenuRight:s.default.ToolbarMenu,style:{visibility:this.state.visibility?"visible":"hidden",opacity:this.state.isOpen?"1":"0"}},this.props.children))}}]),t}()).prototype,"mouseOver",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOver"),r.prototype),f(r.prototype,"toolTipEnter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toolTipEnter"),r.prototype),f(r.prototype,"mouseOverChildren",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOverChildren"),r.prototype),f(r.prototype,"mouseOut",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"mouseOut"),r.prototype),f(r.prototype,"open",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"open"),r.prototype),f(r.prototype,"close",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"close"),r.prototype),r);t.default=h,h.contextTypes={tooltip:u.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=y(n(1)),a=y(n(5)),s=y(n(2)),l=y(n(1250)),u=y(n(372)),c=y(n(1251)),d=y(n(1252)),f=y(n(1253)),h=y(n(1254)),p=y(n(3));function y(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var m=(v((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={currPageLeft:"0px"},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.currPage=1}},{key:"updatePreferences",value:function(){this.preferences&&this.preferences.updatePreferences()}},{key:"componentWillReceiveProps",value:function(e){e.isOpen?this.revisionHistory.getRevisionList():!1===e.isOpen&&this.revisionHistory.cancelPreview()}},{key:"goForward",value:function(e){this.currPage++,this.gotoSettingsPage(e)}},{key:"goBack",value:function(){this.currPage--,this.gotoSettingsPage()}},{key:"gotoSettingsPage",value:function(e){switch(this.currPage){case 1:this.setState({currPageLeft:"0px",showBack:!1});break;case 2:this.setState({currPageLeft:"-200px",showBack:!0,showPage:e})}}},{key:"translatePanelOut",value:function(e,t){t?this.root.style.transform=e?"translate3D(200px, 0, 0)":"translate3D(0px, 0, 0)":this.root.style.display=e?"none":null}},{key:"setRoot",value:function(e){this.root=e}},{key:"setPreferencesRef",value:function(e){this.preferences=e}},{key:"setRevisionHistory",value:function(e){this.revisionHistory=e}},{key:"render",value:function(){var e=h.default.major+"."+h.default.minor+"."+h.default.patch+" ("+(h.default.build||"DEV")+")";return i.default.createElement("div",{id:"SettingsPanel",ref:this.setRoot,style:{width:(this.props.isOpen?200:0)+"px"}},i.default.createElement("div",{className:"SettingsHeader"},i.default.createElement("svg",{className:"BackButton",onMouseDown:this.state.showBack?this.goBack:null,style:{opacity:this.state.showBack?null:0}},i.default.createElement("use",{xlinkHref:p.default.make("/images/symbol-defs.svg#icon-back")})),i.default.createElement("svg",{className:"CloseButton",onMouseDown:this.props.onSettingsToggled},i.default.createElement("use",{xlinkHref:p.default.make("/images/symbol-defs.svg#icon-close3")}))),i.default.createElement("div",{className:"SettingsPages",style:{left:this.state.currPageLeft}},i.default.createElement("div",{className:"SettingsPage1"},i.default.createElement(l.default,{label:"Preferences",type:t.PageTypes.Preferences,onSelect:this.goForward}),this.context.nima.hasWriteAccess?i.default.createElement(l.default,{label:"Revision History",type:t.PageTypes.RevisionHistory,onSelect:this.goForward}):null,i.default.createElement("div",{className:"SettingsListDivider"}),i.default.createElement("a",{className:"SettingsListRow",href:"https://docs.2dimensions.com/support/flare/core-concepts",target:"_blank"},"Flare Manual"),i.default.createElement(l.default,{label:"Keyboard Shortcuts",type:t.PageTypes.KeyboardShortcuts,onSelect:this.props.onShowShortcutsModal})),i.default.createElement("div",{className:"SettingsPage2"},i.default.createElement(u.default,{ref:this.setRevisionHistory,isVisible:this.state.showPage===t.PageTypes.RevisionHistory}),i.default.createElement(c.default,{isVisible:this.state.showPage===t.PageTypes.GettingStarted}),i.default.createElement(d.default,{isVisible:this.state.showPage===t.PageTypes.KeyboardShortcuts}),i.default.createElement(f.default,{ref:this.setPreferencesRef,isVisible:this.state.showPage===t.PageTypes.Preferences})),i.default.createElement("div",{className:"SettingsFooter"},i.default.createElement("div",{className:"NimaText"},"FLARE"),i.default.createElement("div",{className:"NimaVersion"},e))))}}],[{key:"width",get:function(){return 200}}]),t}()).prototype,"goForward",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"goForward"),r.prototype),v(r.prototype,"goBack",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"goBack"),r.prototype),v(r.prototype,"setRoot",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setRoot"),r.prototype),v(r.prototype,"setPreferencesRef",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setPreferencesRef"),r.prototype),v(r.prototype,"setRevisionHistory",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setRevisionHistory"),r.prototype),r);t.default=m,m.contextTypes={nima:a.default.object},m.PageTypes={GettingStarted:0,RevisionHistory:1,KeyboardShortcuts:2,Preferences:3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(1)),a=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}var l,u,c,d,f,h,p=(r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"select",value:function(){this.props.onSelect&&this.props.onSelect(this.props.type)}},{key:"render",value:function(){return i.default.createElement("div",{className:"SettingsListRow",onMouseDown:this.select},this.props.label)}}]),t}(),l=r.prototype,u="select",c=[a.default],d=Object.getOwnPropertyDescriptor(r.prototype,"select"),f=r.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce(function(e,t){return t(l,u,e)||e},h),f&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(f):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(l,u,h),h=null),r);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(1)),i=a(n(3));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),r(t,[{key:"render",value:function(){return o.default.createElement("div",{className:"GettingStartedContent",style:{display:this.props.isVisible?"block":"none"}},o.default.createElement("svg",{className:"GettingStartedIcon"},o.default.createElement("use",{xlinkHref:i.default.make("/images/symbol-defs.svg#icon-lightbulb")})),o.default.createElement("div",{className:"SettingsHeadline"},"Getting Started"),o.default.createElement("p",null,"Welcome to Nima! To get started, drag and drop some images to the stage. Flatten your layers if you're dragging a PSD, so everything loads correctly."),o.default.createElement("p",null,"You're going to be doing most of your work on the stage. The rest of the interface is divided into a few main panels."),o.default.createElement("div",{className:"SettingsListDivider"}),o.default.createElement("div",{className:"HierarchyPanelIcon"},o.default.createElement("div",{className:"HierarchyPanelIcon1"}),o.default.createElement("div",{className:"HierarchyPanelIcon2"}),o.default.createElement("div",{className:"HierarchyPanelIcon3"}),o.default.createElement("div",{className:"HierarchyPanelIcon4"})),o.default.createElement("div",{className:"SettingsHeadline"},"Hierarchy Panel"),o.default.createElement("p",null,"On the far left, you have the Hierarchy panel. Here you can toggle between Setup and Animate modes.  All the items that make up your character appear below. These are divided by Stage, Assets, and Draw Order. Stage reflects everything that's currently on the stage, and the hierarchical structure of your skeleton. Assets is a list of all the files that are available to be used on this project. Not all of them might be on the stage. When you delete an image from the Stage, it does not get removed from your Assets. Draw Order reflects the order that images are rendered on the screen, which you may want to be different from the hierarchical order of your character's skeleton."),o.default.createElement("div",{className:"SettingsListDivider"}),o.default.createElement("div",{className:"SelectionPanelIcon"},o.default.createElement("div",{className:"SelectionPanelIcon1"}),o.default.createElement("div",{className:"SelectionPanelIcon2"}),o.default.createElement("div",{className:"SelectionPanelIcon3"}),o.default.createElement("div",{className:"SelectionPanelIcon4"})),o.default.createElement("div",{className:"SettingsHeadline"},"Selection Panel"),o.default.createElement("p",null,"The Selection panel is to the right of the Hierarchy panel. All the properties of the item you have selected are available here. Most of these can be animated when you toggle to Animate mode."),o.default.createElement("div",{className:"SettingsListDivider"}),o.default.createElement("div",{className:"ToolbarIcon"},o.default.createElement("div",{className:"ToolbarIcon1"}),o.default.createElement("div",{className:"ToolbarIcon2"}),o.default.createElement("div",{className:"ToolbarIcon3"}),o.default.createElement("div",{className:"ToolbarIcon4"})),o.default.createElement("div",{className:"SettingsHeadline"},"Toolbar"),o.default.createElement("p",null,"The Toolbar is on the far right. It displays the tools you have available to manipulate and create objects on the stage. Note that these change based on whether you are in Setup or Animate mode."))}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(1)),i=a(n(3));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),r(t,[{key:"render",value:function(){return o.default.createElement("div",{className:"KeyboardShortcutsContent",style:{display:this.props.isVisible?"block":"none"}},o.default.createElement("svg",{className:"GettingStartedIcon"},o.default.createElement("use",{xlinkHref:i.default.make("/images/symbol-defs.svg#icon-keyboard")})),o.default.createElement("div",{className:"SettingsHeadline"},"Keyboard Shortcuts"),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Translate"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"T")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Rotate"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"R")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Scale"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"S")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"IK"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"W")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Create Bone"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"B")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Create Node"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"G")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Pan Stage & Timeline"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"Spacebar")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Zoom In"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"⌘ +")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Zoom Out"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"⌘ –")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Actual Size"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"⌘ 0")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Zoom to Fit"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"F")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc"},"Deselect"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"⌘ D")),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc",style:{width:"90px",flex:"initial"}},"Move Playhead 1 Frame"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"⌘ ",o.default.createElement("span",{style:{fontSize:"65%",position:"relative",top:"-1px"}},"◀ ▶"))),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc",style:{width:"70px",flex:"initial"}},"Move Playhead 10 Frames"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"⌘ Shift ",o.default.createElement("span",{style:{fontSize:"65%",position:"relative",top:"-1px"}},"◀ ▶"))),o.default.createElement("div",{className:"KeyboardShortcutRow"},o.default.createElement("div",{className:"KeyboardShortcutDesc",style:{width:"90px",flex:"initial"}},"Pick Children"),o.default.createElement("div",{className:"KeyboardShortcutKey"},"C")))}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=c(n(1)),a=c(n(2)),s=c(n(5)),l=c(n(238)),u=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var f=(d((r=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.setState(this.getPreferencesState())}},{key:"toggleRetina",value:function(e){this.context.nima.setLocalPreference("scaleRetina",e),this.setState({scaleRetina:e})}},{key:"toggleGuides",value:function(e){this.context.nima.setProjectPreference("showGuides",e),this.setState({showGuides:e})}},{key:"toggleImageContour",value:function(e){this.context.nima.setProjectPreference("disableImageContour",!e),this.setState({disableImageContour:!e})}},{key:"getPreferencesState",value:function(){return{scaleRetina:this.context.nima.getPreference("scaleRetina"),showGuides:this.context.nima.getPreference("showGuides"),disableImageContour:this.context.nima.getPreference("disableImageContour")}}},{key:"updatePreferences",value:function(){this.setState(this.getPreferencesState())}},{key:"render",value:function(){return i.default.createElement("div",{className:"KeyboardShortcutsContent",style:{display:this.props.isVisible?"block":"none"}},i.default.createElement("svg",{className:"GettingStartedIcon"},i.default.createElement("use",{xlinkHref:u.default.make("/images/symbol-defs.svg#icon-adjustments")})),i.default.createElement("div",{className:"SettingsHeadline"},"Preferences"),i.default.createElement("div",{className:"KeyboardShortcutRow"},i.default.createElement("div",{className:"KeyboardShortcutDesc",style:{flex:2}},"Show Guides"),i.default.createElement("div",{className:"KeyboardShortcutKey"},i.default.createElement(l.default,{isOn:this.state.showGuides,onToggle:this.toggleGuides}))),i.default.createElement("div",{className:"KeyboardShortcutRow"},i.default.createElement("div",{className:"KeyboardShortcutDesc",style:{flex:2}},"Scale for Retina"),i.default.createElement("div",{className:"KeyboardShortcutKey"},i.default.createElement(l.default,{isOn:this.state.scaleRetina,onToggle:this.toggleRetina}))),i.default.createElement("div",{className:"KeyboardShortcutRow"},i.default.createElement("div",{className:"KeyboardShortcutDesc",style:{flex:2}},"Show Image Contour"),i.default.createElement("div",{className:"KeyboardShortcutKey"},i.default.createElement(l.default,{isOn:!this.state.disableImageContour,onToggle:this.toggleImageContour}))))}}]),t}()).prototype,"toggleRetina",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleRetina"),r.prototype),d(r.prototype,"toggleGuides",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleGuides"),r.prototype),d(r.prototype,"toggleImageContour",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleImageContour"),r.prototype),r);t.default=f,f.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";e.exports={major:1,minor:1,patch:0,build:"2225"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(1)),a=d(n(28)),s=d(n(2)),l=d(n(16)),u=d(n(5)),c=d(n(316));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var h=(f((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={opacity:0,isMeasuring:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentDidMount",value:function(){document.addEventListener("mouseleave",this.onWindowMouseLeave)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.showTimeout),document.removeEventListener("mouseleave",this.onWindowMouseLeave)}},{key:"onWindowMouseLeave",value:function(){clearTimeout(this.showTimeout)}},{key:"showFor",value:function(e){var t,n;e.props.tip&&(this.next=e,clearTimeout(this.showTimeout),this.showTimeout=setTimeout((t=this,n=e,function(){t.build.call(t,n)}),800))}},{key:"tooltipHeight",value:function(){var e=void 0;if(this.item.props.tip.actions){e=21+30*this.item.props.tip.actions.length}else e=51;return e}},{key:"build",value:function(e){this.item=e;a.default.findDOMNode(e);clearTimeout(this.hideTimeout);var t=window.innerWidth/2,n=window.innerHeight/2;function r(e){var t=l.default.isOSX,n="";return e.command&&(n+=t?"⌘":"win"),e.shift&&(0!=n.length&&(n+=" "),n+="shift"),e.ctrl&&(0!=n.length&&(n+=" "),n+="ctrl"),e.alt&&(0!=n.length&&(n+=" "),n+="alt"),0!=n.length&&(n+=" "),(n+=c.default.index.getName(e.code)).toUpperCase()}var o=e.props.tip,i=null;if(o.action){var s=this.context.keyMap.getKeyBinding(o.action);s&&(i=r(s))}else if(o.actions){i=[];for(var u=0;u<o.actions.length;u++){var d=o.actions[u],f=this.context.keyMap.getKeyBinding(d.action);f&&i.push({label:d.label,shortcut:r(f)})}}this.setState({opacity:1,tipLeft:void 0,tipRight:t,tipTop:n,label:o.label,shortcut:i})}},{key:"hideImmediatelyFor",value:function(e){e!=this.item&&e!=this.next||(clearTimeout(this.showTimeout),clearTimeout(this.hideTimeout),this.item=null,this.setState({opacity:0}))}},{key:"hideFor",value:function(e){var t;e!=this.item&&e!=this.next||(clearTimeout(this.showTimeout),clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout((t=this,function(){t.item=null,t.setState({opacity:0,isMeasuring:!0})}),200))}},{key:"setTooltipRoot",value:function(e){this.tooltipRoot=e}},{key:"componentDidUpdate",value:function(e,t){if(this.state.isMeasuring&&1===this.state.opacity){var n=a.default.findDOMNode(this.next),r=n.getBoundingClientRect(),o=n.parentElement.getBoundingClientRect(),i=this.tooltipRoot.getBoundingClientRect(),s=void 0,l=void 0,u=r.top;if(r.left<=o.left)r.right>window.innerWidth/2?s=window.innerWidth-r.left+10:l=r.right+10;else{var c=i.height;u=o.top-c-10,r.left+r.width/2+i.width/2<window.innerWidth-70?l=r.left+r.width/2-i.width/2:s=70}u<0&&(u=o.bottom),this.setState({isMeasuring:!1,tipLeft:l,tipRight:s,tipTop:u})}}},{key:"render",value:function(){var e=null,t="Tooltip";if(this.state.shortcut)if(this.state.shortcut.constructor===Array){t="TooltipMulti";for(var n=[],r=[],o=0;o<this.state.shortcut.length;o++){var a=this.state.shortcut[o];n.push(i.default.createElement("div",{key:"l"+o,className:"TooltipLabel"},a.label)),r.push(i.default.createElement("div",{key:"s"+o,className:"TooltipShortcut"},a.shortcut))}e=[i.default.createElement("div",{key:"1",className:"TooltipLabelsList"},n),i.default.createElement("div",{key:"2",className:"TooltipShortcutsList"},r)]}else e=i.default.createElement("div",{className:"TooltipShortcut"},this.state.shortcut);return i.default.createElement("div",{ref:this.setTooltipRoot,className:t,style:{opacity:this.state.isMeasuring?0:this.state.opacity,left:null==this.state.tipLeft?"":this.state.tipLeft+"px",right:null==this.state.tipRight?"":this.state.tipRight+"px",top:null==this.state.tipTop?"":this.state.tipTop+"px"}},i.default.createElement("div",{className:"TooltipTitle"},this.state.label),e)}}]),t}()).prototype,"onWindowMouseLeave",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onWindowMouseLeave"),r.prototype),f(r.prototype,"setTooltipRoot",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setTooltipRoot"),r.prototype),r);t.default=h,h.contextTypes={keyMap:u.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=f(n(1)),a=f(n(2)),s=f(n(5)),l=f(n(238)),u=f(n(271)),c=f(n(164)),d=(f(n(3)),f(n(310)));function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var p=(h((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isModalOpen:!1,isModalClosing:!1,downloadURL:null,isExporting:!1,exportAnimations:!0,includeAllAssets:!0,downloadFilename:null,includeProjectSettings:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"toggleExportAnimations",value:function(e){this.setState({exportAnimations:e})}},{key:"toggleIncludeAllAssets",value:function(e){this.setState({includeAllAssets:e})}},{key:"toggleIncludeProjectSettings",value:function(e){this.setState({includeProjectSettings:e})}},{key:"componentDidMount",value:function(){this.openModal(),this.context.nima.setCancelCallback(this.closeModal)}},{key:"componentWillUnmount",value:function(){this.context.nima.clearCancelCallback(this.closeModal)}},{key:"export",value:function(){var e=this.context.nima;if(e.hasCopyAccess){this.setState({isExporting:!0});var t=this,n=e.actor,r=e.file.name,o=n.serialize(!1);this.state.includeProjectSettings&&(o.settings=e.serializeSettings()),this.state.exportAnimations||delete o.animations;var i=o.assets,a=[],s=[];if(i){!function e(r){for(var o=0;o<r.length;o++){var i=r[o],s=n.getAsset(i.id);(s&&t.state.includeAllAssets||n.isAssetUsed(s))&&a.push(i),i.children&&e(i.children)}}(i);var l=!0,c=!1,f=void 0;try{for(var h,p=i[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var y=h.value,v=n.getAsset(y.id);(v&&t.state.includeAllAssets||n.isAssetUsed(v))&&s.push(y)}}catch(e){c=!0,f=e}finally{try{!l&&p.return&&p.return()}finally{if(c)throw f}}}o.assets=s,d.default.createWriter(new d.default.BlobWriter("application/octet-stream"),function(e){e.add(r+".flr2d",new d.default.TextReader(JSON.stringify(o)),function(){var o=0;function i(){++o>=a.length?e.close(function(e){console.log("BLOB",e);var n=URL.createObjectURL(e);console.log(n),t.setState({isExporting:!1,downloadURL:n,downloadFilename:r+".flr2d"})}):s()}function s(){var t,r=a[o],s=n.getAsset(r.id);s.bitmap?u.default.toBlob(s.bitmap,(t=r.id,function(n){e.add(t,new d.default.BlobReader(new Blob([n],{type:"image/png"})),i)})):i()}o==a.length?i():s()},function(e,t){})},function(e){}),this.setState({downloadURL:null})}}},{key:"exit",value:function(){clearTimeout(this.buildTimeout),this.setState({isOpen:!1,isClosing:!0}),this.props.onExportComplete()}},{key:"openModal",value:function(){this.setState({isModalOpen:!0,isModalClosing:!1})}},{key:"closeModal",value:function(){this.setState({isModalOpen:!1,isModalClosing:!0}),this.props.onExportComplete()}},{key:"render",value:function(){return i.default.createElement(c.default,{addClass:"ExportModal",isOpen:this.state.isModalOpen,isClosing:this.state.isModalClosing,onClose:this.closeModal},i.default.createElement("div",{className:"ModalHeader"},i.default.createElement("div",{className:"ModalHeadline"},"Download File"),i.default.createElement("div",{className:"ModalSubHeadline"},"Export a shareable version of this project file in its current form. You can share this file with other 2Dimensions users, but please note that revision history is not saved with your backup.")),i.default.createElement("div",{className:"ModalContent"},i.default.createElement("div",{className:"ExportGroup"},i.default.createElement("div",{className:"ExportGroupTitle"},"Export Options"),i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"ExportGroupPropertyTitle"},"Include Animations"),i.default.createElement(l.default,{addClass:"ContrastToggle",isOn:this.state.exportAnimations,onToggle:this.toggleExportAnimations})),i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"ExportGroupPropertyTitle"},"Include Unused Assets"),i.default.createElement(l.default,{addClass:"ContrastToggle",isOn:this.state.includeAllAssets,onToggle:this.toggleIncludeAllAssets})),i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"ExportGroupPropertyTitle"},"Include Project Settings"),i.default.createElement(l.default,{addClass:"ContrastToggle",isOn:this.state.includeProjectSettings,onToggle:this.toggleIncludeProjectSettings}))),this.state.downloadURL?i.default.createElement("div",{className:"ExportGroup"},i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"SingleLabel"},"Download Link"),i.default.createElement("a",{href:this.state.downloadURL,download:this.state.downloadFilename},this.state.downloadFilename))):null),i.default.createElement("div",{className:"ModalFooter"},i.default.createElement("div",{className:this.state.isExporting?"ModalFooterBtn ModalFooterBtnDisabled":"ModalFooterBtn",onClick:this.export},"Export")))}}]),t}()).prototype,"toggleExportAnimations",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleExportAnimations"),r.prototype),h(r.prototype,"toggleIncludeAllAssets",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleIncludeAllAssets"),r.prototype),h(r.prototype,"toggleIncludeProjectSettings",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleIncludeProjectSettings"),r.prototype),h(r.prototype,"export",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"export"),r.prototype),h(r.prototype,"exit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"exit"),r.prototype),h(r.prototype,"openModal",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"openModal"),r.prototype),h(r.prototype,"closeModal",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"closeModal"),r.prototype),r);t.default=p,p.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=p(n(1)),a=p(n(2)),s=p(n(5)),l=(p(n(1258)),p(n(676))),u=(p(n(220)),p(n(238))),c=(p(n(1259)),n(668)),d=p(c),f=p(n(164)),h=(p(n(3)),p(n(1260)));function p(e){return e&&e.__esModule?e:{default:e}}function y(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var v=(y((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isExporting:!1,maxImageWidth:null,maxImageHeight:null,linkImageSize:!0,linkAtlasSize:!0,maxAtlasWidth:2048,maxAtlasHeight:2048,atlasPowerOfTwo:!0,atlasSquare:!1,cropImages:!0,maxKeyFrameTimeIsDuration:!1,padding:1,isModalOpen:!1,isModalClosing:!1,selectedExportFormat:c.WRITER_FORMATS.BINARY},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentDidMount",value:function(){this.openModal(),this.context.nima.setCancelCallback(this.closeModal)}},{key:"componentWillUnmount",value:function(){this.context.nima.clearCancelCallback(this.closeModal)}},{key:"export",value:function(){var e=this.context.nima;if(e.hasCopyAccess){var t=e.file.name||"character",n=this.state.selectedExportFormat,r=new d.default({animations:e.actor.animations,characterName:t,multiplyAlpha:!1,isZipExport:!1,maxImageWidth:this.state.maxImageWidth,maxImageHeight:this.state.maxImageHeight,maxAtlasWidth:this.state.maxAtlasWidth,maxAtlasHeight:this.state.maxAtlasHeight,atlasPowerOfTwo:this.state.atlasPowerOfTwo,atlasSquare:this.state.atlasSquare,cropImages:this.state.cropImages,atlasPadding:this.state.padding,cropAnimationsToWorkArea:!0,maxKeyFrameTimeIsDuration:this.state.maxKeyFrameTimeIsDuration,extension:".flr",writerFormat:n}),o=this;r.export(e.actor,function(e){e?((0,l.default)(t+(r.options.isZipExport?".zip":r.options.extension),e),o.setState({isExporting:!1}),o.closeModal()):o.context.nima.alert("Export Error","The export failed, please try again with different options.")}),this.setState({isExporting:!0})}}},{key:"changePadding",value:function(e){isNaN(e)||this.setState({padding:e})}},{key:"changeMaxAtlasWidth",value:function(e){var t={};t.maxAtlasWidth=e,this.state.linkAtlasSize&&(t.maxAtlasHeight=e),this.setState(t)}},{key:"changeMaxAtlasHeight",value:function(e){var t={};t.maxAtlasHeight=e,this.state.linkAtlasSize&&(t.maxAtlasWidth=e),this.setState(t)}},{key:"changeMaxImageWidth",value:function(e){var t={};t.maxImageWidth=e,this.state.linkImageSize&&(t.maxImageHeight=e),this.setState(t)}},{key:"changeMaxImageHeight",value:function(e){var t={};t.maxImageHeight=e,this.state.linkImageSize&&(t.maxImageWidth=e),this.setState(t)}},{key:"toggleLinkAtlasSize",value:function(){var e={linkAtlasSize:!this.state.linkAtlasSize};e.linkAtlasSize&&(e.maxAtlasHeight=e.maxAtlasWidth=Math.max(this.state.maxAtlasWidth,this.state.maxAtlasHeight)),this.setState(e)}},{key:"toggleLinkImageSize",value:function(){var e={linkImageSize:!this.state.linkImageSize};e.linkImageSize&&(e.maxImageHeight=e.maxImageWidth=Math.max(this.state.maxImageWidth,this.state.maxImageHeight)),this.setState(e)}},{key:"toggleAtlasPowerOfTwo",value:function(e){this.setState({atlasPowerOfTwo:e})}},{key:"toggleAtlasSquare",value:function(e){this.setState({atlasSquare:e})}},{key:"toggleCropImages",value:function(e){this.setState({cropImages:e})}},{key:"toggleMaxKeyFrameTimeIsDuration",value:function(e){this.setState({maxKeyFrameTimeIsDuration:e})}},{key:"changeEngine",value:function(e){}},{key:"onFormatSelected",value:function(e){this.setState({selectedExportFormat:e})}},{key:"exit",value:function(){clearTimeout(this.buildTimeout),this.setState({isOpen:!1,isClosing:!0}),this.props.onExportComplete()}},{key:"openModal",value:function(){this.setState({isModalOpen:!0,isModalClosing:!1})}},{key:"closeModal",value:function(){this.setState({isModalOpen:!1,isModalClosing:!0}),this.props.onExportComplete()}},{key:"render",value:function(){return i.default.createElement(f.default,{addClass:"ExportModal",isOpen:this.state.isModalOpen,isClosing:this.state.isModalClosing,onClose:this.closeModal},i.default.createElement("div",{className:"ModalHeader"},i.default.createElement("div",{className:"ModalHeadline"},"Export"),i.default.createElement("div",{className:"ModalSubHeadline"},"Make sure you download the latest ",i.default.createElement("a",{href:"/runtimes",target:"_blank"},"runtime")," for your engine.")),i.default.createElement("div",{className:"ModalContent"},i.default.createElement("div",{className:"ExportGroup"},i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"LockedSizeLabel"},"Format:"),i.default.createElement(h.default,{options:[c.WRITER_FORMATS.BINARY,c.WRITER_FORMATS.JSON],onSwitched:this.onFormatSelected}))),i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"ExportGroupPropertyTitle"},"Duration from Last Keyframe"),i.default.createElement(u.default,{addClass:"ContrastToggle",isOn:this.state.maxKeyFrameTimeIsDuration,onToggle:this.toggleMaxKeyFrameTimeIsDuration}))),i.default.createElement("div",{className:"ModalFooter"},i.default.createElement("div",{className:this.state.isExporting?"ModalFooterBtn ModalFooterBtnDisabled":"ModalFooterBtn",onClick:this.export},"Export")))}}]),t}()).prototype,"export",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"export"),r.prototype),y(r.prototype,"changePadding",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changePadding"),r.prototype),y(r.prototype,"changeMaxAtlasWidth",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMaxAtlasWidth"),r.prototype),y(r.prototype,"changeMaxAtlasHeight",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMaxAtlasHeight"),r.prototype),y(r.prototype,"changeMaxImageWidth",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMaxImageWidth"),r.prototype),y(r.prototype,"changeMaxImageHeight",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMaxImageHeight"),r.prototype),y(r.prototype,"toggleLinkAtlasSize",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleLinkAtlasSize"),r.prototype),y(r.prototype,"toggleLinkImageSize",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleLinkImageSize"),r.prototype),y(r.prototype,"toggleAtlasPowerOfTwo",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleAtlasPowerOfTwo"),r.prototype),y(r.prototype,"toggleAtlasSquare",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleAtlasSquare"),r.prototype),y(r.prototype,"toggleCropImages",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleCropImages"),r.prototype),y(r.prototype,"toggleMaxKeyFrameTimeIsDuration",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleMaxKeyFrameTimeIsDuration"),r.prototype),y(r.prototype,"changeEngine",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeEngine"),r.prototype),y(r.prototype,"onFormatSelected",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onFormatSelected"),r.prototype),y(r.prototype,"exit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"exit"),r.prototype),y(r.prototype,"openModal",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"openModal"),r.prototype),y(r.prototype,"closeModal",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"closeModal"),r.prototype),r);t.default=v,v.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(1)),a=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var u=(l((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isFocused:!1,input:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"inputFocused",value:function(){var e=Math.round(this.props.value);this.props.optional&&(e||(e="")),this.setState({isFocused:!0,input:e});var t=this.textInput;setTimeout(function(){t.select()},0)}},{key:"inputBlurred",value:function(){var e=this.state.input;if(null!=e){var t=parseFloat(e);this.props.valueChanged&&(this.props.optional&&!t?t="":t||(t=this.props.value),this.props.valueChanged(t))}this.setState({isFocused:!1})}},{key:"inputText",value:function(e){this.setState({input:e.target.value})}},{key:"keyDown",value:function(e){switch(e.keyCode){case 13:this.textInput.blur();break;case 27:this.state.input=null,this.textInput.blur()}}},{key:"setTextInput",value:function(e){this.textInput=e}},{key:"render",value:function(){var e=this.state.isFocused?this.state.input:this.props.value;return null===e&&(e=""),i.default.createElement("input",{ref:this.setTextInput,type:"number",className:this.props.className||"LockedSizeInput",value:e,onKeyDown:this.keyDown,onChange:this.inputText,onFocus:this.inputFocused,onBlur:this.inputBlurred})}}]),t}()).prototype,"inputFocused",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputFocused"),r.prototype),l(r.prototype,"inputBlurred",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputBlurred"),r.prototype),l(r.prototype,"inputText",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"inputText"),r.prototype),l(r.prototype,"keyDown",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"keyDown"),r.prototype),l(r.prototype,"setTextInput",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setTextInput"),r.prototype),r);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(3));function l(e){return e&&e.__esModule?e:{default:e}}var u,c,d,f,h,p,y=(r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"mouseDown",value:function(){this.props.onToggle&&this.props.onToggle()}},{key:"render",value:function(){return i.default.createElement("div",null,i.default.createElement("svg",{className:this.props.linked?"LinkToggleIcon":"UnlinkToggleIcon",onMouseDown:this.mouseDown},i.default.createElement("use",{xlinkHref:this.props.linked?s.default.make("/images/symbol-defs.svg#icon-link"):s.default.make("/images/symbol-defs.svg#icon-unlink")})))}}]),t}(),u=r.prototype,c="mouseDown",d=[a.default],f=Object.getOwnPropertyDescriptor(r.prototype,"mouseDown"),h=r.prototype,p={},Object.keys(f).forEach(function(e){p[e]=f[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=d.slice().reverse().reduce(function(e,t){return t(u,c,e)||e},p),h&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(h):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(u,c,p),p=null),r);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(1)),a=s(n(2));function s(e){return e&&e.__esModule?e:{default:e}}var l,u,c,d,f,h,p=(r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={options:e.options,selectedToggle:e.options[0]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"toggleChanged",value:function(e){var t=e.target.id;this.selectedToggle!==t&&(this.selectedToggle=t,this.setState({selectedToggle:t}),this.props.onSwitched&&this.props.onSwitched(t))}},{key:"render",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,a=this.state.options[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;e.push(i.default.createElement("div",{className:"textToggleButton",key:s},i.default.createElement("input",{type:"radio",name:"optionToggle",id:s,checked:s===this.state.selectedToggle,onChange:this.toggleChanged}),i.default.createElement("label",{htmlFor:s,unselectable:"true"},s)))}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return i.default.createElement("div",{className:"TextToggleButtons"},e)}}]),t}(),l=r.prototype,u="toggleChanged",c=[a.default],d=Object.getOwnPropertyDescriptor(r.prototype,"toggleChanged"),f=r.prototype,h={},Object.keys(d).forEach(function(e){h[e]=d[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=c.slice().reverse().reduce(function(e,t){return t(l,u,e)||e},h),f&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(f):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(l,u,h),h=null),r);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=O(n(1)),a=O(n(2)),s=O(n(5)),l=O(n(220)),u=O(n(238)),c=O(n(216)),d=O(n(528)),f=O(n(1262)),h=O(n(176)),p=O(n(195)),y=O(n(522)),v=O(n(253)),m=O(n(266)),g=O(n(179)),b=n(7),k=O(n(164)),S=O(n(3));function O(e){return e&&e.__esModule?e:{default:e}}function w(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var _=(w((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isExporting:!1,capturedFrames:0,exportProgress:0,archiveProgress:0,maxImageHeight:null,linkImageSize:!0,linkAtlasSize:!0,maxAtlasWidth:2048,maxAtlasHeight:2048,atlasPowerOfTwo:!0,atlasSquare:!1,cropImages:!0,padding:1,isModalOpen:!1,isModalClosing:!1,engines:[{label:"PNG",format:"png"},{label:"TGA",format:"tga"},{label:"GIF",format:"gif"}],selectedEngineIndex:0,selectedAnimationIndex:0,matteColor:[255,255,255],scale:1,highQualityScale:!1,conserveMemory:!1},n._OldAnimation=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.exporter=new f.default;for(var e=this.context.nima.animations,t=[{label:"All",animations:e}],n=0;n<e.length;n++){var r=e[n];t.push({label:r.name,animations:[r]})}this.state.animationOptions=t}},{key:"getFrameRateDivisor",value:function(){return"gif"===this.state.engines[this.state.selectedEngineIndex].format?100:1e7}},{key:"componentDidMount",value:function(){this.openModal(),this.context.nima.setCancelCallback(this.closeModal)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.buildTimeout),this.context.nima.clearCancelCallback(this.closeModal)}},{key:"setScale",value:function(e){e<.1&&(e=.1),this.setState({scale:e})}},{key:"export",value:function(){this.state.downloadURL&&URL.revokeObjectURL(this.state.downloadURL);var e=this.state,t=e.scale,n=e.highQualityScale,r=this.exporter,o=this.context.nima.stage,i=this.context.nima.actor,a=this.context.nima,s=a.file.name;a.revisionManager.blockSaving(!0);var l=this.state.animationOptions[this.state.selectedAnimationIndex],u=l.animations[0],c=0,d=0,f=0;this.context.nima.editingAnimation=u;for(var k=[h.default,p.default,y.default,v.default,m.default],S=0;S<k.length;S++){var O=o.getLayerOptions(k[S]);k[S]={options:O,hidden:O.disableDraw},O.disableDraw=!0}for(var w=0,_=0;_<l.animations.length;_++){var P=l.animations[_];P._pp=P.position;var C=Math.floor(P.duration*P.getFpsWithDivisor(this.getFrameRateDivisor()));C>w&&(w=C)}var E=w.toString().length;var T=10,I=this,j={setup:function(){var e={};u.setPosition(d/u.getFpsWithDivisor(I.getFrameRateDivisor()),!0),i.advance(0,u,!1);var r=o.getCombinedAABB(o.filterItems(function(e){return e instanceof g.default})),h=n?1:t;e.renderWidth=Math.ceil(h*r.boxWidth),e.renderHeight=Math.ceil(h*r.boxHeight),e.renderView=b.mat2d.create();var p=r.min;return e.renderView[0]=h,e.renderView[3]=h,e.renderView[4]=-Math.floor(h*p[0]),e.renderView[5]=-Math.floor(h*p[1]),e.aabb=r,e.min=[Math.floor(h*p[0]),Math.floor(h*p[1])],e.name=s+"-"+u.name+"-"+(1e15+d+"").slice(-E),f++,++d/u.getFpsWithDivisor(I.getFrameRateDivisor())>u.duration&&(d=0,++c<l.animations.length?(u=l.animations[c],a.editingAnimation=u):u=null),u?f%T==0&&(I.setState({capturedFrames:f}),A()):(I.setState({capturedFrames:f}),o.clearRenderCapture()),e},complete:function(e,o,i){r.addFrame(this.context.name,e,o,i,this.context.min,n?t:1)},cleanup:function(e){u||function(){var e=I.state.engines[I.state.selectedEngineIndex];I.context.nima.editingAnimation=I._OldAnimation;var t=e.format;"gif"===t&&(t+="-"+l.animations[0].getFpsWithDivisor(I.getFrameRateDivisor()),t+="-"+I.state.matteColor[0]+"-"+I.state.matteColor[1]+"-"+I.state.matteColor[2]);r.getZip(t,function(e){var t=e;I.progress!=t&&(I.progress=t,I.setState({archiveProgress:t}))},function(t){console.log("GOT ZIP",t),"gif"===e.format?I.setState({isExporting:!1,downloadURL:t,downloadFilename:D+".gif"}):I.setState({isExporting:!1,downloadURL:t,downloadFilename:D+".zip"})});for(var n=0;n<l.animations.length;n++){var o=l.animations[n];o.setPosition(o._pp,!0)}var i=!0,s=!1,u=void 0;try{for(var c,d=k[Symbol.iterator]();!(i=(c=d.next()).done);i=!0){var f=c.value;f.options.disableDraw=f.hidden}}catch(e){s=!0,u=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw u}}a.revisionManager.blockSaving(!1)}()}};function A(){for(var e=0;e<T;e++)o.addRenderCapture(j)}var D=this.context.nima.file.name||"character";r.reset({optimizeMemory:this.state.conserveMemory},function(){A()}),this.setState({isExporting:!0,capturedFrames:0,exportProgress:0,archiveProgress:0,downloadURL:null})}},{key:"changeEngine",value:function(e){this.setState({selectedEngineIndex:e})}},{key:"changeAnimation",value:function(e){this.setState({selectedAnimationIndex:e})}},{key:"exit",value:function(){clearTimeout(this.buildTimeout),this._OldAnimation?(this.context.nima.editingAnimation!==this._OldAnimation&&(this.context.nima.editingAnimation=this._OldAnimation),this._OldAnimation=null):this.context.nima.editingAnimation=null,this.context.nima.stage.clearRenderCapture(),this.context.nima.revisionManager.blockSaving(!1),this.setState({isOpen:!1,isClosing:!0}),this.props.onExportComplete()}},{key:"toggleHighQualityScale",value:function(e){this.setState({highQualityScale:e})}},{key:"toggleConserveMemory",value:function(e){this.setState({conserveMemory:e})}},{key:"changeMatteColor",value:function(e){this.setState({matteColor:0===e?[0,0,0]:[255,255,255]})}},{key:"openModal",value:function(){this._OldAnimation=this.context.nima.editingAnimation,this.setState({isModalOpen:!0,isModalClosing:!1})}},{key:"closeModal",value:function(){this._OldAnimation?(this.context.nima.editingAnimation!==this._OldAnimation&&(this.context.nima.editingAnimation=this._OldAnimation),this._OldAnimation=null):this.context.nima.editingAnimation=null,this.context.nima.stage.clearRenderCapture(),this.context.nima.revisionManager.blockSaving(!1),this.setState({isModalOpen:!1,isModalClosing:!0}),this.props.onExportComplete()}},{key:"render",value:function(){for(var e=this.state.animationOptions[this.state.selectedAnimationIndex],t=this.state.engines[this.state.selectedEngineIndex],n=0,r=0;r<e.animations.length;r++){var o=e.animations[r];n+=Math.floor(o.duration*o.getFpsWithDivisor(this.getFrameRateDivisor()))}var a=null;return"gif"===t.format&&(a=["Black","White"]),i.default.createElement(k.default,{addClass:"ExportModal",isOpen:this.state.isModalOpen,isClosing:this.state.isModalClosing,onClose:this.closeModal},i.default.createElement("div",{className:"ModalHeader"},i.default.createElement("svg",{className:"ModalIcon ExportShotModalIcon"},i.default.createElement("use",{xlinkHref:S.default.make("/images/symbol-defs.svg#icon-image-sequence")})),i.default.createElement("div",{className:"ModalHeadline"},"Export Image Sequence"),i.default.createElement("div",{className:"ModalSubHeadline"},"Image sequences are rendered at your FPS setting. Bounds and dimensions are automatically calculated.")),i.default.createElement("div",{className:"ModalContent"},i.default.createElement("div",{className:"ExportGroup"},i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"LockedSizeLabel"},"Type:"),i.default.createElement(l.default,{options:this.state.engines,selectedIndex:this.state.selectedEngineIndex,onSelectionChanged:this.changeEngine,addClass:"ExportOptionsDropdown",disabled:this.state.isExporting}))),i.default.createElement("div",{className:"ExportGroup"},i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"SingleLabel"},"Animation"),i.default.createElement(l.default,{options:this.state.animationOptions,selectedIndex:this.state.selectedAnimationIndex,onSelectionChanged:this.changeAnimation,addClass:"ExportOptionsDropdown"})),i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"SingleLabel"},"Frames"),n),i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"SingleLabel"},"Scale"),i.default.createElement(c.default,{value:this.state.scale,converter:d.default,onValueChanged:this.setScale,addClass:"ContrastInput"})),i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"SingleLabel"},"High Quality Scale"),i.default.createElement(u.default,{addClass:"ContrastToggle",isOn:this.state.highQualityScale,onToggle:this.toggleHighQualityScale})),a?i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"SingleLabel"},"Matte"),i.default.createElement(l.default,{options:a,selectedIndex:255===this.state.matteColor[0]?1:0,onSelectionChanged:this.changeMatteColor,addClass:"ExportOptionsDropdown"})):null),i.default.createElement("div",{className:"ExportGroup"},i.default.createElement("div",{className:"ExportGroupTitle"},"Memory"),i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"LockedSizeLabel"},"Conserve Memory (slower)"),i.default.createElement(u.default,{addClass:"ContrastToggle",isOn:this.state.conserveMemory,onToggle:this.toggleConserveMemory}))),this.state.isExporting?i.default.createElement("div",{className:"ExportGroup"},i.default.createElement("div",{className:"ExportGroupTitle"},"Export Progress"),i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"SingleLabel"},"Rendering"),Math.min(n,this.state.capturedFrames)+"/"+n),i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"SingleLabel"},"Archiving"),this.state.archiveProgress+"%"),this.state.downloadURL?i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"SingleLabel"},"Download Link"),i.default.createElement("a",{href:this.state.downloadURL,download:this.state.downloadFilename},this.state.downloadFilename)):null):null,this.state.downloadURL?i.default.createElement("div",{className:"ExportGroup"},i.default.createElement("div",{className:"ExportGroupProperty"},i.default.createElement("div",{className:"SingleLabel"},"Download Link"),i.default.createElement("a",{href:this.state.downloadURL,download:this.state.downloadFilename},this.state.downloadFilename))):null,null),i.default.createElement("div",{className:"ModalFooter"},i.default.createElement("div",{className:this.state.isExporting?"ModalFooterBtn ModalFooterBtnDisabled":"ModalFooterBtn",onClick:this.export},"Export")))}}]),t}()).prototype,"setScale",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setScale"),r.prototype),w(r.prototype,"export",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"export"),r.prototype),w(r.prototype,"changeEngine",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeEngine"),r.prototype),w(r.prototype,"changeAnimation",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeAnimation"),r.prototype),w(r.prototype,"exit",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"exit"),r.prototype),w(r.prototype,"toggleHighQualityScale",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleHighQualityScale"),r.prototype),w(r.prototype,"toggleConserveMemory",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"toggleConserveMemory"),r.prototype),w(r.prototype,"changeMatteColor",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"changeMatteColor"),r.prototype),w(r.prototype,"openModal",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"openModal"),r.prototype),w(r.prototype,"closeModal",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"closeModal"),r.prototype),r);t.default=_,_.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1263),a=(r=i)&&r.__esModule?r:{default:r};var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Worker=new a.default}return o(e,[{key:"reset",value:function(e,t){this._Worker.reset(e,t)}},{key:"addFrame",value:function(e,t,n,r,o,i){this._Worker.addFrame(e,t,n,r,o,i)}},{key:"getZip",value:function(e,t,n){this._Worker.zipFrames(e,function(e){return e.constructor===Number?(t(e),!0):(n(e),!1)})}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=new Worker(i.default.getWorkerScript("ImageSequenceWorker.js")),t=0,n={};function r(r,o,i){t++,i&&(n[t]=i),o.push(t),e.postMessage({call:r,arguments:o})}var o=document.createElement("canvas");e.onmessage=function(e){if("PNG"===e.data.id){var t=e.data.width,i=e.data.height,a=e.data.pixels;o.width=t,o.height=i;for(var s=o.getContext("2d"),l=new Uint8ClampedArray(a.length),u=0;u<i;u++)for(var c=0;c<t;c++)for(var d=4*(u*t+c),f=4*((i-u-1)*t+c),h=0;h<4;h++)l[f+h]=a[d+h];var p=new ImageData(l,t,i);return s.putImageData(p,0,0),void o.toBlob(function(e){r("PNG",[e])})}var y=n[e.data.id];if(y){if(y(e.data.response))return;delete n[e.data.id]}},this.reset=function(e,t){r("reset",[e],t)},this.addFrame=function(e,t,n,o,i,a){r("addFrame",[e,t,n,o,i,a])},this.zipFrames=function(e,t){r("zipFrames",[e],t)},this.call=r};var r,o=n(208),i=(r=o)&&r.__esModule?r:{default:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=d(n(1)),a=d(n(2)),s=d(n(5)),l=d(n(1265)),u=d(n(1266)),c=d(n(1267));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var h=(f((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dimensions:null},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"componentWillMount",value:function(){this.direction=1}},{key:"componentWillUnmount",value:function(){}},{key:"componentDidMount",value:function(){var e=this.root.getBoundingClientRect();this.setState({dimensions:e})}},{key:"hideRecursiveSubMenu",value:function(e){e.showingMenu&&(this.hideRecursiveSubMenu(e.showingMenu),this.props.onHide(e.showingMenu),e.showingMenu=null)}},{key:"enterItem",value:function(e){this.props.data.showingMenu!==e.props.data&&this.hideRecursiveSubMenu(this.props.data)}},{key:"enter",value:function(e){}},{key:"buildItemList",value:function(e,n){var r=[];if(!e)return r;for(var o=2*t.Margin,a=0;a<e.items.length;a++){var s=e.items[a];"Divider"==s.type?(r.push(i.default.createElement(l.default,{key:a,onMouseEnter:this.enterItem})),o+=t.DividerHeight):"SubMenu"==s.type?(o+=t.ItemHeight,r.push(i.default.createElement(u.default,{parent:e,parentComponent:n,key:s.name,data:s,onMouseEnter:this.enterItem}))):(o+=t.ItemHeight,r.push(i.default.createElement(c.default,{key:a,data:s,onMouseEnter:this.enterItem})))}return e.height=o,r}},{key:"setRoot",value:function(e){this.root=e}},{key:"queueRemove",value:function(e){2===e.button?this.willRemove=!0:this.willRemove=!1}},{key:"removeIfQueued",value:function(e){if(2===e.button&&this.willRemove){var t=this;setTimeout(function(){t.context.nima.removeContextMenus()},10)}}},{key:"render",value:function(){var e=this.props.data||{x:0,y:0,items:[]},t=this.buildItemList(e,this),n=e.parentComponent?e.x:e.x+2,r=Math.min(window.innerHeight-e.height-20,e.y);e.parentComponent&&(r-=10);var o=this.state.dimensions;return o&&(o.right>window.innerWidth-20?e.parentComponent?(n-=e.parentComponent.state.dimensions.width+o.width,this.direction=-1):n=e.x-(o.width+2):e.parentComponent&&-1==e.parentComponent.direction&&(n-=e.parentComponent.state.dimensions.width+o.width)),i.default.createElement("div",{ref:this.setRoot,onMouseDown:this.queueRemove,onMouseUp:this.removeIfQueued,className:"RightClickMenu",style:{opacity:null==o?0:null,left:n+"px",top:r+"px"},onMouseEnter:this.enter},t)}}]),t}()).prototype,"enterItem",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"enterItem"),r.prototype),f(r.prototype,"enter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"enter"),r.prototype),f(r.prototype,"setRoot",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setRoot"),r.prototype),f(r.prototype,"queueRemove",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"queueRemove"),r.prototype),f(r.prototype,"removeIfQueued",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"removeIfQueued"),r.prototype),r);t.default=h,h.MaxWidth=200,h.Margin=10,h.ItemHeight=35,h.DividerHeight=21,h.contextTypes={nima:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(5));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"enter",value:function(e){this.context.editor.setContextMenuItemData(this),this.props.onMouseEnter&&this.props.onMouseEnter(this)}},{key:"leave",value:function(e){this.context.editor.clearContextMenuItemData(this)}},{key:"render",value:function(){return i.default.createElement("div",{className:"RightClickDivider",onMouseEnter:this.enter,onMouseLeave:this.leave})}}]),t}()).prototype,"enter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"enter"),r.prototype),u(r.prototype,"leave",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"leave"),r.prototype),r);t.default=c,c.contextTypes={editor:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=l(n(1)),a=l(n(2)),s=l(n(5));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var c=(u((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"enter",value:function(e){if(this.props.onMouseEnter&&this.props.onMouseEnter(this),this.props.parent.showingMenu!==this.props.data){var t=this.root.getBoundingClientRect();this.props.data.x=t.right,this.props.data.y=t.top,this.props.data.parent=this.props.parent,this.props.data.parentComponent=this.props.parentComponent,this.props.parent.showingMenu=this.props.data,this.context.editor.addContextMenu(this.props.data),this.context.editor.setContextMenuItemData(this.props.data)}}},{key:"leave",value:function(e){this.context.editor.clearContextMenuItemData(this.props.data)}},{key:"setRoot",value:function(e){this.root=e}},{key:"render",value:function(){var e=this.props.data;return i.default.createElement("div",{ref:this.setRoot,key:e.name,className:"RightClickListItem ListItemSubMenu",onMouseEnter:this.enter,onMouseLeave:this.leave},e.name,i.default.createElement("div",{className:"SubMenuArrow"},i.default.createElement("div",null)))}}]),t}()).prototype,"enter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"enter"),r.prototype),u(r.prototype,"leave",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"leave"),r.prototype),u(r.prototype,"setRoot",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"setRoot"),r.prototype),r);t.default=c,c.contextTypes={editor:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),a=u(n(2)),s=u(n(5)),l=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var d=(c((r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"enter",value:function(e){this.context.editor.setContextMenuItemData(this.props.data),this.props.onMouseEnter&&this.props.onMouseEnter(this)}},{key:"leave",value:function(e){this.context.editor.clearContextMenuItemData(this.props.data)}},{key:"render",value:function(){var e=this.props.data;return i.default.createElement("div",{className:e.isActive?"RightClickListItemActive":"RightClickListItem",onMouseEnter:this.enter,onMouseLeave:this.leave},e.icon?i.default.createElement("svg",{className:"RightClickListIcon"},i.default.createElement("use",{xlinkHref:l.default.make("/images/symbol-defs.svg#icon-"+e.icon)})):null,e.name)}}]),t}()).prototype,"enter",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"enter"),r.prototype),c(r.prototype,"leave",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"leave"),r.prototype),r);t.default=d,d.contextTypes={editor:s.default.object}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=l(n(1)),s=l(n(2));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function f(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var h=(f((r=function(e){function t(e){u(this,t);var n=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isOpen:!1,hasHover:!1},n}return d(t,a.default.Component),i(t,[{key:"componentWillMount",value:function(){window.addEventListener("click",this.close,!0)}},{key:"close",value:function(){this.setState({isOpen:!1});var e=this;clearTimeout(this.closeTimeout),this.props.onHiding(this.props.data),this.closeTimeout=setTimeout(function(){e.props.onHide(e.props.data)},200)}},{key:"componentDidMount",value:function(){var e=this.dropdownPanel.getBoundingClientRect().height;this.setState({height:e,isOpen:!0})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.close,!0)}},{key:"select",value:function(e){this.props.data.onSelectionChanged&&this.props.data.onSelectionChanged(e),this.close()}},{key:"setDropdownPanel",value:function(e){this.dropdownPanel=e}},{key:"hoverOn",value:function(e){this.setState({hasHover:!0,descTitle:e.hoverTitle,descBody:e.hoverDesc,descIcon:e.hoverIcon})}},{key:"hoverDescOn",value:function(e){this.setState({hasHover:!0}),window.removeEventListener("click",this.close,!0)}},{key:"hoverDescOff",value:function(e){this.setState({hasHover:!1}),window.addEventListener("click",this.close,!0)}},{key:"hoverOff",value:function(e){this.setState({hasHover:!1})}},{key:"selectOption",value:function(e){var t=this.props.data.options.indexOf(e);this.select(t)}},{key:"render",value:function(){var e=this,t=this.props.data,n=t.rect,r=t.options,o=t.dropdownClass,i=n.top,s=i+25*r.length;s>window.innerHeight&&(s=(i-=s-window.innerHeight+10)+25*r.length);var l=s>window.innerHeight?window.innerHeight-i-50:s;return a.default.createElement("div",{className:o?o+" DropdownPanel":"DropdownPanel",style:{opacity:this.state.isOpen?"1":"0",marginTop:this.state.isOpen?"-14px":"-24px",height:this.state.isOpen?this.state.height:"0px",maxHeight:l,left:this.props.data.rect.left+"px",top:i+"px",minWidth:this.props.data.rect.width+30+"px"}},a.default.createElement("div",{className:"DropdownPanelDesc",onMouseOver:this.hoverDescOn,onMouseLeave:this.hoverDescOff,style:{width:this.state.hasHover?null:"0px"}},a.default.createElement("div",{className:"DropdownPanelDescContent"},this.state.descIcon?a.default.createElement("div",{className:"DropdownPanelDescIcon",dangerouslySetInnerHTML:{__html:this.state.descIcon}}):null,a.default.createElement("div",{className:"DropdownPanelDescTitle"},this.state.descTitle),a.default.createElement("div",{className:"DropdownPanelDescBody",dangerouslySetInnerHTML:{__html:this.state.descBody}}))),a.default.createElement("div",{className:"DropdownPanelScroll",style:{overflowY:l<this.state.height?"scroll":null}},a.default.createElement("div",{className:"DropdownPanelCalcHeight",ref:this.setDropdownPanel},r.map(function(t){return a.default.createElement(p,{key:t.value||t.label,hoverTitle:t.hoverTitle,label:t.label,active:t.active,option:t,hoverOn:e.hoverOn,hoverOff:e.hoverOff,select:e.selectOption})}))))}}]),t}()).prototype,"close",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"close"),r.prototype),f(r.prototype,"select",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"select"),r.prototype),f(r.prototype,"setDropdownPanel",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"setDropdownPanel"),r.prototype),f(r.prototype,"hoverOn",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"hoverOn"),r.prototype),f(r.prototype,"hoverDescOn",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"hoverDescOn"),r.prototype),f(r.prototype,"hoverDescOff",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"hoverDescOff"),r.prototype),f(r.prototype,"hoverOff",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"hoverOff"),r.prototype),f(r.prototype,"selectOption",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"selectOption"),r.prototype),r);t.default=h;var p=(f((o=function(e){function t(){return u(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d(t,a.default.Component),i(t,[{key:"hoverOn",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.hoverOn&&this.props.hoverOn(this.props.option)}},{key:"hoverOff",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.hoverOff&&this.props.hoverOff(this.props.option)}},{key:"mouseDown",value:function(){this.props.select&&this.props.select(this.props.option)}},{key:"render",value:function(){var e=this.props.option,t=e.hoverTitle,n=e.label,r=e.active;return a.default.createElement("div",{className:r?"DropdownOptionActive":"DropdownOption",onMouseEnter:t?this.hoverOn:null,onMouseLeave:t?this.hoverOff:null,onClick:this.mouseDown},n)}}]),t}()).prototype,"hoverOn",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"hoverOn"),o.prototype),f(o.prototype,"hoverOff",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"hoverOff"),o.prototype),f(o.prototype,"mouseDown",[s.default],Object.getOwnPropertyDescriptor(o.prototype,"mouseDown"),o.prototype),o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=G(n(2)),a=G(n(18)),s=G(n(171)),l=G(n(264)),u=G(n(1270)),c=G(n(263)),d=G(n(1274)),f=G(n(1618)),h=G(n(1619)),p=G(n(331)),y=G(n(646)),v=G(n(254)),m=G(n(198)),g=G(n(303)),b=G(n(203)),k=G(n(514)),S=G(n(349)),O=G(n(347)),w=G(n(686)),_=G(n(1620)),P=G(n(16)),C=G(n(348)),E=G(n(245)),T=G(n(17)),I=G(n(173)),j=G(n(237)),A=G(n(506)),D=G(n(19)),R=G(n(244)),M=G(n(275)),x=G(n(419)),F=G(n(517)),L=G(n(225)),N=G(n(252)),z=G(n(179)),V=G(n(230)),B=G(n(219)),H=G(n(197)),W=G(n(1)),K=G(n(162));function G(e){return e&&e.__esModule?e:{default:e}}function U(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function X(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var Y=0,J=new Map,q=(X((r=function(e){function t(e,n,r,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));s._IsReady=!1,s._BuildNumber=o,s._EditorUI=e,s._UserPreferences=r||{},s._User=n,s._Author=i.owner,s._Actor=null,s._LastAdvanceTime,s._AdvanceTimeout,s._IsDrawing=!1,s._LowFrequencyAdvanceTime=1/15*1e3,s._StartedDrawingTime=performance.now(),s._EditingAnimation,s._EditingShape=null,s._EditingShapePaths=[],s._EditingMesh=null,s._EditingWeights,s._IsAnimationEnabled=!1,s._AutoKey=!0,s._ErrorKey=null,s._File=i||null,s._ProjectPreferences={},s._LocalPreferences={},s._FilePreferences={},s._RevisionManager=new u.default(s),s._RevisionManager.addEventListener("fileLoaded",s.onFileLoaded),s._RevisionManager.addEventListener("fileRenamed",s.onFileRenamed),s._RevisionManager.addEventListener("stateChanged",s.onRMStateChanged),s._RMSaveAlert,s._ExpiredAlert,s._LastMouseX=0,s._LastMouseY=0,s._IncBrushSizeCallback=null,s._IncBrushFeatherCallback=null,s._IncBrushStrengthCallback=null,s._SelectIndexItemCallback=null,s._SelectIndexItemNextCallback=null,s._SelectIndexItemPreviousCallback=null,s._CleanupEvents=[],s._IsDragging=!1,s._IsExporting=!1,s._LastReportTime=0,s._FileAccess=E.default.Unknown,s._Journal=[],s._JournalIndex=-1,s._CancelCallback=null,s._SelectedItems=[],s._SaveLocalPreferencesTimeout=null,s._SaveUserPreferencesTimeout=null,s._SaveProjectPreferencesTimeout=null,s._SaveCharacterPreferencesTimeout=null,s._ReplaceTargets=null,s._WasCompensating={compensateBones:!1,compensateImages:!1},s._ExpandedHierarchyItems=new Set;var c,h=localStorage.getItem("preferences-"+s._User.id);try{h=JSON.parse(h)}catch(e){}for(var p in c=i.preferences||{},h=h||{},s._FilePreferences=c||{},h)s._LocalPreferences[p]=h[p];"dev-build"!==s._BuildNumber&&(s._OldErrorHandler=window.onerror,window.onerror=s.onError),s._Graphics=new l.default(s.makeCanvas,a),s._Canvas&&(s._Canvas.style.display="none"),s._Stage=new d.default(s,s._Canvas,s._Graphics),s._Stage.addEventListener("itemVisibilityChanged",s.onStageItemVisibilityChanged),s._Stage.addEventListener("remove",s.onStageItemRemoved),s._Stage.addEventListener("soloChanged",s.onSoloChanged),s._AnimationEditor=new f.default(s),s._Graphics.isLoading?s._Graphics.onLoaded=s.onGraphicsLoaded:s.onGraphicsLoaded();var y=document.body;return y.addEventListener("dragover",s.dragOver),y.addEventListener("dragleave",s.dragLeave),y.addEventListener("drop",s.dragDrop),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default),o(t,[{key:"onStageReady",value:function(){this.checkReady()}},{key:"checkReady",value:function(){this._Stage.isReady&&this._Actor&&this._Actor.onContextReady(this)}},{key:"onSoloChanged",value:function(){var e=this.editingShape;e&&this._Stage.soloItem!==e&&(this._EditingShape=null,this.editShapeOff(e))}},{key:"onStageItemRemoved",value:function(e){var t=this.editingShape;if(t){var n=!1;switch(e.constructor){case N.default:case z.default:n=e===t||-1!==this._EditingShapePaths.indexOf(e);break;case V.default:n=e===t}n&&(this._EditingShape=null,this.editShapeOff(t))}}},{key:"cleanup",value:function(){this.editingAnimation=null,this.editingShape=null,this._RevisionManager.removeEventListener("fileLoaded",this.onFileLoaded),this._RevisionManager.removeEventListener("fileRenamed",this.onFileRenamed),this._RevisionManager.removeEventListener("stateChanged",this.onRMStateChanged),this._RevisionManager.cleanup(),window.removeEventListener("contextmenu",this.onContextMenu,!1),window.removeEventListener("focus",this.onFocus),this._Canvas.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("drag",this.onDrag),this._Canvas.removeEventListener("mouseenter",this.onMouseEnterCanvas),this._Canvas.removeEventListener("mouseleave",this.onMouseLeaveCanvas),this._Canvas.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("mouseenter",this.onMouseEnterWindow),window.removeEventListener("mouseleave",this.onMouseLeaveWindow),window.removeEventListener("blur",this.onBlur),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),this._Stage.removeEventListener("itemVisibilityChanged",this.onStageItemVisibilityChanged),this._Stage.removeEventListener("remove",this.onStageItemRemoved),this._Stage.removeEventListener("soloChanged",this.onSoloChanged)}},{key:"toggleEditMode",value:function(){this.dispatch("toggleEditMode")}},{key:"revalidateSelectionPanel",value:function(){this._EditorUI.revalidateSelectionPanel()}},{key:"onStageItemVisibilityChanged",value:function(){!this._EditingAnimation||this._Actor.hasPlayingAnimations||this._IsDragging||this._EditingAnimation.updateNodes()}},{key:"onRMStateChanged",value:function(e){e.state==c.default.Idle?this._RMSaveAlert&&(this._RMSaveAlert.hide(),this._RMSaveAlert=null):e.state==c.default.Save&&(this._RMSaveAlert=this.alert({title:"Saving is taking a bit longer than usual.",message:"Please don't close your browser until this message has disappeared.",type:s.default.Types.Saving,buttons:[],delaySeconds:10,minimumDisplaySeconds:2}))}},{key:"onFileLoaded",value:function(e){this.setActor(e.actor),e.settings&&this.deserializeSettings(e.settings),this.dispatch("fileLoaded",e.actor),this._Stage.updateSettings()}},{key:"onFileRenamed",value:function(e){document.title=e.name,this.dispatch("fileRenamed",e)}},{key:"onGraphicsLoaded",value:function(){var e=this._Graphics;e.loadError?console.log("Graphics load error",e.loadError+"."):(console.log("Graphics ready."),this._Stage.onGraphicsReady(e),this.onAppReady())}},{key:"advance",value:function(){var e=performance.now(),t=(e-this._LastAdvanceTime)/1e3;this._LastAdvanceTime=e;var n=this._Stage,r=this._Actor,o=r&&r.advance(t,this._EditingAnimation,this._IsExporting,this),i=n.advance(t),a=this.devicePixelRatio,s=n.setSize(window.innerWidth*a,window.innerHeight*a,a);s||o||i?(this._IsDrawing||(this._IsDrawing=!0,this._StartedDrawingTime=performance.now()),this.draw(),s&&this._EditorUI.resizePanels()):this._IsDrawing&&(this._IsDrawing=!1),this.scheduleAdvance()}},{key:"draw",value:function(){this._EditorUI.drawRulers();var e=this._EditorUI.getGuides();this._Stage.draw(e)}},{key:"updateWindowSize",value:function(){this._Stage.setSize(window.innerWidth,window.innerHeight)}},{key:"scheduleAdvance",value:function(){clearTimeout(this._AdvanceTimeout),document.hasFocus()?window.requestAnimationFrame(this.advance):this._AdvanceTimeout=setTimeout(this.advance,this._LowFrequencyAdvanceTime)}},{key:"onContextMenu",value:function(e){e.preventDefault()}},{key:"onFocus",value:function(e){this.scheduleAdvance()}},{key:"onMouseDown",value:function(e){var t=this._Stage;if(t.onMouseDown(e),!t.mouseDownSelected&&0===t.numSelectedItems){var n=performance.now();this.lastClickTime&&n-this.lastClickTime<200&&(this.editingShape=null),this.lastClickTime=n}}},{key:"onMouseUp",value:function(e){this._Stage.onMouseUp(e)}},{key:"onMouseMove",value:function(e){var t=e.clientX-this._LastMouseX,n=e.clientY-this._LastMouseY;this._LastMouseX=e.clientX,this._LastMouseY=e.clientY,this._Stage.onMouseMove(e,t,n)}},{key:"onDrag",value:function(e){var t=e.clientX-this._LastMouseX,n=e.clientY-this._LastMouseY;this._LastMouseX=e.clientX,this._LastMouseY=e.clientY,this._Stage.onMouseMove(e,t,n)}},{key:"onMouseEnterCanvas",value:function(e){this._Stage.onMouseEnterStage(e)}},{key:"onMouseLeaveCanvas",value:function(e){this._Stage.onMouseLeaveStage(e)}},{key:"onMouseEnterWindow",value:function(e){this._Stage.onMouseEnter(e)}},{key:"onMouseLeaveWindow",value:function(e){this._Stage.onMouseLeave(e)}},{key:"onMouseWheel",value:function(e){this._Stage.onMouseWheel(e)}},{key:"onBlur",value:function(e){this.dispatch("blur")}},{key:"onKeyDown",value:function(e){if((P.default.isSearchAction(e)||P.default.isDuplicateAction(e)||P.default.isAltPressed(e))&&e.preventDefault(),(this._EditorUI.state.showCrashError||!(116===e.keyCode||P.default.isOSX&&82===e.keyCode&&e.metaKey||!P.default.isOSX&&82===e.keyCode&&e.ctrlKey)||!this.preventBrowserRefresh(e))&&e.target.constructor===HTMLBodyElement){if(this._Stage.onKeyDown(e))return;this.dispatch("keyDown",e)}}},{key:"onKeyUp",value:function(e){if(e.target.constructor===HTMLBodyElement){if(this._Stage.onKeyUp(e))return;this.dispatch("keyUp",e)}}},{key:"makeCanvas",value:function(){this._Canvas&&(this._Canvas.removeEventListener("mousedown",this.onMouseDown),this._Canvas.removeEventListener("mouseenter",this.onMouseEnterCanvas),this._Canvas.removeEventListener("mouseleave",this.onMouseLeaveCanvas),this._Canvas.removeEventListener("wheel",this.onMouseWheel),this._Canvas.remove());var e=document.createElement("canvas");e.setAttribute("id","stage"+Y.toString()),Y++,e.className="Stage";var t=this.devicePixelRatio;return e.width=window.innerWidth*t,e.height=window.innerHeight*t,document.body.insertBefore(e,document.body.firstChild),this._Canvas=e,this._Stage&&this._Stage.redraw(),this._Canvas.addEventListener("mousedown",this.onMouseDown),this._Canvas.addEventListener("mouseenter",this.onMouseEnterCanvas),this._Canvas.addEventListener("mouseleave",this.onMouseLeaveCanvas),this._Canvas.addEventListener("wheel",this.onMouseWheel),e}},{key:"onAppReady",value:function(){window.stage=this._Stage,window.addEventListener("contextmenu",this.onContextMenu,!1),window.addEventListener("focus",this.onFocus),this._Canvas.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("drag",this.onDrag),this._Canvas.addEventListener("mouseenter",this.onMouseEnterCanvas),this._Canvas.addEventListener("mouseleave",this.onMouseLeaveCanvas),this._Canvas.addEventListener("wheel",this.onMouseWheel),window.addEventListener("mouseenter",this.onMouseEnterWindow),window.addEventListener("mouseleave",this.onMouseLeaveWindow),window.addEventListener("blur",this.onBlur),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp),this._LastAdvanceTime=performance.now(),this._Canvas.style.display=null,this.updateWindowSize(),this.scheduleAdvance(),this.dispatch("ready"),this._IsReady=!0}},{key:"showFork",value:function(){var e=this,t={label:"Fork",action:function(t,r){n.hide(),e._EditorUI.showFilesModal(null,function(t,n){t?e._RevisionManager.fork(t,n,function(t,n){t&&(window.location="/a/"+e._User.username+"/files/"+n.product+"/"+n.slug)}):e.showFork()})}},n=this.alert({type:s.default.Types.Avatar,blockClose:!0,avatar:this._Author.avatar,link:"/a/"+this._Author.username,customTitleRenderer:function(){return W.default.createElement("span",null,W.default.createElement("a",{href:"/a/"+e._Author.username},e._Author.name),"'s file.")},title:this._Author.name+"'s file.",message:this._FileAccess===E.default.Fork?"To make changes, fork it to Your Files.":"This file is read only.",buttons:this._FileAccess===E.default.Fork?[t]:null})}},{key:"loadFile",value:function(){var e=this,t=this._File;if(this._FileAccess=E.default.fromString(t.access),this._RevisionManager.load(t.owner.id,t.id,t.revision,t.updated,this._FileAccess),!t.isPublic&&!K.default.isPaid&&(this._ExpiredAlert=this.alert({type:s.default.Types.Default,blockClose:!0,customTitleRenderer:function(){return W.default.createElement("span",{onClick:e._EditorUI.showPropertiesModal},"Changes will not be saved. Convert this file to Public or re-activate your account.")},title:"",message:"",buttons:[]})),this._FileAccess!==E.default.ReadWrite&&(this.showFork(),t.license)){var n=R.default.get(t.license);this.alert({type:s.default.Types.License,blockClose:!0,avatar:this._Author.avatar,title:"Artwork License:",message:n.label+" "+n.title,license:n,buttons:[{label:"View License",action:function(e,t){window.open(n.link,"_blank")}}]})}}},{key:"changeFileName",value:function(e){this._RevisionManager.rename(e)}},{key:"deserializeSettings",value:function(e){for(var t in e.guides&&this._EditorUI.deserializeGuides(e.guides),delete e.guides,e)this._ProjectPreferences[t]=e[t];this._EditorUI.preferencesUpdated()}},{key:"serializeSettings",value:function(){var e=this._ProjectPreferences,t=this._EditorUI.serializeGuides();return t?e.guides=t:delete e.guides,e}},{key:"setActor",value:function(e){this.resetJournal();var t=this._Stage;this._Actor&&(this._Actor.removeEventListener("play",this.animationPlayStateChanged),this._Actor.removeEventListener("assetListChanged",this.actorAssetListChanged)),this._Actor=e,this._Actor&&(this._Actor.addEventListener("play",this.animationPlayStateChanged),this._Actor.addEventListener("assetListChanged",this.actorAssetListChanged)),window.actor=this._Actor,t.clear(),e.artboards.eachChildRecursive(function(e){e.stageItem&&e.stageItem.isAutomatic&&(t.queueAdd(e.stageItem),t.processQueuedAddRemove())}),this.dispatch("actorLoaded",this._Actor),this._Stage.zoomFit(1),this.checkReady()}},{key:"zoomFit",value:function(){this._EditorUI.zoomFit()}},{key:"changeParent",value:function(e){var t=null;if(this.pickParentAlert&&(t=this.pickParentAlert.items,this.pickParentAlert.hide(),this.pickParentAlert=null,this.dispatch("pickParent",!1)),e&&!e.node){var n=e&&e.constructor.name.toString()||"unknown";return T.default.debug("Attempting to change parent with an invalid parent (maybe a handle?) - "+n),void this.alert({type:s.default.Types.Default,title:"Invalid",message:"Bad parent selected.",buttons:[]})}if(this._Stage.clearRerouteSelection(this.rerouteCB),this.clearCancelCallback(this.rerouteCB),this._Stage.clearExtraSelectionFilter(),e&&t){var r=!0,o=!1,i=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;if(u.node.isValidParent(e.node)){var c=new y.default(this._Stage,this._Actor,[u.node],e.node);c.silent=!0,c.start(),c.end()}}}catch(e){o=!0,i=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}this.captureJournalEntry();var d=this;setTimeout(function(){d.stage.selectItems(t)},0)}}},{key:"pickParent",value:function(){if(!(this.pickParentAlert||this._Stage.soloItem||this._EditingAnimation)){for(var e=this.stage.selectedItems,t=[],n=0;n<e.length;n++){var r=e[n];switch(r.node.constructor){case H.default:case B.default:case b.default:case I.default:t.push(r)}}if(t.length){var o=this;this.pickParentAlert=this.alert({title:"Pick Parent",message:"Select the item to parent to.",type:s.default.Types.State,buttons:[{label:"CLEAR",action:function(e,t){o.changeParent(o._Actor.artboards.active.stageItem)}},{label:"CANCEL",action:function(e,t){o.changeParent(null)}}]}),this.pickParentAlert.items=t,this.dispatch("pickParent",!0),this.setCancelCallback(this.changeParent),this._Stage.rerouteSelection(this.changeParent),this._Stage.setExtraSelectionFilter(function(e){return!e.drawAfterSelections})}}}},{key:"captureJournalEntry",value:function(){if(J.size){var e=new Map(J);J.clear(),e.forEach(function(e,t){clearTimeout(e.timeout),t()})}if(this._EditingWeights)this._EditingWeights.captureJournalEntry();else if(this._EditingAnimation)this._AnimationEditor.captureJournalEntry();else if(this._Actor){var t=this._Actor.getJournalEntry();t.length&&(this._JournalIndex!=this._Journal.length-1&&this._Journal.splice(this._JournalIndex+1,this._Journal.length-(this._JournalIndex+1)),this._Journal.push(t),this._JournalIndex=this._Journal.length-1)}}},{key:"debounceBeforeCapture",value:function(e,t,n){if(!J.get(e)){var r=setTimeout(function(){J.delete(e),e(t)},n||10);J.set(e,{timeout:r})}}},{key:"cancelDebounceBeforeCapture",value:function(e){var t=J.get(e);t&&(J.delete(e),clearTimeout(t.timeout))}},{key:"removeRestOfJournal",value:function(){this._JournalIndex!=this._Journal.length-1&&this._Journal.splice(this._JournalIndex+1,this._Journal.length-(this._JournalIndex+1)),this._JournalIndex=this._Journal.length-1}},{key:"undo",value:function(){var e=this._Stage,t=this._Actor;if(e.isReady){if(this.captureJournalEntry(),this._EditingWeights)return this._EditingWeights.undo(),!1;if(this._EditingAnimation)return this._AnimationEditor.undo(),!1;if(-1==this._JournalIndex)return!1;var n=this._Journal[this._JournalIndex];t.isTimeTraveling=!0,e.resetQueuedAddRemove();for(var r=0;r<n.length;r++){n[r].undo(e)}t.isTimeTraveling=!1,this._JournalIndex--;t.getJournalEntry();return this._EditorUI.debounceUpdateSelectionPanelItem(!0),e.processQueuedAddRemove(),!0}}},{key:"redo",value:function(){var e=this._Stage,t=this._Actor;if(e.isReady)if(this.captureJournalEntry(),this._EditingWeights)this._EditingWeights.redo();else if(this._EditingAnimation)this._AnimationEditor.redo();else if(!(this._JournalIndex+1>this._Journal.length-1)){this._JournalIndex++;var n=this._Journal[this._JournalIndex];t.isTimeTraveling=!0,e.resetQueuedAddRemove();for(var r=0;r<n.length;r++){n[r].redo(this._Stage)}t.isTimeTraveling=!1;t.getJournalEntry();this._EditorUI.debounceUpdateSelectionPanelItem(!0),e.processQueuedAddRemove()}}},{key:"setCancelCallback",value:function(e){this._CancelCallback=e}},{key:"clearCancelCallback",value:function(e){this._CancelCallback==e&&(this._CancelCallback=null)}},{key:"find",value:function(){this._EditorUI.find()}},{key:"cancel",value:function(){if(this._CancelCallback){var e=this._CancelCallback;return this._CancelCallback=null,void e()}this._EditorUI.hasModalOpen?this._EditorUI.closeModal():this._Stage.cancel()}},{key:"contextMenuSendBehind",value:function(e){var t=this._Actor.artboards;if(t&&t.active){for(var n=t.active.drawOrder.drawables.slice(0),r=e.node.drawOrder-.5,o=0;o<n.length;o++){var i=n[o];i.__o=o+1,i.stageItem&&i.stageItem.isSelected&&(i.__o=r)}n.sort(function(e,t){return e.__o-t.__o});for(var a=0;a<n.length;a++){var s=n[a];delete s.__o,s.drawOrder=a+1}this.captureJournalEntry()}}},{key:"contextMenuBringOver",value:function(e){var t=this._Actor.artboards;if(t&&t.active){for(var n=t.active.drawOrder.drawables.slice(0),r=e.node.drawOrder+.5,o=0;o<n.length;o++){var i=n[o];i.__o=o+1,i.stageItem&&i.stageItem.isSelected&&(i.__o=r)}n.sort(function(e,t){return e.__o-t.__o});for(var a=0;a<n.length;a++){var s=n[a];delete s.__o,s.drawOrder=a+1}this.captureJournalEntry()}}},{key:"bumpSelectionDrawOrder",value:function(e){if(this._Actor&&this._Stage.toolType!==C.default&&!this._IncBrushSizeCallback){var t=this._Actor.artboards;if(t&&t.active){e*=t.active.drawOrder.drawables.length+1;for(var n=t.active.drawOrder.drawables.slice(0),r=0;r<n.length;r++){var o=n[r];o.__o=r+1,o.stageItem&&o.stageItem.isSelected&&(o.__o+=e)}n.sort(function(e,t){return e.__o-t.__o});for(var i=0;i<n.length;i++){var a=n[i];delete a.__o,a.drawOrder=i+1}this.captureJournalEntry()}}}},{key:"incrementSelectionDrawOrder",value:function(e){if(this._Actor&&this._Stage.toolType!==C.default&&!this._IncBrushSizeCallback){var t=this._Actor.artboards;if(t&&t.active){for(var n=t.active.drawOrder.drawables.slice(0),r=e<0?0:n.length-1,o=e<0?n.length:-1,i=r;i!=o;i-=e){var a=n[i];if(a.stageItem&&a.stageItem.isSelected){var s=Math.max(0,Math.min(n.length-1,i+e));if(s===i)return;var l=n[s];n[s]=a,n[i]=l}}for(var u=0;u<n.length;u++){n[u].drawOrder=u+1}this.captureJournalEntry()}}}},{key:"deselect",value:function(){this._Stage.clearSelections(),this.clearSelections()}},{key:"clearSelections",value:function(e){for(var t=0;t<this._SelectedItems.length;t++)this._SelectedItems[t].isSelected=!1;this._SelectedItems.length=0,e||this.dispatch("selectionChanged",this.selectedItems)}},{key:"certainSelections",value:function(e){for(var t=[],n=0;n<this._SelectedItems.length;n++){var r=this._SelectedItems[n];e(r)&&t.push(r)}return t}},{key:"clearCertainSelections",value:function(e,t){for(var n=!1,r=0;r<this._SelectedItems.length;r++){var o=this._SelectedItems[r];e(o)&&(o.isSelected=!1,n=!0,this._SelectedItems.splice(r,1),r--)}!t&&n&&this.dispatch("selectionChanged",this.selectedItems)}},{key:"selectItems",value:function(e,t,n){!t&&this._SelectedItems.length&&this.clearSelections(!0);for(var r=0;r<e.length;r++){var o=e[r];o.isSelected||(this._SelectedItems.push(o),o.isSelected=!0)}this.dispatch("selectionChanged",this.selectedItems,n)}},{key:"selectItem",value:function(e,t,n){if(!e)throw new Error("Cannot select a non object");e.isSelected&&1===this._SelectedItems.length||(!t&&this._SelectedItems.length&&this.clearSelections(!0),this._SelectedItems.push(e),e.isSelected=!0,this.dispatch("selectionChanged",this.selectedItems,n))}},{key:"deselectItem",value:function(e,t){var n=this._SelectedItems.indexOf(e);return-1!=n&&(this._SelectedItems.splice(n,1),e.isSelected=!1,t||this.dispatch("selectionChanged",this.selectedItems),!0)}},{key:"removeAnimations",value:function(e){var t=!1,n=this._Actor.artboards.active,r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.isPlaying=!1,l===this._EditingAnimation&&(t=!0),n.removeAnimation(l)}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}if(this.deselectItems(e),t){var u=n.animations;u.length?this.editingAnimation=u[0]:this.editingAnimation=null}}},{key:"deselectItems",value:function(e){for(var t=!1,n=0;n<e.length;n++){var r=this.deselectItem(e[n],!0);t||(t=r)}t&&this.dispatch("selectionChanged",this.selectedItems)}},{key:"animationEventTriggered",value:function(e){e.alert||(e.alert=this.alert({title:e.name,message:" ("+e.parent.name+")",type:s.default.Types.Event}),this._CleanupEvents.push(e)),e.alert.highlight()}},{key:"detectDependencyCycles",value:function(e,t){this._DependencyCycles||(this._DependencyCycles=[]);try{e()}catch(e){e instanceof A.default?(t&&t(),this._DependencyCycles.push(e),(0,D.default)(this.reportDependencyCycles)):T.default.debug("Got an unhandled exception while detecting dependency cycles - "+e)}}},{key:"reportDependencyCycles",value:function(){var e=this._DependencyCycles;if(this._DependencyCycles=null,e.length){var t=void 0,n=1===e.length?"it":"they";t=1===e.length?'"'+e[0].name+'"':e.length>4?e.slice(0,3).map(function(e){return'"'+e.name+'"'}).join(", ")+", ...":e.slice(0,-1).map(function(e){return'"'+e.name+'"'}).join(", ")+' and "'+e.slice(-1)[0].name+'"',this.alert({title:"Cyclic Dependency.",message:t+" could not be used as "+n+" would create a cyclic dependency.",type:s.default.Types.Default,buttons:[]})}}},{key:"actorAssetListChanged",value:function(){}},{key:"animationPlayStateChanged",value:function(){this._EditorUI.updateSelectionPanel(),this.updateStageState();for(var e=0;e<this._CleanupEvents.length;e++){var t=this._CleanupEvents[e];t.alert&&t.alert.hide(),delete t.alert}this._CleanupEvents.length=0}},{key:"updateStageState",value:function(){this._Stage.isSelectionDisabled=this._IsDragging||this._IsExporting||this._EditingAnimation&&this._EditingAnimation.isPlaying||this._Actor&&this._Actor.hasPlayingAnimations}},{key:"cancelEditShape",value:function(){this.editingShape=null}},{key:"editVertexSelectionChanged",value:function(e,t){t&&(this.editingShape=null)}},{key:"editShapeOn",value:function(e){var t=this._Stage;e.isSelectable=!1,t.deSelectItem(e),t.setSoloItems([e],!1),this.setCancelCallback(this.cancelEditShape);var n=[];e.showContour=!0,e.node.all(function(r){switch(r.constructor){case L.default:case b.default:n.push(r.stageItem),r.stageItem.showContour=!0;break;case M.default:case F.default:r.stageItem.addToStage(t),r.stageItem.parent=e}}),this._EditingShapePaths=n,t.addEventListener("selectionChanged",this.editVertexSelectionChanged),this.dispatch("editShape",!0)}},{key:"isEditingPath",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this._EditingShapePaths[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(e===o.value)return!0}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return!1}},{key:"editShapeOff",value:function(e){if(e){var t=this._Stage;e.isSelectable=!0,e.showContour=!1,e.stage&&t.selectItem(e);var n=!0,r=!1,o=void 0;try{for(var i,a=this._EditingShapePaths[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.showContour=!1}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}e.node.all(function(e){switch(e.constructor){case M.default:case F.default:case x.default:e.stageItem.removeFromStage()}}),this._EditingShapePaths=[],t.clearSoloItems(),this.clearCancelCallback(this.cancelEditShape),t.removeEventListener("selectionChanged",this.editVertexSelectionChanged),this.dispatch("editShape",!1)}}},{key:"group",value:function(){if(!this._EditingAnimation){var e=new h.default(this._Stage,this._Actor,I.default,"Group");e.start(),e.end()}}},{key:"groupSolo",value:function(){if(!this._EditingAnimation){var e=new h.default(this._Stage,this._Actor,j.default,"Solo Group");e.start(),e.end()}}},{key:"keyNodes",value:function(e,t,n,r,o){if(this._EditingAnimation)for(var i=0;i<e.length;i++){var a=e[i],s=t,l=n,u=r,c=o&&a.constructor==m.default;switch(a.constructor){case m.default:s=!1;break;case b.default:a.isConnectedToBones&&(s=!1,l=!1,u=!1)}s&&(this._EditingAnimation.setKey(a,"framePosX"),this._EditingAnimation.setKey(a,"framePosY")),u&&(this._EditingAnimation.setKey(a,"frameScaleX"),this._EditingAnimation.setKey(a,"frameScaleY")),l&&this._EditingAnimation.setKey(a,"frameRotation"),c&&this._EditingAnimation.setKey(a,"frameLength")}}},{key:"keySelected",value:function(e,t,n,r){for(var o=this._Stage.selectedItems,i=[],a=0;a<o.length;a++){var s=o[a].node;s&&-1===i.indexOf(s)&&i.push(s)}this.keyNodes(i,e,t,n,r),this.captureJournalEntry()}},{key:"selectAll",value:function(){this._Stage.selectAll()}},{key:"delete",value:function(){if(this._EditingMesh)this._EditingMesh.deleteSelection(),this.captureJournalEntry();else if(this._EditingAnimation)this._EditingAnimation.deleteSelection(),this.captureJournalEntry();else{var e=new p.default(this._Stage,this._Actor,this._Stage.selectedItems,this._SelectedItems);e.start(),e.end(),this._EditorUI.debounceUpdateSelectionPanelItem()}}},{key:"selectIndexItem",value:function(e){this._SelectIndexItemCallback&&this._SelectIndexItemCallback(e)}},{key:"selectIndexItemNext",value:function(){this.selectIndexItemNextCallback&&this.selectIndexItemNextCallback()}},{key:"selectIndexItemPrevious",value:function(){this._SelectIndexItemPreviousCallback&&this._SelectIndexItemPreviousCallback()}},{key:"incBrushSize",value:function(e){this._IncBrushSizeCallback&&this._IncBrushSizeCallback(e)}},{key:"incBrushFeather",value:function(e){this._IncBrushFeatherCallback&&this._IncBrushFeatherCallback(e)}},{key:"incBrushStrength",value:function(e){this._IncBrushStrengthCallback&&this._IncBrushStrengthCallback(e)}},{key:"setBrushCallbacks",value:function(e,t,n){this._IncBrushSizeCallback=e,this._IncBrushFeatherCallback=t,this._IncBrushStrengthCallback=n}},{key:"setSelectionCallbacks",value:function(e,t,n){this._SelectIndexItemCallback=e,this._SelectIndexItemNextCallback=t,this._SelectIndexItemPreviousCallback=n}},{key:"cut",value:function(){this.copy()&&this.delete()}},{key:"copy",value:function(){if(!this.hasCopyAccess)return this.alert({title:"Cannot Copy.",message:"This file is read only.",type:s.default.Types.Default,autoHideSeconds:3,buttons:[]}),!1;var e=void 0;if(this._EditingAnimation)e=this._EditingAnimation.copy();else{var t=function(t){if(t.parent&&(t=t.parent),!o.has(t)){o.add(t);var n=t.serialize();e.assets.push(n)}},n=function e(n){if(n.asset&&t(n.asset),n.children)for(var r=0;r<n.children.length;r++)e(n.children[r])},r=[],o=new Set;e={ownerId:this._File.owner.id,fileId:this._File.id,revisionKey:this._RevisionManager.revisionKey,assets:[],nodes:[]};for(var i=0;i<this._SelectedItems.length;i++){var a=this._SelectedItems[i].serialize();a instanceof O.default&&t(a)}for(var l=this._Stage.selectedItems,u=0;u<l.length;u++){var c=l[u];if(c.node&&-1==r.indexOf(c.node)&&c.node.constructor!==g.default){for(var d=!1,f=0;f<l.length;f++)if(f!=u){var h=l[f].node;c.node.isChildOf(h)&&(d=!0)}if(!d){var p=c.node.serialize();e.nodes.push(p),r.push(c.node),c.node.worldTransform&&(p.worldTransform=Array.prototype.slice.call(c.node.worldTransform)),n(c.node)}}}}if(e){var y=JSON.stringify(e);if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(y).then(function(){});else{var v=document.createElement("textarea");v.style.fontSize="12pt",v.style.border="0",v.style.padding="0",v.style.margin="0",v.style.position="absolute",v.style.left="-9999px";var m=window.pageYOffset||document.documentElement.scrollTop;v.style.top=m+"px",v.setAttribute("readonly",""),v.value=y,document.body.appendChild(v),v.select(),v.setSelectionRange(0,v.value.length),document.execCommand("copy"),document.body.removeChild(v)}}return!0}},{key:"pasteText",value:function(e){var t=this;if(e){var n=null;try{n=JSON.parse(e)}catch(t){return this._Actor.pasteSVG(e,this._Stage),void this.captureJournalEntry()}if(n){if(this._EditingAnimation)return void this._EditingAnimation.paste(n,this._Stage);!function(){t._BlockPaste=!0;var e=t._RevisionManager,r=n.assets||[],o=[],i=!0,a=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){Q(u.value,function(e){o.push(e.id)})}}catch(e){a=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw l}}var d=t,f=null;o.length&&(f=t.alert({type:s.default.Types.Default,title:"Pasting",message:"Assets are being pasted from another character file...",buttons:[]})),e.shareAssets(n.ownerId,n.fileId,o,function(){if(d._BlockPaste=!1,f&&f.hide(),n.assets)for(var t=0;t<n.assets.length;t++){Q(n.assets[t],function(t){e.prepAssetForLoad(t)})}var r=d._Stage.selectedItems.map(function(e){return e.node}),o={drawOrder:-1},i=!0,a=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){Q(l.value,function(e){e.drawOrder&&o.drawOrder<e.drawOrder&&(o=e)})}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}var c=d._Actor.activeArtboard.drawOrder;c.updateDrawOrder();var h=c.drawables.slice(),p=d._Actor.import(n,d._Stage);d._fillDrawOrderAt(o,h,p),n.settings&&d.deserializeSettings(n.settings),d.captureJournalEntry()})}()}}}},{key:"paste",value:function(e){var t=this;if(!this._BlockPaste){for(var n=e.clipboardData,r=0;r<n.items.length;r++){var o=n.items[r];if("string"===o.kind)o.getAsString(function(e){t.pasteText(e)})}n.files&&this.addAssetsFromFiles(n.files)}}},{key:"enableAnimation",value:function(e){this._IsAnimationEnabled!=e&&(this._IsAnimationEnabled=e,this._Actor.useAnimationValues=e)}},{key:"startPan",value:function(){this._Stage.isMouseOver?this._Stage.isPanning=!0:this._EditingAnimation&&this._EditingAnimation.timelineCanvas&&this._EditingAnimation.timelineCanvas.isMouseOver&&(this._EditingAnimation.timelineCanvas.isPanning=!0)}},{key:"removeContextMenus",value:function(){this._EditorUI.removeContextMenus()}},{key:"showContextMenu",value:function(e){this._EditorUI.showContextMenu(e)}},{key:"removeDropdownMenu",value:function(e){this._EditorUI.removeDropDownPopup(e)}},{key:"showDropDownMenu",value:function(e){return this._EditorUI.addDropDownPopup(e)}},{key:"getStageRect",value:function(){return this._EditorUI.getStageRect()}},{key:"getAccurateStageRect",value:function(){return this._EditorUI.getAccurateStageRect()}},{key:"alert",value:function(e){var t=new s.default(e);if(e.delaySeconds){var n=this._EditorUI;t.displayTimeout=setTimeout(function(){n.showAlert(t)},1e3*e.delaySeconds)}else this._EditorUI.showAlert(t);return t}},{key:"onError",value:function(e,t,n,r,o){this._OldErrorHandler&&this._OldErrorHandler(e,t,n,r,o);var i=Date.now();if(!(i-this._LastReportTime<5e3)){this._LastReportTime=i;var a={error:{message:e,url:t,lineNumber:n},stack:o&&o.stack,build:this._BuildNumber,character:this._File,revisionManagerState:this._RevisionManager.state,editorState:this._EditorUI.getStateForLog(),screenshot:this._Canvas.toDataURL("image/jpeg",.67),userAgent:navigator.userAgent};console.log("ERROR HERE",a),this._EditorUI.showCrash();var s=new XMLHttpRequest;s.open("POST","/api/report_error/"+this._BuildNumber,!0);var l=this;return s.onload=function(){var e;try{e=JSON.parse(this.responseText),l._ErrorKey=e.key}catch(e){}},s.send(JSON.stringify(a)),!1}}},{key:"errorFeedback",value:function(e){if(this._ErrorKey){var t={key:this._ErrorKey,message:e},n=new XMLHttpRequest;return n.open("POST","/api/report_error_feedback/"+(window.__NimaBuildNumber||"DEV"),!0),n.send(JSON.stringify(t)),!1}console.log("NO ERROR KEY")}},{key:"getPreference",value:function(e){var t=this._FilePreferences[e];if(void 0!==t)return t;var n=this._ProjectPreferences[e];if(void 0!==n)return n;var r=this._LocalPreferences[e];return void 0!==r?r:this._UserPreferences[e]}},{key:"setLocalPreference",value:function(e,t){this._LocalPreferences[e]=t,clearTimeout(this._SaveLocalPreferencesTimeout);var n=this;this._SaveLocalPreferencesTimeout=setTimeout(function(){localStorage.setItem("preferences-"+n._User.id,JSON.stringify(n._LocalPreferences))},100),this._Stage.updateSettings()}},{key:"setUserPreference",value:function(e,t){this._UserPreferences[e]=t,clearTimeout(this._SaveUserPreferencesTimeout),this._SaveUserPreferencesTimeout=setTimeout(function(){},100),this._Stage.updateSettings()}},{key:"setCharacterPreference",value:function(e,t){if(this.hasWriteAccess){this._FilePreferences[e]=t;var n=this;clearTimeout(this._SaveCharacterPreferencesTimeout),this._SaveCharacterPreferencesTimeout=setTimeout(function(){var e=new XMLHttpRequest;e.open("POST","/api/files/"+n._File.owner.id+"/"+n._File.id+"/preferences",!0),e.onload=function(){200!==this.status&&T.default.warn("Couldn't save Character Preferences",n._File)},e.send(JSON.stringify(n._FilePreferences))},300),this._Stage.updateSettings()}}},{key:"setProjectPreference",value:function(e,t){this._ProjectPreferences[e]=t,this._EditorUI.preferencesUpdated(),clearTimeout(this._SaveProjectPreferencesTimeout);var n=this;this._SaveProjectPreferencesTimeout=setTimeout(function(){n._Actor&&n._Actor.revise()},100),this._Stage.updateSettings()}},{key:"withSelected",value:function(e,t){var n=e.constructor===Array?e:t;t=e.constructor===Function?e:t;for(var r=[],o=0;o<this._Stage.selectedItems.length;o++){var i=this._Stage.selectedItems[o];i.node&&-1!==n.indexOf(i.node.constructor)&&-1===r.indexOf(i.node)&&(r.push(i.node),t(i.node))}}},{key:"setReplaceTarget",value:function(e){var t=[];if(e)for(var n=0;n<e.length;n++){var r=e[n];r instanceof O.default?t.push(r):r.node&&t.push(r.node)}this._ReplaceTargets=t.length&&t||null}},{key:"dragOver",value:function(e){return e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy",!1}},{key:"dragLeave",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"dragDrop",value:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;this.addAssetsFromFiles(t)}},{key:"confirmGroupImageSequence",value:function(e){var t=this;return new Promise(function(n,r){t.alert({type:s.default.Types.Question,title:"Import Sequence?",message:"Do you want to import "+e.name+" as an image sequence?",buttons:[{label:"Yes",action:function(e,t){n(!0)}},{label:"No",action:function(e,t){n(!1)}}]})})}},{key:"getGroupedFiles",value:function(e){this._Stage,this._Actor;var t=this;return new Promise(function(n,r){for(var o=[],i=(0,_.default)(e,w.default.getImageExtensions(),function(e){return e.name}),a=0;a<i.length;a++){var s=i[a];s.items.length>1&&o.push(t.confirmGroupImageSequence(s))}Promise.all(o).then(function(e){for(var t=[],r=0,o=0;o<i.length;o++){var a=i[o];if(a.items.length>1){if(e[r])t.push(a);else for(var s=0;s<a.items.length;s++){var l=a.items[s];t.push({name:l.name,items:[l]})}r++}else t.push(a)}n(t)})})}},{key:"replaceAssets",value:function(e,t){var n=this;if(this._EditingAnimation)console.log("Trying to add files while in animation mode.");else{var r=this.actor,o=this;this.getGroupedFiles(t).then(function(e){return r.makeAssets(e)}).then(function(t){var n=t.assets;t.unprocessed;if(0!=n.length){for(var i=n[0],a=!1,s=0;s<e.length;s++){var l=e[s];l instanceof O.default&&l.canBeReplacedBy(i)?(a=!0,l.replaceWith(i,r)):l.asset&&l.asset instanceof O.default&&l.asset.canBeReplacedBy(i)&&(a=!0,l.asset.replaceWith(i,r))}a&&(r.addAsset(i),o.captureJournalEntry())}}).catch(function(e){n.showImportFileError()})}}},{key:"showImportFileError",value:function(){this.alert({title:"File error.",message:"Flare could not interpret the provided file.",type:s.default.Types.Default,autoHideSeconds:6,buttons:[]})}},{key:"addAssetsFromFiles",value:function(e){var t=this;if(this._EditingAnimation)console.log("Trying to add files while in animation mode.");else{var n=this._ReplaceTargets,r=this._Stage,o=this._Actor,i=this,a=null;this.getGroupedFiles(e).then(function(e){return a=i.alert({title:"Importing Assets.",message:"This can take a minute if your file is large.",type:s.default.Types.Saving,buttons:[],delaySeconds:5,minimumDisplaySeconds:2}),o.makeAssets(e)}).then(function(e){var t=e.assets,l=e.unprocessed;l.length?o.importFiles(l,r,function(e){a.hide(),e&&i.captureJournalEntry()}):a.hide();var u=!1;if(n&&n.length&&1===t.length&&0===l.length){for(var c=t[0],d=[],f=0;f<n.length;f++){var h=n[f];h instanceof O.default&&h.canBeReplacedBy(c)?d.push(h):h.asset&&h.asset instanceof O.default&&h.asset.canBeReplacedBy(c)&&d.push(h)}if(d.length){var p=void 0;p=1===d.length?'"'+d[0].name+'"':d.length>4?d.slice(0,3).map(function(e){return'"'+e.name+'"'}).join(", ")+", ...":d.slice(0,-1).map(function(e){return'"'+e.name+'"'}).join(", ")+' and "'+d.slice(-1)[0].name+'"',u=!0,i.alert({type:s.default.Types.Question,title:"Replace Asset or Import New?",message:"Replace "+p+" with "+c.name+"?",buttons:[{label:"Replace",action:function(e,t){for(var n=0;n<d.length;n++){var r=d[n];r instanceof O.default?r.replaceWith(c,o):r.asset=c}o.addAsset(c),i.captureJournalEntry()}},{label:"Import",action:function(e,n){t.length&&(o.addAssets(t),i.captureJournalEntry())}},{label:"x",action:function(e,n){t.length}}]})}}if(!u){for(var y=o.assets,v=[],m=[],g=0;g<t.length;g++){for(var b=t[g],k=!1,S=0;S<y.length;S++){var w=y[S];if(w.canBeReplacedBy(b)&&b.name==w.name){k=!0,v.push({from:w,to:b});break}}k||m.push(b)}if(v.length){var _=void 0;_=1===v.length?'"'+v[0].from.name+'"':v.length>4?v.slice(0,3).map(function(e){return'"'+e.from.name+'"'}).join(", ")+", ...":v.slice(0,-1).map(function(e){return'"'+e.from.name+'"'}).join(", ")+' and "'+v.slice(-1)[0].from.name+'"',i.alert({type:s.default.Types.Question,title:"Replace Asset or Import New?",message:"Replace "+_+"?",buttons:[{label:"Replace",action:function(e,n){for(var r=0;r<v.length;r++){var a=v[r];a.from.replaceWith(a.to,o)}o.addAssets(t),i.captureJournalEntry()}},{label:"Import",action:function(e,n){t.length&&(o.addAssets(t),i.captureJournalEntry())}},{label:"x",action:function(e,n){t.length}}]})}else t.length&&(o.addAssets(t),i.captureJournalEntry())}}).catch(function(e){a&&a.hide(),t.showImportFileError()})}}},{key:"resetJournal",value:function(){this._Journal=[],this._JournalIndex=-1}},{key:"incSelectionFilter",value:function(e){this._EditorUI.incSelectionFilter(e)}},{key:"translateSelection",value:function(e){var t=new S.default(this._Stage),n=this._Stage.selectedItems;t.startDrag(null,n),t.advanceDrag(e,e,e,[0,0]),t.endDrag(),this.captureJournalEntry()}},{key:"resetGuides",value:function(){this._EditorUI.resetGuides(),this._Actor.revise()}},{key:"preventBrowserRefresh",value:function(e){if(this._RefreshAlert&&!this._RefreshAlert._hide)return!1;e.preventDefault();var t=this;return this._RefreshAlert=this.alert({title:"Sure you want to refresh?",message:"Press reload shortcut again to refresh.",type:s.default.Types.Question,buttons:[{label:"Cancel",action:function(){t._RefreshAlert=null}}]}),!0}},{key:"forceRevision",value:function(){var e=!this.file.isPublic&&!K.default.isPaid;if(this.hasWriteAccess&&!e)if(this._UserSaveAlert)console.log("Wait for next save before queueing another one.");else{var t=this,n=null;this._RevisionManager.userSave("Manual Save",function(){setTimeout(function(){n.hide(),t._UserSaveAlert===n&&(t._UserSaveAlert=null)},2e3)})?this._UserSaveAlert=n=this.alert({title:"Saving Revision.",message:"Your revision is being manually saved.",type:s.default.Types.Saving,buttons:[]}):this.alert({title:"Cannot Save.",message:"You cannot save while previewing revisions.",type:s.default.Types.Default,autoHideSeconds:3,buttons:[]})}else this.alert({title:"Cannot Save.",message:"This file is read only.",type:s.default.Types.Default,autoHideSeconds:3,buttons:[]})}},{key:"sortAnimations",value:function(e){this.editor.filePanel.animationFolder.sort(e)}},{key:"duplicate",value:function(){var e=this;if(!this.hasCopyAccess)return!1;var t={assets:[],nodes:[],selection:[]},n=this._EditingAnimation,r=this._SelectedItems.filter(function(e){return e.constructor===v.default});if((n?n.timelineCanvas.selectedKeyFrames:[]).length){var o=n.copy();n.paste(o),this.captureJournalEntry()}else if(r.length){var i=this._Actor.activeArtboard.duplicateAnimations(r);this.selectItems(i),this.captureJournalEntry()}else if(n)this.alert({title:"Cannot Duplicate.",message:"Switch to Design mode to modify the Hierarchy.",type:s.default.Types.Default,autoHideSeconds:5,buttons:[]});else{for(var a=function e(t){if(t.asset&&c(t.asset),t.children)for(var n=0;n<t.children.length;n++)e(t.children[n])},l=[],u=new Set,c=function(e){if(e.parent&&(e=e.parent),!u.has(e)){u.add(e);var n=e.serialize();t.assets.push(n)}},d=this._Stage.selectedItems,f=0;f<d.length;f++){var h=d[f];if(h.node&&-1==l.indexOf(h.node)&&h.node.constructor!==g.default){for(var p=!1,y=0;y<d.length;y++)if(y!=f){var m=d[y].node;h.node.isChildOf(m)&&(p=!0)}if(!p){var b=h.node.serialize();t.nodes.push(b),t.selection.push(h),l.push(h.node),h.node.worldTransform&&(b.worldTransform=Array.prototype.slice.call(h.node.worldTransform)),a(h.node)}}}if(t.nodes.length){var k=[];this._Stage.clearSelections();var S=this._Actor.activeArtboard.drawOrder;S.updateDrawOrder();for(var O=function(n){var r=t.nodes[n],o=t.selection[n],i=o.node,a={drawOrder:-1};Q(i,function(e){e.drawOrder&&a.drawOrder<e.drawOrder&&(a=e)});var s=S.drawables.slice();e._Stage.selectItem(o,!1,!0);var l={nodes:[r]},u=e._Actor.import(l,e._Stage);if("artboard"===r.type){var c=u[0];c.translation[0]+=c.width+100,(0,D.default)(e.stage.zoomFit)}else e._fillDrawOrderAt(a,s,u);var d=e._Stage.selectedItems;k.push.apply(k,U(d))},w=0;w<t.nodes.length;w++)O(w);this._Stage.selectItems(k),this.captureJournalEntry()}}}},{key:"_fillDrawOrderAt",value:function(e,t,n){if(n&&e&&t&&!((n=n.filter(function(e){return e.drawOrder>0}).sort(function(e,t){return e.drawOrder-t.drawOrder})).length<=0)){var r=e.drawOrder<0?t.length:t.indexOf(e)+1;-1===r&&console.warn("No good index?",t,e);var o=[];o.push.apply(o,U(t.slice(0,r)).concat(U(n.slice()),U(t.slice(r))));for(var i=0;i<o.length;i++)o[i].drawOrder=i+1;this._Actor.activeArtboard.drawOrder._Images=o}}},{key:"devicePixelRatio",get:function(){return this._LocalPreferences&&this._LocalPreferences.scaleRetina&&window.devicePixelRatio||1}},{key:"expandedItems",get:function(){return this._ExpandedHierarchyItems}},{key:"isReady",get:function(){return this._IsReady}},{key:"hasWriteAccess",get:function(){return this._FileAccess===E.default.ReadWrite}},{key:"hasCopyAccess",get:function(){switch(this._FileAccess){case E.default.Fork:case E.default.ReadWrite:return!0;default:return!1}}},{key:"buildNumber",get:function(){return this._BuildNumber}},{key:"stage",get:function(){return this._Stage}},{key:"graphics",get:function(){return this._Graphics}},{key:"editor",get:function(){return this._EditorUI}},{key:"isDragging",get:function(){return this._IsDragging},set:function(e){this._IsDragging!=e&&(this._IsDragging=e,this.updateStageState())}},{key:"isExporting",get:function(){return this._IsExporting},set:function(e){this._IsExporting!=e&&(this._IsExporting=e,this.updateStageState())}},{key:"file",get:function(){return this._File}},{key:"actor",get:function(){return this._Actor}},{key:"selectedItems",get:function(){return this._SelectedItems.slice(0)}},{key:"autoKey",get:function(){return this._AutoKey},set:function(e){this._AutoKey=e,this._EditingAnimation&&(this._EditingAnimation.autoKey=e)}},{key:"editingMesh",get:function(){return this._EditingMesh},set:function(e){this._EditingMesh=e}},{key:"user",get:function(){return this._User}},{key:"revisionManager",get:function(){return this._RevisionManager}},{key:"editingWeights",get:function(){return this._EditingWeights},set:function(e){e&&(this.editingAnimation=null,this.editingMesh=null),this._EditingWeights=e}},{key:"editingShape",get:function(){return this._EditingShape},set:function(e){if(this._EditingShape!==e){var t=this._EditingShape;this._EditingShape=e,t&&this.editShapeOff(t),e&&this.editShapeOn(e)}}},{key:"isEditingShape",get:function(){return this._EditingShapePaths.length>0}},{key:"hasVertexWeights",get:function(){if(this._EditingShape&&this._EditingShape.node instanceof k.default)return this._EditingShape.isConnectedToBones;if(this._EditingShapePaths){var e=!0,t=!1,n=void 0;try{for(var r,o=this._EditingShapePaths[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){if(r.value.node.isConnectedToBones)return!0}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}return!1}},{key:"editingAnimation",get:function(){return this._EditingAnimation},set:function(e){if(this._EditingAnimation!=e){if(this._EditingAnimation?(this._EditingAnimation.removeEventListener("play",this.animationPlayStateChanged),this._EditingAnimation.removeEventListener("triggerEvent",this.animationEventTriggered),this._EditingAnimation.setActor(null,this._AnimationEditor)):(this._WasCompensating={compensateBones:this._Stage.settings.compensateBones,compensateImages:this._Stage.settings.compensateImages},this._Stage.settings.compensateBones=!1,this._Stage.settings.compensateImages=!1,this._AnimationEditor.activate()),this._EditingAnimation=e,this._EditingAnimation){this._EditingAnimation.addEventListener("play",this.animationPlayStateChanged),this._EditingAnimation.addEventListener("triggerEvent",this.animationEventTriggered),this.enableAnimation(!1),this._EditingAnimation.setActor(this._Actor,this._AnimationEditor),this._EditingAnimation.autoKey=this._AutoKey;var t=this._Actor.artboards.active.animations,n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.isVisible=s===this._EditingAnimation}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}else{var l=[],u=!0,c=!1,d=void 0;try{for(var f,h=this._SelectedItems[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value;p instanceof v.default&&l.push(p)}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}l.length&&this.deselectItems(l),this._Stage.settings.compensateBones=this._WasCompensating.compensateBones,this._Stage.settings.compensateImages=this._WasCompensating.compensateImages,this._AnimationEditor.deactivate(),this._Actor.stopAnimations()}this.enableAnimation(null!=e),this.animationPlayStateChanged(),this.dispatch("editingAnimationChanged");var y=this._Stage;y.tool&&!y.tool.validate()&&(y.toolType=S.default),y.updateToolSelection()}}},{key:"animations",get:function(){return this.editor.filePanel.animationFolder.hierarchyChildren}}]),t}()).prototype,"onSoloChanged",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onSoloChanged"),r.prototype),X(r.prototype,"onStageItemRemoved",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onStageItemRemoved"),r.prototype),X(r.prototype,"onStageItemVisibilityChanged",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onStageItemVisibilityChanged"),r.prototype),X(r.prototype,"onRMStateChanged",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onRMStateChanged"),r.prototype),X(r.prototype,"onFileLoaded",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onFileLoaded"),r.prototype),X(r.prototype,"onFileRenamed",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onFileRenamed"),r.prototype),X(r.prototype,"onGraphicsLoaded",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onGraphicsLoaded"),r.prototype),X(r.prototype,"advance",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"advance"),r.prototype),X(r.prototype,"updateWindowSize",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"updateWindowSize"),r.prototype),X(r.prototype,"onContextMenu",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onContextMenu"),r.prototype),X(r.prototype,"onFocus",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onFocus"),r.prototype),X(r.prototype,"onMouseDown",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDown"),r.prototype),X(r.prototype,"onMouseUp",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseUp"),r.prototype),X(r.prototype,"onMouseMove",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseMove"),r.prototype),X(r.prototype,"onDrag",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onDrag"),r.prototype),X(r.prototype,"onMouseEnterCanvas",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseEnterCanvas"),r.prototype),X(r.prototype,"onMouseLeaveCanvas",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseLeaveCanvas"),r.prototype),X(r.prototype,"onMouseEnterWindow",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseEnterWindow"),r.prototype),X(r.prototype,"onMouseLeaveWindow",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseLeaveWindow"),r.prototype),X(r.prototype,"onMouseWheel",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseWheel"),r.prototype),X(r.prototype,"onBlur",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onBlur"),r.prototype),X(r.prototype,"onKeyDown",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyDown"),r.prototype),X(r.prototype,"onKeyUp",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyUp"),r.prototype),X(r.prototype,"makeCanvas",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"makeCanvas"),r.prototype),X(r.prototype,"changeParent",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"changeParent"),r.prototype),X(r.prototype,"pickParent",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"pickParent"),r.prototype),X(r.prototype,"contextMenuSendBehind",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"contextMenuSendBehind"),r.prototype),X(r.prototype,"contextMenuBringOver",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"contextMenuBringOver"),r.prototype),X(r.prototype,"animationEventTriggered",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"animationEventTriggered"),r.prototype),X(r.prototype,"reportDependencyCycles",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"reportDependencyCycles"),r.prototype),X(r.prototype,"actorAssetListChanged",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"actorAssetListChanged"),r.prototype),X(r.prototype,"animationPlayStateChanged",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"animationPlayStateChanged"),r.prototype),X(r.prototype,"cancelEditShape",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"cancelEditShape"),r.prototype),X(r.prototype,"editVertexSelectionChanged",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"editVertexSelectionChanged"),r.prototype),X(r.prototype,"alert",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"alert"),r.prototype),X(r.prototype,"onError",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"onError"),r.prototype),X(r.prototype,"dragOver",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"dragOver"),r.prototype),X(r.prototype,"dragLeave",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"dragLeave"),r.prototype),X(r.prototype,"dragDrop",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"dragDrop"),r.prototype),X(r.prototype,"addAssetsFromFiles",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"addAssetsFromFiles"),r.prototype),r);function Q(e,t){if(t(e),e.children){var n=!0,r=!1,o=void 0;try{for(var i,a=e.children[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){Q(i.value,t)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}}t.default=q},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=a(n(373)),i=a(n(686));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),r(t,[{key:"makeActor",value:function(){return new i.default}},{key:"makeNewActorData",value:function(){return{artboards:{type:"artboards",name:"Artboards",children:[{type:"artboard",name:"Artboard",translation:[0,0],origin:[0,0],width:1024,height:768}]},assets:[]}}},{key:"product",get:function(){return"flare"}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(329),s=(r=a)&&r.__esModule?r:{default:r};var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._Active=null,n._Main=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"silentlySetChildren",value:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"silentlySetChildren",this).call(this,e),this.validate()}},{key:"onChildAdded",value:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildAdded",this).call(this,e),this.validate()}},{key:"onChildRemoved",value:function(e){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onChildRemoved",this).call(this,e),this.validate()}},{key:"validate",value:function(){this._Main&&-1===this._Children.indexOf(this._Main)&&(this._Main=null),this._Active&&-1===this._Children.indexOf(this._Active)&&(this._Active=null),null===this._Main&&this._Children.length>0&&(this.main=this._Children[0]),null===this._Active&&(this.active=this.main)}},{key:"read",value:function(e,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"read",this).call(this,e,n);var r=n.main;if(void 0!==r){var o=parseInt(r)||0,a=this;e.whenNodesLoaded(function(){a.active=a.main=o>=0?a.children[o]:null})}}},{key:"serializeProperties",value:function(e){var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeProperties",this).call(this,e);delete n.main;var r=this.children.indexOf(this._Main);return-1!==r&&(n.main=r),n}},{key:"serializeInteractive",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serializeInteractive",this).call(this);return e.main=this._Main,e}},{key:"typeName",get:function(){return"Artboards"}},{key:"main",get:function(){return this._Main},set:function(e){this._Main!==e&&(this._Main=e,this.dispatch("changeMain",e))}},{key:"active",get:function(){return this._Active},set:function(e){this._Active!==e&&(this._Active=e,this.dispatch("changeActive",e))}}]),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,n&&n.constructor===Object?this.data=n:this.data=new Float32Array(n||[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(168),i=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isVisible=!1,n.isFake=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=se(n(18)),a=n(7),s=se(n(2)),l=se(n(16)),u=se(n(300)),c=se(n(377)),d=se(n(3)),f=se(n(264)),h=se(n(349)),p=se(n(422)),y=se(n(425)),v=se(n(523)),m=se(n(427)),g=se(n(426)),b=se(n(634)),k=se(n(424)),S=se(n(348)),O=se(n(304)),w=se(n(423)),_=se(n(645)),P=se(n(541)),C=se(n(385)),E=se(n(524)),T=se(n(381)),I=se(n(526)),j=se(n(527)),A=se(n(683)),D=se(n(684)),R=se(n(685)),M=n(334),x=se(n(265)),F=se(n(525)),L=se(n(301)),N=se(n(330)),z=se(n(266)),V=se(n(176)),B=se(n(253)),H=se(n(195)),W=se(n(179)),K=se(n(505)),G=se(n(639)),U=n(333),X=se(n(230)),Y=se(n(252)),J=se(n(236)),q=n(302),Q=se(n(543)),Z=se(n(544)),$=se(n(545)),ee=se(n(522)),te=se(n(268)),ne=se(n(519)),re=se(n(516)),oe=se(n(520)),ie=se(n(648)),ae=(n(1275),se(n(19)));function se(e){return e&&e.__esModule?e:{default:e}}function le(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var ue=null,ce=null,de=(le((r=function(e){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));o._AppContext=e,o._Graphics=r,o._CursorElement=document.createElement("img"),o._CursorElement.style.position="absolute",o._CursorElement.style.pointerEvents="none",o._Settings={highlightColor:[1,1,1,1],selectionColor:[0,.4,1,1],contourOpacity:.5,contourThickness:.125,showGridAxis:!0,showGridSubdivisions:!0,disableImageContour:e.getPreference("disableImageContour")},o._Translation=a.vec2.create(),o._TranslationTarget=a.vec2.create(),o._Scale=.01,o._ScaleTarget=1,o._ViewTransform=a.mat2d.create(),o._InverseViewTransform=a.mat2d.create(),o._TransformSpace=c.default.Local,o._White=[1,1,1,1],o._Black=[0,0,0,1],o._ForceRedraw=!1,o._WasAnimatingView=!1,o._States={},o._CursorState=null,o._SelectionTarget=null,o._HoverItem=null,o._LastDispatchedHoverItem=null,o._SelectedItems=[],o._AllTools=[],o._CurrentTool=null,o._PreviousTool=null,o._SelectionFilter=new C.default,o._DisabledSelectionFilter=null,o._CurrentToolClicked=!1,o._CurrentOperation=null,o._ActiveDragTool=null,o._MouseX,o._MouseY,o._MouseDragged=!1,o._SelectionsChanged=!1,o._MouseDownSelected=!1,o._MinZoom=.15,o._MaxZoom=8,o._WorldMouse=a.vec2.create(),o._LastClickedItem=null,o._QueuedRemove=[],o._QueuedAdd=[],o._RenderTransform=a.mat2d.create(),o._StageItems=[],o._StageDrawLayers=[],o._IsSelectionDisabled=!1,o._IsDragDisabled=!1,o._IsMouseOverStage=!1,o._SuppressPanning=!1,o._IsDraggingMarquee=!1,o._DraggedMarquee=!1,o._MarqueeStart=a.vec2.create(),o._MarqueeEnd=a.vec2.create(),o._PreMarqueeSelection=[],o._GuideBackgroundColor=[42/255,42/255,42/255,.9],o._HighlightItems=[],o._SelectionReRoute=null,o._SelectionReRouteCanMarquee=!1,o._ScreenScale=1,o._OriginTransform=null,o._OriginTranslation=a.vec2.create(),o._OriginTranslationTarget=a.vec2.create(),o._OriginRotation=0,o._OriginRotationTarget=0,o._SoloStrength=0,o._SoloFrameBuffer=null,o._SoloVertexBuffer=null,o._SoloIndexBuffer=null,o._SoloTransform=null,o._PreSoloScaleTarget=1,o._PreSoloTranslationTarget=a.vec2.create(),o._SoloZoomed=!1,o._SoloItems=null,o._HoverFallthrough=0,o._RenderCaptureView=null,o._RenderCaptureCallback=null,o._MarqueeSilentChanges=[],o._MouseDownTime=Date.now(),o._MouseMoveAccum=a.vec2.create(),o._IsPreDrag=!1,o._ReRoutedSelection=!1,o._MoveTriggersPan=!1,o._IsMouseDown=!1,o._RegisteredStageItems=[],o._LayerOptions={},o._ContextLookup=new Map,o._MaxDrawLayer=0,o._BreakCapture=!1,o._RegisteredItems=[],o._RegisteredTools=[v.default,y.default,m.default,g.default,b.default,k.default,S.default,O.default,h.default,p.default,w.default,_.default,P.default,E.default,T.default,I.default,j.default,A.default,D.default,R.default],o.registerItem(x.default,5),o.registerItem(F.default,5),o.registerItem(L.default,7),o.registerItem(N.default,6),o.registerItem(z.default,9),o.registerItem(Q.default,3),o.registerItem(Z.default,3),o.registerItem($.default,3),o.registerItem(V.default,3),o.registerItem(B.default,8),o.registerItem(H.default,4),o.registerItem(K.default,1),o.registerItem(W.default,1),o.registerItem(G.default,5),o.registerItem(U.StageArtboard,0),o.registerItem(U.StageArtboardName,0),o.registerItem(X.default,1),o.registerItem(Y.default,5),o.registerItem(J.default,6),o.registerItem(M.StageLinearGradient,6),o.registerItem(M.StageRadialGradient,6),o.registerItem(M.StageLinearGradientEnd,6),o.registerItem(M.StageLinearGradientMid,6),o.registerItem(M.StageGradientLine,5),o.registerItem(M.StageRadialGradientLine,5),o.registerItem(q.StagePathControlPoint,7),o.registerItem(q.StagePathControlIn,7),o.registerItem(q.StagePathControlOut,7),o.registerItem(q.StagePathControlLine,5),o.registerItem(ee.default,5),o.registerItem(te.default,4),o.registerItem(ne.default,5),o.registerItem(re.default,5),o.registerItem(ie.default,5),o.registerItem(oe.default,5);for(var i=0;i<o._RegisteredItems.length;i++){var s=o._RegisteredItems[i],l={constructor:s.constructor,context:{},drawLayer:s.drawLayer};s.drawLayer>o._MaxDrawLayer&&(o._MaxDrawLayer=s.drawLayer),o._ContextLookup.set(s.constructor,l),o._RegisteredStageItems.push(l)}o._StageDrawLayers=[];for(var u=0;u<=o._MaxDrawLayer;u++)o._StageDrawLayers.push([]);for(var d=0;d<o._RegisteredTools.length;d++)o._AllTools.push(new o._RegisteredTools[d](o));return o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),o(t,[{key:"dispatchHoverItemChange",value:function(){this._LastDispatchedHoverItem!==this._HoverItem&&(this._LastDispatchedHoverItem&&this._LastDispatchedHoverItem.dispatch("hoverChange"),this._HoverItem&&this._HoverItem.dispatch("hoverChange"),this._LastDispatchedHoverItem=this._HoverItem)}},{key:"registerItem",value:function(e,t){this._RegisteredItems.push({constructor:e,drawLayer:t||0})}},{key:"isEnabled",value:function(e){return!0===this._States[e]}},{key:"enableState",value:function(e){return!0!==this._States[e]&&(this._States[e]=!0,this.updateCursorState(),this._ForceRedraw=!0,!0)}},{key:"disableState",value:function(e){return!0===this._States[e]&&(this._States[e]=!1,this.updateCursorState(),this._ForceRedraw=!0,!0)}},{key:"screenScaleRect",value:function(e){return 1!=this._ScreenScale&&(e={width:e.width*this._ScreenScale,height:e.height*this._ScreenScale,bottom:e.bottom*this._ScreenScale,top:e.top*this._ScreenScale,left:e.left*this._ScreenScale}),e}},{key:"getVisibleStageArea",value:function(){var e=this._AppContext.getStageRect();return 1!=this._ScreenScale&&(e={width:e.width*this._ScreenScale,height:e.height*this._ScreenScale,bottom:e.bottom*this._ScreenScale,top:e.top*this._ScreenScale,left:e.left*this._ScreenScale}),e}},{key:"rectToWorld",value:function(e){var t=this._Scale;return{left:(e.left-this._Translation[0])/t,width:e.width/t,height:e.height/t,bottom:(e.bottom-this._Translation[1]-e.height)/t}}},{key:"rerouteSelection",value:function(e,t){this._SelectionReRouteCanMarquee=!0===t,this._SelectionReRoute=e}},{key:"clearRerouteSelection",value:function(e){this._SelectionReRoute==e&&(this._SelectionReRoute=null)}},{key:"setSize",value:function(e,t,n,r){var o=this._Graphics,i=!1;this._ScreenScale=n||1;var a=this._Graphics.width,s=this._Graphics.height;if(o.setSize(e,t)){this._ForceRedraw=!0,i=!0;var l=this._Translation[0]-a/2,u=this._Translation[1]-s/2;this._TranslationTarget[0]=this._Translation[0]=l+e/2,this._TranslationTarget[1]=this._Translation[1]=u+t/2}if(0==this._Scale){this._Scale=.5,this._ScaleTarget=1;var c=this.getVisibleStageArea();c?(this._TranslationTarget[0]=this._Translation[0]=c.left+c.width/2,this._TranslationTarget[1]=this._Translation[1]=.33333*c.height):(this._TranslationTarget[0]=this._Translation[0]=e/2,this._TranslationTarget[1]=this._Translation[1]=.33333*t),this.dispatch("zoomChanged",this._ScaleTarget)}return i}},{key:"getZoomFitViewTransform",value:function(e,t,n){for(var r,o=n||this._StageItems,i=0;i<o.length;i++){var s=o[i];s.isVisible&&s.isSelectable&&(s.constructor!==te.default&&(r?r.combine(s.aabb):(r=new u.default).set(s.aabb.min,s.aabb.max)))}var l=a.mat2d.create();if(!r)return l;var c=r.center,d=Math.min(e/r.boxWidth,t/r.boxHeight);return l[0]=d,l[3]=d,l[4]=e/2-c[0]*d,l[5]=t/2-c[1]*d,l}},{key:"filterItems",value:function(e){for(var t=[],n=0;n<this._StageItems.length;n++){var r=this._StageItems[n];e(r)&&t.push(r)}return t}},{key:"getCombinedAABB",value:function(e){var t;e||(e=this._StageItems);for(var n=null!==this._SoloItems,r=0;r<e.length;r++){var o=e[r];o.isVisible&&(!n||o.isSolo||o.parent&&o.parent.isSolo)&&(o.constructor!==te.default&&(o.constructor===W.default&&(o.node.updateDeform(!0),o.updateMesh()),t?t.combine(o.aabb):(t=new u.default).set(o.aabb.min,o.aabb.max)))}return t}},{key:"zoomFit",value:function(e){e||(e=this._MaxZoom);var t=this._SelectedItems,n=null!==this._SoloItems,r=void 0;if(n&&this._OriginTransform){e=1;var o=Number.MAX_VALUE,i=Number.MAX_VALUE,s=-Number.MAX_VALUE,l=-Number.MAX_VALUE,c=this.soloItem,d=[a.vec2.create(),a.vec2.create(),a.vec2.create(),a.vec2.create()],f=c.min,h=c.max,p=[a.vec2.set(d[0],f[0],f[1]),a.vec2.set(d[1],h[0],f[1]),a.vec2.set(d[2],h[0],h[1]),a.vec2.set(d[3],f[0],h[1])],y=c.renderTransform,v=a.mat2d.create();a.mat2d.fromTranslation(v,this._OriginTranslationTarget),y=a.mat2d.mul(a.mat2d.create(),v,y),a.mat2d.fromRotation(v,this._OriginRotationTarget),y=a.mat2d.mul(a.mat2d.create(),v,y);for(var m=0;m<p.length;m++){var g=p[m],b=a.vec2.transformMat2d(g,g,y);b[0]<o&&(o=b[0]),b[1]<i&&(i=b[1]),b[0]>s&&(s=b[0]),b[1]>l&&(l=b[1])}(r=new u.default).set([o,i],[s,l])}else if(n){e=1;for(var k=Number.MAX_VALUE,S=Number.MAX_VALUE,O=-Number.MAX_VALUE,w=-Number.MAX_VALUE,_=this.soloItem,P=[a.vec2.create(),a.vec2.create(),a.vec2.create(),a.vec2.create()],C=_.min,E=_.max,T=[a.vec2.set(P[0],C[0],C[1]),a.vec2.set(P[1],E[0],C[1]),a.vec2.set(P[2],E[0],E[1]),a.vec2.set(P[3],C[0],E[1])],I=_.renderTransform,j=0;j<T.length;j++){var A=T[j],D=a.vec2.transformMat2d(A,A,I);D[0]<k&&(k=D[0]),D[1]<S&&(S=D[1]),D[0]>O&&(O=D[0]),D[1]>w&&(w=D[1])}(r=new u.default).set([k,S],[O,w])}else{if(0==t.length){var R=this._AppContext.actor.artboards.active;t=[R?R.stageItem:this._StageItems]}for(var M=0;M<t.length;M++){var x=t[M];x.isVisible&&x.isSelectable&&(!n||x.isSolo||x.parent&&x.parent.isSolo)&&(x.constructor!==te.default&&(r?r.combine(x.aabb):(r=new u.default).set(x.aabb.min,x.aabb.max)))}}if(r){var F=r.center,L=this.getVisibleStageArea();this._ScaleTarget=Math.min(e,Math.max(this._MinZoom,Math.min(L.width/r.boxWidth,L.height/r.boxHeight))),this._TranslationTarget[0]=L.left+L.width/2-F[0]*this._ScaleTarget,this._TranslationTarget[1]=L.top+L.height/2-F[1]*this._ScaleTarget,this.dispatch("zoomChanged",this._ScaleTarget)}}},{key:"zoomTo",value:function(e,t,n){var r=this._MinZoom;n=Math.min(this._MaxZoom,Math.max(r,n));var o=this._ScaleTarget;this._ScaleTarget=n;var i=this._ScaleTarget/o,a=e-this._TranslationTarget[0],s=t-this._TranslationTarget[1],l=a*i,u=s*i;this._TranslationTarget[0]+=a-l,this._TranslationTarget[1]+=s-u,this.dispatch("zoomChanged",this._ScaleTarget)}},{key:"updateWorldMousePosition",value:function(){this._WorldMouse[0]=this._MouseX*this._ScreenScale,this._WorldMouse[1]=this._MouseY*this._ScreenScale,a.vec2.transformMat2d(this._WorldMouse,this._WorldMouse,this._InverseViewTransform);var e=this.canSelect,t=this._HoverItem;if(!this.isEnabled(fe.Drag)&&!this._WantSelectionDisabled&&this._IsMouseOverStage){var n=0!=this._SoloStrength;this._HoverItem=null;for(var r=null,o=0,i=this._HoverFallthrough,s=this._StageDrawLayers.length-1;s>=0&&null==this._HoverItem;s--){var l=this._StageDrawLayers[s],u=this._LayerOptions[s];if(u){if(u.disableSelection)continue;u.overrideItems&&(l=u.overrideItems(l,this))}for(var c=l.length-1;c>=0;c--){var d=l[c];if(e(d)&&d.isVisible&&d.isSelectable&&(!n||d.drawAfterSelections||d.isSolo||d.parent&&d.parent.isSolo)&&d.isPointOver(this._WorldMouse[0],this._WorldMouse[1])){if(!(o<i)){this._HoverItem=d;break}o++,null===r&&(r=d)}}}this._HoverItem||null===r||(this._HoverItem=r,this._HoverFallthrough=0)}t!==this._HoverItem&&(this._ForceRedraw=!0,this._CurrentTool&&this._CurrentTool.hoverItemChange&&this._CurrentTool.hoverItemChange(this._HoverItem)),this.dispatchHoverItemChange()}},{key:"advance",value:function(e){var t=this._ScaleTarget-this._Scale,n=this._TranslationTarget[0]-this._Translation[0],r=this._TranslationTarget[1]-this._Translation[1],o=Math.min(1,15*e),i=!1;if(this._ForceRedraw&&(i=!0,this._ForceRedraw=!1),Math.abs(t)>1e-5&&(t*=o,i=!0),Math.abs(n)>.01&&(n*=o,i=!0),Math.abs(r)>.01&&(r*=o,i=!0),this._Scale+=t,this._Translation[0]+=n,this._Translation[1]+=r,this._OriginTranslation&&a.mat2d.identity(this._ViewTransform),this._ViewTransform[0]=this._Scale,this._ViewTransform[3]=this._Scale,this._ViewTransform[4]=this._Translation[0],this._ViewTransform[5]=this._Translation[1],this._OriginTransform){var s=this._OriginTranslationTarget[0]-this._OriginTranslation[0],l=this._OriginTranslationTarget[1]-this._OriginTranslation[1],u=this._OriginRotationTarget-this._OriginRotation;Math.abs(u)>1e-5&&(u*=o,i=!0),Math.abs(s)>.01&&(s*=o,i=!0),Math.abs(l)>.01&&(l*=o,i=!0),this._OriginRotation+=u,this._OriginTranslation[0]+=s,this._OriginTranslation[1]+=l,a.mat2d.fromRotation(this._OriginTransform,this._OriginRotation),a.mat2d.mul(this._ViewTransform,this._ViewTransform,this._OriginTransform),a.mat2d.fromTranslation(this._OriginTransform,this._OriginTranslation),a.mat2d.mul(this._ViewTransform,this._ViewTransform,this._OriginTransform),i||0!=this._OriginTranslation[0]||0!=this._OriginTranslation[1]||0!=this._OriginRotation||(this._OriginTransform=null)}if(a.mat2d.invert(this._InverseViewTransform,this._ViewTransform),0!=this._SoloStrength||this._SoloItems){var c=3.22*e;1==this._SoloStrength&&this._SoloItems||(i=!0),i&&(this._SoloStrength+=this._SoloItems?c:-c,this._SoloStrength=Math.min(1,Math.max(0,this._SoloStrength))),0==this._SoloStrength&&this._SoloItems}return this._WasAnimatingView&&!i&&this.updateWorldMousePosition(),this._WasAnimatingView=i,i}},{key:"setSoloItems",value:function(e,t,n){if(this._SoloDarken=!0===n,this._SoloItems)for(var r=0;r<this._SoloItems.length;r++)this._SoloItems[r].isSolo=!1;this._SoloItems=e.slice(0);for(var o=0;o<this._SoloItems.length;o++)this._SoloItems[o].isSolo=!0;t&&(this._SoloZoomed||(this._PreSoloScaleTarget=this._ScaleTarget,a.vec2.copy(this._PreSoloTranslationTarget,this._TranslationTarget)),this._SoloZoomed=!0,this.zoomFit(1),this.dispatch("zoomChanged",this._ScaleTarget)),this._CurrentTool&&this._CurrentTool.updateSolo(this._SoloItems),this.dispatch("soloChanged"),this.validateTool()}},{key:"clearSoloItems",value:function(){if(this._SoloItems){for(var e=0;e<this._SoloItems.length;e++)this._SoloItems[e].isSolo=!1;this._SoloItems=null,this._SoloZoomed&&(this._SoloZoomed=!1,this._ScaleTarget=this._PreSoloScaleTarget,a.vec2.copy(this._TranslationTarget,this._PreSoloTranslationTarget),this.dispatch("zoomChanged",this._ScaleTarget)),this._CurrentTool&&this._CurrentTool.updateSolo(this._SoloItems),this.dispatch("soloChanged"),this.validateTool()}}},{key:"setViewOrigin",value:function(e){this._OriginTransform=a.mat2d.create(),e?(this._OriginTranslationTarget[0]=-e[4],this._OriginTranslationTarget[1]=-e[5],this._OriginRotationTarget=-a.mat2d.getRotation(e)):(a.vec2.set(this._OriginTranslationTarget,0,0),this._OriginRotationTarget=0)}},{key:"setLayerOptions",value:function(e,t){var n=this._ContextLookup.get(e);if(!n)return null;var r=n&&n.drawLayer||0;this._LayerOptions[r]=t,this.dispatch("updateLayerOptions")}},{key:"setLayerRenderExtensions",value:function(e,t){this._LayerOptions[e]=t}},{key:"getLayerOptions",value:function(e){var t=this._ContextLookup.get(e);if(!t)return null;var n=t&&t.drawLayer||0,r=this._LayerOptions[n];return r||(r=this._LayerOptions[n]={}),r}},{key:"clearRenderCapture",value:function(){this._BreakCapture=!0,this._RenderCaptureCallback=null}},{key:"addRenderCapture",value:function(e){this._RenderCaptureCallback&&this._RenderCaptureCallback.constructor===Array||(this._RenderCaptureCallback=[]),this._RenderCaptureCallback.push(e),this._ForceRedraw=!0}},{key:"drawRenderCapture",value:function(e){e.setup&&(e.context=e.setup());var t=128,n=128;e.context&&(e.context.renderWidth&&(t=e.context.renderWidth),e.context.renderHeight&&(n=e.context.renderHeight)),ce||(ce=new f.default);var r=ce;if(r.setSize(t,n),e.context&&e.context.renderView?this._ViewTransform=e.context.renderView:this._ViewTransform=this._RenderCaptureView,a.mat2d.invert(this._InverseViewTransform,this._ViewTransform),this.drawTo(r,t,n)){var o=r.skCanvas.readPixels(0,0,t,n),i=new Uint8Array(o.buffer);e.complete?e.complete(i,t,n,e.context):e(i),e.cleanup&&e.cleanup(e.context),e=null}}},{key:"onGraphicsReady",value:function(e){var t=new(ue=e.canvasKit).SkPaint;t.setAntiAlias(!1),t.setStyle(ue.PaintStyle.Fill),t.setBlendMode(ue.BlendMode.SrcOver),this._SoloDarkenPaint=t;var n=new ue.SkPaint;n.setAntiAlias(!0),n.setStyle(ue.PaintStyle.Fill),n.setBlendMode(ue.BlendMode.SrcOver),n.setColor(ue.Color(87,165,224,1)),this._GuidePaint=n;var r=new ue.SkPaint;r.setAntiAlias(!1),r.setStyle(ue.PaintStyle.Fill),r.setBlendMode(ue.BlendMode.SrcOver),r.setColor(ue.Color(87,165,224,.3)),this._MarqueeFillPaint=r;var o=new ue.SkPaint;o.setAntiAlias(!0),o.setStyle(ue.PaintStyle.Stroke),o.setStrokeWidth(1),o.setBlendMode(ue.BlendMode.SrcOver),o.setColor(ue.Color(87,165,224,1)),this._MarqueeStrokePaint=o;for(var i=0;i<this._RegisteredItems.length;i++){var a=this._RegisteredItems[i],s=a.constructor.initializeStageContext;if(s&&s.constructor===Function)s(e,this._ContextLookup.get(a.constructor).context,this)}var l=new Map,u=!0,c=!1,d=void 0;try{for(var f,h=this._RegisteredTools[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value,y={};l.set(p,y),p.initializeStageContext&&p.initializeStageContext(e,y,this)}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}var v=!0,m=!1,g=void 0;try{for(var b,k=this._AllTools[Symbol.iterator]();!(v=(b=k.next()).done);v=!0){var S=b.value;S.stageContext=l.get(S.constructor)}}catch(e){m=!0,g=e}finally{try{!v&&k.return&&k.return()}finally{if(m)throw g}}this.processQueuedAddRemove(),this._AppContext.onStageReady()}},{key:"draw",value:function(e){if(this._RenderCaptureCallback){var t=this._ViewTransform;if(this._RenderCaptureCallback.constructor===Array){this._BreakCapture=!1;var n=this._RenderCaptureCallback.slice(0);this._RenderCaptureCallback=null;for(var r=0;!this._BreakCapture&&r<n.length;r++){var o=n[r];this.drawRenderCapture(o)}}else{var i=this._RenderCaptureCallback;this._RenderCaptureCallback=null,this.drawRenderCapture(i)}this._ViewTransform=t,a.mat2d.invert(this._InverseViewTransform,this._ViewTransform)}this.drawTo(null,null,null,e)}},{key:"drawTo",value:function(e,t,n,r){var o=!1,i=null,a=this._WantSelectionDisabled,s=this.canSelect,l=e||this._Graphics,u=l.skCanvas;if(!l.clear())return!1;var c=this._ViewTransform;u.save(),l.transform(c),e||this._SoloStrength>0&&(o=this._SoloDarken)&&(i=[]);for(var d=this.isEnabled(fe.Pan)||this.isEnabled(fe.PanModifier),f=[],h=0;h<this._StageDrawLayers.length;h++){var p=this._StageDrawLayers[h],y=this._LayerOptions[h],v=!0;if(y&&(y.overrideItems&&(p=y.overrideItems(p,this)),y.drawPrep&&(p=y.drawPrep.call(y,p,l,this)),y.disableDraw&&(v=!1)),p&&v)for(var m=0;m<p.length;m++){var g=p[m];g.isVisible&&(o&&(g.isSolo||g.parent&&g.parent.isSolo)?i.push(g):g.drawAfterSelections?f.push(g):g.draw(l,g==this._HoverItem&&!d,!a&&g.isSelected&&s(g)))}y&&y.drawCleanup&&y.drawCleanup.call(y,l)}if(o){l.restore(),this._SoloDarkenPaint.setColor(ue.Color(20,20,20,.75*this._SoloStrength)),u.drawRect(ue.XYWHRect(0,0,l.width,l.height),this._SoloDarkenPaint),u.save(),l.transform(c);for(var b=0;b<i.length;b++){var k=i[b];k.draw(l,k==this._HoverItem&&!d)}}if(!a)for(var S=0;S<this._SelectedItems.length;S++){var O=this._SelectedItems[S];s(O)&&O.drawSelection(l,O==this._HoverItem&&!d)}if(d||!this._HoverItem||!this._WantSelectionDisabled&&this._HoverItem.isSelected||this._HoverItem.drawSelection(l,!0),this._CurrentTool&&this._CurrentTool.drawPrep(l),!this._WantSelectionDisabled)for(var w=this.canSelect,_=0;_<f.length;_++){var P=f[_];w(P)&&P.draw(l,P==this._HoverItem&&!d)}if(this._CurrentTool&&this._CurrentTool.draw(l),l.restore(),this._DraggedMarquee){var C=this._MarqueeStart[0]<this._MarqueeEnd[0],E=this._MarqueeStart[1]<this._MarqueeEnd[1],T=C?this._MarqueeStart[0]:this._MarqueeEnd[0],I=E?this._MarqueeStart[1]:this._MarqueeEnd[1],j=C?this._MarqueeEnd[0]:this._MarqueeStart[0],A=E?this._MarqueeEnd[1]:this._MarqueeStart[1],D=ue.LTRBRect(T,I,j,A);u.drawRect(D,this._MarqueeFillPaint),u.drawRect(D,this._MarqueeStrokePaint)}if(r){var R=!0,M=!1,x=void 0;try{for(var F,L=r[Symbol.iterator]();!(R=(F=L.next()).done);R=!0){var N=F.value;u.drawRect(ue.XYWHRect(N.x,N.y,N.w,N.h),this._GuidePaint)}}catch(e){M=!0,x=e}finally{try{!R&&L.return&&L.return()}finally{if(M)throw x}}}return l.flush(),!0}},{key:"updateCustomCursorPosition",value:function(e){e&&(this._MouseX=e.clientX,this._MouseY=e.clientY),this._CursorElement.parentNode&&(this._CursorElement.style.left=this._MouseX-this._CursorElement.width/2+"px",this._CursorElement.style.top=this._MouseY-this._CursorElement.height/2+"px")}},{key:"updateCursorState",value:function(){for(var e=document.body,t=0;t<he.length;t++){var n=he[t];if(this.isEnabled(n.state)){if(n.cursor.constructor==Array)for(var r=0;r<n.cursor.length;r++)e.style.cursor=n.cursor[r];else e.style.cursor=n.cursor;return n.custom&&(this._CursorElement.src=n.custom,this._CursorElement.width=n.width,this._CursorElement.height=n.height,this._CursorElement.parentNode||document.body.appendChild(this._CursorElement),this.updateCustomCursorPosition()),!0}}return this._CursorElement.parentNode&&(this._CursorElement.src="",this._CursorElement.parentNode.removeChild(this._CursorElement)),e.style.cursor="",!1}},{key:"clearSelections",value:function(e,t,n){var r=this.canSelect;0!=this._SelectedItems.length&&(this._ForceRedraw=!0);for(var o=0;o<this._SelectedItems.length;o++){var i=this._SelectedItems[o];(t||r(i))&&(this._SelectedItems[o].isSelected=!1,this._SelectedItems.splice(o,1),o--)}if(!e){var a=this.getFilteredSelectedItems();this._CurrentTool&&(this._CurrentTool.updateSelection(a),this._CurrentTool.clearSelections()),this.dispatch("selectionChanged",a)}n||this.dispatch("selectionCleared"),this.doUpdateHighlights(),this.updateSelectionTarget()}},{key:"markMouseDown",value:function(){this._IsMouseDown=!0}},{key:"clearMouseDownSelected",value:function(e){var t=this;window.removeEventListener("mouseup",this.clearMouseDownSelected,!0),this._MouseDownSelectedTimeout=setTimeout(function(){return t._MouseDownSelected=!1},100)}},{key:"updateSelectionTarget",value:function(){this._SelectionTarget&&!this._SelectionTarget.isSelected&&(this._SelectionTarget=null)}},{key:"onMouseDown",value:function(e){if(!this._IsMouseDown){this._IsPreDrag=!0,this._MouseDownTime=Date.now(),this._MouseMoveAccum[0]=0,this._MouseMoveAccum[1]=0,this._IsMouseDown=!0,this._SelectionsChanged=!1;var t=!1;if(this._MouseDragged=!1,this._ReRoutedSelection=!1,2!==e.button){this._MoveTriggersPan=!1,this._LastClickedItem=this._HoverItem;var n=e.altKey,r=l.default.isMultiSelect(e)||e.shiftKey||n,o=this._SelectedItems.indexOf(this._HoverItem),i=this._HoverItem&&-1!=o,a=this.isEnabled(fe.PanModifier);t=null!==this._HoverItem,!a&&this._HoverItem&&this._HoverItem.customSelectionAction&&this._HoverItem.customSelectionAction(this._HoverItem,e.shiftKey)&&(i=!0);var s=!1;this._SelectionReRoute||!this._HoverItem||r||i||a||(this.clearSelections(!0),s=!0),i&&(r?(this._HoverItem.isSelected=!1,-1!=o&&this._SelectedItems.splice(o,1)):this._SelectionTarget==this._HoverItem?this._SelectionTarget=null:this._SelectedItems.length>1&&(this._SelectionTarget=this._HoverItem));var u=this.getFilteredSelectedItems();if(this.isEnabled(fe.PanModifier))this.enableState(fe.Pan);else if(this._HoverItem||i||!(0==u.length||r||this._SelectionReRoute&&this._SelectionReRouteCanMarquee||this._CurrentTool&&this._CurrentTool.alwaysMarquee)||this._CurrentTool&&this._CurrentTool.blockMarquee(e))if(n||!this._HoverItem||i){if(this._SelectionReRoute){this._ReRoutedSelection=!0;var c=this._SelectionReRoute;this._SelectionReRoute=null,c(null,l.default.isMultiSelect(e)||e.shiftKey)}}else{if(t=!0,this._SelectionReRoute){this._ReRoutedSelection=!0;var d=this._SelectionReRoute;this._SelectionReRoute=null,d(this._HoverItem,l.default.isMultiSelect(e)||e.shiftKey)}else-1===this._SelectedItems.indexOf(this._HoverItem)&&(this._SelectedItems.push(this._HoverItem),this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),s=!0,this._HoverItem.isSelected=!0);this._ForceRedraw=!0}else{if(this._SelectionReRoute&&!this._SelectionReRouteCanMarquee){this._ReRoutedSelection=!0;var f=this._SelectionReRoute;this._SelectionReRoute=null,f(!1,l.default.isMultiSelect(e)||e.shiftKey)}r||this._SelectionReRouteCanMarquee?this._PreMarqueeSelection=this._SelectedItems.slice(0):(this._SelectedItems.length&&(this.clearSelections(!0),s=!0),this._PreMarqueeSelection=this.getFilteredSelectedItems(!0)),this._IsDraggingMarquee=!0,this._DraggedMarquee=!1,this._MarqueeStart[0]=this._MouseX*this._ScreenScale,this._MarqueeStart[1]=this._MouseY*this._ScreenScale,this._CurrentTool&&this._CurrentTool.marqueeStarted&&this._CurrentTool.marqueeStarted()}if(!this.isEnabled(fe.PanModifier)&&!this._IsDragDisabled){var h=!1;/*!_MouseDownSelected && */this._CurrentTool&&(this._CurrentToolClicked=!0,this._CurrentTool.click(this._WorldMouse,t,e)&&(this._IsDraggingMarquee=!1),this._CurrentTool.allowDrag&&!this._CurrentTool.allowDrag()&&(h=!0)),h||this.enableState(fe.Drag)}s&&this.dispatchSelectionChanged(),this.mouseDownSelected=t}else this._MoveTriggersPan=!0}}},{key:"dispatchSelectionChanged",value:function(e){this.updateSelectionTarget(),this.updateHighlights(),this.dispatch("selectionChanged",this.getFilteredSelectedItems(),e)}},{key:"onItemVisibilityChanged",value:function(e){e.isVisible||this.deSelectItem(e),this.dispatch("itemVisibilityChanged",e)}},{key:"selectContextMenuNode",value:function(e){e.stageItem&&this.selectItem(e.stageItem)}},{key:"endDragTool",value:function(e){this._ActiveDragTool&&(this._ActiveDragTool.endDrag(),this._ActiveDragTool=null,this.updateSelectionDisabled(),e&&this._AppContext.captureJournalEntry())}},{key:"onMouseUp",value:function(e){if(this._IsMouseDown){var t=!1,n=this.isEnabled(fe.Pan),r=this.canSelect;if(n)this.disableState(fe.Pan),this._MoveTriggersPan&&this.disableState(fe.PanModifier);else if(2===e.button){for(var o=0!=this._SoloStrength,i=[],a=[],s=[],u=new Set,c=this._StageDrawLayers.length-1;c>=0;c--){var d=this._StageDrawLayers[c],f=this._LayerOptions[c];if(f){if(f.disableSelection)continue;f.overrideItems&&(d=f.overrideItems(d,this))}for(var h=d.length-1;h>=0;h--){var p=d[h];if(r(p)&&p.isVisible&&p.isSelectable&&(!o||p.drawAfterSelections||p.isSolo||p.parent&&p.parent.isSolo)&&p.isPointOver(this._WorldMouse[0],this._WorldMouse[1])){var y=p.node;if(!y)continue;if(u.has(y))continue;u.add(y),i.push({name:y.name,node:y,stageItem:p,isActive:p.isSelected,select:this.selectContextMenuNode}),p.isSelected||void 0===y.rigDrawOrder||(a.push({name:y.name,node:y,stageItem:p,select:this.appContext.contextMenuSendBehind}),s.push({name:y.name,node:y,stageItem:p,select:this.appContext.contextMenuBringOver}))}}}1===this._SelectedItems.length&&this._SelectedItems[0].node&&void 0!==this._SelectedItems[0].node.rigDrawOrder&&(a.length||s.length)&&(i.push({type:"Divider"}),a.length&&i.push({type:"SubMenu",name:"Send Behind",items:a}),s.length&&i.push({type:"SubMenu",name:"Bring Over",items:s})),i.length>0&&(t=!0,this.appContext.showContextMenu({x:e.clientX,y:e.clientY,items:i}))}this._MoveTriggersPan&&(this._MoveTriggersPan=!1),this.disableState(fe.Drag),this.updateWorldMousePosition();var v=this._CurrentTool;if(v&&v.doesCustomSelection||t||this._SelectionReRoute||this._ReRoutedSelection||this._SelectionsChanged||this._MouseDragged||this.mouseDownSelected||n||this._DraggedMarquee?this._MouseDragged&&(this.endDragTool(),this._ForceRedraw=!0):this.clearSelections(),this._CurrentOperation&&this._CurrentOperation.mouseUp?this._CurrentOperation.mouseUp(this._WorldMouse):v&&this._CurrentToolClicked&&(this._CurrentToolClicked=!1,v.release(this._WorldMouse,this._DraggedMarquee||this._MouseDragged,e)),this._IsMouseDown=!1,this._DraggedMarquee){if(this._SelectionReRoute){for(var m=[],g=0;g<this._SelectedItems.length;g++){var b=this._SelectedItems[g];-1===this._PreMarqueeSelection.indexOf(b)&&(m.push(b),b.isSelected=!1,this._SelectedItems.splice(g,1),g--)}this._ReRoutedSelection=!0;var k=this._SelectionReRoute;this._SelectionReRoute=null,this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),k(m,l.default.isMultiSelect(e)||e.shiftKey)}else{this.dispatchSelectionChanged();for(var S=0;S<this._MarqueeSilentChanges.length;S++){this._MarqueeSilentChanges[S].dispatchSelectionChanged()}}this._MarqueeSilentChanges.length=0}else if(this._SelectionReRoute){this._ReRoutedSelection=!0;var O=this._SelectionReRoute;this._SelectionReRoute=null,O(!1,l.default.isMultiSelect(e)||e.shiftKey)}this._IsDraggingMarquee=!1,this._DraggedMarquee=!1}}},{key:"setExtraSelectionFilter",value:function(e){this._ExtraFilter=e,this._ForceRedraw=!0}},{key:"clearExtraSelectionFilter",value:function(){this._ExtraFilter=null,this._ForceRedraw=!0}},{key:"canSelect",value:function(e){var t=this._SelectionFilter,n=this._ExtraFilter;return!(t&&!t.canSelect(e))&&!(n&&!n(e))}},{key:"getFilteredSelectedItems",value:function(e){for(var t=[],n=this._SelectedItems,r=this.canSelect,o=0;o<n.length;o++){var i=n[o],a=r(i);a&&!e?t.push(i):!a&&e&&t.push(i)}return t}},{key:"onMouseMove",value:function(e,t,n){if(e.clientX!=this._MouseX||e.clientY!=this._MouseY){if(this._MoveTriggersPan&&!this.isEnabled(fe.Pan)&&(this.enableState(fe.PanModifier),this.enableState(fe.Pan)),this._IsPreDrag)if(Date.now()-this._MouseDownTime<110){if(this._MouseMoveAccum[0]+=t,this._MouseMoveAccum[1]+=n,!(a.vec2.length(this._MouseMoveAccum)>20))return;t=this._MouseMoveAccum[0],n=this._MouseMoveAccum[1],this._IsPreDrag=!1}else t+=this._MouseMoveAccum[0],n+=this._MouseMoveAccum[1],this._IsPreDrag=!1;this._MouseX=e.clientX,this._MouseY=e.clientY;var r=a.vec2.clone(this._WorldMouse);if(this.updateCustomCursorPosition(),this.updateWorldMousePosition(),this.isEnabled(fe.Pan)&&!this._SuppressPanning&&(e.stopPropagation(),e.preventDefault(),this._TranslationTarget[0]+=t*this._ScreenScale,this._TranslationTarget[1]+=n*this._ScreenScale,this._ForceRedraw=!0),this.isEnabled(fe.Drag)){e.stopPropagation(),e.preventDefault(),this._ForceRedraw=!0;var o=a.vec2.subtract(a.vec2.create(),this._WorldMouse,r);if(this._IsDraggingMarquee)this._DraggedMarquee=!0,this._MarqueeEnd[0]=this._MouseX*this._ScreenScale,this._MarqueeEnd[1]=this._MouseY*this._ScreenScale,this.updateMarqueeSelections(e.altKey,l.default.isMultiSelect(e));else{this._MouseDragged||(this._MouseDragged=!0,this._CurrentTool&&this._CurrentTool.startDrag(this._LastClickedItem,this.getFilteredSelectedItems(),e)?this._ActiveDragTool=this._CurrentTool:this.disableState(fe.Drag));var i=a.vec2.set(a.vec2.create(),t,n);this._ActiveDragTool&&!this._WantSelectionDisabled&&this._ActiveDragTool.advanceDrag(i,o,this._WorldMouse,r)}}else if(this._CurrentOperation&&this._CurrentOperation.mouseMove)e.stopPropagation(),e.preventDefault(),this._ForceRedraw=!0,this._CurrentOperation.mouseMove(this._WorldMouse);else if(this._CurrentTool&&this._CurrentTool.mouseMove){e.stopPropagation(),e.preventDefault();var s=a.vec2.set(a.vec2.create(),t,n),u=a.vec2.subtract(a.vec2.create(),this._WorldMouse,r);this._CurrentTool.mouseMove(s,u,this._WorldMouse,r)&&(this._ForceRedraw=!0)}this.updateSelectionDisabled()}}},{key:"updateMarqueeSelections",value:function(e,t){for(var n=a.vec2.clone(this._MarqueeStart),r=a.vec2.clone(this._MarqueeEnd),o=n[0]<r[0],i=n[1]<r[1],s=o?n[0]:r[0],l=i?n[1]:r[1],u=o?r[0]:n[0],c=i?r[1]:n[1],d=[a.vec2.set(a.vec2.create(),s,l),a.vec2.set(a.vec2.create(),u,l),a.vec2.set(a.vec2.create(),u,c),a.vec2.set(a.vec2.create(),s,c)],f=0;f<4;f++){var h=d[f];a.vec2.transformMat2d(h,h,this._InverseViewTransform)}for(var p=this.canSelect,y=this._SelectedItems,v=0;v<y.length;v++){var m=y[v];m.setSelected(!1,!0)&&-1===this._MarqueeSilentChanges.indexOf(m)&&this._MarqueeSilentChanges.push(m)}y.length=0;var g=0!=this._SoloStrength;if(e)for(var b=0;b<this._PreMarqueeSelection.length;b++){var k=this._PreMarqueeSelection[b];p(k)&&k.rectIntersects(d)||(y.push(k),k.setSelected(!0,!0)&&-1===this._MarqueeSilentChanges.indexOf(k)&&this._MarqueeSilentChanges.push(k))}else{var S=this._PreMarqueeSelection;t&&(S=S.slice(0));for(var O=this._StageDrawLayers.length-1;O>=0;O--){var w=this._StageDrawLayers[O],_=this._LayerOptions[O];if(!_||!_.disableSelection&&!_.disableDraw){for(var P=w.length-1;P>=0;P--){var C=w[P];if((!g||C.isSolo||C.parent&&C.parent.isSolo)&&(p(C)&&C.isVisible&&C.isSelectable&&!C.isHandle&&C.rectIntersects(d))){if(t){var E=S.indexOf(C);if(-1!==E){S.splice(E,1);continue}}C.setSelected(!0,!0)&&-1===this._MarqueeSilentChanges.indexOf(C)&&this._MarqueeSilentChanges.push(C),y.push(C)}}this._ForceRedraw=!0}}for(var T=0;T<S.length;T++){var I=S[T];I.isSelected||(I.isSelected=!0,y.push(I))}}this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems(),{isDeselect:e,isToggle:t,rect:d})}},{key:"onMouseEnterStage",value:function(e){this._IsMouseOverStage=!0,this._CurrentOperation&&this._CurrentOperation.mouseEnterStage&&this._CurrentOperation.mouseEnterStage(this._WorldMouse)}},{key:"onMouseLeaveStage",value:function(e){this._IsMouseOverStage=!1,this._ActiveDragTool||(this._HoverItem=null,this._CurrentTool&&this._CurrentTool.hoverItemChange&&this._CurrentTool.hoverItemChange(this._HoverItem)),this._ForceRedraw=!0,this._CurrentOperation&&this._CurrentOperation.mouseLeaveStage&&this._CurrentOperation.mouseLeaveStage(this._WorldMouse),this.dispatchHoverItemChange()}},{key:"onMouseEnter",value:function(e){this._CursorElement.style.display="",this._ForceRedraw=!0}},{key:"onMouseLeave",value:function(e){this._CursorElement.style.display="none",this._HoverItem=null,this._CurrentTool&&this._CurrentTool.hoverItemChange&&this._CurrentTool.hoverItemChange(this._HoverItem),this._ForceRedraw=!0,this.dispatchHoverItemChange()}},{key:"cycleHover",value:function(){this._HoverFallthrough++,this.updateWorldMousePosition()}},{key:"onMouseWheel",value:function(e){e.preventDefault();var t=-function(e){var t=0,n=0,r=0,o=0;"detail"in e&&(n=e.detail);"wheelDelta"in e&&(n=-e.wheelDelta/120);"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120);"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120);"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0);r=t*pe,o=n*pe,"deltaY"in e&&(o=e.deltaY);"deltaX"in e&&(r=e.deltaX);(r||o)&&e.deltaMode&&(1==e.deltaMode?(r*=ye,o*=ye):(r*=ve,o*=ve));r&&!t&&(t=r<1?-1:1);o&&!n&&(n=o<1?-1:1);return{spinX:t,spinY:n,pixelX:r,pixelY:o}}(e).spinY/20;return e.ctrlKey&&(t/=15),this.zoomTo(e.clientX*this._ScreenScale,e.clientY*this._ScreenScale,this._ScaleTarget+t),!0}},{key:"onKeyDown",value:function(e){return 18===e.keyCode&&this.cycleHover(),!(!this._CurrentTool||!this._CurrentTool.onKeyDown)&&this._CurrentTool.onKeyDown(e)}},{key:"onKeyUp",value:function(e){return!(!this._CurrentTool||!this._CurrentTool.onKeyUp)&&this._CurrentTool.onKeyUp(e)}},{key:"eachSelectedItem",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this._SelectedItems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(e(a))return a}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return null}},{key:"updateSelectionDisabled",value:function(){var e=!(!this._WantSelectionDisabled&&!this._ActiveDragTool);e!==this._IsSelectionDisabled&&(this._IsSelectionDisabled=e,this.dispatch(e?"selectionDisabled":"selectionEnabled",this),this._ForceRedraw=!0)}},{key:"filterSelectedItems",value:function(e){return this._SelectedItems.filter(e)}},{key:"addItem",value:function(e){this._StageItems.push(e);var t=this._ContextLookup.get(e.constructor),n=t&&t.drawLayer||0;this._StageDrawLayers[n].push(e),this._ForceRedraw=!0,this.dispatch("add",e)}},{key:"removeItem",value:function(e){this._SelectionTarget==e&&(this._SelectionTarget=null);var t=this._ContextLookup.get(e.constructor),n=t&&t.drawLayer||0,r=(n=this._StageDrawLayers[n]).indexOf(e);-1!=r&&n.splice(r,1),this._HoverItem==e&&(this._HoverItem=null,this._CurrentTool&&this._CurrentTool.hoverItemChange&&this._CurrentTool.hoverItemChange(this._HoverItem)),-1!=(r=this._StageItems.indexOf(e))&&this._StageItems.splice(r,1),this._SoloItems&&-1!==(r=this._SoloItems.indexOf(e))&&this._SoloItems.splice(r,1),-1!=(r=this._SelectedItems.indexOf(e))&&(this._SelectedItems.splice(r,1),this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),this.dispatchSelectionChanged()),e.isSelected=!1,this._ForceRedraw=!0,this.dispatch("remove",e),this.dispatchHoverItemChange()}},{key:"getStageItemContext",value:function(e){var t=this._ContextLookup.get(e.constructor);return t?t.context:null}},{key:"redraw",value:function(){this._ForceRedraw=!0}},{key:"findTool",value:function(e){for(var t=0;t<this._AllTools.length;t++){var n=this._AllTools[t];if(n instanceof e)return n}return console.warn("Couldn't find tool",e,this._AllTools),null}},{key:"selectTool",value:function(e){var t=this.findTool(e);if(t){if(t.validate&&!t.validate())return console.warn("Attempting to select invalid tool",t),!1;this._CurrentTool&&this._CurrentTool.disable(),this._ActiveDragTool=null,this.updateSelectionDisabled(),t.enable();var n=this.toolType;return this._PreviousTool=this._CurrentTool,this._CurrentTool=t,this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),this.dispatch("toolChanged",{from:n,to:e}),!0}return!1}},{key:"validateTool",value:function(){var e=this._CurrentTool,t=this._PreviousTool,n=this._AllTools;return!(!e||!e.validate())||(this.selectTool(t&&t.constructor||n[0].constructor),!1)}},{key:"updateToolSelection",value:function(){this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems())}},{key:"selectAll",value:function(){var e=null,t=!1,n=[];if(this._SelectedItems)for(var r=0;r<this._SelectedItems.length;r++){var o=this._SelectedItems[r];if(null===e)e=o.constructor;else if(e!==o.constructor){if(e===V.default&&o.constructor===H.default||e===H.default&&o.constructor===V.default)continue;e=null;break}}e===V.default||e===H.default?n.push(V.default,H.default):n.push(e);for(var i=null!==this._SoloItems,a=0;a<this._StageItems.length;a++){var s=this._AppContext.actor.artboards.active,l=this._StageItems[a];if(!l.isSelected&&l.isVisible&&l.isSelectable&&(null===e||-1!==n.indexOf(l.constructor))&&l.node&&l.node.root===s&&l.node!==s){if(i&&!l.isSolo&&(!l.parent||!l.parent.isSolo))continue;this._SelectedItems.push(l),l.isSelected=!0,t=!0}}if(!t)for(var u=0;u<this._StageItems.length;u++){var c=this._StageItems[u];!c.isSelected&&c.isVisible&&(this._SelectedItems.push(c),c.isSelected=!0,t=!0)}this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),this.dispatchSelectionChanged(),this._ForceRedraw=!0}},{key:"deSelectItem",value:function(e,t){var n=this._SelectedItems.indexOf(e);-1!=n&&(this._SelectedItems.splice(n,1),e.isSelected=!1,this.dispatchSelectionChanged(t),this._ForceRedraw=!0,this._HoverItem!==e||e.isSelectable||(this._HoverItem=null)),this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems())}},{key:"selectItems",value:function(e,t,n,r){this._SelectionsChanged=!0,!t&&this._SelectedItems.length&&this.clearSelections(!0);for(var o=0;o<e.length;o++){var i=e[o];i.isSelected||(this._SelectedItems.push(i),i.isSelected=!0)}this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),n||(this.dispatchSelectionChanged(r),this._ForceRedraw=!0)}},{key:"selectItem",value:function(e,t,n,r){if(!e)throw new Error("Cannot select a non object");if(this._SelectionReRoute){var o=this._SelectionReRoute;return this._SelectionReRoute=null,void o(e,t)}e.isSelected||(this._SelectionsChanged=!0,!t&&this._SelectedItems.length&&this.clearSelections(!0),this._SelectedItems.push(e),e.isSelected=!0,this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),n||(this.dispatchSelectionChanged(r),this._ForceRedraw=!0))}},{key:"isItemSelected",value:function(e){return-1!==this._SelectedItems.indexOf(e)}},{key:"startOperation",value:function(e){this._CurrentOperation&&this._CurrentOperation.end(),this._CurrentOperation=e}},{key:"endOperation",value:function(e){(this._CurrentOperation==e||!e&&this._CurrentOperation)&&(this._CurrentOperation=null,e.silent||this.appContext.captureJournalEntry())}},{key:"cancel",value:function(){this._CurrentOperation?(this._CurrentOperation.cancel&&this._CurrentOperation.cancel(),this._CurrentOperation.end()):this._ActiveDragTool&&(this._ActiveDragTool.endDrag(),this._ActiveDragTool=null,this.updateSelectionDisabled(),this._AppContext.captureJournalEntry(),this._AppContext.undo()),this._CurrentTool&&this._CurrentTool.cancel()}},{key:"getTypeItems",value:function(e){e.constructor!==Array&&(e=[e]);for(var t=[],n=0;n<this._StageItems.length;n++){var r=this._StageItems[n];-1!==e.indexOf(r.constructor)&&t.push(r)}return t}},{key:"clear",value:function(){this.clearSelections(),this._HoverItem=this._LastClickedItem=null,this._StageItems.length=0;for(var e=0;e<this._StageDrawLayers.length;e++)this._StageDrawLayers[e].length=0;this._PreMarqueeSelection.length=0,this.dispatchHoverItemChange()}},{key:"queueRemove",value:function(e){var t=this._QueuedAdd.indexOf(e);-1===t?-1===this._QueuedRemove.indexOf(e)&&this._QueuedRemove.push(e):this._QueuedAdd.splice(t,1)}},{key:"queueAdd",value:function(e){var t=this._QueuedRemove.indexOf(e);-1===t?-1===this._QueuedAdd.indexOf(e)&&this._QueuedAdd.push(e):this._QueuedRemove.splice(t,1)}},{key:"resetQueuedAddRemove",value:function(){this._QueuedRemove.length=0,this._QueuedAdd.length=0}},{key:"processQueuedAddRemove",value:function(){if(ue){for(var e=0;e<this._QueuedRemove.length;e++){this._QueuedRemove[e].removeFromStage()}for(var t=0;t<this._QueuedAdd.length;t++){this._QueuedAdd[t].addToStage(this)}this._QueuedRemove.length=0,this._QueuedAdd.length=0,this.updateHighlights()}}},{key:"updateSettings",value:function(){this._Settings.disableImageContour=this._AppContext.getPreference("disableImageContour"),this.redraw()}},{key:"doUpdateHighlights",value:function(){var e=this._HighlightItems,t=e.slice(0);(e.length=0,1===this._SelectedItems.length)&&this._SelectedItems[0].updateHighlights(this);var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;-1===e.indexOf(s)&&(s.highlight=!1)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}},{key:"highlight",value:function(e){this._HighlightItems.push(e),e.highlight=!0}},{key:"updateHighlights",value:function(){clearTimeout(this.hltimeout),this.hltimeout=setTimeout(this.doUpdateHighlights,33)}},{key:"displayWarning",value:function(e){var t=this._AppContext;(0,ae.default)(t.alert,{type:0,title:e.title,message:e.message,buttons:[],autoHideSeconds:3})}},{key:"isDraggingMarquee",get:function(){return this._IsDraggingMarquee}},{key:"mouseDownSelected",get:function(){return this._MouseDownSelected},set:function(e){this._MouseDownSelected!==e&&(clearTimeout(this._MouseDownSelectedTimeout),this._MouseDownSelected=e,e&&window.addEventListener("mouseup",this.clearMouseDownSelected,!0))}},{key:"soloItem",get:function(){return this._SoloItems&&this._SoloItems.length&&this._SoloItems[0]}},{key:"soloItems",get:function(){return this._SoloItems}},{key:"stageItems",get:function(){return this._StageItems.slice(0)}},{key:"isMouseOver",get:function(){return this._IsMouseOverStage}},{key:"suppressPanning",get:function(){return this._SuppressPanning},set:function(e){this._SuppressPanning=e}},{key:"transformSpace",get:function(){return this._TransformSpace},set:function(e){this._TransformSpace!=e&&(this._TransformSpace=e,this.dispatch("transformSpaceChanged",e),this._ForceRedraw=!0)}},{key:"selectedItems",get:function(){return this._SelectedItems.slice(0)}},{key:"numSelectedItems",get:function(){return this._SelectedItems.length}},{key:"isDragDisabled",get:function(){return this._IsDragDisabled},set:function(e){this._IsDragDisabled=e}},{key:"willSelectionsDraw",get:function(){return!this._WantSelectionDisabled}},{key:"isSelectionDisabled",get:function(){return this._IsSelectionDisabled},set:function(e){this._HoverItem=null,this._WantSelectionDisabled!==e&&(this._WantSelectionDisabled=e,this.updateSelectionDisabled())}},{key:"isPanning",get:function(){return this.isEnabled(fe.PanModifier)},set:function(e){e?this.enableState(fe.PanModifier):this.disableState(fe.PanModifier)}},{key:"isGrabbing",get:function(){return this.isEnabled(fe.Pan)},set:function(e){e?this.enableState(fe.Pan):this.disableState(fe.Pan)}},{key:"zoom",get:function(){return this._ScaleTarget},set:function(e){var t=this.getVisibleStageArea();this.zoomTo(t.left+t.width/2,t.bottom-t.height/2,e)}},{key:"appContext",get:function(){return this._AppContext}},{key:"graphics",get:function(){return this._Graphics}},{key:"toolType",get:function(){return this._CurrentTool&&this._CurrentTool.constructor||null},set:function(e){this.selectTool(e)}},{key:"tool",get:function(){return this._CurrentTool}},{key:"selectionFilter",get:function(){return this._SelectionFilter},set:function(e){if(this.disableSelectionFilter)console.info("Changing the selection filter is currently disabled.");else{this._SelectionFilter=e,this._CurrentTool&&this._CurrentTool.updateSelection(this.getFilteredSelectedItems()),this.dispatchSelectionChanged();for(var t=this.canSelect,n=0;n<this._StageItems.length;n++){var r=this._StageItems[n];r.isFiltered=!t(r)}this.dispatch("selectionFilterChanged",e)}}},{key:"disableSelectionFilter",set:function(e){e?(this._DisabledSelectionFilter=this._SelectionFilter,this._SelectionFilter=new C.default):this._DisabledSelectionFilter&&(this._SelectionFilter=this._DisabledSelectionFilter,this._DisabledSelectionFilter=null)},get:function(){return!!this._DisabledSelectionFilter}},{key:"currentOperation",get:function(){return this._CurrentOperation}},{key:"viewTransform",get:function(){return this._ViewTransform}},{key:"inverseViewTransform",get:function(){return this._InverseViewTransform}},{key:"scale",get:function(){return this._Scale}},{key:"screenScale",get:function(){return this._ScreenScale}},{key:"translation",get:function(){return this._Translation}},{key:"worldMouse",get:function(){return this._WorldMouse}},{key:"settings",get:function(){return this._Settings}},{key:"hoverItem",get:function(){return this._HoverItem},set:function(e){this._HoverItem!=e&&(this._HoverItem=e,this._ForceRedraw=!0,this.dispatchHoverItemChange())}},{key:"selectionTarget",get:function(){return this._SelectionTarget}},{key:"isDraggingTool",get:function(){return!!this._ActiveDragTool}},{key:"isReady",get:function(){return!!ue}}]),t}()).prototype,"zoomFit",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"zoomFit"),r.prototype),le(r.prototype,"clearMouseDownSelected",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"clearMouseDownSelected"),r.prototype),le(r.prototype,"onMouseDown",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDown"),r.prototype),le(r.prototype,"selectContextMenuNode",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"selectContextMenuNode"),r.prototype),le(r.prototype,"onMouseUp",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseUp"),r.prototype),le(r.prototype,"canSelect",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"canSelect"),r.prototype),le(r.prototype,"onMouseMove",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseMove"),r.prototype),le(r.prototype,"onMouseEnterStage",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseEnterStage"),r.prototype),le(r.prototype,"onMouseLeaveStage",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseLeaveStage"),r.prototype),le(r.prototype,"onMouseEnter",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseEnter"),r.prototype),le(r.prototype,"onMouseLeave",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseLeave"),r.prototype),le(r.prototype,"onMouseWheel",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseWheel"),r.prototype),le(r.prototype,"onKeyDown",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyDown"),r.prototype),le(r.prototype,"onKeyUp",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyUp"),r.prototype),le(r.prototype,"doUpdateHighlights",[s.default],Object.getOwnPropertyDescriptor(r.prototype,"doUpdateHighlights"),r.prototype),r);t.default=de;var fe={PanModifier:1,Pan:2,Drag:3},he=[{state:fe.Pan,cursor:"none",custom:d.default.make("/images/cursor-grabbing.png"),width:17,height:16},{state:fe.PanModifier,cursor:"none",custom:d.default.make("/images/cursor-grab.png"),width:20,height:20}],pe=10,ye=40,ve=800},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=s(n(2)),a=s(n(327));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var u=(l((r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Nima=t,this._Journal=[],this._JournalIndex=-1,this._LastAnimationList=null,this._LastSelectedAnimation=null,this._LastState=new Map}return o(e,[{key:"activate",value:function(){this._Nima.setSelectionCallbacks(this.selectAnimationIndex,this.selectNextAnimation,this.selectPreviousAnimation)}},{key:"deactivate",value:function(){this._Nima.setSelectionCallbacks(null,null,null)}},{key:"selectAnimationIndex",value:function(e){var t=this.artboard;e>=0&&e<t.animations.length&&this._Nima.selectItem(t.animations[e])}},{key:"selectNextAnimation",value:function(){var e=this.artboard;this.selectAnimationIndex(e.animations.indexOf(this._Nima.editingAnimation)+1)}},{key:"selectPreviousAnimation",value:function(){var e=this.artboard;this.selectAnimationIndex(e.animations.indexOf(this._Nima.editingAnimation)-1)}},{key:"getJournalEntry",value:function(){var e=this.artboard,t=this._Nima.editingAnimation,n=t.captureJournalEntry();n&&(n={animation:t,animationEntry:n});var r=!0;if(this._LastAnimationList&&e.animations.length==this._LastAnimationList.length){for(var o=0;o<e.animations.length;o++)if(e.animations[o]!=this._LastAnimationList[o]){r=!1;break}}else r=!1;r||(n||(n={}),n.listTo=e.animations.slice(0),n.listFrom=this._LastAnimationList,this._LastAnimationList=e.animations.slice(0)),this._LastSelectedAnimation!=t&&(n||(n={}),n.selectedAnimationFrom=this._LastSelectedAnimation,n.selectedAnimationTo=t,this._LastSelectedAnimation=t);var i=new Map,s=this._LastState,l=[],u=!0,c=!1,d=void 0;try{for(var f,h=e.animations[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value,y=p.serializeInteractive();i.set(p,y);var v=s.get(p);if(v)for(var m in y){var g=!0,b=y[m],k=v[m];if(void 0!==b&&void 0!==k){if(null===b)g=b===k;else switch(b.constructor){case Boolean:case Number:case String:b!==k&&(g=!1);break;case Array:case Float32Array:if(k&&b.length===k.length){for(var S=0;S<b.length;S++)if(b[S]!==k[S]){g=!1;break}}else g=!1;break;default:b!=k&&(g=!1)}g||l.push(new a.default(p,m,k,b))}}}}catch(e){c=!0,d=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw d}}return this._LastState=i,l.length&&(n||(n={}),n.stateChanges=l),n}},{key:"captureJournalEntry",value:function(){var e=this.getJournalEntry();e&&(this._JournalIndex!=this._Journal.length-1&&this._Journal.splice(this._JournalIndex+1,this._Journal.length-(this._JournalIndex+1)),this._Journal.push(e),this._JournalIndex=this._Journal.length-1,this._Nima.actor.revise())}},{key:"undo",value:function(){var e=this.artboard;if(this.captureJournalEntry(),-1!=this._JournalIndex){var t=this._Journal[this._JournalIndex];this._JournalIndex--,t.animation&&t.animationEntry&&t.animation.applyEntry(t.animationEntry,!0),t.listFrom&&(e.animations=t.listFrom),t.animation?this.setEditingAnimation(t.animation):t.selectedAnimationFrom&&this.setEditingAnimation(t.selectedAnimationFrom);var n=t.stateChanges;if(n){var r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){a.value.undo()}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}}this.getJournalEntry(),this._Nima.actor.revise()}}},{key:"setEditingAnimation",value:function(e){var t=this.artboard;-1!==t.animations.indexOf(e)?this._Nima.editingAnimation=e:t.animations.length&&(this._Nima.editingAnimation=t.animations[0])}},{key:"redo",value:function(){var e=this.artboard;if(this.captureJournalEntry(),!(this._JournalIndex+1>this._Journal.length-1)){this._JournalIndex++;var t=this._Journal[this._JournalIndex];t.animation&&t.animationEntry&&t.animation.applyEntry(t.animationEntry,!1),t.listTo&&(e.animations=t.listTo),t.animation?this.setEditingAnimation(t.animation):t.selectedAnimationTo&&this.setEditingAnimation(t.selectedAnimationTo);var n=t.stateChanges;if(n){var r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){a.value.redo()}}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}}this.getJournalEntry(),this._Nima.actor.revise()}}},{key:"artboard",get:function(){return this._Nima.actor.artboards.active}}]),e}()).prototype,"selectAnimationIndex",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"selectAnimationIndex"),r.prototype),l(r.prototype,"selectNextAnimation",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"selectNextAnimation"),r.prototype),l(r.prototype,"selectPreviousAnimation",[i.default],Object.getOwnPropertyDescriptor(r.prototype,"selectPreviousAnimation"),r.prototype),r);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(229)),o=n(7),i=a(n(198));a(n(173));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(e,n,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),u=l._Stage.selectedItems;if(0==u.length)return s(l);for(var c=null,d=Number.MAX_SAFE_INTEGER,f=[],h=o.vec2.create(),p=0;p<u.length;p++){var y=u[p];if((!y.node||y.node.isNode&&y.node.constructor!==i.default)&&(y.node&&-1==f.indexOf(y))){o.vec2.add(h,h,y.node.worldTranslation),f.push(y.node);var v=y.node.parent.treeDepth;(null==c||v<d)&&(d=v,c=y.node.parent)}}if(null===c)return s(l);o.vec2.scale(h,h,1/u.length);var m=o.mat2d.invert(o.mat2d.create(),c.worldTransform),g=o.vec2.transformMat2d(o.vec2.create(),h,m),b=l._Actor.addNodeType(r,c,null);if(!b)return s(l);b.name=a||"New Group",b.translation=g,b.stageItem.addToStage(l._Stage);for(var k=0;k<f.length;k++){var S=f[k];b.add(S),S.compensate()}return l._Stage.selectItem(b.stageItem),l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){for(var u=[],c=[],d=0;d<e.length;d++){var f=e[d],h=n(e[d]),p=l(h);-1===t.indexOf(p)?u.push(f):c.push(f)}for(var y={},v=0;v<c.length;v++){var m=c[v],g=n(c[v]);if((g=s(g)).match(r)){var b=g.replace(r,"");y[b]?y[b].push(m):y[b]=[m]}else y[g]=[m]}var k={};for(var S in y){var O=n(y[S][0]),w=a(O);if(w.length)if(w.length<2){for(var _=0;_<y[S].length;_++){var P=y[S][_];k[S]?k[S].array.push(P):(k[S]={},k[S].array=[P],k[S].idx=0)}k[S]=i(k[S],n)}else{var C=o(y[S],n);for(var E in C)k[E]=i(C[E],n)}else k[S]=[y[S][0]]}var T=[];for(var I in k)T.push({name:I,items:k[I]});for(var j=0;j<u.length;j++)T.push({name:n(u[j]),items:[u[j]]});return T};var r=/([-_.:])?([0-9]+)/g;function o(e,t){for(var n={},o=new RegExp(r),i=0;i<e.length;i++){var a=void 0,l=t(e[i]);for(n[l]=[];null!=(a=o.exec(l));){var u=l.substring(0,a.index)+l.substring(a.index+a[0].length,l.length),c={trimmed_filename:u=s(u),object:e[i]};n[l].push(c)}}for(var d=Object.keys(n),f={},h=0;h<d.length;h++){for(var p=!1,y=d[h],v=0;v<n[y].length;v++){var m=n[y][v].trimmed_filename;if(f[m])f[m].array.push(n[y][v].object),f[m].array.idx=v,p=!0;else for(var g=0;g<d.length;g++){var b=d[g];if(y!=b)for(var k=0;k<n[b].length;k++)if(m==n[b][k].trimmed_filename){f[m]={},f[m].array=[n[y][v].object],f[m].idx=v,p=!0;break}}}p||(f[y]={},f[y].array=[n[y][0].object],f[y].idx=0)}return f}function i(e,t){for(var n=new RegExp(r),o=[],i=0;i<e.array.length;i++){var a={};a.obj=e.array[i];for(var s=void 0,l=0,u=t(a.obj);null!=(s=n.exec(u));)l==e.idx&&(a.val=s[2],o.push(a)),l++}return o.sort(function(e,t){return e.val-t.val}),o.map(function(e){return e.obj})}function a(e){var t=e.match(/[0-9]+/g);return t?t.map(function(e){return e}):[]}function s(e){var t=e.lastIndexOf(".");return-1==t?e:e.substring(0,t)}function l(e){var t=e.lastIndexOf(".");return-1===t?null:e.substr(t+1).toLowerCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(1)),a=u(n(2)),s=u(n(164)),l=u(n(1623));function u(e){return e&&e.__esModule?e:{default:e}}var c,d,f,h,p,y,v=(r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),o(t,[{key:"onClose",value:function(){this.props.onClose&&this.props.onClose()}},{key:"render",value:function(){var e=void 0;return e=-1!=navigator.userAgent.indexOf("Mac OS X")?"CMD":"CTRL",i.default.createElement(s.default,{modalClass:l.default.ShortcutsModal,isOpen:this.props.isOpen,isClosing:this.props.isClosing,onClose:this.onClose},i.default.createElement("div",{className:l.default.ShortcutsWrapper},i.default.createElement("div",{className:l.default.ShortcutsContent},i.default.createElement("div",{className:l.default.Column},i.default.createElement("div",{className:l.default.Section+" "+l.default.Stage},i.default.createElement("div",{className:l.default.Header},"Stage"),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:".5"}},"Pan:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},"Right-click and drag."),i.default.createElement("div",{className:l.default.Shortcut},"Hold ",i.default.createElement("kbd",{className:l.default.kbd},"Spacebar"),i.default.createElement("br",null),"and drag"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:".3"}},"Zoom:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},"Mousewheel up/down ",i.default.createElement("br",null),"(hold ",i.default.createElement("kbd",{className:l.default.kbd},"CTRL")," for finer steps)"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:".5"}},"Zoom in:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"+")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:".8"}},"Zoom out:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"-")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Actual size:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"0")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Fit:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"F")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Select all:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"A")))),i.default.createElement("div",{className:l.default.Note},'If an object is already selected, the "select all" shortcut will first select all objects of that type. Press the shortcut again to select all object types.'),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Deselect all:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"D")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Marquee add:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"Shift")," drag"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Marquee subtract:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"Alt")," drag"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Marquee toggle:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," drag"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Nudge 1px:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},"Arrow keys"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:".8"}},"Nudge 10px:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"SHIFT")," arrow keys"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:".6"}},"Show Rulers and Guides:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},";")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:".8"}},"Clear Guides:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"SHIFT")," ",i.default.createElement("kbd",{className:l.default.kbd},";")))))),i.default.createElement("div",{className:l.default.Column},i.default.createElement("div",{className:l.default.Section+" "+l.default.Hierarchy},i.default.createElement("div",{className:l.default.Header},"Hierarchy"),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:"1.2"}},"Expand/collapse all children:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"ALT")," click expand button"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Toggle visibility without ",i.default.createElement("br",null),"affecting children:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," click visibility icon"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:"1"}},"Toggle visibility of other objects:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"ALT")," click visibility icon"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:"1"}},"Toggle visibility of other objects including children:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"ALT")," click visibility icon"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Scroll to hovered item:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"H")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Filter:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"F"))))),i.default.createElement("div",{className:l.default.SectionDivider}),i.default.createElement("div",{className:l.default.Section+" "+l.default.Timeline},i.default.createElement("div",{className:l.default.Header},"Timeline"),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Play/Pause:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"Spacebar")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:".7"}},"Pan timeline:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},"Right-click and drag."),i.default.createElement("div",{className:l.default.Shortcut},"Hold ",i.default.createElement("kbd",{className:l.default.kbd},"Spacebar")," and drag"))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Skip to keys:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},",")," or ",i.default.createElement("kbd",{className:l.default.kbd},".")))),i.default.createElement("div",{className:l.default.Note},"If no object is selected, this shortcut will jump to all keys. Otherwise the shortcut will jump to keys of the selected object."),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Key all:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"K")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Key translate:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"Shift")," ",i.default.createElement("kbd",{className:l.default.kbd},"T")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Key rotation:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"Shift")," ",i.default.createElement("kbd",{className:l.default.kbd},"R")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Key scale:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"Shift")," ",i.default.createElement("kbd",{className:l.default.kbd},"S")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Key bone length:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"Shift")," ",i.default.createElement("kbd",{className:l.default.kbd},"L")))))),i.default.createElement("div",{className:l.default.Column+" "+l.default.ColumnTools},i.default.createElement("div",{className:l.default.Section},i.default.createElement("div",{className:l.default.Header},"Tools"),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:".5"}},"Undo:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"Z")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:".4"}},"Redo:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"SHIFT")," ",i.default.createElement("kbd",{className:l.default.kbd},"Z")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:"1.5"}},"Pick child:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"C")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:"1.5"}},"Pick parent:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"P")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Translate:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"T")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Rotate:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"R")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Scale:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"S")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"IK Pose:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"X")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Rectangle:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"U")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Ellipse:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"O")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Pen:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"V")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Artboard:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"A")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Bone:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"B")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Node:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"G")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:"1"}},"Group selection into Node:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"G")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action},"Solo:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},"Y")))),i.default.createElement("div",{className:l.default.ShortcutWrapper},i.default.createElement("div",{className:l.default.Action,style:{flex:"1"}},"Group selection into Solo:"),i.default.createElement("div",{className:l.default.Commands},i.default.createElement("div",{className:l.default.Shortcut},i.default.createElement("kbd",{className:l.default.kbd},e)," ",i.default.createElement("kbd",{className:l.default.kbd},"Y")))))))))}}]),t}(),c=r.prototype,d="onClose",f=[a.default],h=Object.getOwnPropertyDescriptor(r.prototype,"onClose"),p=r.prototype,y={},Object.keys(h).forEach(function(e){y[e]=h[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=f.slice().reverse().reduce(function(e,t){return t(c,d,e)||e},y),p&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(p):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(c,d,y),y=null),r);t.default=v},function(e,t,n){var r=n(1624);"string"==typeof r&&(r=[[e.i,r,""]]);var o={insertAt:"top",hmr:!0,transform:void 0};n(14)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){(t=e.exports=n(13)(!1)).push([e.i,".source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-ShortcutsWrapper-3XFhE {\n  overflow: hidden;\n  overflow-y: auto; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-ShortcutsContent-1aPhK {\n  padding: 0 30px;\n  font-weight: 400;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  color: #888;\n  -webkit-user-select: text;\n     -moz-user-select: text;\n      -ms-user-select: text;\n          user-select: text;\n  line-height: 21px;\n  position: relative; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Column-3Nd7f {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  border-left: 1px solid #eaeaea;\n  padding-left: 30px;\n  padding-top: 40px;\n  padding-bottom: 40px;\n  margin-left: 30px;\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Column-3Nd7f:first-child {\n  margin-left: 0;\n  border-left: 0;\n  padding-left: 0; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-SectionDivider-1vZRu {\n  height: 1px;\n  background: #eaeaea;\n  margin-left: -30px;\n  margin-right: -30px;\n  margin-top: -19px;\n  margin-bottom: 37px; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-ShortcutsModal-1TTBv {\n  width: 860px !important;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Section-1qlYg {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  margin-bottom: 60px; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Section-1qlYg:first-child {\n  margin-top: 0; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-ShortcutWrapper-28inX {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  margin-top: 32px; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Header-3ix05 {\n  font-size: 20px;\n  font-weight: 400;\n  color: #333; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Action-3zYTs {\n  -webkit-box-flex: 1.8;\n      -ms-flex: 1.8;\n          flex: 1.8;\n  font-weight: 400;\n  margin-right: 10px; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Commands-71ock {\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  list-style: circle;\n  padding: 0;\n  margin: 0; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Shortcut-17QrY {\n  margin-top: 20px;\n  text-align: right;\n  color: #666;\n  font-weight: 600; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Shortcut-17QrY:first-child {\n  margin-top: 0; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Note-2VZiN {\n  font-style: oblique;\n  margin-top: 10px;\n  line-height: 21px;\n  background: #f7f7f7;\n  border-radius: 10px;\n  padding: 15px 15px 15px 56px; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Note-2VZiN::before {\n  content: \"Note:\";\n  position: absolute;\n  margin-left: -41px; }\n\n.source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-kbd-Hewjq {\n  font-family: 'Roboto', sans-serif;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  font-style: normal;\n  padding: 3px 5px;\n  color: #666;\n  font-weight: 600;\n  text-transform: uppercase; }\n",""]),t.locals={ShortcutsWrapper:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-ShortcutsWrapper-3XFhE",ShortcutsContent:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-ShortcutsContent-1aPhK",Column:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Column-3Nd7f",SectionDivider:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-SectionDivider-1vZRu",ShortcutsModal:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-ShortcutsModal-1TTBv",Section:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Section-1qlYg",ShortcutWrapper:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-ShortcutWrapper-28inX",Header:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Header-3ix05",Action:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Action-3zYTs",Commands:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Commands-71ock",Shortcut:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Shortcut-17QrY",Note:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-Note-2VZiN",kbd:"source-client-source-editors-flare-ui-Components-Settings-ShortcutsStyles-kbd-Hewjq"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=new Map,i=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._Label=t,this._Title=n,this._Description=r,this._HelpLink=i,o.set(t,this)}return r(e,[{key:"toString",value:function(){return this._Label}},{key:"title",get:function(){return this._Title}},{key:"description",get:function(){return this._Description}},{key:"helpLink",get:function(){return this._HelpLink}}],[{key:"fromString",value:function(t){return o.get(t)||e.Unknown}}]),e}();t.default=i,i.Unknown=new i(null,"Error occurred.","Please make sure you are running a supported browser.","https://www.2dimensions.com/b/55-browser-support"),i.WebGLDisabled=new i("webgl-disabled","WebGL is disabled.","WebGL is required to run Nima. Please enable it in your browser settings.","https://medium.com/2dimensions/webgl-and-nima-c0ff97ef2359")},,function(e,t,n){"use strict";(function(e){var t=o(n(26)),r=o(n(1628));function o(e){return e&&e.__esModule?e:{default:e}}(0,t.default)(e,r.default,!0)}).call(this,n(165)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=u(n(2)),s=u(n(633)),l=u(n(263));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,r,o){var i={};return Object.keys(r).forEach(function(e){i[e]=r[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var d=(c((r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._TestCB=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),o(t,[{key:"componentWillMount",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillMount",this).call(this),this.nima.revisionManager.addEventListener("stateChanged",this.onRMStateChanged)}},{key:"componentDidMount",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidMount",this).call(this),window.tests={},window.tests.importSVG=this.importSVG.bind(this)}},{key:"componentWillUnmount",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this),this.nima.revisionManager.removeEventListener("stateChanged",this.onRMStateChanged)}},{key:"onRMStateChanged",value:function(e){if(this._TestCB&&e.state===l.default.Idle){var t=this._TestCB;this._TestCB=null,t("DONE")}}},{key:"importSVG",value:function(e){return this._TestCB=e,"trying..."}}]),t}()).prototype,"componentWillMount",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"componentWillMount"),r.prototype),c(r.prototype,"componentDidMount",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"componentDidMount"),r.prototype),c(r.prototype,"componentWillUnmount",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"componentWillUnmount"),r.prototype),c(r.prototype,"onRMStateChanged",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"onRMStateChanged"),r.prototype),c(r.prototype,"importSVG",[a.default],Object.getOwnPropertyDescriptor(r.prototype,"importSVG"),r.prototype),r);t.default=d}])]);
//# sourceMappingURL=FlareBase.d2cc35cfa50840d8d943.js.map